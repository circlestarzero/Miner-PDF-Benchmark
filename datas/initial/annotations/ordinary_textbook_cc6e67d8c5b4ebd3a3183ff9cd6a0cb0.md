数学新星网 $\%$ 学生专栏

www.nsmath.cn/xszl

# 2023 年国家集训队第一轮选拔考试试题解析 

王淳稷 孙启傲

(上海市上海中学, 200237)

指导教师: 王广廷

2023 年 3 月, 国际数学奥林匹克中国国家队的第一轮选拔在成都嘉祥外国语高级中学举行. 本次试题新颖有趣, 值得思考与研究. 因作者水平有限, 不当之处在所难免. 请读者不吝赐教.

## I. 试 题

1. 设整数 $n \geq 2, A_{1} A_{2} \cdots A_{2 n}$ 是圆内接凸 $2 n$ 边形. 已知形内存在一点 $P$, 满足

$$
\angle P A_{1} A_{2}=\angle P A_{2} A_{3}=\cdots=\angle P A_{2 n} A_{1}
$$

求证:

$$
\prod_{i=1}^{n}\left|A_{2 i-1} A_{2 i}\right|=\prod_{i=1}^{n}\left|A_{2 i} A_{2 i+1}\right|
$$

其中 $A_{2 n+1}=A_{1}$.

2. 某次聚会有 $n$ 个人参加. 已知其中共有不超过 $n$ 对朋友, 且两人握手当且仅当他们有公共朋友. 设整数 $m \geq 3$, 且满足 $n \leq m^{3}$. 求证: 存在一个人 $A, A$ 握过手的人数不超过 $A$ 的朋友数的 $m-1$ 倍.
3. (1) 设 $a, b$ 为互质的正整数. 求证: 存在实数 $\lambda, \beta$, 使得对任意正整数 $m$, 均有

$$
\lambda m-\beta \leq \sum_{k=1}^{m-1}\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\} \leq \lambda m+\beta
$$

(2) 求证: 存在正整数 $N$, 使得对任意质数 $p>N$, 若正整数 $a, b, c$ 满足 $p$ 不整除 $(a+b)(b+c)(c+a)$, 则至少存在 $\left[\frac{p}{12}\right]$ 个 $1 \leq k \leq p-1$, 使得

$$
\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\} \leq 1 .
$$

修订日期: 2023-06-20.

4. 对正整数 $m, n$, 记

$$
S(m, n)=\left\{(a, b) \in \mathbb{N}_{+}^{2} \mid 1 \leq a \leq m, 1 \leq b \leq n, \operatorname{gcd}(a, b)=1\right\}
$$

求证：对任意正整数 $d, r$, 存在不小于 $d$ 的整数 $m, n$, 使得

$$
|S(m, n)| \equiv r \quad(\bmod d)
$$

5. 设 $P_{1}, \cdots, P_{n}$ 是 $\triangle A B C$ 内的点, 满足 $P_{1}, \cdots, P_{n}, A, B, C$ 中任意三点不共线. 求证: 可以将 $\triangle A B C$ 划分为 $2 n+1$ 个小三角形, 使得每个小三角形的顶点都来自 $P_{1}, \cdots, P_{n}, A, B, C$, 且含 $A, B, C$ 中至少一个的小三角形不少于 $n+\sqrt{n}+1$个.
6. 求证: (1) 在复平面中, 每条过原点的直线 (实轴除外) 上至多有一点 $z$, 使得 $\frac{1+z^{23}}{z^{64}}$ 是实数.

(2) 对任意非零复数 $a$ 和任意实数 $\theta$, 方程 $1+z^{23}+a z^{64}=0$ 在

$$
S_{\theta}=\left\{z \in \mathbb{C}\left|\operatorname{Re}\left(z e^{-i \theta}\right) \geq\right| z \left\lvert\, \cos \frac{\pi}{20}\right.\right\}
$$

中都有根.

7. 给定整数 $n \geq 2$ 及与 $n$ 互质的整数 $a$. 一个国家有 $n$ 座小岛 $D_{1}, D_{2}, \cdots$, $D_{n}$, 对任意 $1 \leq i \neq j \leq n, D_{i}$ 到 $D_{j}$ 有单向轮渡当且仅当 $i j \equiv i a(\bmod n)$. 一个游客初始时可以坐飞机到达任意一个小岛, 之后只能乘坐单向轮渡. 问: 他最多可以游览多少座小岛?
8. 在非等腰锐角 $\triangle A B C$ 中, $A P, B Q, C R$ 是高, $H$ 是垂心. $A_{1}$ 是 $B C$ 的中点, $A A_{1}$ 交 $Q R$ 于点 $K, Q R$ 交过 $A$ 且平行于 $B C$ 的直线于点 $D, A H$ 的中点与 $K$ 的连线交 $D A_{1}$ 于点 $A_{2}$. 类似定义点 $B_{2}, C_{2}$. 已知 $\triangle A_{2} B_{2} C_{2}$ 非退化, 其外接圆为 $\omega$.求证: 存在 $\omega$ 内与之相切的圆 $A^{\prime}, B^{\prime}, C^{\prime}$, 满足:

(1) 圆 $A^{\prime}$ 与 $A B, A C$ 相切、圆 $B^{\prime}$ 与 $B C, B A$ 相切、圆 $C^{\prime}$ 与 $C A, C B$ 相切;

(2) $A^{\prime}, B^{\prime}, C^{\prime}$ 不同且共线.

9. 求最大的正整数 $m$, 使得可以将一个 $70 \times 70$ 方格表中的一些格染红, 满足:

(1) 不存在两个红格, 它们所在行中红格数相同, 所在列中红格数也相同;

(2) 存在两行中恰有 $m$ 个红格.

10. 称非空整数集 $A$ 是 “优美的”, 如果对任意 $a \in A, 1 \leq k \leq 2023$, 集合

$$
\left\{b \in A:\left[\frac{b}{3^{k}}\right]=\left[\frac{a}{3^{k}}\right]\right\}
$$

的元素个数恰为 $2^{k}$. 求证: 若整数集 $S$ 与任意优美集合的交非空, 则 $S$ 包含一个优美的集合.

11. 设 $n$ 是正整数, $a_{i j k} \in\{-1,1\}(1 \leq i, j, k \leq n)$. 求证: 存在 $x_{1}, \cdots, x_{n}$, $y_{1}, \cdots, y_{n}, z_{1}, \cdots, z_{n} \in\{-1,1\}$, 使得

$$
\left|\sum_{i=1}^{n} \sum_{j=1}^{n} \sum_{k=1}^{n} a_{i j k} x_{i} y_{j} z_{k}\right|>\frac{n^{2}}{3}
$$

12. 求证: 存在正实数 $\lambda$, 使得对任意实数 $D>1$, 在平面直角坐标系中都存在一个锐角三角形, 满足:

(1) 三角形的顶点均为整点;

(2) 三角形的边长均大于 $D$;

(3) 三角形的面积小于 $\frac{\sqrt{3}}{4} D^{2}+\lambda D^{\frac{4}{5}}$.

## II . 解答与评注

1. 设整数 $n \geq 2, A_{1} A_{2} \cdots A_{2 n}$ 是圆内接凸 $2 n$ 边形. 已知形内存在一点 $P$, 满足

$$
\angle P A_{1} A_{2}=\angle P A_{2} A_{3}=\cdots=\angle P A_{2 n} A_{1}
$$

求证:

$$
\prod_{i=1}^{n}\left|A_{2 i-1} A_{2 i}\right|=\prod_{i=1}^{n}\left|A_{2 i} A_{2 i+1}\right|
$$

其中 $A_{2 n+1}=A_{1}$.

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-03.jpg?height=668&width=776&top_left_y=1596&top_left_x=640)

证明 延长 $A_{1} P, A_{2} P, \cdots, A_{2 n} P$ 分别交圆与 $B_{1}, B_{2}, \cdots, B_{2 n}$, 设圆心为 $O$.

不妨设 $A_{1} A_{2} \cdots A_{2 n}$ 按顺时针排列, 设 $\alpha=\angle P A_{1} A_{2}=\angle P A_{2} A_{3}=\cdots=$ $\angle P A_{2 n} A_{1}$. 则对任意 $1 \leq i \leq 2 n, \angle B_{i} O A_{i+1}=2 \angle P A_{i} A_{i+1}=2 \alpha($ 下标 $\bmod 2 n$ 考虑, 下同), 故 $B_{1} B_{2} \cdots B_{2 n}$ 是 $A_{2} A_{3} \cdots A_{2 n} A_{1}$ 绕 $O$ 顺时针旋转 $2 \alpha$ 所得多边形, 故

$$
\left|A_{i} A_{i+1}\right|=\left|B_{i-1} B_{i}\right| .
$$

又因为对任意 $1 \leq i \leq 2 n, \triangle A_{i} A_{i+1} P \sim \triangle B_{i+1} B_{i} P$, 故

$$
\frac{\left|A_{i} A_{i+1}\right|}{\left|B_{i+1} B_{i}\right|}=\frac{\left|A_{i} P\right|}{\left|B_{i+1} P\right|}=\frac{\left|A_{i+1} P\right|}{\left|B_{i} P\right|} .
$$

因此,

$$
\begin{aligned}
\prod_{i=1}^{n} \frac{\left|A_{2 i-1} A_{2 i}\right|}{\left|A_{2 i} A_{2 i+1}\right|} & =\prod_{i=1}^{n} \frac{\left|A_{2 i-1} A_{2 i}\right|}{\left|B_{2 i} B_{2 i-1}\right|}=\prod_{i=1}^{n} \frac{\left|A_{2 i-1} P\right|}{\left|B_{2 i} P\right|}=\prod_{i=1}^{n} \frac{\left|A_{2 i-1} P\right|}{\left|B_{2 i-2} P\right|} \\
& =\prod_{i=1}^{n} \frac{\left|A_{2 i-1} A_{2 i-2}\right|}{\left|B_{2 i-2} B_{2 i-1}\right|}=\prod_{i=1}^{n} \frac{\left|A_{2 i} A_{2 i+1}\right|}{\left|A_{2 i-1} A_{2 i}\right|} .
\end{aligned}
$$

故

$$
\prod_{i=1}^{n}\left|A_{2 i-1} A_{2 i}\right|=\prod_{i=1}^{n}\left|A_{2 i} A_{2 i+1}\right|
$$

得证!

评注 本题是一道简单的几何题, 将多边形反演后, 发现恰好可以由原多边形旋转得到, 然后导边的比例即可.

2. 某次聚会有 $n$ 个人参加。包知其中共有不超过 $n$ 对朋友, 且两人握手当且仅当他们有公共朋友. 设整数 $m \geq 3$, 且满足 $n \leq m^{3}$. 求证: 存在一个人 $A, A$ 握过手的人数不超过 $A$ 的朋友数的 $m-1$ 倍.

证明 (反证法) 若每个人握手的人数均大于其朋友数的 $m-1$ 倍.

以 $n$ 个人为顶点, 两人是朋友则连边, 构成图 $G$, 记 $A \sim B$ 表示 $A$ 与 $B$ 连边.设 $G$ 有 $k$ 条边, 则 $k \leq n$.

不妨设图 $G$ 联通, (否则考虑一个 $G$ 的联通分支, 其边数小于等于点数, 即可)不妨设 $n \geq 3$, 否则显然成立.

故 $k=n-1$ 或 $n$, 因此图 $G$ 是树或基环树.

(1) 图 $G$ 是树, 则取图 $G$ 的最长链 $A_{1} A_{2} \cdots A_{l}(l \geq 3)$. 显然 $A_{1}$ 只有 $A_{2}$ 这一个邻点.

考虑 $A_{2}$, 若 $A_{2}$ 的邻点中除了 $A_{3}$ 以外还有度数 $\geq 2$ 的点, 设为 $A$, 则 $A \neq A_{1}, A_{2}, \cdots, A_{l}$.

设 $A \sim B, B \neq A_{2}$, 则因为 $G$ 是一棵树(无圈), 故 $B \neq A_{1}, A_{2}, \cdots, A_{l}$, 故 $B \sim A \sim A_{1} \sim \cdots \sim A_{l}$ 是一个长为 $l+1$ 的链, 矛盾!

故 $A_{2}$ 的邻点中度为 2 的点至多只有一个 $\left(A_{3}\right)$, 并且至少有一个度为 1 的邻点 $\left(A_{1}\right)$.

(2) 图 $G$ 是基环树, 则设图 $G$ 唯一的圈: $A_{1} A_{2} \cdots A_{k} A_{1}(k \geq 3)$.

若除了 $A_{1} A_{2} \cdots A_{k}$ 以外的每个点均与 $A_{1} A_{2} \cdots A_{k}$ 中的某个点连边, 则设 $A_{i}$
度数为 $d_{i}$ (任意 $1 \leq i \leq n$ ) 不妨设 $d_{1}=\max \left\{d_{1}, d_{2}, \cdots, d_{n}\right\}$. 故 $A_{1}$ 有 $d_{1}$ 个月友,与 $\leq\left(d_{2}-1\right)+\left(d_{n}-1\right)<(m-1) d_{1}$ 个人握手, 矛盾!

否则, 设 $A$ 是到 $A_{1} A_{2} \cdots A_{k}$ 距离最远的点, 设最短路为 $A \sim B_{1} \sim B_{2} \sim \cdots \sim$ $B_{t} \sim A_{i}(1 \leq i \leq k)$, 则 $t \geq 1$.

则类似 (1) 中分析可知: $B_{1}$ 的邻点中度为 2 的点至多只有一个 $\left(B_{2}\right)$, 并且至少有一个度为 1 的邻点 $(A)$ (否则就能找到距离 $A_{1} A_{2} \cdots A_{k}$ 更远的点).

综合 (1)(2) 知, 存在顶点 $C$, 使 $C$ 至多与一个度 $\geq 2$ 的点相连, 并且至少有一个度为 1 的邻点.

又因为 $C$ 握过手, 所以 $C$ 一定恰与一个度 $\geq 2$ 的点相连, 设为 $D$.

设 $C$ 恰与 $k$ 个度数为 1 的点相连: $C_{1}, C_{2}, \cdots, C_{k}(k \geq 1)$. 则 $C_{1}$ 与 $C_{2}, \cdots$, $C_{k}, D$ 这 $k$ 个人握手, 且恰有 1 个朋友 $C$. 故 $k>m-1, k \geq m$.

设 $D$ 有 $s$ 个朋友, 则 $C$ 与 $D$ 除 $C$ 外的 $s-1$ 个朋友握手, 且恰有 $k+1$ 个朋友. 故

$$
s-1>(m-1)(k+1)>(m-1)(m+1)=m^{2}-1 .
$$

所以 $s \geq m^{2}+1$, 与 $D$ 握手的人数

$$
\geq(m-1) s+1 \geq(m-1)\left(m^{2}+1\right)+1=m^{3}-m^{2}+m
$$

所以总人数 $\geq\left(m^{3}-m^{2}+m\right)+\left(m^{2}-1\right)+1>m^{3}$, 矛盾!

故得证.

评注 本题是一道不难的组合题. 不妨联通, 进而图 $G$ 是树或基环树, 然后对树的结构进行局部分析即可. 另外, 为了说明存在满足解答中所说条件的顶点 $C$还有另一种办法: 把原图中所有度为 1 的点删去, 在剩下的图中任意找一个度数为 1 的点, 则符合要求.

3. (1) 设 $a, b$ 为互质的正整数. 求证: 存在实数 $\lambda, \beta$, 使得对任意正整数 $m$, 均有

$$
\lambda m-\beta \leq \sum_{k=1}^{m-1}\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\} \leq \lambda m+\beta .
$$

(2) 求证: 存在正整数 $N$, 使得对任意质数 $p>N$, 若正整数 $a, b, c$ 满足 $p$ 不整除 $(a+b)(b+c)(c+a)$, 则至少存在 $\left[\frac{p}{12}\right]$ 个 $1 \leq k \leq p-1$, 使得

$$
\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\} \leq 1
$$

证明 不妨设 $m \geq \max \{a, b\}$.

(1) 令 $\lambda=\int_{0}^{1}\{a x\}\{b x\} \cdot d x$ 为与 $m$ 无关的定值.

$$
f_{m}(a, b)=\sum_{k=1}^{m-1}\left\{\frac{a k}{m}\right\} \cdot\left\{\frac{b k}{m}\right\}
$$

则

$$
\begin{aligned}
\left|f_{m}(a, b)-\lambda_{m}\right|= & \left|\sum_{k=1}^{m-1}\left\{\frac{a k}{m}\right\} \cdot\left\{\frac{b k}{m}\right\}-\int_{0}^{m}\left\{\frac{a x}{m}\right\}\left\{\frac{b x}{m}\right\} d x\right| \\
\leq & \sum_{k=1}^{m-1}\left|\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\}-\int_{k-\frac{1}{2}}^{k+\frac{1}{2}}\left\{\frac{a x}{m}\right\}\left\{\frac{b x}{m}\right\} d x\right|+\int_{0}^{\frac{1}{2}}\left(\left\{\frac{a x}{m}\right\}\left\{\frac{b x}{m}\right\}\right) d x \\
& \quad+\int_{m-\frac{1}{2}}^{m}\left\{\frac{a(m-x)}{m}\right\}\left\{\frac{b(m-x)}{m}\right\} d x \\
\leq & \sum_{k=1}^{m-1}\left|\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\}-\int_{k-\frac{1}{2}}^{k+\frac{1}{2}}\left\{\frac{a x}{m}\right\}\left\{\frac{b x}{m}\right\} d x\right|+1 .
\end{aligned}
$$

满足 “存在 $-\frac{1}{2} \leq \delta<\frac{1}{2}, \frac{a(k+\delta)}{m} \in \mathbb{Z}$ 或 $\frac{b(k+\delta)}{m} \in \mathbb{Z}$ ” 的 $1 \leq k \leq m-1$ 至多有 $(a-1)+(b-1)=a-b+2$ 个.

对这些 $k$,

$$
\left|\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\}-\int_{k-\frac{1}{2}}^{k+\frac{1}{2}}\left\{\frac{a x}{m}\right\}\left\{\frac{b x}{m}\right\} d x\right|<1
$$

对其余的 $1 \leq k \leq m-1$,

$$
\begin{aligned}
& \left|\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\}-\int_{-\frac{1}{2}}^{\frac{1}{2}}\left\{\frac{a(k+x)}{m}\right\}\left\{\frac{b(k+x)}{m}\right\} d x\right| \\
= & \left|\int_{-\frac{1}{2}}^{\frac{1}{2}}\left(\left\{\frac{a k}{m}\right\}\left\{\frac{b k}{m}\right\}-\left(\left\{\frac{a k}{m}\right\}+\frac{a x}{m}\right)\left(\left\{\frac{b k}{m}\right\}+\frac{b x}{m}\right)\right) d x\right| \\
= & \left|\int_{-\frac{1}{2}}^{\frac{1}{2}}\left(-\left(\left\{\frac{a k}{m}\right\} \cdot \frac{b}{m}+\left\{\frac{b k}{m}\right\} \cdot \frac{a}{m}\right) \cdot x-\frac{a b x^{2}}{m^{2}}\right) d x\right| \\
= & \left|\int_{-\frac{1}{2}}^{\frac{1}{2}}\left(-\frac{a b x^{2}}{m^{2}}\right) d x\right|=\frac{a b}{12 m^{2}} .
\end{aligned}
$$

故

$$
\left|f_{m}(a, b)-\lambda_{m}\right| \leq m \cdot \frac{a b}{12 m^{2}}+(a+b-2)+1=a+b-1+\frac{a b}{12 m}<2(a+b)
$$

上式因为 $m \geq \max \{a, b\}$. 所以令 $\beta=2(a+b)$ 即可.

下面我们来算 $\lambda$.

$$
\begin{aligned}
\lambda= & \int_{0}^{1}\{a x\}\{b x\} d x=\sum_{k=0}^{a b-1} \int_{\frac{k}{a b}}^{\frac{k+1}{a b}}\{a x\}\{b x\} d x=\sum_{k=0}^{a b-1} \frac{1}{a b} \cdot \int_{k}^{k+1}\left\{\frac{x}{b}\right\}\left\{\frac{x}{a}\right\} d x \\
& =\sum_{i=0}^{a-1} \sum_{j=0}^{b-1} \frac{1}{a b} \cdot \int_{0}^{1}\left(\frac{i}{a}+\frac{x}{a}\right)\left(\frac{j}{b}+\frac{x}{b}\right) d x
\end{aligned}
$$

$$
\begin{aligned}
& =\frac{1}{a b} \cdot \sum_{i=0}^{a-1} \sum_{j=0}^{b-1}\left(\frac{i j}{a b}+\frac{1}{2 a b} \cdot(i+j)+\frac{1}{3 a b}\right) \\
& =\frac{1}{a^{2} b^{2}} \cdot \sum_{i=0}^{a-1} \sum_{j=0}^{b-1}\left(\left(i+\frac{1}{2}\right)\left(j+\frac{1}{2}\right)+\frac{1}{12}\right)=\frac{1}{4 a b}+\frac{1}{12}
\end{aligned}
$$

所以

$$
\left(\frac{1}{4 a b}+\frac{1}{12}\right) \cdot m-2(a+b)<f_{m}(a, b)<\left(\frac{1}{4 a b}+\frac{1}{12}\right) \cdot m+2(a+b) .
$$

得证.

(2) 若 $a+b+c \equiv 0(\bmod p)$, 则 $\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}$ 与 $\left\{\frac{a(p-k)}{p}\right\}+\left\{\frac{b(p-k)}{p}\right\}+$ $\left\{\frac{c(p-k)}{p}\right\}$ 中必恰有一个为 1 . 故恰有 $\frac{p-1}{2}>\left[\frac{p}{12}\right]$ 个 $k(1 \leq k \leq p-1)$. 符合. 成立!

若 $a, b, c$ 中有一个 $\equiv 0(\bmod p)$. 不妨设 $a \equiv 0(\bmod p)$, 则

$$
\left(\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}\right)+\left(\left\{\frac{a(p-k)}{p}\right\}+\left\{\frac{b(p-k)}{p}\right\}+\left\{\frac{c(p-k)}{p}\right\}\right)=2 .
$$

所以与 $p-k$ 至少一个符合. 故至少有 $\frac{p-1}{2}>\left[\frac{p}{12}\right]$ 个 $k(1 \leq k \leq p-1)$ 符合, 成立!

下面不妨设 $a+b+c, a, b, c$ 均 $\equiv \equiv 0(\bmod p)$. 令 $d=-a-b-c$, 则 $p \nmid a, b, c, d$.

不妨设 $|a|,|b|,|c|,|d|<p^{\frac{3}{4}}$. 这是因为: 对 $0 \leq i_{1}, i_{2}, i_{3}, i_{4}<p^{\frac{3}{4}}$ (这里 $\left(i_{1}, i_{2}, i_{3}, i_{4}\right)$共 $\left(\left[p^{\frac{3}{4}}\right]+1\right)^{4}>p^{3}$ 种取值 $)$, 考虑 $\left(\left(i_{2} a-i_{1} b\right),\left(i_{3} a-i_{1} c\right),\left(i_{4} a-i_{1} d\right)\right)((\bmod p)$共有 $p^{3}$ 种可能). 所以由抽屉原理: 存在

$$
\left(i_{1}, i_{2}, i_{3}, i_{4}\right) \neq\left(j_{1}, j_{2}, j_{3}, j_{4}\right), 0 \leq i_{1}, i_{2}, i_{3}, i_{4}, j_{1}, j_{2}, j_{3}, j_{4}<p^{\frac{3}{4}}
$$

使

$\left(\left(i_{2} a-i_{1} b\right),\left(i_{3} a-i_{1} c\right),\left(i_{4} a-i_{1} d\right)\right) \equiv\left(\left(j_{2} a-j_{1} b\right),\left(j_{3} a-j_{1} c\right),\left(j_{4} a-j_{1} d\right)\right) \quad(\bmod p)$.

令 $a^{\prime}=i_{1}-j_{1}, b^{\prime}=i_{2}-j_{2}, c^{\prime}=i_{3}-j_{3}, d^{\prime}=i_{4}-j_{4}$, 则 $\left|a^{\prime}\right|,\left|b^{\prime}\right|,\left|c^{\prime}\right|,\left|d^{\prime}\right|$ 均 $<p^{\frac{3}{4}}$且 $a^{\prime}, b^{\prime}, c^{\prime}, d^{\prime}$ 不全为 0 , 则

$$
b^{\prime} a \equiv a^{\prime} b \quad(\bmod p), c^{\prime} a \equiv a^{\prime} c \quad(\bmod p), d^{\prime} a \equiv a^{\prime} d \quad(\bmod p)
$$

所以存在 $t \in\{1,2, \cdots, p-1\}$, 使 $a^{\prime} \equiv t a(\bmod p), b^{\prime} \equiv t b(\bmod p), c^{\prime} \equiv a^{\prime} d$ $(\bmod p), a \equiv a^{\prime} b(\bmod p), c^{\prime} a \equiv a^{\prime} c(\bmod p), d^{\prime} \equiv t d(\bmod p)$.

所以用 $a^{\prime}, b^{\prime}, c^{\prime}, d^{\prime}$ 代替 $a, b, c, d$ 即可.

不妨设 $(a, b, c, d)=1$. 否则, 令 $d_{0}=(a, b, c, d), a^{\prime \prime}=\frac{a}{d_{0}}, b^{\prime \prime}=\frac{b}{d_{0}}, c^{\prime \prime}=\frac{c}{d_{0}}, d^{\prime \prime}=$ $\frac{d}{d_{0}}$, 用 $a^{\prime \prime}, b^{\prime \prime}, c^{\prime \prime}, d^{\prime \prime}$ 代替 $a, b, c, d$ 即可.

又因为 $p \mid a+b+c+d$. 故

$$
\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\} \in \mathbb{Z}(\forall 1 \leq k \leq p-1)
$$

所以

$$
\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\} \in\{1,2,3\} \quad(\forall 1 \leq k \leq p-1)
$$

又因为 $0<\frac{d k}{p}<1$, 所以

$$
\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\} \leq 1 \Leftrightarrow\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\}=1
$$

设在 $1 \leq k \leq p-1$ 中, $\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\}=1,2,3$ 的 $k$ 的个数分别为 $S_{1}, S_{2}, S_{3} . S_{1}+S_{2}+S_{3}=p-1$.

因为

$$
\sum_{k=1}^{p-1}\left(\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\}\right)=2(p-1)
$$

故 $S_{1}+2 S_{2}+3 S_{3}=2 p-2$. 所以 $S_{1}=S_{3}$.

因此

$$
\begin{aligned}
\sum_{k=1}^{p-1}\left(\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\}\right)^{2} & =S_{1}+4 S_{2}+9 S_{3} \\
& =10 S_{1}+4\left(p-1-2 S_{1}\right) \\
& =4(p-1)+2 S_{1}
\end{aligned}
$$

即

$$
\begin{aligned}
S_{1} & =\frac{1}{2} \cdot \sum_{k=1}^{p-1}\left(\left\{\frac{a k}{p}\right\}+\left\{\frac{b k}{p}\right\}+\left\{\frac{c k}{p}\right\}+\left\{\frac{d k}{p}\right\}\right)^{2}-2(p-1) \\
& =\frac{1}{2} \cdot \sum_{k=1}^{p-1}\left(\left\{\frac{a k}{p}\right\}^{2}+\left\{\frac{b k}{p}\right\}^{2}+\left\{\frac{c k}{p}\right\}^{2}+\left\{\frac{d k}{p}\right\}^{2}\right) \\
& +\sum_{k=1}^{p-1}\left(\left\{\frac{a k}{p}\right\} \cdot\left\{\frac{b k}{p}\right\}+\left\{\frac{a k}{p}\right\} \cdot\left\{\frac{c k}{p}\right\}+\cdots+\left\{\frac{c k}{p}\right\} \cdot\left\{\frac{d k}{p}\right\}\right)-2(p-1) \\
& =\frac{1}{2} \cdot 4 \cdot \frac{1}{p^{2}} \cdot\left(1^{2}+2^{2}+\cdots+(p-1)^{2}\right)+\sum_{k=1}^{p-1} \sum_{\text {sym }}\left\{\frac{a k}{p}\right\}\left\{\frac{b k}{p}\right\}-2(p-1) \\
& =\sum_{\text {sym }} \sum_{k=1}^{p-1}\left\{\frac{a k}{p}\right\}\left\{\frac{b k}{p}\right\}-\frac{(p-1)(4 p+1)}{3 p} \\
& >\sum_{\text {sym }} f_{p}\left(\frac{a}{(a, b)}, \frac{b}{(a, b)}\right)-\frac{4}{3} \cdot p+1 \\
& >\sum_{\text {sym }}\left(\left(\frac{1}{4}+\frac{(a, b)}{12[a, b]}\right) \cdot p-2(|a|+|b|)\right)-\frac{4}{3} p+1
\end{aligned}
$$

(容易发现: (1) 中结论当 $a<0$ 或 $b<0$ 时也成立)

$$
=\frac{1}{12} \cdot\left[2+\sum_{\text {sym }} \frac{(a, b)^{2}}{a b}\right] \cdot p-6(|a|+|b|+|c|+|d|) \text {. }
$$

由题意: $a+b+c+d=0$ 且 $a, b, c, d$ 中无两数互为相反数.

(i) $a, b, c, d$ 三正一负或三负一正.

不妨设 $a, b, c, d$ 三正一负, $a>0, b>0, c>0, d<0$, 则 $d \equiv-a-b-c$.

设 $x=-\frac{(a, d)^{2}}{a d}, y=-\frac{(b, d)^{2}}{b d}, x=-\frac{(c, d)^{2}}{c d}$, 则 $0<x, y, z \leq \frac{1}{2}$.

又因为

$$
\frac{(a, b)^{2}}{a b} \geq \frac{((a, d),(b, d))^{2}}{a b}=\frac{(a, d)^{2} \cdot(b, d)^{2}}{a b \cdot[(a, d),(b, d)]^{2}} \geq \frac{(a, d)^{2} \cdot(b, d)^{2}}{a b d^{2}}=x y
$$

故

$$
\begin{aligned}
\sum_{\text {sym }} \frac{(a, b)^{2}}{a b} & \geq x y+y z+z x-x-y-z=(1-x)(1-y)(1-z)+x y z-1 \\
& \geq\left(1-\frac{1}{2}\right)\left(1-\frac{1}{2}\right)\left(1-\frac{1}{2}\right)-1=-\frac{7}{8} .
\end{aligned}
$$

(ii) $a, b, c, d$ 两正两负.

讨论可知: 除非 $(a, b, c, d)=(1 .-3,-4,6)$ 或 $(1,-2,-3,4)$ 及其轮换. 否则一定有 $\sum_{\text {sym }} \frac{(a, b)^{2}}{a b} \geq-0.99$.

所以对于 $(a, b, c, d) \neq(1,-3,-4,6),(1,-2,-3,4)$ 以及轮换, 我们有

$$
\begin{aligned}
S_{1} & >\frac{1}{2} \cdot\left[2+\sum_{\text {sym }} \frac{(a, b)^{2}}{a b}\right] \cdot p-6(|a|+|b|+|c|+|d|) \\
& >\frac{1.01}{12} \cdot p-24 \cdot p^{\frac{3}{4}}
\end{aligned}
$$

我们取 $N$ 使 $\frac{0.01}{12} N>24 \cdot N^{\frac{3}{4}}$. 即有 $p>N$ 时, $S_{1} \geq\left[\frac{p}{12}\right]$.

对于 $(a, b, c, d)=(1,-2,-3,4)$ 或 $(1,-2,-4,6)$, 对这两组检验知 $p>N$ 时,也有 $S_{1} \geq\left[\frac{p}{12}\right]$.

故对任何 $(a, b, c, d)$ 均有 $S_{1} \geq\left[\frac{p}{12}\right]$. 即有 $\geq\left[\frac{p}{12}\right]$ 个 $k(1 \leq k \leq p-1)$ 符合题意.

得证!

评注 本题是道困难的数论题, 考场上没有人完整的做出来. 本题第 (2) 问补一个 $d=-a-b-c$ 的想法来源于 1999 年 USAMO 第三题.

4. 对正整数 $m, n$, 记

$$
S(m, n)=\left\{(a, b) \in \mathbb{N}_{+}^{2} \mid 1 \leq a \leq m, 1 \leq b \leq n, \operatorname{gcd}(a, b)=1\right\} .
$$

求证：对任意正整数 $d, r$, 存在不小于 $d$ 的整数 $m, n$, 使得

$$
|S(m, n)| \equiv r \quad(\bmod d) .
$$

证明 令 $m=d+r, n=d(d+r) !+1$. 则对任意 $1 \leq i \leq d+r$, 满足
$\operatorname{gcd}(i, b)=1$ 的 $b(1 \leq b \leq d(d+r) !)$ 恰有 $\frac{\varphi(i)}{i} \times d(d+r)$ ! 个. 而对任意 $1 \leq j \leq d+r$, $\operatorname{gcd}(j, d(d+r) !+1)=1$. 故

$$
\begin{aligned}
|S(d+r, d(d+r) !+1)| & =\sum_{i=1}^{d+r} \frac{\varphi(i)}{i} \times d(d+r) !+(d+r) \\
& =d \sum_{i=1}^{d+r} \frac{\varphi(i)(d+r) !}{i}+(d+r) \\
& \equiv r \quad(\bmod d) .
\end{aligned}
$$

又因为 $d+r, d(d+r) !+1>d$, 所以结论成立, 得证.

评注 本题是一道简单的数论题, 只需发现固定 $n$ 之后 $|S(m, n)|(\bmod d)$ 是个纯周期数列, 并且 $|S(1, n)|=n$ 即可.

5. 设 $P_{1}, \cdots, P_{n}$ 是 $\triangle A B C$ 内的点, 满足 $P_{1}, \cdots, P_{n}, A, B, C$ 中任意三点不共线. 求证: 可以将 $\triangle A B C$ 划分为 $2 n+1$ 个小三角形, 使得每个小三角形的顶点都来自 $P_{1}, \cdots, P_{n}, A, B, C$, 且含 $A, B, C$ 中至少一个的小三角形不少于 $n+\sqrt{n}+1$个.

证明 不妨设 $S_{\triangle P_{1} B C} \leq S_{\triangle P_{2} B C} \leq \cdots \leq S_{\triangle P_{n} B C}$.

对任意 $1 \leq i \leq n$, 设 $b_{i}$ 是最大的 $k$, 使存在 $i=i_{1}<i_{2}<\cdots<i_{k} \leq n$, 使 $\triangle P_{i_{1}} A B$ 包含 $\triangle P_{i_{2}} A B$ 包含 $\cdots$ 包含 $\triangle P_{i_{k}} A B$.

同样地定义 $c_{i}$ (考虑 $\left.\triangle P_{i} A C\right)$.

对任意 $1 \leq i<j \leq n$, 因为 $S_{\triangle P_{i} B C} \leq S_{\triangle P_{j} B C}$, 所以 $P_{j}$ 不在 $\triangle P_{i} B C$ 内部, 故 $P_{j}$ 在 $\triangle P_{i} A B$ 或 $\triangle P_{i} A C$ 内部, 于是可知 $b_{i} \geq b_{j}+1$ 或 $c_{i} \geq c_{j}+1$.

故 $\left(b_{1}, c_{1}\right),\left(b_{2}, c_{2}\right), \cdots,\left(b_{n}, c_{n}\right)$ 两两不同. 所以 $b_{1}, b_{2}, \cdots, b_{n}, c_{1}, c_{2}, \cdots, c_{n}$ 至少有一个 $\geq \sqrt{n}$. 不妨设 $b_{1}, b_{2}, \cdots, b_{n}$ 中有一个 $\geq \sqrt{n}$, 则存在 $k \geq \sqrt{n}, 1 \leq i_{1}<i_{2}<$ $\cdots<i_{k} \leq n$, 使 $\triangle P_{i_{1}} A B$ 包含 $\triangle P_{i_{2}} A B$ 包含 $\cdots$ 包含 $\triangle P_{i_{k}} A B$.(如图所示)

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-10.jpg?height=434&width=600&top_left_y=2073&top_left_x=728)

令 $C=P_{i_{0}}, B=P_{i_{k+1}}$.

连接 $P_{i_{0}} P_{i_{1}}, P_{i_{1}} P_{i_{2}}, \cdots, P_{i_{k-1}} P_{i_{k}}, A P_{i_{1}}, A P_{i_{2}}, \cdots, A P_{i_{k}}, B P_{i_{1}}, B P_{i_{2}}, \cdots, B P_{i_{k}}$.
设 $\triangle A P_{i_{j}} P_{i_{j+1}}$ 内部有 $s_{j}$ 个点 $(0 \leq j \leq k), \triangle B P_{i_{j}} P_{i_{j+1}}$ 内部有 $t_{j}$ 个点 $(0 \leq j \leq$ $k-1)$, 则

$$
\sum_{j=0}^{k} s_{j}+\sum_{j=0}^{k-1} t_{j}=n-k
$$

即 $P_{1}, P_{2}, \cdots, P_{n}$ 中去掉 $P_{i_{1}}, \cdots, P_{i_{k}}$ 以外的 $n-k$ 个点.

对任意 $0 \leq j \leq k$, 连接 $A$ 与 $\triangle A P_{i_{j}} P_{i_{j+1}}$ 内部的 $s_{j}$ 个点, 知 $\triangle A P_{i_{j}} P_{i_{j+1}}$ 剖分成小三角形之后有 $s_{j}+1$ 个含有顶点 $A$.

同理, 对任意 $0 \leq j \leq k-1, \triangle B P_{i_{j}} P_{i_{j+1}}$ 剖分成小三角形之后有 $t_{j}+1$ 个含有顶点 $B$.

所以可知所有小三角形中, 含 $A, B, C$ 中至少一个作为顶点的至少有

$$
\sum_{j=0}^{k}\left(s_{j}+1\right)+\sum_{j=0}^{k-1}\left(t_{j}+1\right)=n+k+1 \geq n+\sqrt{n}+1
$$

个. 得证!

评注 本题是一道中等难度的组合题, 对张角使用 $E-S$ 定理也可证明.即不妨设 $\angle C A P_{1}<\angle C A P_{2}<\cdots<\angle C A P_{n}$, 则存在 $\lceil\sqrt{n}\rceil$ 个点 $P_{i_{1}}, \cdots, P_{i_{\lceil\sqrt{n}\rceil}}$ $\left(1 \leq i_{1}<\cdots<i_{\lceil\sqrt{n}\rceil} \leq n\right)$, 使

$$
\angle A C P_{i_{1}}<\cdots<\angle A C P_{i_{\sqrt{ } \sqrt{n} \mid}} \text { 或 } \angle A C P_{i_{1}}>\cdots>\angle A C P_{i_{\sqrt{ } \sqrt{n} \mid}} \text {. }
$$

6. 求证: (1) 在复平面中, 每条过原点的直线 (实轴除外) 上至多有一点 $z$, 使得 $\frac{1+z^{23}}{z^{64}}$ 是实数.

(2) 对任意非零复数 $a$ 和任意实数 $\theta$, 方程 $1+z^{23}+a z^{64}=0$ 在

$$
S_{\theta}=\left\{z \in \mathbb{C}\left|\operatorname{Re}\left(z e^{-i \theta}\right) \geq\right| z \left\lvert\, \cos \frac{\pi}{20}\right.\right\}
$$

中都有根。

证明 (1) 设直线 $\ell$ 倾斜角为 $\theta(0<\theta<\pi)$.

因为 $z$ 在直线 $\ell$ 上, 所以可设 $z=r(\cos \theta+i \sin \theta)(r \neq 0, r \in \mathbb{R})$.

所以

$$
\begin{aligned}
\frac{1+z^{23}}{z^{64}} & =\frac{1}{z^{64}}+\frac{1}{z^{41}} \\
& =\frac{\cos 64 \theta-i \sin 64 \theta}{r^{64}}+\frac{\cos 41 \theta-i \sin 41 \theta}{r^{41}} .
\end{aligned}
$$

所以 $\frac{1+z^{23}}{z^{64}} \in \mathbb{R} \Leftrightarrow \frac{\sin 64 \theta}{r^{64}}+\frac{\sin 41 \theta}{r^{41}}=0 \Leftrightarrow r^{23} \cdot \sin 41 \theta=-\sin 64 \theta$.

$1^{\circ}$ 若 $\frac{41 \theta}{\pi} \notin \mathbb{Z}$, 则 $\sin 41 \theta \neq 0$, 故 $r=\sqrt[23]{\frac{-\sin 64 \theta}{\sin 41 \theta}}$. 所以至多一个 $z$ 符合题意. 成立!
$2^{\circ}$ 若 $\frac{41 \theta}{\pi} \in \mathbb{Z}$, 则 $\sin 41 \theta=0$. 又因为 $(41,64)=1$ 且 $\frac{\theta}{\pi} \notin \mathbb{Z}$. 故 $\frac{41 \theta}{\pi} \notin \mathbb{Z}$. 故 $\sin 64 \theta \neq 0$. 所以 $\sin 41 \theta \cdot r^{23} \neq-\sin 64 \theta$ (任意 $r \neq 0, r \in \mathbb{R}$ ). 故此时不存在 $z$ 符合题意, 成立!

综上, 得证!

(2) 设 $z=r(\cos \alpha+i \sin \alpha),(r>0), a=r_{0}(\cos \beta+i \sin \beta),\left(r_{0}>0\right)$. 则 $1+r^{23}(\cos 23 \alpha+i \sin 23 \alpha)+r_{0} r^{64}(\cos (\beta+64 \alpha)+i \sin (\beta+64 \alpha))=0$.

故

$$
\left\{\begin{array}{l}
1+r^{23} \cdot \cos 23 \alpha+r_{0} \cdot r^{64} \cdot \cos (\beta+64 \alpha)=0, \\
r^{23} \cdot \sin 23 \alpha+r_{0} \cdot r^{64} \cdot \sin (\beta+64 \alpha)=0,
\end{array}\right.
$$

故 $r=\sqrt[41]{-\frac{\sin 23 \alpha}{r_{0} \sin (\beta+64 \alpha)}}, \sin 23 \alpha$ 与 $\sin (\beta+64 \alpha)$ 异号. 代回(1)知:

$$
\begin{aligned}
& 1+r^{23} \cdot \frac{\cos 23 \alpha \cdot \sin (\beta+64 \alpha)-\cos (\beta+64 \alpha) \cdot \sin 23 \alpha}{\sin (\beta+64 \alpha)}=0 \\
& \Leftrightarrow 1+r^{23} \cdot \frac{\sin (\beta+41 \alpha)}{\sin (\beta+64 \alpha)}=0 \\
& \Leftrightarrow \frac{(\sin 23 \alpha)^{23}}{r_{0}^{23}(\sin (\beta+64 \alpha))^{23}}=\frac{(\sin (\beta+64 \alpha))^{41}}{(\sin (\beta+4 \alpha))^{41}} \\
& \Leftrightarrow r_{0}^{23}(\sin (\beta+64 \alpha))^{64}-(\sin 23 \alpha)^{23} \cdot(\sin (\beta+41 \alpha))^{41}=0
\end{aligned}
$$

所以 $z=r \cdot(\cos \alpha+i \sin \alpha)$ 为 $1+z^{23}+a z^{64}=0$ 的根.

$\Leftrightarrow \sin 23 \alpha$ 与 $\sin (\beta+64 \alpha)$ 异号且

$$
r_{0}^{23} \cdot(\sin (\beta+64 \alpha))^{64}-(\sin 23 \alpha)^{23} \cdot(\sin (\beta+41 \alpha))^{41}=0
$$

且 $r=\sqrt[41]{-\frac{\sin 23 \alpha}{r_{0} \cdot \sin (\beta+64 \alpha)}}$.

下证: 存在 $\alpha \in\left(\theta-\frac{\pi}{20}, \theta+\frac{\pi}{20}\right)$, 使得

(a): $\sin (23 \alpha)$ 与 $\sin (\beta+64 \alpha)$ 异号.

(b): $f(\alpha)=r_{0}^{23}(\sin (\beta+64 \alpha))^{64}-(\sin 23 \alpha)^{23} \cdot(\sin (\beta+41 \alpha))^{41}=0$.

因为 $\left(\theta+\frac{\pi}{20}\right)-\left(\theta-\frac{\pi}{20}\right)=\frac{\pi}{10}>4 \cdot \frac{\pi}{41}$, 所以存在 4 个连续整数 $x, x+1, x+3$ 使 $\left(\theta-\frac{\pi}{20}\right)+\frac{\beta}{41}<\frac{\pi}{41} \cdot x<\frac{\pi}{41} \cdot(x+1)<\frac{\pi}{41} \cdot(x+2)<\frac{\pi}{41} \cdot(x+3)<\left(\theta+\frac{\pi}{20}\right) \frac{\beta}{41}$.所以令

$$
\alpha_{1}=\frac{\pi}{41}(x+1)-\frac{\beta}{41}, \alpha_{2}=\frac{\pi}{41}(x+2)-\frac{\beta}{41},
$$

则 $\frac{41 \alpha_{1}+\beta}{\pi}, \frac{41 \alpha_{2}+\beta}{\pi}$ 均 $\in \mathbb{Z}$.

又因为 $\frac{23 \alpha_{r}}{\pi}-\frac{23 \alpha_{1}}{\pi}=\frac{23}{41} \notin \mathbb{Z}$, 故 $\frac{23 \alpha_{2}}{\pi}$ 与 $\frac{23 \alpha_{1}}{\pi}$ 至多一个 $\notin \mathbb{Z}$.

所以存在 $r \in\left\{\alpha_{1}, \alpha_{2}\right\}$, 使 $\frac{41 r+\beta}{\pi} \in \mathbb{Z}$ 且 $\frac{23 r}{\pi} \notin \mathbb{Z}$,

故 $\left[r-\frac{\pi}{41}, r+\frac{\pi}{41}\right] \subseteq\left(\theta-\frac{\pi}{20}, \theta+\frac{\pi}{20}\right)$.

(因为 $\theta-\frac{\pi}{20}<\alpha_{1}-\frac{\pi}{41}<\alpha_{1}<\alpha_{2}<\alpha_{2}+\frac{\pi}{41}<\theta+\frac{\pi}{20}$ ).

$1^{\circ} 2 \nmid \frac{41 r+\beta}{\pi}$. 则

$$
\sin (41 r+\beta)=0, \sin (23 r)=-\sin (64 r+\beta) .
$$

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-13.jpg?height=420&width=494&top_left_y=478&top_left_x=770)

不妨设 $\sin (23 r)<0, \sin (64 r+\beta)>0$.

取 $r_{1}=r, r_{2}>r$ 最小, 使 $\sin \left(64 r_{1}+\beta\right)=0$, 所以对 $\forall \alpha \in\left(r_{1}, r_{2}\right)$,

$$
\sin (64 \alpha+\beta)>0, \sin (23 \alpha)<0, \sin (41 \alpha+\beta)<0
$$

故 $f\left(r_{1}\right)>0, f\left(r_{2}\right)<0$. 所以由介值原理, 存在 $\alpha \in\left(r_{1}, r_{2}\right)$ 使 $f(\alpha)=0$, 满足 $(b)$.此时 $\sin (64 \alpha+\beta)>0, \sin (23 \alpha)<0$, 满足 $(a)$. 所以 $\alpha$ 符合要求, 成立!

$2^{\circ} 2 \left\lvert\, \frac{41 r+\beta}{\pi}\right.$. 则

$$
\sin (41 r+\beta)=0, \sin (23 r)=\sin (64 r+\beta) \text {. }
$$

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-13.jpg?height=406&width=506&top_left_y=1599&top_left_x=792)

不妨设 $\sin (23 r), \sin (64 r+\alpha)>0$. 设

$$
23 r=2 k_{1} \pi+\varphi\left(0<\varphi<\pi, k_{1} \in \mathbb{Z}\right), 64 r+\beta=2 k_{2} \pi+\varphi\left(k_{2} \in \mathbb{Z}\right)
$$

$1^{\circ}$ 若 $\varphi \neq \frac{18}{41} \pi$, 取 $r_{1}=r+\frac{\pi-4}{64}, r_{2}=r+\min \left\{\frac{\pi-4}{23}, \frac{\pi}{41}\right\}$, 则 $r_{1}<r_{2}<r+\frac{2 \pi-4}{64}$.所以当 $r_{1}<\alpha<r_{2}$ 时, $\sin (23 r), \sin (41 r+\beta)>0, \sin (64 r+\beta)<0$, 所以满足 $(a)$.

又因为 $f\left(r_{1}\right)<0, f\left(r_{2}\right)>0$, 所以由介值原理, 存在 $r_{1}<\alpha<r_{2}$, 使 $f(\alpha)=0$. 所以满足 $(b)$. 所以 $\alpha$ 符合要求, 成立!

$2^{\circ}$ 若 $\varphi=\frac{18}{41} \cdot \pi$. 取 $r_{1}=r-\frac{\pi}{41}, r_{2}=r-\frac{59}{41 \cdot 64} \cdot \pi$, 则当 $r_{1}<\alpha<r_{2}$ 时, $\sin (23 r), \sin (41 r+\beta)<0, \sin (64 r+\beta)>0$. 所以满足 $(a)$.
又因为 $f\left(r_{1}\right)>0, \sin f\left(r_{2}\right)<0$. 所以由介值定理, 存在 $r_{1}<\alpha<r_{2}$, 使 $f(\alpha)=0$. 所以满足 $(b)$. 所以 $\alpha$ 符合要求, 得证!

综上, 一定存在 $\alpha \in\left(\theta-\frac{\pi}{20}, \theta+\frac{\pi}{20}\right)$, 使 $f(\alpha)=0$ 且 $\sin (23 \alpha)$ 与 $\sin (\beta+64 \alpha)$异号.

所以令 $r=\sqrt[41]{-\frac{\sin 23}{r_{0} \cdot \sin (\beta+64 \pi)}}>0, z=r \cdot(\cos \alpha+i \sin \alpha)$ 知 $z$ 是原方程的根且 $z \in S_{\theta}$. 得证!

评注 本题是一道较难的代数题. 第 (2) 问的想法是解出 $z$ 的辐角 $\alpha$ 应该满足的式子, 然后通过介值定理证明存在一个 $\alpha$ 在题中所要求的范围内.

7. 给定整数 $n \geq 2$ 及与 $n$ 互质的整数 $a$. 一个国家有 $n$ 座小岛 $D_{1}, D_{2}, \cdots$, $D_{n}$, 对任意 $1 \leq i \neq j \leq n, D_{i}$ 到 $D_{j}$ 有单向轮渡当且仅当 $i j \equiv i a(\bmod n)$. 一个游客初始时可以坐飞机到达任意一个小岛, 之后只能乘坐单向轮渡。问: 他最多可以游览多少座小岛?

解 记 $S$ 是所有 $n$ 的素因数组成的集合.

对任意 $p \in S$, 设 $p^{\alpha} \| n\left(\alpha \in \mathbb{Z}_{+}\right)$.

(1) 若 $\alpha \geq 2$, 则对任意 $1 \leq i \leq n$, 令

$$
f_{p}(i)= \begin{cases}0, & \nu_{p}(i) \geq \alpha, \nu_{p}(i-a)=0 \\ 1, & 0<\nu_{p}(i)<\alpha, \nu_{p}(i-a)=0 \\ 2, & \nu_{p}(i)=0,0 \leq \nu_{p}(i-a)<\alpha \\ 3, & \nu_{p}(i)=0, \nu_{p}(i-a) \geq \alpha\end{cases}
$$

(2) 若 $\alpha=1$, 若 $p \neq 2$, 则对任意 $1 \leq i \leq n$, 令

$$
f_{p}(i)= \begin{cases}0, & \nu_{p}(i)=1, \nu_{p}(i-a)=0 \\ 1, & \nu_{p}(i)=0, \nu_{p}(i-a)=0 \\ 2, & \nu_{p}(i)=0, \nu_{p}(i-a)=1\end{cases}
$$

若 $p=2$, 则 $i$ 与 $i-a$ 中恰有一个是 $p$ 的倍数, 则对任意 $1 \leq i \leq n$, 令

$$
f_{p}(i)= \begin{cases}0, & \nu_{p}(i)=1, \nu_{p}(i-a)=0 \\ 1, & \nu_{p}(i)=0, \nu_{p}(i-a)=1\end{cases}
$$

对任意 $1 \leq i \leq n$, 令 $f(n)=\sum_{p \in S} f_{p}(i)$. 则对任意 $1 \leq i \neq j \leq n$, 若 $D_{i}$ 到 $D_{j}$ 有单向轮渡, 则 $i j \equiv i a(\bmod n)$, 故 $n \mid i(j-a)$.

故对任意素数 $p \in S, p^{\alpha} \| n\left(\alpha \in \mathbb{Z}_{+}\right)$, 则 $p$ 不整除 $a$.
所以

$$
\begin{gathered}
\nu_{p}(\operatorname{gcd}(i, n)) \geq \alpha-\nu_{p}(\operatorname{gcd}(j-a, n)) \geq \nu_{p}(\operatorname{gcd}(j, n)) \\
\nu_{p}(\operatorname{gcd}(i-a, n)) \leq \alpha-\nu_{p}(\operatorname{gcd}(i, n)) \leq \nu_{p}(\operatorname{gcd}(j-a, n))
\end{gathered}
$$

所以有 $f_{p}(i) \leq f_{p}(j)$. (任意 $p \in S$ ).

若对任意 $p \in S$, 均有 $f_{p}(i)=f_{p}(j)$, 则设 $p^{\alpha} \| n$, 有 $i \equiv j \equiv 0$ 或 $a\left(\bmod p^{\alpha}\right)$,故 $i=j$, 矛盾.

所以存在 $p \in S$, 使 $f_{p}(i)<f_{p}(j)$.

所以 $f(i) \geq f(j)+1$ (任意 $D_{i}$ 到 $D_{j}$ 有单向轮渡).

所以该游客至多游览

$$
\begin{aligned}
& \max \{f(1), f(2), \cdots, f(n)\}-\min \{f(1), f(2), \cdots, f(n)\}+1 \\
& =f(a)-f(n)+1=f(a)+1
\end{aligned}
$$

座小岛.

设 $n=p_{1} p_{2} \cdots p_{k} q_{1}^{\alpha_{1}} q_{2}^{\alpha_{2}} \cdots q_{l}^{\alpha_{l}},\left(\alpha_{1}, \cdots, \alpha_{l} \geq 2, p_{i}, q_{j}\right.$ 是互不相同的素数 $)$, 则

$$
f(a)= \begin{cases}3 l+2 k-1, & 2 \in\left\{p_{1}, p_{2}, \cdots, p_{k}\right\} \\ 3 l+2 k, & 2 \notin\left\{p_{1}, p_{2}, \cdots, p_{k}\right\}\end{cases}
$$

故游客至多游览

$$
\begin{cases}3 l+2 k, & 2 \in\left\{p_{1}, p_{2}, \cdots, p_{k}\right\} \\ 3 l+2 k+1, & 2 \notin\left\{p_{1}, p_{2}, \cdots, p_{k}\right\}\end{cases}
$$

座岛.

构造: 若 $2 \notin\left\{p_{1}, p_{2}, \cdots, p_{k}\right\}$, 则对任意 $0 \leq i \leq 2 k$ : 若 $i$ 是偶数, 令

$$
\begin{array}{ll}
a_{i} \equiv a & \left(\bmod p_{1} p_{2} \cdots p_{\frac{i}{2}}\right) \\
a_{i} \equiv 0 & \left(\bmod p_{\frac{i}{2}+1} \cdots p_{k} q_{1}^{\alpha_{1}} q_{2}^{\alpha_{2}} \cdots q_{l}^{\alpha_{l}}\right)
\end{array}
$$

若 $i$ 是奇数, 令

$$
\begin{aligned}
& a_{i} \equiv a \quad\left(\bmod p_{1} p_{2} \cdots p_{\frac{i-1}{2}}\right) \\
& a_{i} \equiv \equiv 0, a \quad\left(\bmod p_{\frac{i+1}{2}}\right) \\
& a_{i} \equiv 0 \quad\left(\bmod p_{\frac{i+3}{2}}^{\cdots} p_{k} q_{1}^{\alpha_{1}} q_{2}^{\alpha_{2}} \cdots q_{l}^{\alpha_{l}}\right)
\end{aligned}
$$

其中 $1 \leq a_{i} \leq n$.

对任意 $1 \leq j \leq 3 l$ : 若 $j \equiv 0(\bmod 3)$, 令

$$
\begin{array}{ll}
a_{2 k+j} \equiv a & \left(\bmod p_{1} p_{2} \cdots p_{k} q_{1}^{\alpha_{1}} \cdots q_{\frac{j}{3}}^{{ }^{\frac{j}{3}}}\right) \\
a_{2 k+j} \equiv 0 & \left(\bmod q_{\frac{j}{3}+1}^{\alpha^{\frac{j}{3}+1}} \cdots q_{l}^{\alpha_{l}}\right)
\end{array}
$$

若 $j \equiv 1(\bmod 3)$, 令

$$
\begin{aligned}
& a_{2 k+j} \equiv a \quad\left(\bmod p_{1} p_{2} \cdots p_{k} q_{1}^{\alpha_{1}} \cdots q_{\frac{j-1}{3}}^{\alpha_{j-1}^{3}}\right) \\
& a_{2 k+j} \equiv q_{\frac{\alpha^{\frac{j+2}{3}}}{}}^{\alpha^{3}-1} \quad\left(\bmod q_{\frac{j+2}{3}}^{\alpha^{\frac{j+2}{3}}}\right) \\
& a_{2 k+j} \equiv 0 \quad\left(\bmod \frac{\left.q_{\frac{j+5}{3}}^{\alpha_{j+5}^{3}} \cdots q_{l}^{\alpha_{l}}\right)}{}\right.
\end{aligned}
$$

若 $j \equiv 2(\bmod 3)$, 令

$$
\begin{aligned}
& a_{2 k+j} \equiv a \quad\left(\bmod p_{1} p_{2} \cdots p_{k} q_{1}^{\alpha_{1}} \cdots q_{\frac{j-2}{3}}^{\alpha_{j-1}^{3}}\right) \\
& a_{2 k+j} \equiv q_{\frac{j+1}{3}}^{\alpha_{j+1}^{3}-1}+a \quad\left(\bmod q_{\frac{j+1}{3}}^{\alpha_{j+1}^{3}}\right) \\
& a_{2 k+j} \equiv 0 \quad\left(\bmod q_{\frac{j+4}{3}}^{\alpha_{\frac{j+4}{3}}^{3}} \cdots q_{l}^{\alpha_{l}}\right)
\end{aligned}
$$

其中上述 $1 \leq a_{2 k+j} \leq n$.

由中国剩余定理, 存在这样的 $a_{0}, a_{1}, \cdots, a_{3 l+2 k}$. 此时游客可依次游览 $D_{a_{0}}, \cdots, D_{a_{3 l+2 k}}$ 这 $3 l+2 k+1$ 座岛.

若 $2 \in\left\{p_{1}, p_{2}, \cdots, p_{k}\right\}$ 类似可知, 游客可游览 $3 l+2 k$ 座岛.

综上, 设 $n=p_{1} p_{2} \cdots p_{k} q_{1}^{\alpha_{1}} q_{2}^{\alpha_{2}} \cdots q_{l}^{\alpha_{l}},\left(\alpha_{1}, \cdots, \alpha_{l} \geq 2, p_{i}, q_{j}\right.$ 是互不相同的素数), 则所求最大值为

$$
\left\{\begin{array}{ll}
3 l+2 k, & 2 \in\left\{p_{1}, p_{2}, \cdots, p_{k}\right\} \\
3 l+2 k+1, & 2 \notin\left\{p_{1}, p_{2}, \cdots, p_{k}\right\}
\end{array} .\right.
$$

证毕.

评注 本题是道简单的组合题, 但要注意素因子 2 要另外讨论.

8. 在非等腰锐角 $\triangle A B C$ 中, $A P, B Q, C R$ 是高, $H$ 是垂心. $A_{1}$ 是 $B C$ 的中点, $A A_{1}$ 交 $Q R$ 于点 $K, Q R$ 交过 $A$ 且平行于 $B C$ 的直线于点 $D, A H$ 的中点与 $K$ 的连线交 $D A_{1}$ 于点 $A_{2}$. 类似定义点 $B_{2}, C_{2}$. 已知 $\triangle A_{2} B_{2} C_{2}$ 非退化, 其外接圆为 $\omega$.求证: 存在 $\omega$ 内与之相切的圆 $A^{\prime}, B^{\prime}, C^{\prime}$, 满足:

(1) 圆 $A^{\prime}$ 与 $A B, A C$ 相切、圆 $B^{\prime}$ 与 $B C, B A$ 相切、圆 $C^{\prime}$ 与 $C A, C B$ 相切;

(2) $A^{\prime}, B^{\prime}, C^{\prime}$ 不同且共线.

证明 我们首先证明 $\omega$ 是 $\triangle A B C$ 的九点圆.

设 $A H$ 中点是 $H_{A}$, 显然 $H_{A}$ 是 $\odot A Q R$ 的圆心, 而 $Q A_{1}, R A_{1}, A D$ 是该圆的切线; 于是 $D A_{1}$ 是 $K$ 关于该圆的极线, 从而熟知 $H_{A} K \perp D A_{1}$. 这就证明了 $A_{2}$ 在 $\triangle A B C$ 的九点圆上, 从而 $\omega$ 就是 $\triangle A B C$ 的九点圆.

著名的费尔巴哈定理断言九点圆和内切圆相切. 记 $\triangle A B C$ 的内心为 $I$.

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-17.jpg?height=717&width=1219&top_left_y=190&top_left_x=424)

我们接下来通过反演构造 $\odot A^{\prime}$ (其余两圆同理), 再证明:

(1) $A^{\prime}, B^{\prime}, C^{\prime}$ 互不相同,

(2) $A^{\prime}, B^{\prime}, C^{\prime}$ 共线.

记 $A B=c, B C=a, C A=b$. 考虑以 $A$ 为中心,

$$
\frac{1}{2} A Q \cdot A C=\frac{1}{2} A R \cdot A B=\frac{b^{2}+c^{2}-a^{2}}{4}
$$

为幂的反演, 它保持九点圆, 于是内切圆的像仍与九点圆相切.

这个像记作 $\odot A^{\prime}$, 显然 $A^{\prime} \in A I$. 由反演的定义可以算得

$$
A I \cdot A A^{\prime}=\frac{b^{2}+c^{2}-a^{2}}{4 \cos ^{2} \frac{A}{2}}=\frac{b c\left(b^{2}+c^{2}-a^{2}\right)}{(b+c-a)(b+c+a)} .
$$

$1^{\circ}$ 若 $A^{\prime}=B^{\prime}$, 由于 $A^{\prime} \in A I, B^{\prime} \in B I$, 所以 $A^{\prime}=B^{\prime}=I$.

熟知 $A I=\sqrt{\frac{b c(b+c-a)}{b+c+a}}$, 代入 $(*)$ 化简得 $2(a-b)(a-c)=0$ 与条件矛盾. 故 $A^{\prime} \neq B^{\prime}$, 同理可知 $A^{\prime}, B^{\prime}, C^{\prime}$ 互不相同.

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-17.jpg?height=706&width=837&top_left_y=1897&top_left_x=564)

$$
\begin{aligned}
\sum_{c y c} \frac{\sin \left(90^{\circ}-\frac{A}{2}\right)}{A I-A A^{\prime}} & =\sum_{c y c} \frac{A I \cos \frac{A}{2}}{A I^{2}-A I \cdot A A^{\prime}} \\
& =\sum_{c y c} \frac{\frac{b+c-a}{2}}{\frac{b c(b+c-a)}{b+c+a}-\frac{b c\left(b^{2}+c^{2}-a^{2}\right)}{(b+c-a)(b+c+a)}} \\
& =\sum_{c y c} \frac{(b+c+a)(b+c-a)^{2}}{4 b c(a-b)(a-c)} \\
& =-\frac{a+b+c}{4 a b c(a-b)(b-c)(c-a)} \sum_{c y c} a(b-c)(b+c-a)^{2}
\end{aligned}
$$

右边的轮换和式易证为 0 , 所以 $\sum_{c y c} \frac{\sin \left(90^{\circ}-\frac{A}{2}\right)}{A I-A A^{\prime}}=0$. 由张角定理 $A^{\prime}, B^{\prime}, C^{\prime}$ 共线.

综上, 原题得证.

评注 本题是道中等难度的几何题。首先刻画三角形 $\triangle A_{2} B_{2} C_{2}$ 外接圆的性质, 容易发现这三个点都在原三角形九点圆上, 然后要刻画三个圆的位置, 思考一会会想到三角形内接圆与它们都位似, 再观察后会想到费尔巴哈定理, 这就说明那三个圆是内接圆分别过三个顶点的反演圆, 经过计算可以完成本题.

9. 求最大的正整数 $m$, 使得可以将一个 $70 \times 70$ 方格表中的一些格染红, 满足:

(1) 不存在两个红格, 它们所在行中红格数相同, 所在列中红格数也相同;

(2) 存在两行中恰有 $m$ 个红格.

证明 对 $m \in \mathbb{Z}^{+}$. 若存在一个符合 (1)(2) 的染色方法, 不妨设 $m$ 是最大的. 以 70 行 $A_{1}, A_{2}, \cdots, A_{70}$ 以及 70 列 $B_{1}, B_{2}, \cdots, B_{70}$ 为顶点, $A_{i}$ 与 $B_{j}$ 连边 $\Leftrightarrow A_{i}$ 行 $B_{j}$ 列的格子是红格, 构成二分图 $G$.

设 $a_{i}=\operatorname{deg} A_{i}, b_{j}=\operatorname{deg} B_{i} .(\forall 1 \leq i \leq 70)$, 则 $a_{1}, a_{2}, \cdots, a_{70}$ 中至少有 2 个 $m$.

不妨设 $a_{1}=\max \left\{a_{1}, a_{2}, \cdots, a_{70}\right\}, b_{1}=\max \left\{b_{1}, b_{2} \cdots, b_{70}\right\}$, 则由 (1) 与 $A_{1}$ 相连的 $a_{1}$ 个 $B_{i}(1 \leq i \leq 70)$ 度数互不相同.

所以这些 $B_{i}$ 中一定有一个度数 $\geq a_{1}$. 所以 $b_{1} \geq a_{1}$.

同理, $a_{1} \geq b_{1}$. 故 $a_{1}=b_{1}$. 设 $s=a_{1}=b_{1}$. 故与 $B_{1}$ 相连的 $s$ 个 $A_{i}$ 度数分别为 $1,2, \cdots, s$. 所以 $1,2, \cdots, s$ 均在 $a_{1}, a_{2}, \cdots, a_{70}$ 中出现且 $m$ 出现 $\geq 2$ 次.

不妨设 $a_{1}=s, a_{2}=s-1, \cdots, a_{s-m}=m+1, a_{s-m+1}=a_{s-m+2}=m$, 同理, $1,2, \cdots, s$ 均在 $b_{1}, b_{2}, \cdots, b_{70}$ 中出现.

由 (1) 与 $A_{s-m+1}, A_{s-m+2}$ 相连的 $2 m$ 个 $B_{i}(1 \leq i \leq 70)$ 度数互不相同. 所以 $s \geq 2 m$. 设 $b_{1}, b_{2}, \cdots, b_{70}$ 中去掉 $1,2, \cdots, s$ 各一个后还剩 $x_{1}, x_{2}, \cdots, x_{70-s}\left(x_{1} \leq\right.$ $x_{2} \leq \cdots \leq x_{70-s}$.
对 $\forall k \in \mathbb{N}$ 且 $(s-2 m+1) \cdot 2^{k} \leq s-m$, 设 $B_{1}, B_{2}, \cdots, B_{70}$ 中所有度数 $\leq(s-2 m+1) \cdot 2^{k}$ 的点构成集合 $T$. 记 $s=\left\{A_{1}, A_{2}, \cdots, A_{70}\right\}$.

设 $s$ 与 $T$ 之间共有 $x$ 条边, 一方面:

$$
\begin{aligned}
x & =\left[1+2+\cdots+(s-2 m+1) \cdot 2^{k}\right]+\sum_{1 \leq i \leq 70-s, x_{i} \leq(s-2 m+1) \cdot 2^{k}} x_{i} \\
& =\frac{1}{2} \cdot\left[(s-2 m+1) \cdot 2^{k}\right] \cdot\left[(s-2 m+1) \cdot 2^{k}+1\right]+\sum_{1 \leq i \leq 70-s, x_{i} \leq(s-2 m+1) \cdot 2^{k}} x_{i}
\end{aligned}
$$

(这是因为 $T$ 中点的度数有 $1 \sim(s-2 m+1) \cdot 2^{k}$ 各一个以及 $x_{1}, x_{2}, \cdots, x_{70-s}$ 中所有 $\leq(s-2 m+1) \cdot 2^{k}$ 的数 $)$.

另一方面, 对 $\forall 1 \leq i \leq(s-2 m+1) \cdot 2^{k} \leq s-m, \operatorname{deg} A_{i}=a_{i}=s+1-i$. 所以与 $A_{i}$ 相连的 $(s+1-i)$ 个 $B_{j}$ 的度数两两不同. 这 $(s+1-i)$ 个 $B_{j}$ 中度数 $>(s-2 m+1) \cdot 2^{k}$ 个. 所以至少 $(s-2 m+1) \cdot 2^{k}+1-i$ 个的度数 $\leq(s-2 m+1) \cdot 2^{k}$.即与 $A_{i}$ 相连的 $B_{j}$ 中至少有 $(s-2 m+1) \cdot 2^{k}+1-i$ 个 $\in T$.

又因为 $A_{s-m+1}$ 与 $A_{s-m+2}$ 所连出的 $2 m$ 个 $B_{i}(1 \leq i \leq 70)$ 度数互不相同. 所以类似地, 其中至少有 $(s-2 m+1) \cdot 2^{k}-(s-2 m)$ 个 $\in T$. 所以

$$
\begin{aligned}
x & \geq \sum_{i=1}^{(s-2 m+1) \cdot 2^{k}}\left((s-2 m+1) \cdot 2^{k}+1-i\right)+(s-2 m+1) \cdot 2^{k}-(s-2 m) \\
& =\frac{1}{2} \cdot\left[(s-2 m+1) \cdot 2^{k}\right]\left[(s-2 m+1) \cdot 2^{k}+1\right]+(s-2 m+1) \cdot 2^{k}-(s-2 m) .
\end{aligned}
$$

由(1)(2)知:

$\sum_{1 \leq i \leq 70-s, x_{i} \leq(s-2 m+1) \cdot 2^{k}} x_{i} \geq(s-2 m+1) \cdot 2^{k}-(s-2 m)\left(\forall k \in \mathbb{N},(s-2 m+1) \cdot 2^{k} \leq s-m\right)$.

下面对 $k \in \mathbb{N},(s-2 m+1) \cdot 2^{k} \leq S-m$ 归纳证明: $x_{1}, x_{2}, \cdots, x_{70-S}$ 中 $\leq(s-2 m+1) \cdot 2^{k}$ 的数有至少 $k+1$ 个.

$k=0$ 时, 由 $(*)$ 知:

$$
\sum_{1 \leq i \leq 70-s, x_{i} \leq s-2 m+1} x_{i} \geq(s-2 m+1)-(s-2 m)=1 .
$$

故 $x_{1}, x_{2}, \cdots, x_{70-s}$ 中 $\leq(s-2 m+1)$ 的数至少 1 个. 成立!

假设 $0 \leq k \leq t-1$ 时成立 $\left(t \in \mathbb{Z}^{+},(s-2 m+1) \cdot 2^{t} \leq s-m\right)$ ，

则 $k=t$ 时, 由归纳假设, $\forall 0 \leq k \leq t-1, x_{1}, x_{2}, \cdots, x_{70-s}$ 中 $\leq(s-2 m+1) \cdot 2^{k}$的数至少 $k+1$ 个. 所以 $x_{i} \leq(s-2 m+1) \cdot 2^{i-1}(\forall 1 \leq i \leq t)$.

又由 $(*)$,

$\sum_{1 \leq i \leq 70-s, x_{i} \leq(s-2 m+1) \cdot 2^{t}} X_{i} \geq(s-2 m+1) \cdot 2^{k}-(s-2 m)>\sum_{i=1}^{t}(s-2 m+1) \cdot 2^{i-1} \geq \sum_{i=1}^{t} x_{i}$.
所以 $x_{1}, x_{2}, \cdots, x_{70-s}$ 除了 $x_{1}, x_{2}, \cdots, x_{t}$ 以外还有 $\leq(s-2 m+1) \cdot 2^{t}$ 的数. 故 $x_{1}, x_{2}, \cdots, x_{70-s}$ 中 $\leq(s-2 m+1) \cdot 2^{t}$ 的数至少 $t+1$ 个. 成立!

综上, 归纳得证!

故令 $k=\left\lfloor\log _{2} \frac{s-m}{s-2 m+1}\right\rfloor$, 得

$$
70-s \geq\left\lfloor\log _{2} \frac{s-m}{s-2 m+1}\right\rfloor+1>\log _{2} \frac{s-m}{s-2 m+1} .
$$

所以 $2^{70-s}>\frac{s-m}{s-2 m+1}(s \geq 2 m)$. 从而

$$
2^{70-2 m}=2^{70-s} \cdot 2^{s-2 m} \geq 2^{70-s}(s-2 m+1)>s-m \geq m
$$

即 $2^{70-2 m} \geq m+1$. 当 $m \geq 33$ 时, 左 $\leq 2^{70-2 \cdot 33}=16$, 右 $\geq 33+1=34$. 矛盾!

故 $m \leq 32$. 得证!

构造: 记 $(i, j)$ 为第 $i$ 行第 $j$ 列的格子. $(1 \leq i, j \leq 70)$.

将所有 $(i, j)(i+j \leq 65)$ 染红.

将 $(65,1),(65,2), \cdots,(65,22) ;(66,33),(66,34), \cdots,(66,64)$ 染红.

将 $(1,65),(2,66),(3,66),(4,67), \cdots,(7,67),(8,68), \cdots,(15,68),(16,69),(17,69)$,

$\cdots,(31,69),(32,70),(33,70)$ 染红. (如图所示)

![](https://cdn.mathpix.com/cropped/2024_02_26_0c121c24648cae0e78aeg-20.jpg?height=511&width=596&top_left_y=1338&top_left_x=730)

则第 65 行, 66 行均有 32 个格子. 所以满足 (2). 易验证满足 (1). 所以 $m=32$符合要求.

综上, $m$ 的最大值为 32 .

评注 根据证明部分的不等式, 我们可以发现：将 70 改为 71 时, 仍然可得 $m \leq 32$.

10. 称非空整数集 $A$ 是“优美的”, 如果对任意 $a \in A, 1 \leq k \leq 2023$, 集合

$$
\left\{b \in A:\left[\frac{b}{3^{k}}\right]=\left[\frac{a}{3^{k}}\right]\right\}
$$

的元素个数恰为 $2^{k}$. 求证: 若整数集 $S$ 与任意优美集合的交非空, 则 $S$ 包含一个优美的集合.
证明 对正整数 $t$, 定义一个 $t-$ 好集 $B$ 是 $\left\{0,1, \cdots, 3^{t}-1\right\}$ 的子集, 使任意 $a \in B, 1 \leq k \leq t$, 集合

$$
\left\{b \in B:\left[\frac{b}{3^{k}}\right]=\left[\frac{a}{3^{k}}\right]\right\}
$$

的元素个数恰为 $2^{k}$, 则任意优美集都是 $2023-$ 好集.

对 $t$ 归纳证明: 若整数集 $S$ 与任意 $t$-好集的交非空, 则 $S$ 包含一个 $t$-好集(任意 $t \in \mathbb{Z}_{+}$).

当 $t=1$ 时, $S$ 与 $\{0,1\},\{0,2\},\{1,2\}$ 交均非空, 故 $S$ 包含 $0,1,2$ 中至少 2 个元素, 故 $S$ 包含一个 $1-$ 好集, 成立!

假设 $t$ 时成立 $(t \geq 1)$, 则 $t+1$ 时, 则整数集 $S$ 与任意 $(t+1)$-好集的交非空, 令 $S^{\prime}=\left\{a \in\left\{0,1, \cdots, 3^{t}-1\right\}: 3 a, 3 a+1,3 a+2\right.$ 中至少 2 个 $\left.\in S\right\}$, 则对任意 $t$-好集 $A$, 若 $S^{\prime} \cap A=\emptyset$, 则对任意 $a \in A$, 有 $a \notin S^{\prime}$, 故 $3 a, 3 a+1,3 a+2$ 中至少 2 个 $\notin S$, 设为 $3 a+f(a), 3 a+g(a) \notin S(f(a), g(a) \in\{0,1,2\}, f(a) \neq g(a))$, 则令 $A^{\prime}=\{3 a+f(a), 3 a+g(a): a \in A\}$, 则 $A^{\prime}$ 是 $t+1$-好集, 且 $S \cap A^{\prime}=\emptyset$, 矛盾!

故对任意 $t$-好集 $A$, 若 $S^{\prime} \cap A \neq \emptyset$. 所以由归纳假设, 存在 $t$-好集 $C$, 使 $C \subseteq S^{\prime}$.

所以对任意 $x \in C$, 则 $x \in S^{\prime}$, 故 $3 x, 3 x+1,3 x+2$ 中至少 2 个 $\in S$, 设 $3 x+p(x), 3 x+q(x) \in S, p(x), q(x) \in\{0,1,2\}$.

故令 $C^{\prime}=\{3 x+p(x), 3 x+q(x): x \in C\}$, 则 $C^{\prime} \in S$ 且 $C^{\prime}$ 是 $(t+1)$ 一好集, 成立!

## 综上, 归纳得证!

回到原题, 因为整数集 $S$ 与任意优美集的交非空, 所以 $S$ 与任意 2023-好集的交非空, 所以 $S$ 包含一个 2023-好集, 故 $S$ 包含一个优美集, 得证!

评注 本题的想法是把 $3 x, 3 x+1,3 x+2$ 合并成一个数 $x$, 若 $3 x, 3 x+1,3 x+2$中有 $\geq 2$ 个数 $\in S$, 则 $x \in S^{\prime}$. 可知 $S$ 进行 2023 次这样的操作后得到整数集 $\mathbb{Z}$, 于是完成了证明.

11. 设 $n$ 是正整数, $a_{i j k} \in\{-1,1\}(1 \leq i, j, k \leq n)$. 求证: 存在 $x_{1}, \cdots, x_{n}$, $y_{1}, \cdots, y_{n}, z_{1}, \cdots, z_{n} \in\{-1,1\}$, 使得

$$
\left|\sum_{i=1}^{n} \sum_{j=1}^{n} \sum_{k=1}^{n} a_{i j k} x_{i} y_{j} z_{k}\right|>\frac{n^{2}}{3}
$$

证明 令

$$
S_{l}=\sum_{1 \leq j, k \leq n} a_{j, k, l} x_{j} y_{k}
$$

对 $i \in \mathbb{Z}^{+}, 1 \leq l \leq n$, 令 $E\left[\left|S_{l}\right|^{i}\right]$ 是 $x_{j}, y_{k}(1 \leq j \leq n, 1 \leq k \leq n)$ 均独立地等概率取 1 或 -1 时 $\left|S_{l}\right|^{i}$ 的数学期望.

于是对任意 $1 \leq l \leq n ，$

$$
E\left[\left|S_{l}\right|^{2}\right]=\sum_{1 \leq j_{1}, k_{1}, j_{2}, k_{2} \leq n} a_{j_{1}, k_{1}, l} a_{j_{2}, k_{2}, l} E\left[x_{j_{1}} y_{k_{1}} x_{j_{2}} y_{k_{2}}\right]=\sum_{1 \leq j, k \leq n} a_{j, k, l}^{2} x_{j}^{2} y_{k}^{2}=n^{2}
$$

下面考虑 $E\left[\left|S_{l}\right|^{4}\right]$.

$$
E\left[\left|S_{l}\right|^{2}\right]=\sum_{1 \leq j_{1}, k_{1}, j_{2}, k_{2}, j_{3}, k_{3}, j_{4}, k_{4} \leq n} a_{j_{1}, k_{1}, l} a_{j_{2}, k_{2}, l} a_{j_{3}, k_{3}, l} a_{j_{4}, k_{4}, l} E\left[x_{j_{1}} y_{k_{1}} x_{j_{2}} y_{k_{2}} x_{j_{3}} y_{k_{3}} x_{j_{4}} y_{k_{4}}\right]
$$

又因为上述这些项中, 当且仅当 $j_{1}, j_{2}, j_{3}, j_{4}$ 中每个数均出现偶数次; $k_{1}, k_{2}, k_{3}$, $k_{4}$ 中每个数均出现偶数次(即 $j_{1}=j_{2}, j_{3}=j_{4}$ 或 $j_{1}=j_{3}, j_{2}=j_{4}$ 或 $j_{1}=j_{4}, j_{2}=$ $j_{3}$; 并且 $k_{1}=k_{2}, k_{3}=k_{4}$ 或 $k_{1}=k_{3}, k_{2}=k_{4}$ 或 $k_{1}=k_{4}, k_{2}=k_{3}$, 共有 $\left(3 n^{2}-2 n\right)^{2}$组这样的 $\left.j_{1}, j_{2}, j_{3}, j_{4} ; k_{1}, k_{2}, k_{3}, k_{4}\right)$ 时, $E\left[x_{j_{1}} y_{k_{1}} x_{j_{2}} y_{k_{2}} x_{j_{3}} y_{k_{3}} x_{j_{4}} y_{k_{4}}\right]=1$, 其余项均为 0 . 故

$$
E\left[\left|S_{l}\right|^{4}\right] \leq\left(3 n^{2}-2 n\right)^{2}<9 n^{4}
$$

又由 Cauchy 不等式,

$$
\begin{gathered}
E\left[\left|S_{l}\right|\right] E\left[\left|S_{l}\right|^{3}\right] \geq E\left[\left|S_{l}\right|^{2}\right]^{2} \\
E\left[\left|S_{l}\right|^{2}\right] E\left[\left|S_{l}\right|^{4}\right] \geq E\left[\left|S_{l}\right|^{3}\right]^{2}
\end{gathered}
$$

于是可得：

$$
E\left[\left|S_{l}\right|\right] \geq \sqrt{\frac{E\left[\left|S_{l}\right|^{2}\right]^{3}}{E\left[\left|S_{l}\right|^{4}\right]}}>\sqrt{\frac{\left(n^{2}\right)^{3}}{9 n^{4}}}=\frac{n}{3}
$$

所以我们可以适当地取 $x_{j}, y_{k} \in\{-1,1\}(1 \leq j, k \leq n)$, 使

$$
\sum_{j=1}^{n}\left|S_{j}\right| \geq E\left[\sum_{j=1}^{n}\left|S_{j}\right|\right]=\sum_{j=1}^{n} E\left[\left|S_{j}\right|\right]>\frac{n^{2}}{3}
$$

于是我们再取

$$
z_{i}= \begin{cases}-1, & S_{i}<0 \\ 1, & S_{i} \geq 0\end{cases}
$$

此时

$$
\left|\sum_{i=1}^{n} \sum_{j=1}^{n} \sum_{k=1}^{n} a_{i j k} x_{i} y_{j} z_{k}\right|=\sum_{j=1}^{n}\left|S_{j}\right|>\frac{n^{2}}{3}
$$

得证!

评注 本题是一道中等难度的代数题, 想法是对于随机的 $x_{i}, y_{i}$, 然后取 $z_{i}$ 使原
式尽量大, 再算原式的期望.

12. 求证: 存在正实数 $\lambda$, 使得对任意实数 $D>1$, 在平面直角坐标系中都存在一个锐角三角形, 满足:

(1) 三角形的顶点均为整点;

(2) 三角形的边长均大于 $D$;

(3) 三角形的面积小于 $\frac{\sqrt{3}}{4} D^{2}+\lambda D^{\frac{4}{5}}$.

证明 $D \leq 10^{5}$ 时, 考虑腰长为 $10^{5}$ 的等腰直角三角形知: $\lambda=10^{10}$ 成立. 故不妨设 $D \geq 10^{5}$.

引理 1 对 $\forall c, t \in \mathbb{R}, c>1$, 存在整数 $n \in(t-6 c, t)$, 使 $\{\sqrt{3} n\}<\frac{1}{c}$.

证明 考虑 Pell 方程 $x^{2}-3 y^{2}=1$ 的正整数解 $(x, y)$.

由熟知结论: $x_{m}+\sqrt{3} y_{m}=(1+\sqrt{3})^{m}$, 则 $\left(x_{m}, y_{m}\right)\left(m \in \mathbb{Z}^{+}\right)$是其所有解. 故

$$
y_{m+1}=2 y_{m}+2 y_{m-1},(m \geq 2), y_{1}=1, y_{2}=4
$$

故 $y_{n+1}=2 y_{n}+2 y_{n-1} \leq 4 y_{n},\left(\forall n \in \mathbb{R}^{+}\right)$. 所以存在 $m \in \mathbb{Z}^{+}$, 使 $\frac{3}{2} c \leq y_{m}<6 c$. 因此

$$
\left(x_{m}-\sqrt{3} y_{m}\right)\left(x_{m}+\sqrt{3} y_{m}\right)=1 .
$$

所以 $\sqrt{3} y_{m}=x_{m}-\frac{1}{x_{m}+\sqrt{3} y_{m}}$.

又因为 $x_{m}^{2}-3 y_{m}^{2}=1$, 故 $\left(x_{m}, y_{m}\right)=1$. 又 $y_{m}<6 c$, 所以存在连续 $y_{m}$ 个整数 $z-y_{m}+1, z-y_{m}+2, \cdots, z \in(t-6 c, t)$

设 $k=\left[\{\sqrt{3} z\} \cdot y_{m}\right],\left(0 \leq k \leq y_{m}-1\right)$. 则

$$
\frac{k}{y_{m}} \leq\{\sqrt{3} z\}<\frac{k+1}{y_{m}}
$$

因为 $\left(x_{m}, y_{m}\right)=1$, 所以存在 $0 \leq \ell \leq y_{m}-1$ 使 $x_{m} \cdot \ell \equiv\left(\bmod y_{m}\right)$.

所以

$$
\begin{aligned}
\{\sqrt{3}(z-\ell)\} & \left\{\sqrt{3} z-\left(\frac{x_{m}}{y_{m}}-\frac{1}{y_{m}\left(x_{m}+\sqrt{3} y_{m}\right)}\right) \cdot \ell\right\} \\
& =\left\{\{\sqrt{3} z\}-\frac{x_{m} \ell}{y_{m}}+\frac{1}{y_{m}\left(x_{m}+\sqrt{3} y_{m}\right)}\right\} \\
& \leq\left\{\{\sqrt{3} z\}-\frac{k}{y_{m}}\right\}+\left\{\frac{\ell}{y_{m}\left(x_{m}+\sqrt{3} y_{m}\right)}\right\} \\
& <\frac{1}{y_{m}}+\frac{1}{2 y_{m}}=\frac{3}{2 y_{m}}<\frac{1}{c},
\end{aligned}
$$

所以考虑 $z-\ell \in(t-6 c, t)$ 知, 成立!

引理 2 存在 $a, b \in \mathbb{Z}_{\geq 0}$ 使 $\{\sqrt{3} a\}<D^{-\frac{1}{5}},\{\sqrt{3} b\}<D^{-\frac{1}{5}}$ 且

$$
\frac{D^{2}}{4}+25 \cdot D^{\frac{4}{5}}<a^{2}+b^{2}<\frac{D^{2}}{4}+100 D^{\frac{4}{5}} .
$$

证明 令

$$
S=\frac{D^{2}}{4}+100 D^{\frac{4}{5}}, T=\frac{D^{2}}{4}+25 \cdot D^{\frac{4}{5}}, S<\frac{D^{2}}{4}+\frac{D^{2}}{4}<D^{2}
$$

由引理 1 , 令 $t=\sqrt{S}, c=D^{\frac{1}{5}}$ 知: 存在 $a \in \mathbb{Z}^{+}, a \in\left(\sqrt{S}-6 \cdot D^{\frac{1}{5}}, \sqrt{S}\right)$ 且 $\{\sqrt{3} a\}<D^{-\frac{1}{5}}$.

令 $t=\sqrt{S-a^{2}}, c=D^{\frac{1}{5}}$ 知: 存在 $b \in \mathbb{Z}_{\geq 0}, b \in\left(\sqrt{S-a^{2}}-6 D^{\frac{1}{5}}, \sqrt{S-a^{2}}\right)$ 且 $\{\sqrt{3} b\}<D^{-\frac{1}{5}}$. (这是因为若 $\sqrt{S-a^{2}}-6 D^{\frac{1}{5}}<0$, 则令 $b=0$ 即可.)

此时 $a^{2}+b^{2}<a^{2}+\left(\sqrt{S-a^{2}}\right)^{2}=S$,

$$
\begin{aligned}
a^{2}+b^{2} & >a^{2}+\left(\sqrt{S-a^{2}}-6 D^{\frac{1}{5}}\right)^{2}>S-\sqrt{S-a^{2}} \cdot 12 D^{\frac{1}{5}} \\
& >S-12 D^{\frac{1}{5}} \cdot \sqrt{S-\left(\sqrt{S}-6 D^{\frac{1}{5}}\right)^{2}}>S-12 \cdot D^{\frac{1}{5}} \cdot \sqrt{12 \sqrt{S} \cdot D^{\frac{1}{5}}} \\
& >S-12 \cdot D^{\frac{1}{5}} \cdot \sqrt{12 \cdot \sqrt{D^{2}} \cdot D^{\frac{1}{5}}}>S-48 \cdot D^{\frac{4}{5}} \\
& =\frac{D^{2}}{4}+52 \cdot D^{\frac{4}{5}}>\frac{D^{2}}{4}+25 \cdot D^{\frac{4}{5}} .
\end{aligned}
$$

成立!

回到原题. 我们取引理 2 中的 $a, b \in \mathbb{Z}_{\geq 0}$, 令 $c=[\sqrt{3} a], d=[\sqrt{3} b]$. 故 $c<\sqrt{3} a<c+D^{-\frac{1}{5}}, d<\sqrt{3} b<d+D^{-\frac{1}{5}}$ 且

$$
\frac{D^{2}}{4}+25 \cdot D^{\frac{4}{5}}<a^{2}+b^{2}<\frac{D^{2}}{4}+100 D^{\frac{4}{5}}
$$

可知 $a, b<D$.

所以取 $\triangle A B C: A(0,0), B(2 a, 2 b), C(a+d, b-c)$. 显然符合 $(1)$, 则

$$
\begin{gathered}
|A B|=\sqrt{(2 a)^{2}+(2 b)^{2}}=\sqrt{4\left(a^{2}+b^{2}\right)}>0 \\
|A C|=\sqrt{(a+d)^{2}+(b-c)^{2}} \\
>\sqrt{(a+\sqrt{3} b)^{2}-2 \cdot D^{-\frac{1}{5}}(a+\sqrt{3} b)+(b-\sqrt{3} a)^{2}}-2 \cdot D^{-\frac{1}{5} \cdot|b-\sqrt{3} a|} \\
>\sqrt{4 a^{2}+4 b^{2}-20 \cdot D^{-\frac{1}{5}}(|a|+|b|)} \\
>\sqrt{4 a^{2}+4 b^{2}-20 \cdot D^{-\frac{1}{5}} \cdot D}>\sqrt{4\left(\frac{D^{2}}{4}+25 \cdot D^{\frac{4}{5}}\right)-20 \cdot D^{\frac{4}{5}}}>D .
\end{gathered}
$$

同理可知 $|B C|>D$.

故符合 (2).

又因为

$$
\begin{aligned}
S_{\triangle A B C} & =\frac{1}{2} \cdot|2 b(a+d)-2 a(b-c)| \\
& =\frac{1}{2}|2 a c+2 b d|=a c+b d \\
& <\sqrt{3} a^{2}+\sqrt{3} b^{2}=\sqrt{3}\left(a^{2}+b^{2}\right)<\frac{\sqrt{3}}{4} D^{2}+100 \sqrt{3} \cdot D^{\frac{4}{5}} .
\end{aligned}
$$

所以令 $\lambda=10^{10}$ 成立!

综上, 令 $\lambda=10^{10}$, 符合要求. 得证!

评注 本题是道较难的数论题. 将 $A, B, C$ 的坐标按解答中的方式设出来后可将原题转化至引理 2 的形式, 然后联想到引理 1 的结论即可完成证明.

