数学新星网 学生专栏

www.nsmath.cn/xszl

# 2022 年集训队试题解析 

张贻然，江城

(上海市上海中学，200231)

指导教师：王广廷

本文给出 2022 年集训队的试题解答及评析, 文章尽可能还原作者们在考试时的思考和作法, 并不代表每个题的答案都是最好的.

## I. 试题

测试一

1.1 设凸六边形 $A B C D E F$ 内接于圆, $A B$ 的延长线和 $D C$ 的延长线相交于点 $G, A F$ 的延长线和 $D E$ 的延长线相交于点 $H$. 记 $\triangle B C G$ 的外心为 $M$, $\triangle E F H$ 的外心为 $\mathrm{N}$. 证明: $B E, C F, M N$ 三线共点.

1.2 给定素数 $p$, 设 $A$ 是一个由整数构成的无穷集合. 证明：可以选出 $A$ 的一个 $2 p-2$ 元子集 $B$, 使得 $B$ 中任意 $p$ 个两两不同的元素算数平均值都不在 $A$ 中.

1.3 设 $a, b, c, p, q, r$ 是给定的正整数，且 $p, q, r \geq 2$. 令

$$
Q=\left\{(x, y, z) \in \mathbb{Z}^{3} \mid 0 \leq x \leq a, 0 \leq y \leq b, 0 \leq z \leq c\right\}
$$

初始时，在 $Q$ 中的每个点处放置一枚棋子，一共放置 $M$ 枚棋子. 之后可以进行如下三类操作：

(1) 从点 $(x, y, z)$ 处取走 $p$ 枚棋子, 并在点 $(x-1, y, z) \in Q$ 处放上一枚新棋子;

(2) 从点 $(x, y, z)$ 处取走 $q$ 枚棋子, 并在点 $(x, y-1, z) \in Q$ 处放上一枚新棋子;

(3) 从点 $(x, y, z)$ 处取走 $r$ 枚棋子, 并在点 $(x, y, z-1) \in Q$ 处放上一枚新棋子.求 $M$ 的最小值，使得不论最初的 $M$ 枚棋子如何分布，都可以经过一系列上述操作，使得点 $(0,0,0)$ 处放有棋子.

2.4 锐角 $\triangle A B C$ 中, $\angle A C B>2 \angle A B C, I$ 为内心, $K$ 为 $I$ 关于 $B C$ 的对称点, $B A$ 的延长线与 $K C$ 的延长线交于点 $D$. 过 $B$ 作 $C I$ 的平行线, 与 $\triangle A B C$ 的外接圆的劣弧 $\overparen{B C}$ 交于点 $E(E \neq B)$. 过 $A$ 作 $B C$ 的平行线, 与直
线 $B E$ 交于点 $F$. 证明：若 $B F=C E$, 则 $A D=F K$.

2.5 设 $C=\{z \in \mathbb{C}|| z \mid=1\}$ 是复平面上的单位圆周, 240 个复数 $z_{1}, z_{2}, \cdots$, $z_{240} \in C$ (可以相同）满足下面两个条件:

(1) 对 $C$ 上任意长度为 $\pi$ 的开弧 $\Gamma$, 至多有 200 个 $j(1 \leq j \leq 240)$ 使得 $z_{j} \in \Gamma$;

(2) 对 $C$ 上任意长度为 $\frac{\pi}{3}$ 的开弧 $\gamma$, 至多有 120 个 $j(1 \leq j \leq 240)$ 使得 $z_{j} \in \gamma$.求 $\left|z_{1}+z_{2}+\cdots+z_{240}\right|$ 的最大值.

2.6 设 $\mathrm{m}$ 是正整数, $A_{1}, A_{2}, \cdots, A_{m}$ 是有限集 $A$ 的 $m$ 个子集 (可以相同).已知对 $\{1,2, \cdots, m\}$ 的每个非空子集 $I$ 均有

$$
\left|\bigcup_{i \in I} A_{i}\right| \geq|I|+1
$$

证明：可将 $A$ 中的每个元素染成黑白两种颜色之一, 使得 $A_{1}, A_{2}, \cdots, A_{m}$ 中的每个集合都同时包含黑色元素和白色元素.

## 测试二

3.1 求所有正整数 $m, n$, 使得在 $m \times n$ 的方格表 (有 $m+1$ 条坚线和 $n+1$条横线) 中, 可以将某些小格添加对角线 (每格至多添加一条, 可以不添), 使得整个图（包括所有对角线及表格自身的边）可以一笔画走遍所有边并回到起点.

3.2 在非直角 $\triangle A B C$ 中, $B C>C A>A B$. 设 $P_{i}(i=1,2)$ 为平面上不同两点, $D_{i}, E_{i}, F_{i}$ 分别为 $A P_{i}, B P_{i}, C P_{i}$ 与 $\odot(A B C)$ 的另一个交点, 满足 $D_{i} E_{i}, D_{i} F_{i}$ 垂直且相等. 设 $P_{1} P_{2}$ 与 $\odot(A B C)$ 交于点 $Q_{1}, Q_{2}$. 取 $Q_{i}$ 在 $A B, A C$上的垂足 $X_{i}, Y_{i}$, 设 $X_{1} Y_{1}, X_{2} Y_{2}$ 交于点 $W$. 证明: $W$ 在 $\triangle A B C$ 的九点圆上.

3.3 设 $a_{1}, a_{2}, \cdots, a_{n}$ 为 $n$ 个两两互不整除的正整数, 证明:

$$
a_{1}+a_{2}+\cdots+a_{n} \geq 1.1 n^{2}-2 n
$$

4.4 给定正整数 $n$, 求实数 $x_{1}, x_{2}, \cdots, x_{n}$ 的值, 使得下式取到最小值:

$$
\sum_{\left(k_{1}, k_{2}, \cdots, k_{n}\right) \in\{0,1,2\}^{n}}\left|k_{1} x_{1}+k_{2} x_{2}+\cdots+k_{n} x_{n}-1\right|
$$

4.5 给定正整数 $n$ 与映射 $f: \mathbb{Z} \rightarrow \mathbb{Z}$ ，证明下列命题等价：

(1) 对任意正整数 $m$ 满足 $m \mid n$, 有 $n \left\lvert\, \sum_{d \mid m} f(d)\left(\begin{array}{c}n / d \\ m / d\end{array}\right)\right.$.

(2) 对任意正整数 $k$ 满足 $k \mid n$ ，有 $k \mid \sum_{d \mid k} f(d)$.

4.6 给定正整数 $m \geq n \geq 2022$, 证明：对任意 $2 n$ 个实数 $a_{1}, a_{2}, \cdots, a_{n}$, $b_{1}, b_{2}, \cdots, b_{n}$, 满足 $\left|a_{i}+b_{j}-i j\right| \leq m$ 的有序对 $(i, j)$ 的数量不超过 $3 n \sqrt{m \ln n}$.

## 测试三

5.1 已知平面上圆 $\Gamma_{2}$ 在圆 $\Gamma_{1}$ 的内部. 证明平面上存在点 $P$ 满足如下条件：若 $l$ 是一条不过 $P$ 的直线，且 $l$ 与 $\Gamma_{1}$ 交于不同两点 $A, B$, 与 $\Gamma_{2}$ 交于不同两点 $C, D$ (其中 $A, C, D, B$ 在 $l$ 上顺次排列 $)$, 则 $\angle A P C=\angle D P B$.

5.2 已知正实数 $\alpha, \beta$ 满足：对任意正整数 $k_{1}, k_{2}$, 均有 $\left\lfloor k_{1} \alpha\right\rfloor \neq\left\lfloor k_{2} \beta\right\rfloor$, 其中 $\lfloor x\rfloor$ 表示不超过 $x$ 的最大整数. 证明: 存在正整数 $m_{1}, m_{2}$ 使得 $\frac{m_{1}}{\alpha}+\frac{m_{2}}{\beta}=1$.

5.3 给定整数 $n \geq 2$. 求满足下列两个条件的所有 $n$ 元整数组 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$ : （1） $a_{1}$ 是奇数, $1<a_{1} \leq a_{2} \leq \cdots \leq a_{n}$ ，且 $M=\frac{1}{2^{n}}\left(a_{1}-1\right) a_{2} \cdots a_{n}$ 是整数.

（2）存在 $M$ 个 $n$ 元整数组 $\left(c_{i, 1}, c_{i, 2}, \cdots, c_{i, n}\right)(i=1,2, \cdots, M)$, 满足对任何 $1 \leq i<j \leq M$ 都存在 $k \in\{1,2, \cdots, n\}$ 使得

$$
c_{i, k}-c_{j, k} \not \equiv-1,0,1 \quad\left(\bmod a_{k}\right) .
$$

6.4 求所有正整数 $k$, 使得平面直角坐标系中存在有限多个重心为整点的三角形，其中任意两个三角形的交集或为空集，或为一个公共顶点，或为连接两个公共顶点的边, 且这些三角形的并集是一个边长为 $k$ 的正方形（该正方形的顶点可以不是整点，边可以不平行于坐标轴）.

6.5 证明: 存在正实数 $C$ 和 $\alpha>\frac{1}{2}$, 使得对任意正整数 $n$, 均存在 $\{1,2, \cdots, n\}$的子集 $A$, 满足 $|A| \geq C n^{\alpha}$, 且 $A$ 中任意两个不同数的差不是完全平方数.

6.6 (1) 证明：在复平面上, 方程

$$
z^{20}+63 z+22=0
$$

的全体复根的凸包的面积大于 $\pi$.

（2）设 $n$ 为正整数， $1 \leq k_{1}<k_{2}<\cdots<k_{n}$ 为 $n$ 个奇数. 证明：对任意总和为 1 的 $n$ 个复数 $a_{1}, a_{2}, \cdots, a_{n}$ 以及任意模长不小于 1 的复数 $w$, 方程

$$
a_{1} z^{k_{1}}+a_{2} z^{k_{2}}+\cdots+a_{n} z^{k_{n}}=w
$$

都至少有一个模长不超过 $3 n|w|$ 的复根.

## 测试四

7.1 在 $n \times n(n \geq 2)$ 的网络屏上, 每个单位方格初始时显示红黄蓝三种颜色之一. 每一秒钟网络屏中所有单位方格按如下方式同时变换颜色, 称为一轮变换：

- 对当前颜色是红色的单位方格 A, 如果当前存在黄色单位方格与它有公共边，那么下一秒钟 $\mathrm{A}$ 变为黄色, 否则 $\mathrm{A}$ 的颜色仍是红色.
- 对当前颜色是黄色的单位方格 B, 如果当前存在蓝色单位方格与它有公共边, 那么下一秒钟 $\mathrm{B}$ 变为蓝色, 否则 $\mathrm{B}$ 的颜色仍是黄色.
- 对当前颜色是蓝色的单位方格 C, 如果当前存在红色单位方格与它有公共边, 那么下一秒钟 $\mathrm{C}$ 变为红色, 否则 $\mathrm{C}$ 的颜色仍是蓝色.

证明：如果在 $2 n-2$ 轮变换后屏幕没有变成单一颜色, 那么它将永远不会变成单一颜色.

7.2 在凸四边形 $A B C D$ 中, $\triangle A B C, \triangle A D C$ 的内心分别为 $I, J$. 已知 $I J, A C, B D$相交与一点 $P$. 过 $P$ 且垂直于 $B D$ 的直线与 $\angle B A D$ 的外角平分线相交于点 $E$,与 $\angle B C D$ 的外角平分线相交于点 $F$. 证明: $P E=P F$.

7.3 求所有的函数 $f: \mathbb{R} \rightarrow \mathbb{R}$ 满足：对任意实数 $x, y$, 如下两个可重集相等

$$
\{f(x f(y)+1), f(y f(x)-1)\}=\{x f(f(y))-1, y f(f(x))+1\} .
$$

注: $\{a, b\}=\{c, d\}$ 作为可重集相等指 $a=c, b=d$, 或者 $a=d, b=c$.

8.4 求所有的素数 $p$ 和正整数 $a, b, c$, 满足

$$
2^{a} p^{b}=(p+2)^{c}+1
$$

8.5 设 $n$ 是正整数, $2 n$ 个非负实数 $x_{1}, x_{2}, \cdots, x_{2 n}$ 满足 $x_{1}+x_{2}+\cdots+x_{2 n}=4$.证明：存在非负整数 $p, q$ ，使得 $q \leq n-1$ ，且

$$
\sum_{i=1}^{q} x_{p+2 i-1} \leq 1, \sum_{i=q+1}^{n-1} x_{p+2 i} \leq 1
$$

注 1: 下标模 $2 n$ 理解, 即若 $k \equiv l(\bmod 2 n)$, 则 $x_{k}=x_{l}$.

注 2: 若 $q=0$, 则第一个求和视为 0 ; 若 $q=n-1$, 则第二个求和视为 0 .

8.6 给定正整数 $n$, 用 $D$ 表示 $n$ 的所有正因子构成的集合. 设 $A, B$ 是 $D$的子集，满足：对任何 $a \in A, b \in B$, 总有 $a$ 不整除 $b$ 且 $b$ 不整除 $a$. 证明：

$$
\sqrt{|A|}+\sqrt{|B|} \leq \sqrt{|D|}
$$

## II. 解答与评注

## 测试一

1.1 设凸六边形 $A B C D E F$ 内接于圆, $A B$ 的延长线和 $D C$ 的延长线相交于点 $G, A F$ 的延长线和 $D E$ 的延长线相交于点 $H$. 记 $\triangle B C G$ 的外心为 $M$, $\triangle E F H$ 的外心为 $\mathrm{N}$. 证明: $B E, C F, M N$ 三线共点.
证明：记 $B E, C F$ 交于 $P$, 则只需证明 $M, P, N$ 三点共线. 为此, 只需证

![](https://cdn.mathpix.com/cropped/2024_02_26_6d36037dbc5f26d340d2g-05.jpg?height=489&width=742&top_left_y=395&top_left_x=660)

$$
\frac{\sin \angle M P B}{\sin \angle M P C}=\frac{\sin \angle N P E}{\sin \angle N P F}
$$

而在 $\triangle M P B$ 中利用正弦定理, 有

$$
\sin \angle M P B=\frac{M B}{M P} \cdot \sin \angle M B P
$$

$\triangle M P C$ 等同理有上式，因而

$$
\frac{\sin \angle M P B}{\sin \angle M P C}=\frac{\frac{M B}{M P} \cdot \sin \angle M B P}{\frac{M C}{M P} \cdot \sin \angle M C P}=\frac{\sin \angle M B P}{\sin \angle M C P}
$$

同样有

$$
\frac{\sin \angle N P E}{\sin \angle N P F}=\frac{\sin \angle N E P}{\sin \angle N F P}
$$

因而只需证

$$
\frac{\sin \angle M B P}{\sin \angle M C P}=\frac{\sin \angle N E P}{\sin \angle N F P}
$$

而利用

$$
\begin{aligned}
& \angle M B P+\angle P E N \\
= & \angle P B C+\angle M B C+\angle P E F+\angle N F E \\
= & \left(180^{\circ}-\angle C D E\right)+\left(90^{\circ}-\angle B G C\right)+\left(180^{\circ}-\angle B A F\right)+\left(90^{\circ}-\angle A H D\right) \\
= & 540^{\circ}-360^{\circ}=180^{\circ}
\end{aligned}
$$

同理

$$
\angle M C P+\angle P F N=180^{\circ}
$$

从而有欲证式成立.

评注. 本题是简单的几何题，有多种解法，其中考场上大部分同学给出的是上述利用正弦比解决问题的较为直接的做法.

1.2 给定素数 $p$, 设 $A$ 是一个由整数构成的无穷集合. 证明：可以选出 $A$ 的一个 $2 p-2$ 元子集 $B$, 使得 $B$ 中任意 $p$ 个两两不同的元素算数平均值都不在 $A$ 中.

证明：对 $\mathrm{n}$ 归纳证明：对 $1 \leq n \leq 2 p-2$, 可以选出 $A$ 的 $n$ 元子集 $B$, 使 $B$ 中任意 $p$ 个两两不同的元素算数平均值不在 $A$ 中.

$n=1$ 时, 任选一个 $A$ 中元素, 由 $p>1$ 知结论成立.

假设小于 $n$ 时成立, $n$ 时 $(2 \leq n \leq 2 p-2)$

注意到将所有 $A$ 中元素同时加上一个整数不影响结论, 从而可同加上某元素的相反数, 因此不妨 $0 \in A$.

又若 $A$ 中所有元素均为某正整数倍数, 则可同除以该数, 不影响结论, 因而不妨 $A$ 中所有元素整体互素.

因此, $A$ 中有数不是 $p$ 的倍数, 且有数 (0) 是 $p$ 的倍数, 因而 $A$ 中元素模 $p$ 有 2 个剩余类.

情形 1 若 $A$ 中存在两个模 $p$ 剩余类各含无穷个元素, 设为模 $p$ 余 $s, t$ 的剩余类， $0 \leq s<t \leq p-1$.

则在两个剩余类中各取 $p-1$ 个元素, 从这 $2 p-2$ 个元素中取 $n$ 个元素,下证这 $n$ 个元素满足要求.

事实上, 对于这 $n$ 个元素中的 $p$ 个元素, 设有 $l$ 个模 $p$ 余 $s, 1 \leq l \leq p-1$,则它们的和

$$
S \equiv l s+(p-l) t \equiv l(s-t) \not \equiv 0(\bmod p)
$$

因而它们的算数平均值不为整数，当然不属于 $A$.

情形 2 若 $A$ 中仅有一个模 $p$ 剩余类含无穷个元素, 设为模 $p$ 余 $s$ 剩余类,模 $p$ 余 $s$ 剩余类构成集合 $B$.

注意将 $A, B$ 中元素同时取相反数不影响结论, 因而可不妨设 $A$ 中有无穷多个正整数, 从而 $\mathrm{B}$ 中有无穷多个正整数.

由于 $A$ 中仅有有限个元素不在 B 中, 因而存在 $N>0$ 使一切 $A$ 中大于 $N$ 的数在 $B$ 中. 取 $A$ 中模 $p$ 不余 $s$ 的数 $a$, 并对 $B$ 中大于 $N$ 的数构成无限集及 $n-1$ 用归纳假设, 得到 $n-1$ 个数构成集合 $C$, 使 $C$ 中任 $p$ 个数的算术平均值不在 $B$ 中. 下只需证 $a$ 及 $C$ 中 $n-1$ 个元素满足要求.

对于其中 $p$ 个数, 若有 $a$, 则它们和 $S \equiv a+(p-1) s \equiv a-s \not \equiv 0(\bmod p)$,因而算术平均值不为整数，当然不属于 $A$.

若无 $a$, 则算术平均值大于 $N$, 而由归纳假设, 它们算术平均值不在 $B$ 中,
结合 $B$ 为 $A$ 中所有大于 $N$ 的数知它们算术平均值不在 $A$ 中.

从而，我们完成了归纳过渡.

令 $n=2 p-2$ 知原命题成立.

评注. 本题是中等偏易的数论题, 可以先令 $A=Z$, 看出此时必须让任意 $p$ 个数算数平均不是整数, 从而容易想到 $A$ 中有两个包含无穷个数的剩余类时的构造, 对于 $A$ 中仅有一个无穷剩余类的情况, 可以利用归纳法完成构造.

1.3 设 $a, b, c, p, q, r$ 是给定的正整数, 且 $p, q, r \geq 2$. 令

$$
Q=\left\{(x, y, z) \in \mathbb{Z}^{3} \mid 0 \leq x \leq a, 0 \leq y \leq b, 0 \leq z \leq c\right\}
$$

初始时, 在 $Q$ 中的每个点处放置一枚棋子, 一共放置 $M$ 枚棋子. 之后可以进行如下三类操作:

(1) 从点 $(x, y, z)$ 处取走 $p$ 枚棋子, 并在点 $(x-1, y, z) \in Q$ 处放上一枚新棋子;

(2) 从点 $(x, y, z)$ 处取走 $q$ 枚棋子, 并在点 $(x, y-1, z) \in Q$ 处放上一枚新棋子;

(3) 从点 $(x, y, z)$ 处取走 $r$ 枚棋子, 并在点 $(x, y, z-1) \in Q$ 处放上一枚新棋子.

求 $M$ 的最小值, 使得不论最初的 $M$ 枚棋子如何分布, 都可以经过一系列上述操作，使得点 $(0,0,0)$ 处放有棋子.

解: 所求 $\mathrm{M}$ 的最小值为 $p^{a} q^{b} r^{c}$.

一方面, 若初始时在 $(a, b, c)$ 处放置少于 $p^{a} q^{b} r^{c}$ 枚棋子, 则无法使 $(0,0,0)$处有棋子, 因为可对每个 $(x, y, z) \in Q$ 处的棋子 $u$ 定义其权重 $\omega(u)=\frac{1}{p^{x} q^{y} r^{z}}$,则操作不改变所有棋子的权重和, 因而由于一开始权重和小于 1 , 有最终不能有权值为 1 的棋子, 即无法使 $(0,0,0)$ 处有棋子.

另一方面, 证明当 $M \geq p^{a} q^{b} r^{c}$ 时, 可以使 $(0,0,0)$ 处有棋子:

事实上, 对所有非负实数 $a, b, c$ 证明结论成立.

先来证明一个引理:

引理. 对于二维的情况 $\left(Q=\left\{(x, y) \in \mathbb{Z}^{2} \mid 0 \leq x \leq a, 0 \leq y \leq b\right\}\right.$, 每次可以从点 $(x, y)$ 处取走 $p$ 枚棋子, 并在点 $(x-1, y) \in Q$ 处放上一枚新棋子或从点 $(x, y)$ 处取走 $q$ 枚棋子, 并在点 $(x, y-1) \in Q$ 处放上一枚新棋子). 设 $M, K$ 表示 $Q$ 上的棋子数量及有棋子的格点数, $u \geq 2$ 是一个正整数, 则当 $M+K>u \cdot p^{a} q^{b}$时，可以进行操作使得 $(0,0)$ 处有 $u$ 枚棋子.

引证. 对 $a+b$ 归纳证明结论:

$a+b=0$ 时, $M+K>1$ 知初始时有至少 $u$ 棋子在 $(0,0)$, 成立.

假设 $a+b$ 较小时均成立, 则对于 $(a, b)$, 若 $a, b$ 之一为 0 , 不妨 $b=0$, 对
每个点 $(x, 0)$ 处的棋子, 定义其权重为 $\frac{1}{p^{x}}$, 则所有棋子的权重和不小于

$$
\frac{M-K+1}{p^{a}}+\frac{K-1}{p^{a-1}} \geq \frac{M-K+1}{p^{a}}+2 \cdot \frac{K-1}{p^{a}}=\frac{M+K-1}{p^{a}} \geq u .
$$

因此, 将所有棋子尽量操作, 最终无法操作时如果 $(0,0)$ 处没有 $u$ 枚棋子, 则所有棋子赋值和不大于

$$
u-1+\sum_{x=1}^{a} \frac{p-1}{p^{x}}<u-1+(p-1) \cdot \sum_{x=1}^{+\infty} \frac{1}{p^{x}}=u-1+(p-1) \cdot \frac{1}{p-1}=u
$$

与所有棋子赋值和不变矛盾!

因此, $a, b$ 中有 0 时可以操作, 下设 $a, b>0$. 并且由上述证明, 我们可以看出只要一条链上的赋值和不小于 1 , 则可以完成操作.

记 $Q_{0}=\left\{(x, y) \in \mathbb{Z}^{2} \mid 0 \leq x \leq a-1,0 \leq y \leq b-1\right\}$ 中有 $M_{0}$ 枚棋子, $K_{0}$个点有棋子; $Q_{1}=\left\{(x, y) \in \mathbb{Z}^{2} \mid x=a, 0 \leq y \leq b\right\}$ 中有 $M_{1}$ 枚棋子, $K_{1}$ 个点有棋子； $Q_{2}=\left\{(x, y) \in \mathbb{Z}^{2} \mid 0 \leq x \leq a, y=b\right\}$ 中有 $M_{2}$ 枚棋子, $K_{2}$ 个点有棋子.

将 $Q_{1}$ 中的棋子尽量进行去掉 $p$ 个并在横坐标少 1 处放 1 个棋子的操作,由归纳假设, 如果操作结束后 $M^{\prime}+K^{\prime}>u \cdot p^{a-1} q^{b}$ 则结论成立, 否则有

$$
\begin{aligned}
\frac{M+K-1}{p} & \geq u \cdot p^{a-1} q^{b} \\
& \geq M^{\prime}+K^{\prime} \\
& \geq M-M_{1}+K-K_{1}+\frac{M_{1}-(p-1) K_{1}}{p} \\
& =M+K-K_{1}-(p-1) \cdot \frac{M_{1}+K_{1}}{p}
\end{aligned}
$$

因此, 有

$$
p K_{1}-1 \geq(p-1)\left(M+K-M_{1}-K_{1}\right)
$$

对另一个方向同样操作，则同样可设

$$
p K_{2}-1 \geq(p-1)\left(M+K-M_{2}-K_{2}\right)
$$

不妨设 $K_{1} \geq K_{2}$, 则假设 $K_{1}>K_{2}$, 有 $M-M_{2} \geq K-K_{2} \geq K_{1}-1$, 因此

$$
K_{2}>\frac{p-1}{p} \cdot\left(M+K-M_{2}-K_{2}\right) \geq \frac{1}{2} \cdot 2\left(K_{1}-1\right)=K_{1}-1 \geq K_{2},
$$

矛盾！因而 $K_{1}=K_{2}$.

由上可得如果 $M+K-M_{1}-K_{1} \geq 2 K_{1}$ 则不成立, 因此若 $K_{0} \neq 0$ 则有至少 $K_{1}-1+1=K_{1}$ 个点横坐标非 $a$ 且有棋子, 与 $M+K-M_{1}-K_{1}<2 K_{1}$矛盾! 同样的, 如果角上没有棋子, 则 $M+K-M_{1}-K_{1} \geq 2 K_{2}=2 K_{1}$, 不成立, 因此角上一定有棋子.
因此, $K_{0}=0$, 所有棋子或者横坐标为 $a$, 或者纵坐标为 $b$. 记 $k=K_{1}=$ $K_{2} \cdot k=1$ 时显然可以完成操作, 下设 $k \geq 2$.

再考虑 $M+K-M_{1}-K_{1}<2 K_{1}$ 知除了 $(a, b)$ 外, 仅有至多一个横坐标为 $b$ 的点有两个棋子, 对 $a$ 同样有此结论.

我们为了完成操作, 只要将 $(a, 0)$ 上放上 $p^{a}$ 个棋子或将 $(0, b)$ 上放上 $q^{b}$ 个棋子即可.

假设不能完成原操作, 则上述这两种操作都不能完成, 则对 $x=a, y=b$用一维时只要赋值和不小于 1 即可操作, 记 $(a, b)$ 处有 $m$ 枚棋子, 不妨 $y=b$处棋子不少于 $x=a$ 处棋子, 有 $l$ 枚不在角上, 则 $k=l+1$ 或 $l$.

若 $k=l$, 则 $2 l-1+2 l+m>u \cdot p^{a} q^{b}$, 则赋值和不小于

$$
\frac{m}{p^{a}}+\frac{2}{p^{a-1}}+\frac{l-2}{p^{a-2}} \geq \frac{m+4+4 l-8}{p^{a}} \geq \frac{u \cdot p^{a} q^{b}-2}{p^{a}}
$$

若 $k=l+1$, 则 $2 l+1+2 l+m>u \cdot p^{a} q^{b}$, 赋值和不小于

$$
\frac{m}{p^{a}}+\frac{1}{p^{a-1}}+\frac{l-1}{p^{a-2}} \geq \frac{m+2+4 l-4}{p^{a}} \geq \frac{u \cdot p^{a} q^{b}-2}{p^{a}}
$$

但由于不能操作使产生 $q^{b}$ 枚棋子, 因此赋值和小于 $q^{b}$, 因而仅能为 $\frac{u \cdot p^{a} q^{b}-2}{p^{a}}$ 或 $\frac{u \cdot p^{a} q^{b}-1}{p^{a}}, l \leq 3, k \leq 3$. 非角上棋子赋值和不超过 $\frac{2}{p^{a-1}}+\frac{1}{p^{a-2}} \leq 2 \leq q^{b}$.

而 $u \geq 2$, 因此 $y=b$ 的赋值和不小于 $\frac{u \cdot p^{a} q^{b}-1}{p^{a}} \geq q^{b}$, 从而可以操作使得 $(0, b)$ 上有 $q^{b}$ 枚棋子, 于是转换为 $(0,0)$ 处的一枚棋子, 且用尽除了 $(a, b)$ 处的所有棋子.

此时, 如果 $k=2$, 则原来至少 $u p^{a} q^{b}-2$ 枚棋子, 此时除 $(0,0)$ 处棋子外还剩至少 $(u-1) p^{a} q^{b}-1$ 枚棋子且不全在角上，因而 $x=a$ 上的赋值和不小于

$$
\frac{(u-1) p^{a} q^{b}-1}{q^{b}}+\frac{1}{q^{b}} \geq(u-1) p^{a}
$$

如果 $k=3$, 则原来至少 $u p^{a} q^{b}-4$ 枚棋子, 且用了不超过 $p^{a} q^{b}-1-3$ 枚棋子,因而 $x=a$ 上至少 $(u-1) p^{a} q^{b}$ 枚棋子, 赋值和不小于 $(u-1) p^{a}$. 于是, 无论如何, 可以操作使得 $(a, 0)$ 处不少于 $(u-1) p^{a}$ 枚棋子, 从而容易再在 $(0,0)$ 上加 $u-1$ 枚棋子.

从而，假设不成立，引理获证.

回到原题. 对 $a+b+c$ 归纳证明原命题：

$a+b+c=0$ 时，结论显然成立.

假设 $a+b+c$ 较小时均成立，则 $(a, b, c)$ 时，注意到 $c=0$ 时可将 $r$ 变成

2 , 不影响结论, 因而可不妨 $a \neq 0$, 且 $p \geq q, r$.

记 $x=a$ 的这些点处共有 $M_{2}$ 枚棋子, 占用了 $K_{2}$ 个点, 其他地方共有 $M_{1}$
枚棋子，占用了 $K_{1}$ 个点. 则 $M_{1}+M_{2}=p^{a} q^{b} r^{c}$.

若 $M_{1} \geq K_{2}$, 将 $x=a$ 处的棋子尽量做 (1) 操作, 转移后 $M^{\prime} \geq M_{1}+$ $\frac{M_{2}-(p-1) K_{2}}{p} \geq \frac{M_{1}+M_{2}}{p}=p^{a-1} q^{b} r^{c}$, 由归纳假设知结论成立.

若 $M_{1}<K_{2}$, 则 $M_{2}+K_{2}>M_{2}+M_{1}=p^{a} q^{b} r^{c}$, 由引理可知可以操作使 $(a, 0,0)$ 处有至少 $p^{a}$ 枚棋子，结论成立.

从而, 完成归纳证明, 原命题成立.

评注. 本题是困难的组合问题，事实上标答用归纳法证明了一般的 $n$ 维情形，而此处的证明是对于只要求证明三维的简化版本.

本题的第一个难点在于发现直接将一个平面上的棋子直接向下转移不太亏，第二个难点在于发现设出这个平面上有棋子的点数 $K$ 后可以使放缩更加精确, 从而诱导出引理, 而引理的证明是不太困难的.

2.4 锐角 $\triangle A B C$ 中, $\angle A C B>2 \angle A B C, I$ 为内心, $K$ 为 $I$ 关于 $B C$ 的对称点, $B A$ 的延长线与 $K C$ 的延长线交于点 $D$. 过 $B$ 作 $C I$ 的平行线，与 $\triangle A B C$ 的外接圆的劣弧 $\overparen{B C}$ 交于点 $E(E \neq B)$. 过 $A$ 作 $B C$ 的平行线, 与直线 $B E$ 交于点 $F$. 证明：若 $B F=C E$, 则 $A D=F K$.

证明：延长 $\mathrm{CI}$ 交 $\odot A B C$ 于 $\mathrm{M}$, 则 $\mathrm{M}$ 为 $\overparen{B A}$ 中点, 且由内心性质有

![](https://cdn.mathpix.com/cropped/2024_02_26_6d36037dbc5f26d340d2g-10.jpg?height=403&width=648&top_left_y=1532&top_left_x=744)

$M A=M I=M B$. 由于 $B E \| C M$, 有四边形 $B E C M$ 为等腰梯形, 因而 $B M=C E=B F$. 结合 $B M=M I$ 及 $B F \| M I$ 知四边形 $B I M F$ 为平行四边形.

因此, $B F=B M=M A, B K=B I=F M, \angle F B K=\angle F B I+\angle K B I=$ $\angle F M I+\angle A B C=\angle F M I+\angle A M C=\angle A M F$, 从而有 $\triangle F B K \cong \triangle A M F \Rightarrow$ $A F=F K$.

从而, 只需证明 $A F=A D$.

注意到 $\angle B D K=\angle B A C-\angle A C D=\angle B A C-180^{\circ}+\frac{3}{2} \angle A C B=\frac{1}{2} \angle A C B-$ $\angle A B C=\angle M A B-\angle F A B=\angle M A F=\angle K F B$, 有 $F, B, K, D$ 共圆.
因此 $\angle F D A=\angle F D B=\angle F K B=\angle M F A=\angle I B C=\frac{1}{2} \angle A B C=$ $\frac{1}{2} \angle F A B \Rightarrow A F=A D$.

因此 $A D=F K$ 成立.

评注. 本题是中等难度的几何题, 发现两个结论并不容易, 实际上考场上许多选手均采用了利用三角法计算的证明.

2.5 设 $C=\{z \in \mathbb{C}|| z \mid=1\}$ 是复平面上的单位圆周, 240 个复数 $z_{1}, z_{2}, \cdots$, $z_{240} \in C($ 可以相同）满足下面两个条件:

(1) 对 $C$ 上任意长度为 $\pi$ 的开弧 $\Gamma$, 至多有 200 个 $j(1 \leq j \leq 240)$ 使得 $z_{j} \in \Gamma$;

(2) 对 $C$ 上任意长度为 $\frac{\pi}{3}$ 的开弧 $\gamma$, 至多有 120 个 $j(1 \leq j \leq 240)$ 使得 $z_{j} \in \gamma$.求 $\left|z_{1}+z_{2}+\cdots+z_{240}\right|$ 的最大值.

解: 所求的最大值为 $80+40 \sqrt{3}$.

一方面，给出取到 $80+40 \sqrt{3}$ 的构造:

取 80 个 $1, i,-i, e^{\frac{\pi}{6} i}, e^{-\frac{\pi}{6} i}$ 各 40 个, 满足要求, 且 $\left|z_{1}+z_{2}+\cdots+z_{240}\right|=$ $|80+40 \sqrt{3}|=80+40 \sqrt{3}$ ，成立.

另一方面, 证明 $\left|z_{1}+z_{2}+\cdots+z_{240}\right| \leq 80+40 \sqrt{3}$ :

注意到将所有 $z_{j}$ 同时沿相同方向旋转相同角度不影响结论, 因而可不妨设 $S=z_{1}+z_{2}+\cdots+z_{240}$ 为非负实数, 从而只需证 $\mathrm{S}$ 的实部不大于 $80+40 \sqrt{3}$.

由对称性，不妨设从- 1 开始， $z_{1}, z_{2}, \cdots, z_{240}$ 沿顺时针排列. 则对 $1 \leq j \leq$ 40, 由 (1),$z_{j}$ 的虚部不小于 0 . 从而 $z_{j+200}$ 在 $z_{j}$ 的对径点及左侧, 因此 $\operatorname{Re}\left(z_{j}+z_{j+200}\right) \leq 0$.

对 $41 \leq j \leq 80$, 由 $(2), z_{j}$ 与 $z_{j+120}$ 的夹角不小于 $60^{\circ}$, 从而记 $z_{j}, z_{j+120}$辐角为 $\alpha, 360^{\circ}-\beta$, 有 $60^{\circ} \leq \alpha+\beta, \alpha, \beta \leq 180^{\circ}$.

从而有

$$
\begin{aligned}
\operatorname{Re}\left(z_{j}+z_{j+120}\right) & =\cos \alpha+\cos \beta \\
& =2 \cos \frac{\alpha+\beta}{2} \cos \frac{\alpha-\beta}{2} \\
& \leq 2 \cos \frac{\alpha+\beta}{2} \\
& \leq 2 \cos 30^{\circ}=\sqrt{3}
\end{aligned}
$$

因此,

$$
\left|z_{1}+z_{2}+\cdots+z_{240}\right|=\sum_{j=1}^{40} \operatorname{Re}\left(z_{j}+z_{j+200}\right)+\sum_{j=41}^{80} \operatorname{Re}\left(z_{j}+z_{j+120}\right)+\sum_{j=81}^{160} \operatorname{Re}\left(z_{j}\right)
$$

$$
\leq 0+40 \sqrt{3}+80=80+40 \sqrt{3} \text {. }
$$

综上, 原式最大值为 $80+40 \sqrt{3}$.

评注. 本题是中等难度的代数题, 本题可以转化为六元的情况 (将所有复数顺时针标号为 $z_{1}, z_{2}, \cdots, z_{240}$, 然后取出一切 $z_{k}, z_{k+40}, \cdots, z_{k+200}, k=1,2, \cdots, 40$,容易验证这 40 组点满足六元的条件)，而考虑六元的情形就容易想到上述分组，从而猜出答案并完成证明.

2.6 设 $\mathrm{m}$ 是正整数, $A_{1}, A_{2}, \cdots, A_{m}$ 是有限集 $A$ 的 $m$ 个子集 (可以相同).已知对 $\{1,2, \cdots, m\}$ 的每个非空子集 $I$ 均有

$$
\left|\bigcup_{i \in I} A_{i}\right| \geq|I|+1
$$

证明：可将 $A$ 中的每个元素染成黑白两种颜色之一, 使得 $A_{1}, A_{2}, \cdots, A_{m}$ 中的每个集合都同时包含黑色元素和白色元素.

证明：构造二部图 $G$, 其两个部集 $X, Y$ 分别表示 $\left\{A_{1}, A_{2}, \cdots, A_{m}\right\}$ 和 $A$.对 $1 \leq i \leq m$ 和 $a \in A, A_{i}$ 与 $a$ 连边当且仅当 $a$ 属于 $A$.

由条件, 对每个 $1 \leq k \leq m, X$ 中 $k$ 个点有至少 $k+1$ 个邻居, 因此由 Hall 匹配定理, $G$ 中存在一个包含 X 中所有点的匹配. 记 $A_{i}$ 与 $a_{i}$ 匹配, $i=1,2, \cdots, m$. 下给出一个满足要求的染色方式：

首先, 将除 $a_{1}, a_{2}, \cdots, a_{m}$ 外的 $A$ 中元素都染白. 接下来, 每次找一个 $i$, 使 $a_{i}$ 未被染色且 $A_{i}$ 有染色邻居, 将 $a_{i}$ 染成与 $A_{i}$ 某个染色邻居不同的颜色.

如果有某一刻, 操作无法进行且 $a_{1}, a_{2}, \cdots, a_{m}$ 没有全部被染色，则不妨所有没有被染色的点为 $a_{1}, a_{2}, \cdots, a_{k}, 1 \leq k \leq m$, 则由染色无法进行, $a_{1}, a_{2}, \cdots, a_{k}$为全部未染色点, 有 $A_{1}, A_{2}, \cdots, A_{k}$ 的所有邻居在 $\left\{a_{1}, a_{2}, \cdots, a_{k}\right\}$ 中，与它们至少有 $k+1$ 个邻居矛盾!

因此, 操作结束时, 所有 $a_{i}$ 被染色, 且染 $a_{i}$ 时保证了 $A_{i}$ 有黑白两色邻居,因而最终的染色满足要求.

评注. 本题是中等偏难的组合题，考场上更多同学采用的是归纳的方法. 而上述解法较为巧妙, 给出了较为直接的染色方法. 实际上, 利用找 Hall 匹配的方法，也可以证明条件的充要转化：对二部图，左部集的每个 $k$ 元子集有至少 $k+1$ 个邻居等价于可以对每个左部集的元素找到其两个邻居 $a, b$ ，将右部集中 $a, b$ 连边, 最终右部集中的点构成诱导子图为森林, 于是由森林是二部图原结论显然成立.

## 测试二

3.1 求所有正整数 $m, n$, 使得在 $m \times n$ 的方格表 (有 $m+1$ 条竖线和 $n+1$条横线) 中, 可以将某些小格添加对角线 (每格至多添加一条, 可以不添), 使得整个图（包括所有对角线及表格自身的边）可以一笔画走遍所有边并回到起点.

解：所求为所有 $m=n$.

熟知一个图能一笔画并回到起点等价于它连通并且每一个点的度数都是偶数.

首先给出构造，将除了左上-右下对角线的 $n$ 个方格的左上-右下对角线都添加, 形成的图中除了左上-右下对角线上的 $n+1$ 个点和另外两个顶点度数为 2 以外, 其余点度数都是 4 , 并且原来的方格表就连通, 因此它可以一笔画并回到起点. 下证明 $m=n$.

我们删去原来就有的格线, 只保留添加的对角线, 这样所有的这些对角线都是不相交的. 此时, 边界上不是顶点的点度数变为奇数, 其余点度数仍然是偶数. 我们证明在现在这个图中, 每一个连通块, 上下边界和左右边界的点数相同，这直接推出了 $m=n$.

（1）每一个连通块中含有偶数个边界点（不包括顶点）. 根据每一个连通块的度数和是偶数以及顶点的奇偶性, 这是显然的.

(2) 不可能有一个连通块含有同一条边中的两个点. 否则, 取同一条边中距离最近的两点 $A, B$ 使得它们连通. 注意到相邻的点不可能连通（我们可以将所有顶点黑白间隔二染色, 每一条对角线只能连接同色的两个点, 故不同色的点不连通), 故 $A, B$ 之间有一个点 $C$. 由 $A, B$ 距离的最小性, $C$ 不与 $A, B$ 连通,也不与 $A, B$ 之间的点连通. 但是由 (1), $C$ 至少和 1 个其他点连通, 这个点在 $A, B$ 之外, $C$ 连向它的任意一条路径必定和 $A, B$ 之间的路径相交, 这是不可能的.

(3) 现在, 如果一个连通块中左右边界中的点数不等于上下边界中的点数,只有可能是它只含有上下边界中的点各一个 (或者左右边界中的点各一个)，连接这两个点 $A, B$ 的路径将正方形分成两个部分. 将整个方格表的顶点黑白间隔染色，同上可知 $A, B$ 同色，这样 $A, B$ 间包含顶点有奇数个点，去掉顶点还是奇数个点, 表明每一个部分都有奇数个边界点 (不含顶点), 这和 (1) 矛盾.

由 (3) 可知结论成立.

评注. 本题是一道非常漂亮的组合几何问题. 关键是想到去掉原来的格线
之后, 利用剩下的图是一个平面图的性质来讨论连通性.

3.2 在非直角 $\triangle A B C$ 中, $B C>C A>A B$. 设 $P_{i}(i=1,2)$ 为平面上不同两点, $D_{i}, E_{i}, F_{i}$ 分别为 $A P_{i}, B P_{i}, C P_{i}$ 与 $\odot(A B C)$ 的另一个交点, 满足 $D_{i} E_{i}, D_{i} F_{i}$ 直且相等. 设 $P_{1} P_{2}$ 与 $\odot(A B C)$ 交于点 $Q_{1}, Q_{2}$. 取 $Q_{i}$ 在 $A B, A C$上的垂足 $X_{i}, Y_{i}$, 设 $X_{1} Y_{1}, X_{2} Y_{2}$ 交于点 $W$. 证明: $W$ 在 $\triangle A B C$ 的九点圆上.

![](https://cdn.mathpix.com/cropped/2024_02_26_6d36037dbc5f26d340d2g-14.jpg?height=700&width=625&top_left_y=672&top_left_x=727)

证明: 如上图所示, 令 $O$ 为三角形 $A B C$ 外接圆的圆心, 我们先证明 $Q_{1}, Q_{2}$是三角形 $A B C$ 外接圆上的一对对径点, 只用证明 $O, P_{1}, P_{2}$ 共线.

注意到 $\triangle F_{1} D_{1} P_{1} \sim \triangle A C P_{1}, \triangle E_{1} D_{1} P_{1} \sim \triangle A B P_{1}$, 我们有

$$
\frac{F_{1} D_{1}}{D_{1} P_{1}}=\frac{A C}{C P_{1}}, \frac{E_{1} D_{1}}{D_{1} P_{1}}=\frac{A B}{B P_{1}}
$$

结合 $F_{1} D_{1}=D_{1} E_{1}$ 可知 $\frac{B P_{1}}{C P_{1}}=\frac{A B}{A C}$. 同理可得 $\frac{B P_{2}}{C P_{2}}=\frac{A B}{A C}$.

另外, $\frac{\pi}{2}=\angle F_{1} D_{1} P_{1}+\angle E_{1} D_{1} P_{1}=\angle A B P_{1}+\angle A C P_{1}$, 因此 $\angle B P_{1} C=$ $\angle B A C+\frac{\pi}{2}$, 同理可知 $\angle B P_{2} C=\frac{\pi}{2}-\angle B A C$. 在 $B, C$ 处作外接圆的切线交于 $L$, 那么由于 $\angle B L C=\pi-2 \angle B A C, B, P_{1}, C, P_{2}$ 共圆, 并且圆心是 $L$. 结合 (1)知 $B P_{1} C P_{2}$ 是调和四边形, 又 $B O, C O$ 是 $\odot L$ 的两条切线, 故 $O, P_{1}, P_{2}$ 共线,结论成立.

现在我们证明结论. 如上图所示, 设 $H$ 是三角形 $A B C$ 的垂心, 熟知 $H Q_{1}$, $H Q_{2}$ 的中点 $Z_{1}, Z_{2}$ 在 $Q_{1}, Q_{2}$ 关于三角形 $A B C$ 的西姆松线上.

由于 $\angle A X_{2} W=\angle A Q_{2} Y_{2}=\frac{\pi}{2}-\angle Q_{2} A C$, 同理有 $\angle B X_{1} W=\frac{\pi}{2}-\angle C B Q_{1}$,结合 $Q_{1}, Q_{2}$ 是对径点知 $\angle Q_{2} A C+\angle C B Q_{1}=\frac{\pi}{2}$, 因此 $\angle A X_{2} W+\angle B X_{1} W=\frac{\pi}{2}$.

过 $Q_{2}, Q_{1}$ 作对应的西姆松线的平行线交于 $W_{1}$. 由 (2) 知 $W$ 为 $H W_{1}$ 中点. 另一方面, 由于已经证明了西姆松线垂直, 我们有 $Q_{2} W_{1}, Q_{1} W_{1}$ 垂直, 结

![](https://cdn.mathpix.com/cropped/2024_02_26_6d36037dbc5f26d340d2g-15.jpg?height=577&width=563&top_left_y=263&top_left_x=792)

合 $Q_{2}, Q_{1}$ 是 $\odot O$ 的对径点知 $W_{1}$ 在三角形 $A B C$ 的外接圆上. 最后, 三角形 $A B C$ 的外接圆和九点圆关于 $H$ 位似, 位似系数为 2 , 故 $W$ 在三角形 $A B C$ 的九点圆上.

评注. 本题是一道图形比较复杂的几何题, 基本所有解答都分了两步完成,先证明 $Q_{1}, Q_{2}$ 是对径点, 然后证明西姆松线交点在九点圆上. 后一部分是熟知的，利用导角来诱导也不难. 前一部分也有很多办法完成，总体难度不大，只要不被题目的复杂程度吓住就行。

3.3 设 $a_{1}, a_{2}, \cdots, a_{n}$ 为 $n$ 个两两互不整除的正整数，证明:

$$
a_{1}+a_{2}+\cdots+a_{n} \geq 1.1 n^{2}-2 n
$$

证明: 首先注意到, 对于 $m$ 个形如 $2^{x} 3^{y}$ 的互不整除的数, 它们的和至少是 $3^{m}-2^{m}$. 这是因为, 如果设它们所含的 2 的幂为 $t_{1}<t_{2}<\cdots<t_{m}$, 则他们所含的 3 的幂 $l_{1}>l_{2}>\cdots>l_{m}$, 故和不小于 $2^{m-1}+2 \times 3^{m-2}+\cdots+3^{m-1}=3^{m}-2^{m}$.

现在，我们将 $a_{1}, a_{2}, \cdots, a_{n}$ 都表示成 $2^{x} 3^{y} t$ 的形式，并且按照 $t$ 分组. 设分成了 $1 \leq k \leq n$ 组, 他们分别对应了 $x_{1} \geq x_{2} \geq \cdots \geq x_{k}$ 个 $a_{i}$, 这些 $t$ 为 $t_{1}, t_{2}, \cdots, t_{k}$ 两两不同并且和 6 互素，则只用证明:

$$
\sum_{i=1}^{k}\left(3^{x_{i}}-2^{x_{i}}\right) t_{i} \geq 1.1 n^{2}-2 n
$$

记 $x_{1}=p$, 对 $1 \leq i \leq p$, 记不小于 $i$ 的 $x_{j}$ 有 $s_{i}$ 个, 则 $s_{1}+s_{2}+\cdots+s_{p}=$ $x_{1}+x_{2}+\cdots+x_{k}=n$, 并记 $\lambda_{i}=3^{i}-2^{i}$, 则

$$
\sum_{i=1}^{k}\left(3^{x_{i}}-2^{x_{i}}\right) t_{i}=\sum_{i=1}^{k} t_{i} \lambda_{x_{i}}=\sum_{i=1}^{p}\left(\lambda_{i}-\lambda_{i-1}\right)\left(t_{1}+t_{2}+\cdots+t_{s_{i}}\right)
$$

而对正整数 $l, t_{1}+t_{2}+\cdots+t_{l} \geq 1+5+7+11+\cdots \geq \frac{3}{2} l^{2}-\frac{1}{2}$, 故所求式
不小于 $\sum_{i=1}^{p}\left(\lambda_{i}-\lambda_{i-1}\right)\left(\frac{3}{2} s_{i}^{2}-\frac{1}{2}\right)$, 其中 $s_{1} \geq s_{2} \geq \cdots \geq s_{p} \geq 1$.

注意到 $\sum_{i=1}^{4} \frac{1}{\lambda_{i}-\lambda_{i-1}}+\sum_{i=5}^{\infty} \frac{3}{2\left(\lambda_{i}-\lambda_{i-1}\right)} \leq 1+\frac{1}{4}+\frac{1}{14}+\frac{1}{46}+\frac{1}{146} \times \frac{9}{4}<\frac{3}{2.2}$,

且对 $1 \leq i \leq p, \frac{3}{2} s_{i}^{2}-\frac{1}{2} \geq \max \left\{s_{i}^{2}, \frac{3}{2}\left(s_{i}-0.2\right)^{2}\right\}$, 故结合柯西不等式,

$$
\begin{gathered}
\sum_{i=1}^{p}\left(\lambda_{i}-\lambda_{i-1}\right)\left(\frac{3}{2} s_{i}^{2}-\frac{1}{2}\right) \geq \sum_{i=1}^{\min \{4, p\}}\left(\lambda_{i}-\lambda_{i-1}\right) \frac{3}{2}\left(s_{i}-0.2\right)^{2}+\sum_{i=5}^{p}\left(\lambda_{i}-\lambda_{i-1}\right) s_{i}^{2} \\
\geq \frac{3\left(s_{1}+s_{2}+\cdots s_{p}-0.8\right)^{2}}{2 \sum_{i=1}^{4} \frac{1}{\lambda_{i}-\lambda_{i-1}}+3 \sum_{i=5}^{\infty} \frac{1}{\lambda_{i}-\lambda_{i-1}}} \geq 1.1(n-0.8)^{2} \geq 1.1 n^{2}-2 n
\end{gathered}
$$

结论成立.

评注. 本题思路很常规，直接考虑奇数部分不同就可以估计出 $n^{2}$ 的界，想再精细一点就能直接写成 $2^{x} 3^{y} z$, 要求 $z$ 相同时 $2^{x} 3^{y}$ 互不整除. 之后每一步都只是比较耗时，总体思想也只是得到转换后的问题的最优解. 上面解答由于考场时间紧凑, 对于 $\frac{3}{2} s_{i}^{2}-\frac{1}{2}$ 的处理时牺牲了 $n^{2}$ 前面的常数来快速做出 1.1.实际上可以证明转换后的问题的最优解就是原问题的最优解, 并且具体对应的 $a_{1}, a_{2}, \cdots, a_{n}$ 甚至都能求出，这里不再展开.

4.4 给定正整数 $n$, 求实数 $x_{1}, x_{2}, \cdots, x_{n}$ 的值，使得下式取到最小值:

$$
\sum_{\left(k_{1}, k_{2}, \cdots, k_{n}\right) \in\{0,1,2\}^{n}}\left|k_{1} x_{1}+k_{2} x_{2}+\cdots+k_{n} x_{n}-1\right|
$$

解: 我们证明所有最小值点为 $x_{1}=x_{2}=\cdots=x_{n}=\frac{1}{n+1}$.

令 $m_{i}$ 为 $k_{1}+k_{2}+\cdots+k_{n}=i\left(k_{1}, k_{2}, \cdots, k_{n} \in\{0,1,2\}\right)$ 的 $\left(k_{1}, k_{2}, \cdots, k_{n}\right)$的个数, $y_{i}=i m_{i}, S=y_{0}+y_{1}+\cdots+y_{2 n}$.

先证明 $y_{0}+y_{1}+\cdots+y_{n}<\frac{S}{2}, y_{0}+y_{1}+\cdots+y_{n+1}>\frac{S}{2}$.

事实上, $m_{i}$ 为多项式 $\left(x^{2}+x+1\right)^{n}$ 的 $i$ 次项系数, 故 $y_{i}$ 为其导数 $(2 x+$ 1) $\left(x^{2}+x+1\right)^{n-1}$ 的 $i-1$ 次项系数.

由对称性可设多项式 $\left(x^{2}+x+1\right)^{n-1}$ 的 $0,1,2, \cdots, n-2$ 次项系数和为 $z$, $n-1$ 次项系数为 $w, n, n+1, \cdots, 2 n-2$ 次项系数和为 $z$.

那么 $S=6 z+3 w$,

$$
y_{0}+y_{1}+\cdots+y_{n} \leq 3 z+w<\frac{S}{2}, y_{0}+y_{1}+\cdots+y_{n+1} \geq 3 z+3 w>\frac{S}{2},
$$

结论成立.
因此存在实数 $|t|<1$ 使得 $-\left(y_{0}+y_{1}+\cdots+y_{n}\right)+t y_{n+1}+\left(y_{n+2}+\cdots+y_{2 n}\right)=0$,这样

$$
\begin{aligned}
& \sum_{0 \leq k_{1}, k_{2}, \cdots, k_{n} \leq 2}\left|k_{1} x_{1}+k_{2} x_{2}+\cdots+k_{n} x_{n}-1\right| \\
& \geq \sum_{k_{1}+k_{2}+\cdots+k_{n} \geq n}\left(1-k_{1} x_{1}-k_{2} x_{2}+\cdots-k_{n} x_{n}\right) \\
& +t \sum_{k_{1}+k_{2}+\cdots+k_{n}=n+1}\left(k_{1} x_{1}+k_{2} x_{2}+\cdots+k_{n} x_{n}-1\right) \\
& +\sum_{k_{1}+k_{2}+\cdots+k_{n} \geq n+2}\left(k_{1} x_{1}+k_{2} x_{2}+\cdots+k_{n} x_{n}-1\right) \\
& =C
\end{aligned}
$$

为与 $x_{1}, x_{2}, \cdots, x_{n}$ 无关的常数. 这是因为对称性表明所有 $x_{i}$ 前系数都相等, 但是系数和 $-\left(y_{0}+y_{1}+\cdots+y_{n}\right)+t y_{n+1}+\left(y_{n+2}+\cdots+y_{2 n}\right)=0$.

最后证明结论. 当 $x_{1}=x_{2}=\cdots=x_{n}=\frac{1}{n+1}$ 时, 绝对值内部确实在 $k_{1}+k_{2}+\cdots+k_{n}$ 小于、等于、大于 $n+1$ 时小于、等于、大于 0 ，故不等号取等.

另一方面, 若不等号取等, 必有当 $k_{1}+k_{2}+\cdots+k_{n}=n+1$ 时, $k_{1} x_{1}+$ $\cdots+k_{n} x_{n}=1$. 取 $k_{i}$ 中有一个为 2 , 其余为 1 , 共 $n$ 个方程, 解得 $x_{1}=x_{2}=$ $\cdots=x_{n}=\frac{1}{n+1}$.

综上, 结论成立.

评注. 简单的代数问题, 首先放缩的时候考虑直接利用三角不等式将里面的 $x_{i}$ 前系数都消掉, 就可以得到解答中的放缩, 并且把问题转换为多项式的系数. 之后利用系数对称性容易解决.

4.5 给定正整数 $n$ 与映射 $f: \mathbb{Z} \rightarrow \mathbb{Z}$, 证明下列命题等价:

(1) 对任意正整数 $m$ 满足 $m \mid n$, 有 $n \left\lvert\, \sum_{d \mid m} f(d)\left(\begin{array}{l}n / d \\ m / d\end{array}\right)\right.$.

(2) 对任意正整数 $k$ 满足 $k \mid n$ ，有 $k \mid \sum_{d \mid k} f(d)$.

证明: 令 $g_{k}=\sum_{d \mid k} f_{d}$, 由 Mobius 反演知 $f_{k}=\sum_{d \mid k} \mu(k / d) g_{d}$, 因此 $B$ 可以变形为 $k \mid g_{k}, A$ 变形为

$$
n \left\lvert\, \sum_{d \mid m}\left(\begin{array}{c}
n / d \\
m / d
\end{array}\right) \sum_{l \mid d} \mu(d / l) g_{l}=\sum_{l \mid m} h(l, m) g_{l}\right., h(l, m)=\sum_{l|d| m} \mu(d / l)\left(\begin{array}{c}
n / d \\
m / d
\end{array}\right)
$$

先证明 $n / l \mid h(l, m)$. 注意到 $\left(\begin{array}{c}n / l \\ m / l\end{array}\right)$ 为 $n-m$ 个 0 和 $m$ 个 1 排在一个圆周上, 且以 $n / l$ 为周期的方案数, 因此由容斥原理, $h(l, m)$ 为最小正周期为 $n / l$
的方案数. 而最小正周期为 $n / l$ 的方案可以按照旋转意义 $n / l$ 个分为一组, 故 $n / l \mid h(l, m)$.

现在, 如果 $B$ 成立, 那么 $\sum_{l \mid m} h(l, m) g_{l}$ 中每一项都是 $n$ 的倍数, $A$ 成立. 若 $A$ 成立, 对 $k$ 归纳证明若 $k \mid n$ ，则 $B$ 对于 $k$ 成立. 只用考虑 $k \mid n$ 的情况，此时在 $A$ 中代人 $m=k$, 变为 $n \mid \sum_{l \mid k} h(l, k) g_{l}$. 对于 $l<k$, 由归纳假设知 $l \mid g(l)$, 进而 $n \mid h(l, k) g_{l}$, 因此 $n \mid h(k, k) g_{k}$, 而直接由 $h$ 的定义知 $h(k, k)=n / k$, 故 $k \mid g_{k}$.

综上, $A, B$ 等价.

评注. 本题的关键是知道反演公式，写出反演公式之后只要证明系数是所需要的数的倍数. 这部分操作可以用上面的组合方法，也可以依次证明系数是所需要的每一个 $p_{i}$ 的对应幂次的倍数，方法是将表达式中的项两两配对，证明每一对中的差是所需要的数的倍数.

4.6 给定正整数 $m \geq n \geq 2022$, 证明: 对任意 $2 n$ 个实数 $a_{1}, a_{2}, \cdots, a_{n}, b_{1}, b_{2}$, $\cdots, b_{n}$, 满足 $\left|a_{i}+b_{j}-i j\right| \leq m$ 的有序对 $(i, j)$ 的数量不超过 $3 n \sqrt{m \ln n}$.

证明: 称 $(i, j)$ 为好对, 若 $\left|a_{i}+b_{j}-i j\right| \leq m$. 对于给定的 $i<j$, 我们估计使得 $(i, k),(j, k)$ 都是好对的 $k$ 的个数.

由 $\left|a_{i}+b_{k}-i k\right| \leq m,\left|a_{j}+b_{k}-j k\right| \leq m$ 知 $\left|a_{i}-a_{j}-(i-j) k\right| \leq 2 m$, 这样的 $k$ 至多有 $\frac{4 m}{j-i}+1$ 个.

现在，设对每一个 $k$ 有 $c_{k}$ 个 $i$ 使得 $(i, k)$ 为好对，那么

$$
\begin{aligned}
\sum_{k=1}^{n}\left(\begin{array}{c}
c_{k} \\
2
\end{array}\right) & \leq \sum_{i<j}\left(\frac{4 m}{j-i}+1\right) \\
& =\sum_{i=1}^{n-1} 4 m \frac{n-i}{i}+\left(\begin{array}{l}
n \\
2
\end{array}\right) \\
& =\sum_{i=1}^{n-1} \frac{4 m n}{i}-4 m(n-1)+\left(\begin{array}{l}
n \\
2
\end{array}\right) \\
& \leq 4 m n(1+\ln n)-4 m n+4 m+\left(\begin{array}{l}
n \\
2
\end{array}\right) \\
& =4 m n \ln n+\left(\begin{array}{l}
n \\
2
\end{array}\right)+4 m
\end{aligned}
$$

这样 $\sum_{k=1}^{n} c_{k}^{2} \leq 8 m n \ln n+8 m+2\left(\begin{array}{c}n \\ 2\end{array}\right)+\sum_{k=1}^{n} c_{k}<8 m n \ln n+8 m+n^{2}+n^{2}<$ $9 n m \ln n$ ，故由柯西不等式， $c_{1}+c_{2}+\cdots+c_{n} \leq 3 n \sqrt{m \ln n}$, 即为所证.

评注. 较为巧妙的组合题, 关键是将难以估计的每一个式子是否成立转换为估计角的个数，角的个数再转换到枚举两个顶点看有多少个角包含它.

## 测试三

5.1 已知平面上圆 $\Gamma_{2}$ 在圆 $\Gamma_{1}$ 的内部. 证明平面上存在点 $P$ 满足如下条件：若 $l$ 是一条不过 $P$ 的直线，且 $l$ 与 $\Gamma_{1}$ 交于不同两点 $A, B$, 与 $\Gamma_{2}$ 交于不同两点 $C, D$ (其中 $A, C, D, B$ 在 $l$ 上顺次排列), 则 $\angle A P C=\angle D P B$.

![](https://cdn.mathpix.com/cropped/2024_02_26_6d36037dbc5f26d340d2g-19.jpg?height=463&width=642&top_left_y=554&top_left_x=707)

证明：若两圆同心，取 $P$ 为两圆的公共圆心，显然满足要求; 下设两圆不同心，则取 $P$ 为两圆所在的共轴圆系中的点圆（由于两圆内含，存在两个，任取一个) 。

现在, 若 $l$ 和根轴平行, 由 $P$ 在连心线上和对称性, 结论显然; 否则设 $l$与两圆根轴相交于点 $X$, 则 $X P^{2}=X A \times X B=X C \times X D$, 这表明 $\angle X P A=$ $\angle X B P, \angle X P C=\angle X D P$, 两式相减即得结论.

评注. 本题是简单的几何题, 利用几何方法和计算方法都很好处理.

5.2 已知正实数 $\alpha, \beta$ 满足：对任意正整数 $k_{1}, k_{2}$, 均有 $\left\lfloor k_{1} \alpha\right\rfloor \neq\left\lfloor k_{2} \beta\right\rfloor$, 其中 $\lfloor x\rfloor$ 表示不超过 $x$ 的最大整数. 证明：存在正整数 $m_{1}, m_{2}$ 使得 $\frac{m_{1}}{\alpha}+\frac{m_{2}}{\beta}=1$.

证明：用 $\{x\}$ 表示 $x$ 的小数部分，特别地，定义整数的小数部分为 1 .

首先, 对于给定的正整数 $t$, 存在正整数 $k$ 使得 $[k \alpha]=t$ 等价于 $t \leq k \alpha<$ $t+1$, 等价于 $\frac{t}{\alpha} \leq k<\frac{t+1}{\alpha}$, 也就是 $\left\{\frac{t}{\alpha}\right\} \in\left(1-\frac{1}{\alpha}, 1\right]$. 因此条件被转换为不存在正整数 $t$ 使得 $\left(\left\{\frac{t}{\alpha}, \frac{t}{\beta}\right\} \in\left(1-\frac{1}{\alpha}, 1\right] \times\left(1-\frac{1}{\beta}, 1\right]\right.$. 这立即推出了 $\alpha, \beta>1$.

现在证明 $\alpha, \beta$ 都是无理数. 如果都是有理数, 显然存在 $t$ 使得 $\frac{t}{\alpha}, \frac{t}{\beta}$ 都是整数, 矛盾; 否则若 $\alpha$ 是有理数, $\beta$ 不是, 取正整数 $d$ 使得 $\frac{d}{\alpha}$ 是整数, 此时注意到 $\frac{d t}{\beta}$ 的小数部分在 $(0,1)$ 中稠密, 仍然矛盾.

下记 $x=\frac{1}{\alpha}, y=\frac{1}{\beta}$.

若 $x, y, 1$ 在 $\mathbb{Q}$ 上线性无关, 由 Kronecker 定理知 $(\{t x\},\{t y\})$ 在 $(0,1)^{2}$ 上稠密，矛盾. 因此存在整数 $m, n, k$ 使得 $m x+n y=k$. 若 $k=0$ ，这代表 $\alpha$ 是 $\beta$ 的有理数倍, 条件显然不成立, 因此可以假设 $k \neq 0$, 进一步可以不妨假设 $m, k>0$ 并且 $\operatorname{gcd}(m, n, k)=1$.
考虑 $(\{t x\},\{t y\})$ 构成的点集 $E$.

接下来, 我们证明: 若 $(a, b) \in(0,1)^{2}$ 满足 $a m+b n=l \in \mathbb{Z}$, 那么 $(a, b)$是 $E$ 的极限点. 以下所有 $\rightarrow$ 均在 $\bmod 1$ 下考虑.

将 $m x+n y=k$ 变形为 $\frac{x}{n}+\frac{y}{m}=\frac{k}{m n}$. 取整数 $u, v, w$ 使得 $l+u m+v n=k w$ (由于 $\operatorname{gcd}(m, n, k)=1$, 有解 $)$, 考虑让 $t \equiv w(\bmod m n)$, 此时 $\{t x\}$ 在 $(0,1)$ 中稠密,我们可以让 $\frac{t x}{n} \rightarrow \frac{a+u}{n}$, 此时由于 $\frac{t x}{n}+\frac{t y}{m} \rightarrow \frac{w k}{m n}$, 结合 $l+u m+v n=k w, a m+b n=l$知 $\frac{t y}{m} \rightarrow \frac{b+v}{m}$, 也就是 $t x \rightarrow a, t y \rightarrow b$.

以上表明对于 $a \in(1-x, 1), b \in(1-y, 1), a x+b y$ 不是整数. 最后证明 $k=1$ 且 $n>0$. 若 $n<0$, 那么存在 $a, b$ 略小于 1 使得 $a m+b n=m+n \in \mathbb{Z}$,否则 $a m+b n$ 的取值范围是 $(m+n-m x-n y, m+n)$ 也就是 $(m+n-k, m+n)$.这个范围内没有整数，表明 $k=1$.

评注. 本题是中等偏难的数论题，场上选手给出的做法基本都基于上述的 Kronecker 定理. 在转换成小数部分的取值范围之后，很容易利用上述定理得到一个条件.之后的操作也不平凡，需要将“没有一个点在指定范围内”转换为思路更接近 Kronecker 定理的 “刻画哪些点能取到”. 从这个角度来看问题是并不复杂的, 但是所用到的同余方程有解这一步似乎不能简单的用别的方法来代替.

5.3 给定整数 $n \geq 2$. 求满足下列两个条件的所有 $n$ 元整数组 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$ : (1) $a_{1}$ 是奇数, $1<a_{1} \leq a_{2} \leq \cdots \leq a_{n}$, 且 $M=\frac{1}{2^{n}}\left(a_{1}-1\right) a_{2} \cdots a_{n}$ 是整数.

（2）存在 $M$ 个 $n$ 元整数组 $\left(c_{i, 1}, c_{i, 2}, \cdots, c_{i, n}\right)(i=1,2, \cdots, M)$, 满足对任何 $1 \leq i<j \leq M$ 都存在 $k \in\{1,2, \cdots, n\}$ 使得

$$
c_{i, k}-c_{j, k} \not \equiv-1,0,1 \quad\left(\bmod a_{k}\right) .
$$

解: 设 $a_{1}, a_{2}, \cdots, a_{n}$ 中有 $s$ 个奇数, 所求为所有 $2^{s} \mid a_{1}-1$.

先证明必要性. 事实上, 我们对 $n$ 归纳证明至多能选出 $M=\frac{1}{2^{n}}\left(a_{1}-\right.$ 1) $a_{2} \cdots a_{n}$ 个满足 (2) 的数组.

当 $n=1$ 时, 结论显然成立. 下设 $n \geq 2$ 且在 $n-1$ 时成立. 对一个给定的 $2 \leq k \leq n$ 以及 $\bmod a_{k}$ 完系中的 $l$, 我们考虑 $c_{i, k} \equiv l, l+1\left(\bmod a_{k}\right)$ 的 $i$, 由归纳假设, 至多 $\frac{2 M}{a_{k}}$ 个, 对所有的 $l$ 求和, 就知道至多 $M$ 个.

如果取到等号时, 每一处归纳假设都要取到等号.

如果存在 $k$ 使得 $2 \mid a_{k}$, 那么根据去掉 $a_{k}$ 的归纳假设可以知道 $2^{s} \mid a_{1}-1$, 否则 $a_{k}(2 \leq k \leq n)$ 都是奇数, 根据 $M$ 是整数知道 $2^{s} \mid a_{1}-1$, 必要性得证.

然后证明充分性, 对 $n+a_{1}+a_{2}+\cdots+a_{n}$ 归纳. 构造中不妨让每一个 $c_{i, k}$
在 $1,2, \cdots, a_{k}$ 中选取. $n=1$ 时取不超过 $a_{1}$ 的所有正偶数即可. 下设 $n \geq 2$ 且结论对 $n-1$ 成立.

如果存在 $2 \leq k \leq n$ 使得 $a_{k}$ 是偶数, 我们考虑去掉 $a_{k}$, 使用归纳假设得到一组构造. 然后对已经有的构造中的每一个向量, 将其变成 $\frac{a_{k}}{2}$ 个向量, 分别在第 $k$ 位写上 $2,4, \cdots, a_{k}$, 满足要求.

下设 $a_{2}, a_{3}, \cdots, a_{n}$ 都是奇数. 如果存在 $2 \leq k \leq n$ 使得 $a_{k}>a_{1}$, 对 $\left(a_{1}, a_{2}, \cdots, a_{k-1}, a_{k}-2, a_{k+1}, \cdots, a_{n}\right)$ 用归纳假设. 注意到前面的证明表明了满足要求的构造中, $c_{i, k}$ 模 $a_{k}-2$ 的每一个剩余类个数都相同, 因此只用对于已经有的一个向量 $C$, 其中第 $k$ 位为 $a_{k}-3, a_{k}-2$ 之一, 加上一个第 $k$ 位对应加上 2 的向量, 此时由于原来第 $k$ 位是 $a_{k}-2$ 的和是 $1, a_{k}-3$ 的其它维差不全是 $0,1,-1$, 因此新加上的向量也符合要求, 并且总个数为原来的 $\frac{a_{k}}{a_{k}-2}$ 倍, 满足要求.

最后考虑 $a_{1}=a_{2}=\cdots=a_{n}=k 2^{n}+1$ 的情形. 我们考虑所有 $(t+$ $\left.2 j, x_{2}, \cdots, x_{n}\right)$, 其中 $0 \leq j \leq k-1, a_{1} \mid t+k\left(2 x_{2}+4 x_{4}+\cdots 2^{n-1} x_{n}\right)$, 它们满足要求. 因为在 $x_{2}, \cdots, x_{n}$ 的差不超过 1 时, $t$ 的差在模意义下为 $k\left( \pm 2 \pm 4 \cdots \pm 2^{n-1}\right)$,也就是 $\left(2-2^{n}\right) k$ 和 $\left(2^{n}-2\right) k$ 中的 $2 k$ 的整数倍, 因此两个 $t+2 j$ 也不可能差为 $0,1,-1$, 满足要求.

评注. 本题是中等难度的组合题, 在注意到题目中所给的 $M$ 就是最大可能值之后很容易给出证明. 构造时限考虑 $a_{i}$ 相同的情形很容易想到让坐标满足线性关系，然后稍做试验就能得到所要求的构造.

6.4 求所有正整数 $k$, 使得平面直角坐标系中存在有限多个重心为整点的三角形，其中任意两个三角形的交集或为空集，或为一个公共顶点，或为连接两个公共顶点的边, 且这些三角形的并集是一个边长为 $k$ 的正方形 (该正方形的顶点可以不是整点，边可以不平行于坐标轴）.

解: 所求为所有 $3 \mid k$. 构造时, 考虑一个顶点为整点, 边和坐标轴平行的正方形，不妨设顶点为 $(0,0),(0, k),(k, 0),(k, k)$, 将其沿左上-右下对角线一分为二, 所得到的的两个三角形重心分别为 $(k / 3, k / 3)$ 和 $(2 k / 3,2 k / 3)$, 都是整点.

下证明 $3 \mid k$. 更强的, 我们证明可以将所有顶点三染色, 使得任意两个同色的点横坐标和纵坐标的差都是 3 的倍数. (这直接推出了结论, 因为正方形有两个顶点同色, 他们的距离平方为 $k^{2}, 2 k^{2}$ 之一是 3 的倍数, 表明 $k$ 是 3 的倍数)

任取一个三角形, 将顶点标上 $1,2,3$. 对于两个三角形, 如果它们有公共边,设为 $A B C, B C D$, 那么由于重心都是整点, 这表明 $\left(x_{a}+x_{b}+x_{c}\right) / 3,\left(x_{b}+x_{c}+x_{d}\right) / 3$
都是整数, 因此 $\left(x_{a}-x_{d}\right) / 3$ 是整数, 同理纵坐标也满足要求, 因此若 $A, D$ 之一未染色, 另一个染色了, 我们可以将未染色的染上已经染色的点的颜色.

在以上规则下, 我们可以让所有三角形的所有顶点都被染色. 事实上, 称两个三角形是相邻的, 如果它们有公共边, 并在一张新图中连边. 不难发现, 我们可以依次将和初始任选的三角形距离为 $1,2, \cdots, n, \cdots$ 的三角形的三个顶点都染上色. 由于这个图是连通的，（显然对于任何两个三角形，我们都可以画一条在正方形形内的, 不经过任何顶点的曲线连接它们的内部, 因此路径上任何依次经过的三角形都是相邻的, 也就说明了连通性）所有顶点都被染上了色, 满足要求.

评注. 本题是简单的组合几何问题，条件中的 “坐标不一定是整数” 提示我们去刻画坐标的差，有了这一思路之后就不难得到上面的解答.

6.5 证明: 存在正实数 $C$ 和 $\alpha>\frac{1}{2}$, 使得对任意正整数 $n$, 均存在 $\{1,2, \cdots, n\}$的子集 $A$, 满足 $|A| \geq C n^{\alpha}$, 且 $A$ 中任意两个不同数的差不是完全平方数.

证明：考虑 16 进制下，每一位都是 $1,4,7,9,12$ 的正整数构成 $A$. 显然 $1,2, \cdots, n$ 中至少选出了 $0.0001 n^{\log _{16} 5}$ 个正整数.

对于两个 $A$ 中的数, 设 16 进制下位权最小的它们不同的位位权为 $16^{t}$, 那么它们的差可以被写为 $x \times 16^{t}$, 其中 $x \equiv 2,3,5,6,8,10,11,13,14(\bmod 16)$, 它除以 $16^{t}$ 在 $\bmod 16$ 意义下不为 $0,1,4,9$, 不是平方数, 因此取 $\alpha=\log _{16} 5, C=0.0001$满足要求.

评注. 本题是中等偏易的数论构造, 思想很经典, 通过模意义下的一组解来扩展成一般的解.

6.6 (1) 证明：在复平面上, 方程

$$
z^{20}+63 z+22=0
$$

的全体复根的凸包的面积大于 $\pi$.

（2）设 $n$ 为正整数， $1 \leq k_{1}<k_{2}<\cdots<k_{n}$ 为 $n$ 个奇数. 证明：对任意总和为 1 的 $n$ 个复数 $a_{1}, a_{2}, \cdots, a_{n}$ 以及任意模长不小于 1 的复数 $w$ ，方程

$$
a_{1} z^{k_{1}}+a_{2} z^{k_{2}}+\cdots+a_{n} z^{k_{n}}=w
$$

都至少有一个模长不超过 $3 n|w|$ 的复根.

证明: 我们有熟知的 Gauss-Lucas 定理: 对于任何复系数多项式 $P(x), P^{\prime}(x)$的所有根都位于 $P(x)$ 的根的凸包内.

（1）我们只用证明 $P^{\prime}(z)=20 z^{19}+63$ 的根构成的凸包面积大于 $\pi$ ，只用证明它包含一个单位圆.

而它是一个以原点为中心, 外接圆半径为 $\sqrt[19]{63 / 20}>\sqrt[19]{e}>\frac{20}{19}$. 因此内切圆半径不小于 $\frac{20}{19} \cos \frac{\pi}{19}>\frac{20}{19}\left(1-\frac{1}{2}\left(\frac{\pi}{19}\right)^{2}\right)>\frac{20}{19}\left(1-\frac{1}{72}\right)>1$, 满足要求.

（2）反证法, 假设结论不成立, 这表明多项式 $P_{0}(z)=w z^{k_{n}}-a_{1} z^{k_{n}-k_{1}}-$ $\cdots-a_{n}$ 的根都在一个以原点为中心, 半径为 $r=\frac{1}{3 n|w|}$ 的圆内.

我们归纳地定义 $P_{j+1}(z)=\frac{P_{j}^{\prime}(z)}{z^{k_{n-j}-k_{n-j-1}-1}}$, 也就是 $P_{j}(z)$ 的导数去掉所有零点. 由 Gauss-Lucas 定理, $P_{j+1}(z)$ 的所有零点都在 $P_{j}(z)$ 的零点构成的凸包内,这样归纳易得所有 $P_{j}(z)$ 的根模长均不超过 $r$.

注意到 $P_{j}(z)$ 的首项为 $w k_{n} k_{n-1} \cdots k_{n-j+1}$, 常数项系数为

$$
-a_{n-j}\left(k_{n}-k_{n-j}\right) \cdots\left(k_{n-j+1}-k_{n-j}\right),
$$

因此由韦达定理，

$$
\left|a_{n-j}\right| \leq|w| \frac{k_{n}}{k_{n}-k_{n-j}} \cdots \frac{k_{n-j+1}}{k_{n-j+1}-k_{n-j}} r^{k_{n-j}} .
$$

记 $d=k_{n-j} \geq n-j$, 那么利用 $k_{i}$ 互不相同容易得到 $\left|a_{n-j}\right|<w\left(\begin{array}{c}d+j \\ j\end{array}\right) r^{d}$,这显然关于 $d$ 单调递减, 因此 $\left|a_{n-j}\right| \leq w r^{n-j}\left(\begin{array}{l}n \\ j\end{array}\right)$. 对 $j$ 求和,

$$
\left|a_{1}\right|+\cdots+\left|a_{n}\right| \leq|w|\left((1+r)^{n}-1\right)<1,
$$

矛盾.

最后用到了 $(1+r)^{n} \leq\left(1+\frac{1}{3 n|w|}\right)^{n} \leq e^{\frac{1}{3|w|}} \leq 1+\frac{1}{|w|}$.

评注. 本题是常规的数学分析题, 知识性偏强. 第一小问提示了使用 GaussLucas 定理之后，第二小问想到倒转并求导就不难了. 删去零点也是一个经典技巧，在证明 “有 $k$ 个非零系数的多项式至多 $k-1$ 个正实根” 这样一个问题的时候也有用到。

## 测试四

7.1 在 $n \times n(n \geq 2)$ 的网络屏上, 每个单位方格初始时显示红黄蓝三种颜色之一. 每一秒钟网络屏中所有单位方格按如下方式同时变换颜色, 称为一轮变换：

- 对当前颜色是红色的单位方格 A，如果当前存在黄色单位方格与它有公共边, 那么下一秒钟 $\mathrm{A}$ 变为黄色, 否则 $\mathrm{A}$ 的颜色仍是红色.
- 对当前颜色是黄色的单位方格 B，如果当前存在蓝色单位方格与它有公共边，那么下一秒钟 $\mathrm{B}$ 变为蓝色，否则 $\mathrm{B}$ 的颜色仍是黄色.
- 对当前颜色是蓝色的单位方格 C, 如果当前存在红色单位方格与它有公共边, 那么下一秒钟 $\mathrm{C}$ 变为红色, 否则 $\mathrm{C}$ 的颜色仍是蓝色.

证明: 如果在 $2 n-2$ 轮变换后屏幕没有变成单一颜色, 那么它将永远不会变成单一颜色.

证明: 我们只要证明: 如果网络屏在最终变成单一颜色, 则它在 $2 n-2$ 步内变成单一颜色. 由三种颜色的对称性, 不妨设最后所有格子变成红色.

分两步证明原命题：

（1）证明存在一个格子 $A$, 其初始时为红色，且操作过程中没有变换过颜色.

反证：假设这样的格子不存在, 则每个格子均经历过颜色的变化, 对每个格子标记其最后一次变换颜色的时间，则必有一个格子 $B$ 对应时间最早.

由于最后所有格颜色为红色, 因而 $\mathrm{B}$ 最后一次是变成红色, 此次变化前必有 $B$ 的某个邻格 $C$ 为红色, 由于其最后一次变色时间不早于 $B$, 因而其在 $B$变色时或以后有一次变成黄色, 此后一轮 $B$ 变成黄色, 与前面是 $B$ 的最后一次变色矛盾!

因此，假设不成立，(1) 获证.

(2) 证明 $2 n-2$ 次变换后，所有格子变成红色.

事实上, 可以对 $k$ 归纳证明：对 $1 \leq k \leq 2 n-2$, 在第 $k$ 次变换后, 所有与 $A$ 距离不超过 $k$ 的格子均变为红色 (此处两格子间的距离定义为其行数差与列数差之和）.

$k=1$ 时, 由 $A$ 为红色, 一轮后 $A$ 的所有原来蓝色邻格变为红色, 且由 $A$不变色知 $A$ 没有黄色邻格. 因此, 一轮变换后 $A$ 的邻格仅能为红色或黄色. 如有黄色, 则下一轮 $A$ 变色, 与 $A$ 不变色矛盾! 因而一轮后 $A$ 的所有邻格变为红色.

假设 $k-1$ 时结论成立, $k$ 时 $(2 \leq k \leq 2 n-2)$

反证：假设 $k$ 轮变换后有与 $A$ 距离不超过 $k$ 的格子不为红色, 则由于变换前与 $A$ 距离不超过 $k-1$ 的格子全红, 因而变换后该不为红色的格子与 $A$ 距离为 $k-1$ 或 $k$.

如果距离为 $k-1$ 的格子中有非红色格，则其为红色格子变换而得，从而变成黄色; 如果距离为 $k-1$ 的格子仍全红, 则变换前与 $A$ 距离为 $k$ 的格子中无黄色, 且变换将一切距离为 $k$ 的蓝色格变红, 因而变换后与 $A$ 距离不超过 $k$的格子无蓝色，因而其中有黄色.
由上述讨论, 存在 $t \in\{k-1, k\}$, 使变换后与 $A$ 距离小于 $t$ 的格子全红,且与 $A$ 距离为 $t$ 的格子中有黄色. 此时, 每经过一次操作, 与 $A$ 距离最近的黄色格距离变近且更近的格子全红, 若干次后存在 $A$ 的邻格为黄色, 再下一轮后 $A$ 变色, 与 $A$ 不变色矛盾!

因此，假设不成立. 从而完成归纳过渡.

由于每格与 $A$ 的距离不超过 $2 n-2$, 因而 $2 n-2$ 轮后所有格子变红, 从而原命题获证.

评注. 本题是中等偏难的组合题, 其想法是对于最终变为红色的情形, 通过逆推找到一个格子没有经历过变色, 于是利用这个格子可以刻画出整体变色的结构, 从而完成整个证明.

7.2 在凸四边形 $A B C D$ 中, $\triangle A B C, \triangle A D C$ 的内心分别为 $I, J$. 已知 $I J, A C$, $B D$ 相交与一点 $P$. 过 $P$ 且垂直于 $B D$ 的直线与 $\angle B A D$ 的外角平分线相交于点 $E$, 与 $\angle B C D$ 的外角平分线相交于点 $F$. 证明: $P E=P F$.

证明：若 $A B C D$ 为平行四边形, 则 $P$ 为 $A C, B D$ 中点, 整个图形关于 $P$

![](https://cdn.mathpix.com/cropped/2024_02_26_6d36037dbc5f26d340d2g-25.jpg?height=666&width=763&top_left_y=1386&top_left_x=635)

中心对称, 因而 $P$ 为 $E F$ 中点 $\Rightarrow P E=P F$.

下设 $A B C D$ 不是平行四边形, 不妨设 $D A$ 与 $C B$ 相交于 $K$, 且交点在射线 $D A, C B$ 上. 考虑 $\triangle A B K$ 的 $A$-旁切圆 $\odot O$, 其与 $\odot I$ 的内位似中心为 $B$.由 $P$ 为 $\odot I, \odot J$ 一条内公切线 $A C$ 与 $I J$ 的交点, 知 $P$ 为 $\odot I$ 与 $\odot J$ 的内位似中心.

对 $\odot I, \odot J, \odot O$ 用 Monge 定理知 $\odot J$ 与 $\odot O$ 的外位似中心在 $B P$ 上, 又 $A D$ 为它们的一条外公切线, 因而外位似中心在 $A D$ 上. 从而, 它们的外位似中心为 $B P$ 与 $A D$ 的交点 $D$, 而 $D C$ 与 $\odot J$ 相切, 知其也与 $\odot O$ 相切.
从而, $\odot O$ 与 $A B C D$ 四边所在直线相切, 记其与 $A B, B C, C D, D A$ 的切点为 $X, Y, Z, W$.

由 Newton 定理的推广知 $P$ 为 $X Z, Y W$ 的交点, 记 $X W, Y Z$ 交于 $Q$. 若 $X Y \| Z W$ 知整个图形关于 $X Y$ 中垂线对称, $P E=P F$ 显然成立, 下设 $X Y$与 $Z W$ 有交点 $R$.

由 Brocard 定理, $R$ 关于 $\odot O$ 的极线为 $P Q$, 又由 $B X, B Y$ 为切线及 $R$在 $X Y$ 上知 $B, R$ 关于 $\odot O$ 共轭，同理 $D, R$ 共轨，因而 $B, D$ 也在 $R$ 的极线上，从而 $D, P, B, Q$ 共线. 同理，考虑 $Q$ 的极线知 $R, A, P, C$ 共线.

对完全四边形 $P X Z Q W Y$ 用调和性质知 $Q X, Q Y ; Q P, Q R$ 成调和线束, 考虑过 $O$ 关于这四条直线的垂线知 $O A, O C ; O R, O P$ 成调和线束.

由于 $B D$ 为 $R$ 的极线，因而 $B D \perp O R \Rightarrow O R \| E F$.

又由于 $\angle B A D, \angle B C D$ 的外角平分线为 $A O, C O$ 知 $E, F$ 为 $A O, C O$ 与 $E F$ 交点.

因此，用直线 $E F$ 截调和线束 $O A, O C ; O R, O P$ ，结合 $O R \| E F$ 可知 $P$为 $E F$ 中点, 因而 $P E=P F$ 成立.

评注. 本题是中等难度的几何题, 对于熟悉蒙格定理、牛顿定理及调和结构的选手来说本题是一道常规题，然而对不熟悉性质的选手而言本题就比较难以处理了. 当然, 本题也可以直接三角计算, 但耗时较长.

7.3 求所有的函数 $f: \mathbb{R} \rightarrow \mathbb{R}$ 满足：对任意实数 $x, y$ ，如下两个可重集相等

$$
\{f(x f(y)+1), f(y f(x)-1)\}=\{x f(f(y))-1, y f(f(x))+1\} .
$$

注: $\{a, b\}=\{c, d\}$ 作为可重集相等指 $a=c, b=d$, 或者 $a=d, b=c$.

解: 所有的 $f$ 为 $f(x)=x$ 及 $f(x)=-x$.

记原式为 $P(x, y)$.

一方面, $f(x)=x$ 及 $f(x)=-x$ 时, $P(x, y) \Leftrightarrow\{x y+1, x y-1\}=\{x y+$ $1, x y-1\}$, 成立.

另一方面，对满足要求的 $f$, 证明其为上述两解中的一个:

考虑 $P(0, y)$, 有

$$
\{f(1), f(y f(0)-1)\}=\{-1, y f(f(0))+1\}
$$

因此，假设 $f(0) \neq 0$, 则若 $f(1) \neq-1$, 有 $f(y f(0)-1)=-1$, 而由 $y f(0)-1$可取遍一切实数，因而可取其为 1 ，与 $f(1) \neq-1$ 矛盾!
于是仅能 $f(1)=-1$, 从而 $f(y f(0)-1)=y f(f(0))+1$, 即 $f(y)=\frac{y+1}{f(0)}$. $f(f(0))+1$.

令 $y=f(0)$, 知 $0=\frac{f(f(0))}{f(0)}+1 \Rightarrow f(f(0))=-f(0) \Rightarrow f(y)=-y$, 与 $f(0) \neq 0$ 矛盾!

因此，假设不成立， $f(0)=0$.

考虑 $P(0,0)$ 知 $\{f(1), f(-1)\}=\{-1,1\} \Rightarrow f(f(1))=1$.

下面依次证明如下性质：

(1) $f$ 是满射.

考虑 $P(x, 1) \Rightarrow x-1 \in\{f(x f(1)+1), f(f(x)-1)\}$, 即一切 $x-1$ 在值域中, 从而 $f$ 值域取遍一切实数.

(2) $f$ 是单射.

反证：假设存在实数 $x_{1} \neq x_{2}$ 使 $f\left(x_{1}\right)=f\left(x_{2}\right)=t, t \in \mathbb{R}$.

考虑 $P\left(x_{1}, y\right), P\left(x_{2}, y\right)$, 有:

$f(y t-1) \in\left\{x_{1} f(f(y))-1, y f(t)+1\right\}, f(y t-1) \in\left\{x_{2} f(f(y))-1, y f(t)+1\right\}$.

因此, 如果 $f(y t-1) \neq y f(t)+1$, 则有 $x_{1} f(f(y))-1=f(y t-1)=x_{2} f(f(y))-1 \Rightarrow$ $f(f(y))=0 \Rightarrow f(y t-1)=-1$.

于是, 若 $t \neq 0$, 则 $f(y t-1) \in\{-1, y f(t)+1\}$, 因而 $f(t) \neq 0$ (若否 $f \equiv 1,-1$, 与其为满射矛盾), 从而对 $c \neq-1$, 恰一个 $y$ 使 $y f(t)+1=c$, 结合 $f$ 为满射知这个 $y$ 满足 $f(y t-1)=y f(t)+1$. 对 $y$ 使 $y f(t)+1=-1$, 用 $f(y t-1) \in\{-1, y f(t)+1\}$ 也有 $f(y t-1)=y f(t)+1$ 成立, 从而对每个实数 $y$, 有

$$
f(y t-1)=y f(t)+1 .
$$

因此, 结合 $f(t) \neq 0$ 知 $f$ 为单射, 与 $f$ 不是单射矛盾!

从而假设不成立, $t=0$, 因而每个非零实数恰为一个 $x$ 的 $f$ 值.

由 $x_{1} \neq x_{2}$, 可不妨设 $x_{1} \neq 0$.

考虑 $P\left(x_{1}, y\right) \Rightarrow\left\{f\left(x_{1} f(y)+1\right), f(-1)\right\}=\left\{x_{1} f(f(y))-1,1\right\}$.

若 $f(-1) \neq 1$ 知 $f\left(x_{1} f(y)+1\right)=1$ 恒成立, 但 $x_{1} f(y)+1$ 可取遍一切实数 ( $f$ 为满射 $)$, 从而 $f \equiv 0$, 矛盾!

因此 $f(-1)=1 \Rightarrow f\left(x_{1} f(y)+1\right)=x_{1} f(f(y))-1$, 从而结合 $f$ 为满射知 $f\left(x_{1} y+1\right)=x_{1} f(y)-1$ 对每个实数 $y$ 成立.

令 $y=x_{1}, x_{2}$ 知 $f\left(x_{1}^{2}+1\right)=-1=f\left(x_{1} x_{2}+1\right)$, 与 $f$ 在值非零处为单射矛
盾!

因此, 假设不成立, $f$ 为单射.

(3) $f$ 为奇函数, 并且对 $x \neq 0$ ，有 $f(x) f\left(\frac{1}{x}\right)=1$.

事实上, 由 $f$ 为双射知 0 为 $f$ 的唯一零点, 因而对 $x \neq 0$, 在 $f$ 的任意次迭代下 $x$ 的函数值非零.

下考虑 $x, y \neq 0$.

考虑 $P\left(\frac{1}{f(f(x))}, x\right) P\left(x, \frac{1}{f(x)}\right), P\left(x,-\frac{1}{f(f(x))}\right), P\left(-\frac{1}{f(x)}, x\right)$, 结合单射性质有

$$
\begin{aligned}
& 0 \in\left\{\frac{f(x)}{f(f(x))}+1, x f\left(\frac{1}{f(f(x))}\right)-1\right\} . \\
& 0 \in\left\{x f\left(f\left(\frac{1}{f(x)}\right)\right)-1, \frac{f(f(x))}{f(x)}+1\right\} . \\
& 0 \in\left\{x f\left(-\frac{1}{f(f(x))}\right)+1,-\frac{f(x)}{f(f(x))}-1\right\} . \\
& 0\left.\in-\frac{f(f(x))}{f(x)}-1, x f\left(f\left(-\frac{1}{f(x)}\right)\right)+1\right\} .
\end{aligned}
$$

结合 $(3.1)(3.2)$, 有当 $f(f(x)) \neq-f(x)$ 时,

结合单射有

$$
f\left(\frac{1}{f(f(x))}\right)=\frac{1}{x}=f\left(f\left(\frac{1}{f(x)}\right)\right) .
$$

$$
\frac{1}{f(f(x))}=f\left(\frac{1}{f(x)}\right) \text {. }
$$

即

$$
f\left(\frac{1}{f(x)}\right) f(f(x))=1 \text {. }
$$

因此, 对每个 $x \neq 0$, 有 $f(f(x))=-f(x)$ 或 $f\left(\frac{1}{f(x)}\right) f(f(x))=1$.

用 $x$ 代替 $f(x)$ ( $f$ 为满射）, 有对每个 $x \neq 0$, 或者 $f(x)=-x$, 或者 $f\left(\frac{1}{x}\right) f(x)=1$.

于是, 假设有 $x \neq 0$ 使 $f(x) f\left(\frac{1}{x}\right) \neq 1$, 则 $f(x)=-x$ 且 $f\left(\frac{1}{x}\right)=-\frac{1}{x}$, 因此 $f(x) f\left(\frac{1}{x}\right)=1$ 成立, 与假设矛盾!

因此, 对 $x \neq 0$, 有 $f(x) f\left(\frac{1}{x}\right)=1$.

比较 (3.3),(3.4), 有若 $f(f(x)) \neq-f(x)$, 则

$$
f\left(-\frac{1}{f(f(x))}\right)=-\frac{1}{x}=f\left(f\left(-\frac{1}{f(x)}\right)\right) .
$$

结合单射知

$$
-\frac{1}{f(f(x))}=f\left(-\frac{1}{f(x)}\right)
$$

即

$$
f(f(x)) f\left(-\frac{1}{f(x)}\right)=-1
$$

因此, 对每个 $x \neq 0$, 或者 $f(f(x))=-f(x)$, 或者 $f(f(x)) f\left(-\frac{1}{f(x)}\right)=-1$.

用 $x$ 代替 $f(x)$, 有对每个 $x \neq 0$, 或者 $f(x)=-x$, 或者 $f(x) f\left(-\frac{1}{x}\right)=-1$.

因此, 如果 $f(x) \neq-x$, 则 $f(x) f\left(-\frac{1}{x}\right)=-1 \Rightarrow f(-x)=-f(x)$. (用到 $\left.f(-x) f\left(-\frac{1}{x}\right)=1\right)$

于是, 假设有 $x \neq 0$ 使 $f(-x) \neq-f(x)$, 则 $f(x)=-x, f(-x)=x$, 与 $f(-x) \neq-f(x)$ 矛盾!

因此, 假设不成立, 结合 $f(0)=0$ 知 $f$ 为奇函数.

如果 $f(x)=-x$ 恒成立, 则结论已获证, 下设存在 $s$, 使 $f(s) \neq-s$ 则 $s \neq 0$.

（4）对每个实数 $x$, 有 $f^{(3)}(x)=x$, 其中 $f^{(3)}$ 表示 $f$ 的三次迭代.

由 (3.1), 对每个 $x \neq 0$, 若 $f(f(x))=-f(x) \Rightarrow f(f(x))=f(-x) \Rightarrow f(x)=$ $-x$; 若 $x f\left(\frac{1}{f(f(x))}\right)=1$ 则 $x=f(f(f(x)))$.

因此, 对每个 $x \neq 0$, 或者 $f(x)=-x$, 或者 $f^{(3)}(x)=x \Rightarrow f^{(3)}(s)=s$, 上述结论对 $x=0$ 也成立.

考虑 $P(f(s), y), P(f(y), s)$, 有

$$
f(f(s) f(y)+1) \in\{f(s) f(f(y))-1, s y+1\},\left\{f(y) f(f(s))-1, s f^{(3)}(y)+1\right\}
$$

考虑 $P(y, f(s)), P(s, f(y))$, 有

$$
f(f(s) f(y)-1) \in\{s y-1, f(s) f(f(y))+1\},\left\{s f^{(3)}(y)-1, f(y) f(f(s))+1\right\}
$$

因此, 假设 $f^{(3)}(y) \neq y$, 则 $f(y)=-y \Rightarrow f(-y)=y, y \neq 0$.

于是, 上述两式可改述为

$$
\begin{aligned}
& f(-y f(s)+1) \in\{f(s) y-1, s y+1\},\{-y f(f(s))-1,-s y+1\} \\
& f(-y f(s)-1) \in\{s y-1, f(s) y+1\},\{-s y-1,-y f(f(s))+1\}
\end{aligned}
$$

由 $f(s) \neq-s \Rightarrow f(f(s)) \neq f(-s)$, 即 $f(f(s)) \neq-f(s)$.

因此, 若 $f(-y f(s)+1)=s y+1 \Rightarrow f(-y f(s)+1) \neq-s y+1 \Rightarrow f(-y f(s)+$ $1)=-y f(f(s))-1 \Rightarrow s y+1=-y f(f(s))-1$.

由 $-y f(s)+1 \neq-(-y f(s)-1) \Rightarrow f(-y f(s)-1) \neq-s y-1 \Rightarrow f(-y f(s)-$ $1)=-y f(f(s))+1 \Rightarrow f(-y f(s)-1) \neq s y-1 \Rightarrow f(s) y+1=f(-y f(s)-1)=$ $-y f(f(s))+1$, 与 $f(f(s)) \neq-f(s)$ 矛盾!
因此, $f(-y f(s)+1)=f(s) y-1 \Rightarrow f(-y f(s)+1) \neq-f(f(s)) y-1 \Rightarrow$ $f(-y f(s)+1)=-s y+1 \Rightarrow f(s) y-1=-s y+1$.

同理, 由 $-y f(s)+1 \neq-(-y f(s)-1) \Rightarrow f(-y f(s)-1) \neq s y-1 \Rightarrow$ $f(-y f(s)-1)=f(s) y+1$, 因而 $f(-y f(s)-1)=f(-y f(s)+1)+2$, 从而结合 $f(-y f(s)+1) \neq-f(f(s)) y-1$ 知仅能 $f(-y f(s)-1)=-s y-1 \Rightarrow f(s) y+1=$ $-s y-1$, 与 $f(s) y-1=-s y+1$ 矛盾!

因此, 假设不成立, 对每个实数 $x$, 有 $f^{(3)}(x)=x$.

结合 $\{f(1), f(-1)\}=\{-1,1\}$ 知 $f(1)=1, f(-1)=-1$.

(5) 对任意实数 $x$, 有 $f(x)=x$.

考虑 $P(f(x), y)(x, y \neq 0) \Rightarrow f(f(x) f(y)+1) \in\{f(x) f(f(y))-1, x y+1\}$.交换 $x, y$ 可得 $f(f(x) f(y)+1) \in\{f(y) f(f(x))-1, x y+1\}$

因此, 如果 $f(f(x) f(y)+1) \neq x y+1$, 则 $f(x) f(f(y))-1=f(f(x) f(y)+1)=$ $f(y) f(f(x))-1 \Rightarrow f(f(x)): f(x)=f(f(y)): f(y)$.

并且, $P(f(x), y) \Rightarrow x y+1=f(y f(f(x))-1)$, 同理有 $x y+1=f(x f(f(y))-$ $1)$, 结合单射知 $y f(f(x))=x f(f(y))$.

综合上述两式, 有对 $x, y \neq 0$, 或者 $f(f(x) f(y)+1)=x y+1$, 或者 $(f(x))$ : $f(x): x=f(f(y)): f(y): y$.

假设 $f(f(x) f(y)+1) \neq x y+1$, 则 $f(f(x)): f(x): x=f(f(y)): f(y): y$,若其为 $1: 1: 1$, 则 $P(x, y) \Rightarrow\{f(x y-1), f(x y+1)\}=\{x y-1, x y+1\}$,又 $f(f(x) f(y)+1) \neq x y+1$ 知 $f(x y-1)=x y+1, f(x y+1)=x y-1 \Rightarrow$ $f^{(3)}(x y+1)=x y-1 \neq x y+1$, 与 $(4)$ 矛盾!

因此 $f(f(x)): f(x): x \neq 1: 1: 1$, 记 $f(f(x)): f(x): x=a: b: 1$, 而考虑 $P(x, f(y)), P(f(f(x)), f(f(y)))$, 有

$$
\begin{aligned}
& f(x f(f(y))+1)=f(y f(f(x))+1) \\
\in & \{x y-1, f(y) f(f(x))+1\},\{f(f(x)) f(y)-1, f(x) f(f(y))+1\}
\end{aligned}
$$

若 $f(x f(f(y))+1) \neq f(y) f(f(x))+1$, 则考虑 $P(x, f(y)), P(f(f(x)), f(f(y)))$知

$$
\begin{aligned}
& x y-1=f(x f(f(y))+1)=f(f(x)) f(y)-1, \\
& f(f(x) f(y)-1)=f(y) f(f(x))+1=f(f(f(y)) x-1) \\
& \Rightarrow x y=f(f(x)) f(y), f(y) f(x)=x f(f(y)) \\
& \Rightarrow 1=a b, b^{2}=a \Rightarrow a=b=1
\end{aligned}
$$

, 与 $f(f(x)): f(x): x \neq 1: 1: 1$ 矛盾!

因而 $f(x f(f(y))+1)=f(y) f(f(x))+1$, 结合 $P(f(f(x)), f(f(y))) \Rightarrow$ $f(x f(f(y))-1)=f(f(x)) f(y)-1$.

考虑 $P(f(x), y)$, 得 $\{f(f(x) f(y)+1), f(y f(f(x))-1)\}=\{f(x) f(f(y))-$ $1, x y+1\}$, 结合上式知

$$
f(f(x) f(y)+1)=x y+1,
$$

与反证法假设矛盾!

因此假设不成立，对所有 $x, y \neq 0$ ，有 $f(f(x) f(y)+1)=x y+1$ ，而这对 $x, y$ 中有 0 也成立.

考虑上式中代人 $(x, y),(1, x y)$, 有 $f(f(x) f(y)+1)=x y+1=f(f(x y)+1) \Rightarrow$ $f(x) f(y)=f(x y)$.

再考虑代人 $(f(f(x)), y)$, 知 $f(x f(y)+1)=y f(f(x))+1$, 结合 $P(x, y)$ 知 $f(y f(x)-1)=x f(f(y))-1$ ，交换 $x, y$ 有 $f(x f(y)-1)=y f(f(x))-1$ ，而 $x f(y)-1$ 可取遍一切实数, 因而有对所有实数 $x, f(x+2)=f(x)+2$.

由 $f(x y)=f(x) f(y) \Rightarrow f\left(x^{2}\right)=f(x)^{2} \geq 0 \Rightarrow$ 对 $x>0$, 有 $f(x)>0$.

因此, 结合 $f(x+2)=f(x)+2$, 有对 $x>2$, 有 $f(x)>2$, 从而对 $x>0, \ln f(x)$ 在区间 $(2,3)$ 上有下界, 从而由柯西方程知存在 $c \in \mathbb{R}, f(x)=$ $x^{c}, x>0$, 结合 $f(2)=f(0)+2=2 \Rightarrow c=1$.

结合 $f$ 为奇函数知对所有 $x \in \mathbb{R}, f(x)=x$.

综上, 所有解为 $f(x)=x, f(x)=-x$.

评注. 本题是困难的函数方程, 在考场上耗时较长. 基本所有的解法都要按照上述的五步来推, 对可重集的对应关系的讨论增加了本题的复杂度.

8.4 求所有的素数 $p$ 和正整数 $a, b, c$, 满足

$$
2^{a} p^{b}=(p+2)^{c}+1 .
$$

证明：由于左边为偶数知右边也为偶数，因而 $p$ 为奇素数.

假设 $c$ 不是 2 的幂, 则记 $c=2^{\alpha} \cdot t, \alpha \in \mathbb{N}, t$ 为不小于 3 的奇数.

则

$$
2^{a} p^{b}=(p+2)^{c}+1=\left((p+2)^{2^{\alpha}}+1\right) \cdot \frac{(p+2)^{2^{\alpha} t}+1}{(p+2)^{2^{\alpha}}+1} .
$$

由

$$
\frac{(p+2)^{2^{\alpha} t}+1}{(p+2)^{2^{\alpha}}+1}=\sum_{i=0}^{t-1}(p+2)^{2^{\alpha} i} \cdot(-1)^{i} \equiv t \equiv 1(\bmod 2)
$$

知其为奇数, 因而 $\frac{(p+2)^{2^{\alpha} t}+1}{(p+2)^{2 \alpha}+1}$ 为 $p$ 的幂.

若 $p \mid(p+2)^{2^{\alpha}}+1$, 则 $\left(p \nmid(p+2)^{2^{\alpha}}-1,(p+2)^{2^{\alpha} t}+1\right.$.

因此, 由升幂定理,

$$
\begin{aligned}
v_{p}\left(\frac{(p+2)^{2^{\alpha} t}+1}{(p+2)^{2^{\alpha}}+1}\right) & =v_{p}\left(\frac{(p+2)^{2^{\alpha+1} t}-1}{(p+2)^{2^{\alpha+1}}-1}\right. \\
& =v_{p}\left((p+2)^{2^{\alpha+1} t}-1\right)-v_{p}\left((p+2)^{2^{\alpha+1}}-1\right) \\
& =v_{p}(t)
\end{aligned}
$$

因此,

$$
\frac{(p+2)^{2^{\alpha} t}+1}{(p+2)^{2^{\alpha}}+1} \leq t
$$

记 $S=(p+2)^{2^{\alpha}} \geq 5$, 有 $\frac{s^{t}+1}{s+1} \leq t$, 这在 $t \geq 3$ 时不成立!

因此 $p \nmid(p+2)^{2^{\alpha}}+1$, 从而 $(p+2)^{2^{\alpha}}+1$ 为 2 的幕, 但 $\alpha$ 大于 0 时其模 4 余 2 且大于 2 , 不能为 2 的幂. 因此仅能 $\alpha=0$, 从而 $2^{a}=p+3, c=t$, 结合 $p \geq 3 \Rightarrow a \geq 3$.

由条件两边 $\bmod p$ 知 $p\left|2^{t}+1 \Rightarrow p\right| 2^{2 t}-1$, 记 2 模 $p$ 的阶为 $d$, 则 $d \mid 2 t, p-1$, 结合 $4 \mid p-1$ 知 $d \left\lvert\, \frac{p-1}{2}\right.$, 结合 Euler 判别法知 $1=\left(\frac{2}{p}\right)=$ $(-1)^{\frac{(p-1)(p+1)}{8}}=-1$ (最后一个等号用到 $p$ 模 8 余 5 ), 矛盾!

因此, 假设不成立, $c$ 是 2 的幂.

记 $c=2^{\alpha}, \alpha \in \mathbb{N}$.

$\alpha=0$ 时, $2 p \leq 2^{a} p^{b}=p+3 \leq 2 p$, 等号取到当 $(a, b, c, p)=(1,1,1,3)$, 此时条件满足.

下设 $\alpha>0$.

由 $c$ 为偶数知 $(p+2)^{c}+1 \equiv 2(\bmod 4) \Rightarrow a=1$, 则条件等价于 $2 p^{b}=$ $(p+2)^{c}+1$.

两边模 $p$, 有 $p \mid 2^{c}+1$, 记 2 模 $p$ 的阶为 $d$, 则 $d=2^{\alpha+1} \Rightarrow p \equiv 1\left(\bmod 2^{\alpha+1}\right)$.

若 $\alpha=1$, 有 $2 p^{b}=p^{2}+4 p+5$, 因此 $p \mid 5 \Rightarrow 2 \cdot 5^{b}=50 \Rightarrow b=2$, 此时 $(a, b, c, p)=(1,2,2,5)$, 成立.

下设 $\alpha \geq 2$, 原式两边模 $p+1$ 知 $p+1 \mid 2\left((-1)^{b}-1\right)$, 因此若 $\mathrm{b}$ 为奇数有 $p=3 \Rightarrow 2 \cdot 3^{b}=5^{2^{\alpha}}+1$, 但两边模 3 知 $0 \equiv 2(\bmod 3)$, 矛盾!

因此, $b$ 为偶数.

由 $\alpha \geq 2$ 知 $p \equiv 1(\bmod 8)$, 将条件式改写为

$$
(p+2)^{2^{\alpha}}-1=2\left(p^{b}-1\right) .
$$

而

$$
(p+2)^{2^{\alpha}}-1=(p+1)(p+3) \prod_{k=1}^{\alpha-1}\left((p+2)^{2^{k}}+1\right)
$$

其含 2 的幂为 $1+2+(\alpha-1)=\alpha+2$.

但

$$
v_{2}\left(2\left(p^{b}-1\right)\right)=1+v_{2}\left(p^{\frac{b}{2}}-1\right)+v_{2}\left(p^{\frac{b}{2}}+1\right) \geq 1+\alpha+1+1=\alpha+3
$$

因此,

$$
(p+2)^{2^{\alpha}}-1 \neq 2\left(p^{b}-1\right) .
$$

与条件矛盾!

于是, $\alpha \geq 2$ 不成立, 因此所有解为 $(a, b, c, p)=(1,1,1,3),(1,2,2,5)$.

评注. 本题是简单的不定方程, 但有一定的复杂度. 本题的各种做法基本都要用到升幕定理, 以此排除 $c$ 的奇素因子较多的情况, 而后的讨论方法较多,此处采用的方法也较为常规.

8.5 设 $n$ 是正整数, $2 n$ 个非负实数 $x_{1}, x_{2}, \cdots, x_{2 n}$ 满足 $x_{1}+x_{2}+\cdots+x_{2 n}=4$.证明：存在非负整数 $p, q$, 使得 $q \leq n-1$, 且

$$
\sum_{i=1}^{q} x_{p+2 i-1} \leq 1, \sum_{i=q+1}^{n-1} x_{p+2 i} \leq 1
$$

注 1: 下标模 $2 n$ 理解, 即若 $k \equiv l(\bmod 2 n)$ ，则 $x_{k}=x_{l}$.

注 2: 若 $q=0$, 则第一个求和视为 0 ; 若 $q=n-1$, 则第二个求和视为 0 .

证明: 不妨设 $x_{1}+x_{3}+\cdots+x_{2 n-1} \leq x_{2}+x_{4}+\cdots+x_{2 n}$.

对原命题反证：假设满足要求的 $p, q$ 不存在.

记 $S=x_{1}+x_{3}+\cdots+x_{2 n-1} \Rightarrow S \leq 2$.

由于令 $p=0, q=n-1$ 不成立知 $x_{1}+x_{3}+\cdots+x_{2 n-3}>1 \Rightarrow S>1, n \geq 2$.

对每个 $p \geq 0, p$ 为奇数, 定义 $f(p)$ 为最小奇数 $m \geq p$, 使 $x_{p}+x_{p+2}+\cdots+$ $x_{m}>1$, 则 $m \leq p+2(n-1)$.

因此, 若 $x_{m+1}+x_{m+3}+\cdots+x_{p+2 n-3} \leq 1$, 有

$$
\sum_{i=1}^{\frac{m-p}{2}} x_{p-1+2 i-1} \leq 1, \sum_{i=\frac{m-p}{2}+1}^{n-1} x_{p-1+2 i-1} \leq 1
$$

与命题中 $(p, q)$ 不存在矛盾!

因此, $x_{m+1}+x_{m+3}+\cdots+x_{p+2 n-3}>1$.
构造图 $G$, 其有 $n$ 个点 $1,3,5, \cdots, 2 n-1$, 对每个点 $p, p$ 指向 $f(p)+2$ 模 $2 n$ 的余数, 则图中有 $n$ 条边, 因而熟知 $G$ 中有有向圈.

考虑 $G$ 的有向圈 $p_{1} \rightarrow p_{2} \rightarrow \cdots \rightarrow p_{m} \rightarrow p_{1}, p$ 的下标按模 $m$ 理解.

由 $f$ 的定义知对 $1 \leq i \leq m, x_{p_{i}}+x_{p_{i}+2}+\cdots+x_{f\left(p_{i}\right)}>1$.

设有 $u$ 个 $i$ 使 $p_{i+1}=f\left(p_{i}\right)+2-2 n$, 则

$$
m<\sum_{k=1}^{m}\left(x_{p_{k}}+x_{p_{k}+2}+\cdots+x_{f\left(p_{k}\right)}\right)=u\left(x_{1}+x_{3}+\cdots+x_{2 n-1}\right)=u s .
$$

因此, $u>\frac{m}{s} \geq \frac{m}{2}$.

又由 $(*)$,

$$
m<\sum_{k=1} m\left(x_{f\left(p_{k}\right)+1}+x_{f\left(p_{k}\right)+3}+\cdots+x_{p_{k}+2 n-3}\right)=(m-u)(4-S) .
$$

将上述两式相加，结合 Chebyshev 不等式，有

$$
2 m<u s+(m-u)(4-S) \leq \frac{(u+m-u)(S+4-S)}{2}=2 m,
$$

矛盾!

因此，假设不成立，原命题成立.

评注. 本题是中等难度的组合题, 根据反证法假设可以观察出上述图的构造，再利用熟知的图论性质即可给出上述证明.

8.6 给定正整数 $n$, 用 $D$ 表示 $n$ 的所有正因子构成的集合. 设 $A, B$ 是 $D$的子集, 满足：对任何 $a \in A, b \in B$, 总有 $a$ 不整除 $b$ 且 $b$ 不整除 $a$. 证明:

$$
\sqrt{|A|}+\sqrt{|B|} \leq \sqrt{|D|} .
$$

证明: 记 $A_{1}=\left\{a_{1} \mid a_{1} \in D\right.$, 存在 $\left.a \in A, a_{1} \mid a\right\}, A_{2}=\left\{a_{2} \mid a_{2} \in D\right.$, 存在 $\left.a \in A, a \mid a_{2}\right\}$, 同理定义 $B_{1}, B_{2}$.

由定义, $A \subseteq A_{1} \bigcap A_{2}, B \subseteq B_{1} \cap B_{2}$.

由于 $A, B$ 中元素没有整除关系, 因而 $A_{1}$ 与 $B_{2}$ 不交 $\Rightarrow\left|A_{1}\right|+\left|B_{2}\right| \leq|D|$,同理 $\left|B_{1}\right|+\left|A_{2}\right| \leq|D|$

利用 Harris-Kleitman inequality，以及 Cauchy 不等式，有

$$
\begin{aligned}
\sqrt{|A|}+\sqrt{|B|} & \leq \sqrt{\left|A_{1} \bigcap A_{2}\right|}+\sqrt{\left|B_{1} \bigcap B_{2}\right|} \\
& \leq \sqrt{\frac{\left|A_{1}\right|\left|A_{2}\right|}{|D|}}+\sqrt{\frac{\left|B_{1}\right|\left|B_{2}\right|}{|D|}} \\
& =\frac{\sqrt{\left|A_{1}\right|\left|A_{2}\right|}+\sqrt{\left|B_{1}\right|\left|B_{2}\right|}}{\sqrt{|D|}}
\end{aligned}
$$

$$
\begin{aligned}
& \leq \frac{\sqrt{\left|A_{1}\right|+\left|B_{2}\right|} \cdot \sqrt{\left|A_{2}\right|+\left|B_{1}\right|}}{\sqrt{|D|}} \\
& \leq \frac{|D|}{\sqrt{|D|}}=\sqrt{|D|} .
\end{aligned}
$$

从而原命题成立.

评注. 本题是中等难度的组合题. 对于熟悉 Harris-Kleitman inequality 的选手而言本题是常规题，然而对不熟悉 Harris-Kleitman inequality 的选手而言本题较难处理, 可以先将 $A, B$ 进行调整使一切 $D$ 中其余元素可被分成两种,其中一种在 $A, B$ 中都有约数，另一种在 $A, B$ 中都有倍数，记两种数构成的集合为 $C_{1}, C_{2}$, 于是只需证明 $|A * B| \leq\left|C_{1} * C_{2}\right|(A * B$ 表示笛卡尔积), 这可以用分组后证明数量关系解决.

