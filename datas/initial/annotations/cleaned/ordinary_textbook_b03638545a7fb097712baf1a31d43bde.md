数学新星网 苯学生专栏

www.nsmath.cn/xszl

# 整数数列中素因子个数的问题 

付艺渲<br>(山东省实验中学, 济南, 250001)

站在数论的角度研究一个整数数列, 其中是否有无穷多个素数显然是让人极感兴趣的性质. 但我们甚至不能知道简单的数列, 如 $n^{2}+1$ 中是否有无穷多个素数. 退一步, 一个整数数列中是否有无穷多个素因子, 也可以算是它的基本的数论性质. 在数学竞赛中, 不乏这类问题. 本文主要介绍这一方面的结论与问题.

我们首先来看一下有关的基本定理.

定理 1 (Issai Schur ${ }^{[1]}$ ). 设 $f(x)$ 是一个非常数的整系数多项式, 则数列 $\{f(n)\}(n=0,1, \cdots)$ 有无穷多个不同的素因数.

证明 设非常数的整系数多项式 $f(x)=\sum_{i=0}^{n} a_{i} x^{i}$ 对 $x=0,1, \cdots$ 仅有有限个不同的素因子 $p_{1}, \ldots, p_{k}$, 则 $a_{0} \neq 0$.

取 $x=p_{1} \cdots p_{k} a_{0} t$, 并设整数 $t$ 充分大, 则 $f(x)$ 可表示为如下形式:

$$
f(x)=a_{0}\left(p_{1} \cdots p_{k} A_{t}+1\right)
$$

这里 $A_{t}$ 是一个依赖于 $t$ 的整数. 在 $t$ 充分大时, $\left|A_{t}\right|>1$, 故 $p_{1} \cdots p_{k} A_{t}+1$ 有素因子 $p$, 显然 $p$ 不同于 $p_{1}, \ldots, p_{k}$ ，与假设矛盾.

评注 定理 1 的应用无疑是极其广泛的. 这里的证明手法, 与 Euclid 证明素数无限的方式如出一辙.

定理 2. 若 $f$ 是一个首项系数大于 0 的整系数多项式, $\left\{a_{n}\right\}$ 是一个严格递增的正整数数列, 且对于任意正整数 $n$, 都有 $a_{n} \leq f(n)$, 则 $\left\{a_{n}\right\}$ 中有无穷多个不同的素因数.

证明 若结论不成立, 则只存在有限个素数 $p_{1}, \ldots, p_{t}$ 满足要求.

设多项式 $f$ 的首项为 $b_{m} x^{m}$, 由于每个 $a_{n}$ 都可以写成 $p_{1}, \ldots, p_{t}$ 的幂次之积，收稿日期: 2018-02-14； 修订日期: 2018-04-29.
因此

$$
\sum_{n=1}^{\infty} \frac{1}{f(n)^{\frac{1}{m}}} \leq \sum_{n=1}^{\infty} \frac{1}{a_{n}^{\frac{1}{m}}} \leq \prod_{i=1}^{t} \sum_{j=1}^{\infty} \frac{1}{p_{i}^{\frac{j}{m}}}=\prod_{i=1}^{t} \frac{1}{1-p_{i}^{-\frac{1}{m}}}
$$

又因为存在正整数 $N$, 使得当 $n \geq N$ 时, 有 $f(n)^{\frac{1}{m}}<2 b_{m}^{\frac{1}{m}} n$, 因此

$$
\sum_{n=N}^{\infty} \frac{1}{f(n)^{\frac{1}{m}}}>\frac{1}{2 b_{m}^{\frac{1}{m}}} \sum_{n=N}^{\infty} \frac{1}{n}
$$

不存在上界, 这就导致了矛盾.

评注 本题的结论是定理 1 的推广, 当 $n$ 充分大时, 显然 $f(n)$ 是单调的.

正如定理 1 可以看作 Euclid 的手法的再次成功, 本题的结论, 也可以视作 Euler 对于素数无限的证明的推广. 在这种有分析色彩的数论问题中, 取倒数相加或许是一种有力的手段. Dirichlet 在证明他的著名定理一算术级数中有无穷多素数时, 采用的正是这一方法.

在素数无限的证明中, 下面的这种证法称不上简单, 也并不算很漂亮. 假设只有有限个素数 $p_{1}, \ldots, p_{k}$, 则 $1,2, \ldots, N$ 中每个数可以写成 $\prod_{i=1}^{k} p_{i}^{\alpha_{i}}$ 的形式, 且

$$
2^{\alpha_{1}+\cdots+\alpha_{k}} \leq \prod_{i=1}^{k} p_{i}^{\alpha_{i}} \leq N
$$

因此 $\alpha_{i} \leq \alpha_{1}+\cdots+\alpha_{k} \leq \log _{2} N$. 于是 $\prod_{i=1}^{k} p_{i}^{\alpha_{i}}$ 最多能表示出 $\left(\log _{2} N+1\right)^{k}$ 个不同的数, 因此 $\left(\log _{2} N+1\right)^{k} \geq N$, 取 $N$ 充分大, 这不可能成立.

但这种证法有趣之处在于: 它表明, 如果正整数列中只有有限个素数, 那么它的增长速度似乎太慢了一些. 认真追究这个证法成功的原因, 或许我们不难得到如下的定理.

定理 3 (Christian Elsholtz $\left.{ }^{[2]}\right)$. 令 $S=\left(s_{1}, s_{2}, s_{3}, \ldots\right)$ 为一整数序列. 称

(1) $S$ 是几乎单射的, 如果存在常数 $c$, 每个值至多出现 $c$ 次;

(2) $S$ 是次指数增长的, 如果存在一个函数 $f: \mathbb{N} \rightarrow \mathbb{R}^{+}$, 满足 $\lim _{n \rightarrow \infty} \frac{f(n)}{\log _{2} n}=0$,使得 $\left|s_{n}\right| \leq 2^{2^{f(n)}}$ 对所有 $n$ 成立.

设整数数列 $\left\{a_{n}\right\}$ 是几乎单射的, 且是次指数增长的, 则 $\left\{a_{n}\right\}$ 中有无穷多个素因子.

证明 设 $f(n)$ 都是单调不减的, 否则用 $F(n)=\max _{i \leq n} f(i)$ 代替 $f(n)$ 不影响问题. 假设 $\left\{a_{n}\right\}$ 只有有限个素因数 $p_{1}, \ldots, p_{k}$. 对任意的 $n$, 设 $a_{n}=\varepsilon_{n} \prod_{i=1}^{k} p_{i}^{\alpha_{i}}$, 其中 $\varepsilon_{n} \in\{-1,0,1\}, \alpha_{i} \geq 0$, 则有

$$
2^{\alpha_{1}+\cdots+\alpha_{k}} \leq a_{n} \leq 2^{2^{f(n)}} .
$$

以 2 为底取对数, 我们得到

$$
0 \leq \alpha_{i} \leq \alpha_{1}+\cdots+\alpha_{k} \leq 2^{f(n)}, 1 \leq i \leq k
$$

因此, 每个 $\alpha_{i}=\alpha_{i}(n)$ 有不超过 $2^{f(n)}+1$ 个不同的可能值, 而 $f$ 是单调的. 这表明, 对于给定的 $N$, 在 $\left|a_{1}\right|,\left|a_{2}\right|, \ldots,\left|a_{N}\right|$ 中最多有 $\left(2^{f(N)}+1\right)^{k}$ 个不同的数.

另一方面, 由于 $\left\{a_{n}\right\}$ 是几乎单射的, 序列中只有 $c$ 项可以为 0 , 每个非零的绝对值至多可以出现 $2 c$ 次. 于是, 在 $\left|a_{1}\right|,\left|a_{2}\right|, \ldots,\left|a_{N}\right|$ 中至少有 $\frac{N-c}{2 c}$ 个不同的数. 放在一起, 我们得到 $\frac{N-c}{2 c} \leq\left(2^{f(N)+1}\right)^{k}$, 由于 $\frac{f(n)}{\log _{2} n} \rightarrow 0$, 对于充分大的 $N$, 这不可能成立, 矛盾.

评注 显然, 这个定理蕴含了定理 1 和定理 2.

这里的次指数增长, 实际上比指数增长要慢很多. 它并不能理解为存在一个函数 $g: \mathbb{N} \rightarrow \mathbb{R}^{+}$, 满足 $\lim _{n \rightarrow \infty} \frac{g(n)}{n}=0$, 使得 $\left|s_{n}\right| \leq 2^{g(n)}$ 对 $n$ 所有成立. 比如,取 $g(n)=\sqrt{n}$, 那么 $\lim _{n \rightarrow \infty} \frac{g(n)}{n}=0$, 但是 $\lim _{n \rightarrow \infty} \frac{\log _{2} g(n)}{\log _{2} n}=\frac{1}{2}$, 然而 $\lim _{n \rightarrow \infty} \frac{f(n)}{\log _{2} n}=0$ 不能改进了. 对前 $T$ 个素数 $p_{1}, \ldots, p_{T}$, 考虑所有形如 $\prod_{i=1}^{T} p_{i}^{\alpha_{i}}$ 的数按从小到大顺序排列得到的数列, 它的增长速度大概是 $2^{2^{f(n)}}$, 其中 $\frac{f(n)}{\log _{2} n} \approx \frac{1}{T}$, 但这样的数列只有有限个素因子.

下面这道最近的赛题, 应用上面的定理可以很快做出.

题 1 (2016 USA TST). 求所有大于 1 的整数 $C$, 使得存在由两两不同的正整数构成的无穷数列 $a_{1}, \ldots, a_{k}$, 对于任意正整数 $k$, 都有 $a_{k+1}^{k} \mid C^{k} a_{1} a_{2} \ldots a_{k}$.

解 我们来证明 $\left\{a_{n}\right\}$ 是次指数增长的, 由定理 3 即得不存在这样的 $C$.

令 $b_{n}=\log _{2} a_{n}, A=\log _{2} C$, 有 $k b_{k+1} \leq k A+b_{1}+\cdots+b_{k}$. 令 $A_{n}=\frac{b_{1}+\cdots+b_{n}}{n}$,有 $A_{k+1} \leq A_{k}+\frac{A}{k+1}$, 因此存在一个正实数 $M$, 使得

$$
A_{n} \leq M \log _{2} n, b_{n} \leq A+A_{n-1} \leq A+M \log _{2} n
$$

因此 $\lim _{n \rightarrow \infty} \frac{\log _{2} b_{n}}{\log _{2} n}=0$.

评注 事实上 $b_{n}$ 是对数级增长的, 于是 $a_{n}$ 是幂级增长的, 应用定理 2 也可以解决本题.

可以看出, 研究素数的幂起到了非常重要的作用. 事实上, 当我们假设数列 $\left\{a_{n}\right\}$ 中仅有有限个素数 $p_{1}, \ldots, p_{k}$ 时, 使用这个反证假设, 得到的唯一信息就是,每一个 $a_{n}$ 都可以写成 $\prod_{i=1}^{k} p_{i}^{\alpha_{i}}$ 的形式. 那么自然就会去考虑某个素数幂次的大小.

下面的题便是一个利用阶乘性质去分析幕次的例子.
题 $2\left(2012 \mathrm{RMO}^{[3]}\right)$. 记 $S_{n}=1 !+2 !+\cdots+n !$, 证明: 存在 $n \in \mathbb{N}$, 使得 $S_{n}$ 有大于 $10^{2012}$ 的素因数.

证明 对任意素数 $p$, 任意正整数 $n$, 用 $v_{p}(n)$ 表示 $n$ 的质因数分解中素数 $p$的幂次.

注意到, 若 $v_{p}(n) \neq v_{p}(k)$, 则 $v_{p}(n \pm k)=\min \left\{v_{p}(n), v_{p}(k)\right\}$. 由此得到下面的引理:

引理 如果存在某个正整数 $n$ 满足 $v_{p}\left(S_{n}\right)<v_{p}((n+1) !)$, 则对于任意的 $k \geq n$, 有 $v_{p}\left(S_{k}\right)=v_{p}\left(S_{n}\right)$.

令 $P=10^{2012}$. 假设对于任意正整数 $n, S_{n}$ 的所有素因子都小于 $P$. 对于任意素数 $p<P$, 如果存在某个正整数 $m$, 使得 $v_{p}\left(S_{m}\right)<v_{p}((m+1) !)$. 根据引理,存在正整数 $a_{p}$, 使得对任意的正整数 $n$, 有 $v_{p}\left(S_{n}\right) \leq a_{p}$. 我们称这样的素数为 “小素数”, 所有小于 $P$ 且不是小素数的素数称为 “大素数”.

取定正整数 $M$,使得不等式 $M>p^{a_{p}}$ 对任意小素数成立.

对任意一个大素数 $p$, 如果 $n+2$ 是 $p$ 的倍数, 则由引理,

$$
v_{p}\left(S_{n+1}\right) \geq v_{p}((n+2) !)>v_{p}((n+1) !),
$$

这推出 (注意到 2 显然是小素数)

$$
v_{p}\left(S_{n}\right)=v_{p}\left(S_{n+1}-(n+1) !\right)=v_{p}((n+1) !)=v_{p}(n !)
$$

令 $N=M P !-2$, 则上述论证表明 $v_{p}\left(S_{N}\right)=v_{p}(N !)$ 对任意大素数 $p$ 成立.又因为 $N \geq M, v_{p}\left(S_{N}\right) \leq v_{p}\left(p^{a_{p}}\right) \leq v_{p}(N !)$, 而 $S_{N}$ 所有的素因数不是小素数就是大素数, 这表明 $S_{N} \leq N$ !, 矛盾.

评注 本题还有别的一些证明, 但大都用到了公式: $v_{p}(n !)=\sum_{k=1}^{\infty}\left[\frac{n}{p^{k}}\right]$.

而上面的证明, 也即标准答案中的做法, 用到的知识是非常少的. 它几乎只利用了如下的事实:

若 $v_{p}(a) \neq v_{p}(b)$, 则 $v_{p}(a+b)=\min \left\{v_{p}(a), v_{p}(b)\right\}$.

然后围绕阶乘的性质分析其中素数的幂次, 最终得到矛盾.

在分析幂次时, 一种常见的手法是, 考虑数列中的若干个数, 其中必有两个数, 素数部分最大者对应着同一个素数, 这样, 两个数的最大公约数就大于较小数的 $k$ 次根. 下题便是这样一个例子.

题 $3(2009$ Iran TST). 设 $a$ 是一个给定的正整数, 证明：集合 $S=$ $\left\{2^{2^{n}}+a \mid n \in \mathbb{N}^{+}\right\}$中的整数有无穷多个不同的素因子.
证明 设 $S$ 中全体素因子为 $p_{1}<\ldots<p_{k}$. 对任意的 $r \in \mathbb{N}^{+}$, 取充分大的正整数 $N$, 使得 $2^{2^{N}}+a>\left(\prod_{i=1}^{k} p_{i}\right)^{r}$. 令

$$
B=\left\{2^{2^{N}}+a, 2^{2^{N+1}}+a, \cdots, 2^{2^{N+k}}+a\right\} .
$$

对任意 $b \in B$, 有一个素因子的幂次大于 $r$, 而 $|B|=k+1$, 因此存在 $u, v$, 使得对于某个 $p_{i}$, 有 $p_{i}^{r}\left|2^{2^{u}}+a, p_{i}^{r}\right| 2^{2^{u+v}}+a$. 而

$$
2^{2^{u}}+a \mid\left(2^{2^{u}}\right)^{2^{v}}-a^{2^{v}}=2^{2^{u+v}}-a^{2^{v}},
$$

因此 $p_{i}^{r} \mid a^{2^{v}}+a$, 于是 $p_{i}^{r} \leq a^{2^{v}}+a \leq a^{2^{k}}+a$, 但 $k$ 是常数, 矛盾.

评注 我们可以走得更远一些. 注意到 $\left\{2^{2^{n}}+a\right\}$ 可以看做由 $\left\{2^{2^{n}}\right\}$ 平移得到的, 而后者仅存在有限个素因子. 下面, 我们以一个强大的定理作结此文.

定理 4 (Kobayashi). 若无界正整数列 $\left\{a_{n}\right\}_{n \geq 0}$ 只存在有限个素因子, 则对 $a \in \mathbb{Z}, a \neq 0$, 数列 $\left\{a_{n}-a\right\}_{n \geq 0}$ 有无穷多个素因子.

证明 我们不加证明的使用 Thue 定理 ${ }^{[4]}$ :

引理 (Thue) 设 $n \geq 3, f(z)=a_{n} z^{n}+a_{n-1} z^{n-1}+\cdots+a_{1} z+a_{0}$ 是一个整系数的 $n$ 次(有理数域上) 既约多项式, 则不定方程

$$
H(x, y)=a_{n} x^{n}+a_{n-1} x^{n-1} y+\cdots+a_{1} x y^{n-1}+a_{0} y^{n}=C
$$

仅有有限多组整数解 $x, y$, 其中 $C$ 是给定的整数.

回到我们的问题. 设 $\left\{a_{n}\right\}$ 的素因子仅有 $p_{1}, \ldots, p_{r}$, 且 $\left\{a_{n}-a\right\}$ 的素因子仅有 $q_{1}, q_{2}, \ldots, q_{s}$. 由于 $\left\{a_{n}\right\}$ 无界, 因此 $\prod_{i=1}^{r} p_{i}^{\alpha_{i}}-\prod_{j=1}^{s} q_{j}^{\beta_{j}}$ 有无穷多组非负整数解.

考虑向量 $v=\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{r}, \beta_{1}, \beta_{2}, \ldots, \beta_{s}\right)$, 将它们模 3 分类, 必有一类有无穷个元素. 这样的一类解, 可以写成 $A x^{3}-B y^{3}=a$ 的形式. 其中 $A, B$ 是确定的正整数, 并且 $A, B$ 中每个素因子的幂次都不超过 2 .

若 $A=B$, 有 $x^{2}+x y+y^{2} \mid a$, 因此 $x^{2}+x y+y^{2} \leq a$, 只能有有限组解. 若 $A \neq B$, 则 $\sqrt[3]{\frac{A}{B}} \notin \mathbb{Q}$, 因此 $A x^{3}-B y^{3}$ 既约, 根据 Thue 定理, 只能有有限组解.这就导致了矛盾. 故 $\left\{a_{n}-a\right\}_{n \geq 0}$ 有无穷多个素因子.

## 参考文献

$[1]$ 余红兵. 奥数教程 . 高三年级 $[\mathrm{M}]$. 第六版, 上海: 华东师范大学出版社, 2014.4.

[2] Martin Aigner, Gunter M. Ziegler. 数学天书中的证明 [M]. 第五版, 北京: 高
等教育出版社, 2016. 3.

[3] 2012 年 IMO 中国国家集训队教练组. 走向 IMO: 数学奥林匹克试题集锦 (2012) [M]. 上海: 华东师范大学出版社, 2012. 8 .

[4] 柯召, 孙琦. 数论讲义 [M]. 第 2 版, 北京: 高等教育出版社, 2003. 5.

