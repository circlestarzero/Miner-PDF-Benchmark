数学新星网 $*$ 教师专栏

www.nsmath.cn/jszl

# 2021 年日本数学奥林匹克最后一轮试题解析 

羊明亮

(浙江乐清知临中学, 325600)

2021 年日本数学奥林匹克最后一轮于 2 月 11 日 $13: 00-17: 00$ 举行, 比赛共有 5 道试题, 总体难度不大, 其中第 1 题偏容易, $2,3,4$ 题是中档难度, 适合联赛训练, 第 5 题表达清楚有一定难度, 适合冬令营训练. 本文给出此次大赛的试题与解答, 由于作者水平有限, 不当之处, 还请读者批评指正.

## I. 试 题

1. 求所有函数 $f: \mathbb{Z}^{+} \rightarrow \mathbb{Z}^{+}$, 使得对任意两个正整数 $n, m$, 以下两个命题等价:
(1) $n \mid m$;
(2) $f(n) \mid f(m)-n$.
2. 设 $n$ 是大于 1 的整数. 甲, 乙两人在一张 $n$ 行 2021 列的棋盘上玩一个游戏. 首先, 甲先将每个棋盘的格子都涂成黑色或白色; 接着, 乙在最上面一行选择一格放入一枚棋子, 再在最下面一行选择一格作为终点; 再接着, 甲将进行 $n-1$次如下操作: 若棋子所在格子是白格, 那么就将棋子向下移动一格; 若棋子所在的格子是黑格, 那么先将棋子向左或者向右移动一格, 再将棋子向下移动一格.求最小的 $n$, 使得无论乙怎样放棋子和终点, 甲都可以将棋子移动到终点.
3. 在锐角 $\triangle A B C$ 中, 点 $D, E$ 分别在 $A B, A C$ 边上, 并且满足 $B D=C E$.设点 $P$ 在线段 $D E$ 上, 而点 $Q$ 是 $\triangle A B C$ 的外接圆中劣弧 $\overparen{B C}$ 上的一点, 且 $P, Q$ 两点满足 $B P: P C=E Q: Q D$. 假设点 $A, B, C, D, E, P, Q$ 两两不同,证明: $\angle B P C=\angle B A C+\angle E Q D$.
4. 2021 个整数 $a_{1}, a_{2}, \cdots, a_{2021}$ 满足对任意 $n=1,2, \cdots, 2016$ 都有 $a_{n+5}+a_{n}>a_{n+2}+a_{n+3}$ 成立. 求 $a_{1}, a_{2}, \cdots, a_{2021}$ 中最大值与最小值之差的最小可能值.[^0]
4. 对任意正整数 $n$, 求出所有满足如下条件的不小于 1 且不超过 $2 n^{2}$ 的整数 $k$ : 在 $2 n \times 2 n$ 的表格中, 任选 $k$ 个不同的格子, 并将这些格子涂成黑色, 其他所有格子都涂成白色. 这时我们记录下同时有白格子和黑格子的 $2 \times 2$ 的子表格的个数. 那么, 在所有选格子的方法中, 这种子表格的个数最小值恰为 $2 n-1$.

## II . 解答与评注

题 1 求所有函数 $f: \mathbb{Z}^{+} \rightarrow \mathbb{Z}^{+}$, 使得对任意两个正整数 $n, m$, 以下两个命题等价:

$$
\text { (1) } n|m ; \quad(2) f(n)| f(m)-n \text {. }
$$

解 所求函数为 $f(x)=x$.

一方面, 当 $f(x)=x$ 时, 有

$$
n|m \Leftrightarrow n| m-n \Leftrightarrow f(n) \mid f(m)-n .
$$

此时 (1), (2) 等价.

另一方面, 我们证明 $f(x)=x$ 唯一.

令 $n=m$, 知 (1) 成立, 则有 $f(n) \mid f(n)-n$, 即 $f(n) \mid n$. 又 $f(n) \in \mathbb{Z}^{+}$, 知 $f(n) \leq n$, 特别地 $f(1)=1$.

下面用归纳法(对 $n$ ) 证明 $f(n)=n, n \in \mathbb{Z}^{+}$.

(i) $n=1$ 时已证毕.

(ii)若结论对小于 $n$ 的正整数均成立, 考虑 $n(n \geq 2)$. 假设 $f(n)=s \neq n$, 则由 $f(n) \leq n$, 知 $1 \leq s \leq n-1$. 从而由归纳假设, $f(s)=s$. 进而

$$
f(n) \mid f(s)-n(\text { 即 } s \mid s-n \text {, 亦即 } f(n) \mid n) \text {. }
$$

故由题设条件, 知 $n \mid s$, 即 $s \geq n$, 这与 $s \leq n-1$ 矛盾. 故 $f(n)=n$, 即结论对 $n$也成立.

(iii) 由归纳公理知 $f(n)=n, n \in \mathbb{Z}^{+}$.

故 $f(x)=x$.

评注 本题难度较小. 核心要点是在 (1) 中令 $n=m$, 从而得到 $f(n) \leq n$ 这一关键范围。同时归纳结合反证的手法值得留意.

题 2 设 $n$ 是大于 1 的整数. 甲, 乙两人在一张 $n$ 行 2021 列的棋盘上玩一个游戏. 首先, 甲先将每个棋盘的格子都涂成黑色或白色; 接着, 乙在最上面一行选择一格放入一枚棋子, 再在最下面一行选择一格作为终点; 再接着, 甲将进行
$n-1$ 次如下操作: 若棋子所在格子是白格, 那么就将棋子向下移动一格; 若棋子所在的格子是黑格, 那么先将棋子向左或者向右移动一格, 再将棋子向下移动一格. 求最小的 $n$, 使得无论乙怎样放棋子和终点, 甲都可以将棋子移动到终点.

解 $n$ 最小值是 2022 .

一方面, 我们证明 $n \geq 2022$. 为叙述方便, 以下用 $(a, b)$ 代指第 $a$ 行第 $b$ 列的格子, 并称 $a, b$ 是其横, 纵坐标.

若乙将棋子放在 $(1,1)$, 注意到每次操作纵坐标至多加 1 , 故棋子在 $n$ 行的纵坐标至多为 $n$, 则乙将终点定为 $(n, 2021)$, 即知 $n \geq 2021$.

若 $n=2021$, 由上述论证即知 $(t, t)$ 均为黑格 $(t=1,2, \cdots, 2020)$, 此时棋子无法移至 $(2021,2020)$. 事实上, 若要移至 $(2021,2020)$, 易知这 2020 次操作需经过 2019 次黑格, 1 次白格, 且每次经过黑格均向右移, 这与 $(t, t)$ 是黑格显然矛盾.

故 $n \geq 2022$.

另一方面, 当 $n=2022$ 时. 记 $k=1011$. 现甲将 $(k, k-1),(k, k)$ 涂白, 剩余格子均涂黑. 称两个不同行的格子连通, 若棋子可从其中横坐标较小的格子移动到另一个. 我们分三步说明该构造符合条件.

I. 第一行的每个方格均至少与 $(k-1, k-1),(k-1, k),(k-1, k+1)$ 中一个连通.

II. $(k-1, r)$ 与 $(k+2, s)$ 连通 $(r, s=k-1, k, k+1)$.

III. 最后一行的每个格子均至少与 $(k+2, k-1),(k+2, k),(k+2, k+1)$中一个连通.

易知若 I, II, III 成立则该构造符合条件. 又由于 $1 \sim k-1$ 行, $k+2 \sim 2 k$ 行均全为黑格, 知 I, III 等价, 故只需证 I, II.

首先证明 I. 考虑第一行任一方格 $(1, m)$.

1) $m=1$, 则前 $k-2$ 次操作均向右, 可至 $(k-1, k-1)$.
2) $2 \nmid m$ 且 $m \neq 1$, 则前 $k-2$ 次操作先向右 $\frac{2 k-1-m}{2}$ 次至 $\left(\frac{2 k+1-m}{2}, \frac{2 k-1+m}{2}\right)$ (由 $m \leq 2 k-1$ 知该方格存在), 再向左移 $\frac{m-3}{2}$ 次即至 $(k-1, k+1)$.
3) $2 \mid m$, 则前 $k-2$ 次操作先向右 $\frac{2 k-2-m}{2}$ 次至 $\left(\frac{2 k-m}{2}, \frac{2 k-2+m}{2}\right)$ (由 $m \leq$ $2 k-2$ 知该方格存在), 再向左移 $\frac{m-2}{2}$ 次即至 $(k-1, k)$.

故 I 证毕.

其次证明 II. 只需考虑第 $(k-1)$ 至 $(k+2)$ 行, 第 $(k-2)$ 至 $(k+2)$ 列的局部图如下, 其中灰色格子代表黑格, 白色格子代表白格.



并注意到下图三种移动方式(忽略涂色方式)，


即知 II 证毕.

综上即知该构造符合条件.

综上可知, $n$ 最小值是 2022 .

评注 本题难度适中. $n \geq 2022$ 是好证明的, 而初次构造可能只会构出 2023 ,后在 $n=2022$ 和 2023 之间取舍. 容易发现的是白格只起到了一个“中转站”的作用, 类似于横纵坐标之和奇偶性的更换格, 于是不宜过多. 解答中 I 的想法, 即将较多格合并在一起的想法是重要的. 另外, 当 $n=2022$ 时白格个数的极值也是有意思的问题, 其最小值即为 2 , 构造如证明.

题 3 在锐角 $\triangle A B C$ 中, 点 $D, E$ 分别在 $A B, A C$ 两条边上, 并且满足 $B D=C E$. 设点 $P$ 在线段 $D E$ 上, 而点 $Q$ 是 $\triangle A B C$ 的外接圆中劣弧 $\overparen{B C}$ 上的一点, 且 $P, Q$ 两点满足 $B P: P C=E Q: Q D$. 假设点 $A, B, C, D, E, P, Q$ 两两不同, 证明:

$$
\angle B P C=\angle B A C+\angle E Q D .
$$

证明 延长 $Q D, Q E$ 分别交 $\triangle A B C$ 外接圆于 $M, N$. 连结 $C M, B N, C N$.连结 $B Q, C Q$. 记 $C M, B N$ 交点为 $P^{\prime}$.

首先说明 $D, P^{\prime}, E$ 共线. 对圆内接六边形 $A B N Q M C$, 由 Pascal 定理及

$$
A B \cap Q M=D, B N \cap M C=P^{\prime}, N Q \cap C A=E
$$

知 $D, P^{\prime}, E$ 共线.



其次, 我们证明 $B P^{\prime}: P^{\prime} C=E Q: Q D$. 事实上

$$
\begin{aligned}
\frac{B P^{\prime}}{P C^{\prime}} & \left.=\frac{\sin \angle B C P^{\prime}}{\sin \angle C B P^{\prime}} \quad \text { (在 } \triangle B C P^{\prime} \text { 中运用正弦定理 }\right) \\
& =\frac{\sin \angle B C M}{\sin \angle C B N} \\
& =\frac{\sin \angle B Q M}{\sin \angle C Q N} \quad \text { (圆周角相等) }
\end{aligned}
$$

在 $\triangle D B Q, \triangle E C Q$ 中分别运用正弦定理,

$$
\frac{B D}{\sin \angle D Q B}=\frac{Q D}{\sin \angle D B Q}, \frac{C E}{\sin \angle E Q C}=\frac{Q E}{\sin \angle E C Q}
$$

又 $B D=C E, \angle D B Q+\angle E C Q=\angle A B Q+\angle A C Q=\pi$. 以上两式相比, 即

$$
\frac{E Q}{Q D}=\frac{\sin D Q B}{\sin E Q C}
$$

由(1), (2)即知 $B P^{\prime}: P^{\prime} C=E Q: Q D$.

又当 $P$ 在线段 $D E$ 上时,

$$
\frac{B P}{C P}=\frac{\sin \angle B C P}{\sin \angle C B P}
$$

该值在 $P$ 从 $D$ 到 $E$ 上逐渐增大 ( $\angle B C P$ 逐渐增大, $\angle C B P$ 逐渐减小, 且均为锐角). 故 $P^{\prime}$ 即为 $P$. 又

$$
\begin{aligned}
\angle B P^{\prime} C & =\angle B N C+\angle N C M \\
& =\angle B A C+\angle N Q M \\
& =\angle B A C+\angle E Q D .
\end{aligned}
$$

知 $\angle B P C=\angle B A C+\angle E Q D$.

评注 为了寻找到题目所需的角度关系, 容易想到将角度导到圆弧上, 进而会猜测解答中的性质。注意要把 $\frac{B P}{P C}$ 的单调性说清楚.
题 42021 个整数 $a_{1}, a_{2}, \cdots, a_{2021}$ 满足对任意 $n=1,2, \cdots, 2016$ 都有 $a_{n+5}+a_{n}>a_{n+2}+a_{n+3}$ 成立. 求 $a_{1}, a_{2}, \cdots, a_{2021}$ 中最大值与最小值之差的最小可能值.

解 $a_{1}, a_{2}, \cdots, a_{2021}$ 中最大值与最小值之差的最小可能值为 85008 .

一方面, 取

$$
a_{1}=a_{2}=a_{3}, a_{n}=a_{n-3}+\left[\frac{n}{2}\right]-506(n=4,5, \cdots, 2021) \text {, }
$$

则对 $n=1,2, \cdots, 2016$, 有

$$
\begin{aligned}
a_{n+5}+a_{n} & =a_{n+2}+\left[\frac{n+5}{2}\right]-506+a_{n} \\
& =a_{n+2}+a_{n}+\left[\frac{n+3}{2}\right]-506+1 \\
& =a_{n+2}+a_{n+3}+1 \\
& >a_{n+2}+a_{n+3} .
\end{aligned}
$$

且此时有

$$
\begin{aligned}
\max _{1 \leq i \leq 2021}\left\{a_{i}\right\}-\min _{1 \leq i \leq 2021}\left\{a_{i}\right\} & =\sum_{j=1}^{337}\left(506-\left[\frac{3 j+1}{2}\right]\right) \\
& =(2+3)+(5+6)+(8+9)+\cdots+(503+504) \\
& =(1+2+\cdots+505)-(1+4+7+\cdots+505) \\
& =\frac{505 \times 506}{2}-\frac{506 \times 169}{2} \\
& =168 \times 506=85008 .
\end{aligned}
$$

另一方面, 由 $a_{1}, a_{2}, \cdots, a_{2021} \in \mathbb{Z}$ 和 $a_{n+5}+a_{n}>a_{n+2}+a_{n+3}$ 知

$$
a_{n+5}+a_{n} \geq a_{n+2}+a_{n+3}+1
$$

故

$$
a_{n+5}-a_{n+2} \geq a_{n+3}-a_{n}+1, \quad n=1,2, \cdots, 2016 .
$$

对任意 $1 \leq i \leq 1009$, 设 $a_{2 i+2}-a_{2 i-1}=b_{i}, a_{2 i+3}-a_{2 i}=c_{i}$, 则有

$$
c_{i+1} \geq c_{i}+1, b_{i+1} \geq b_{i}+1(1 \leq i \leq 1009)
$$

进而知对任意 $i+j \leq 1009, i, j \in \mathbb{N}^{+}$, 有

$$
c_{i+j} \geq c_{i}+j, b_{i+j} \geq b_{i}+j
$$

又

$$
a_{1009}-a_{1}=\left(b_{502}+b_{499}+\cdots+b_{1}\right)+\left(c_{503}+c_{500}+\cdots+c_{2}\right),
$$

$$
a_{2021}-a_{1013}=\left(c_{1009}+c_{1006}+\cdots+c_{508}\right)+\left(b_{1008}+b_{1005}+\cdots+b_{507}\right) .
$$

由 $(*)$, 知

$$
\begin{aligned}
a_{1009}-a_{1} & \leq 168 \cdot b_{505}-\sum_{i=1}^{168}(505-(3 i-2))+168 \cdot c_{505}-\sum_{i=1}^{168}(505-(3 i-1)) \\
& =168 \cdot\left(b_{505}+c_{505}\right)-((2+3)+(5+6)+\cdots+(503+504)) \\
& =168\left(b_{505}+c_{505}\right)-85008,
\end{aligned}
$$

且

$$
\begin{aligned}
a_{2021}-a_{1013} & \geq 168 \cdot c_{505}+\sum_{i=1}^{168} 3 i+168 \cdot b_{505}+\sum_{i=1}^{168}(3 i-1) \\
& =168 \cdot\left(b_{505}+c_{505}\right)+((2+3)+(5+6)+\cdots+(503+504)) \\
& =168\left(b_{505}+c_{505}\right)+85008,
\end{aligned}
$$

故

$$
\left(a_{2021}-a_{1013}\right)-\left(a_{1009}-a_{1}\right) \geq 2 \times 85008 \text {, }
$$

知

$$
\begin{aligned}
\max _{1 \leq i \leq 2021}\left\{a_{i}\right\}-\min _{1 \leq i \leq 2021}\left\{a_{i}\right\} & \geq \max \left\{\left|a_{2021}-a_{1013}\right|,\left|a_{1009}-a_{1}\right|\right\} \\
& \geq \frac{a_{2021}-a_{1013}-\left(a_{1009}-a_{1}\right)}{2} \\
& \geq 85008 .
\end{aligned}
$$

综上, $a_{1}, a_{2}, \cdots, a_{2021}$ 中最大值与最小值之差的最小可能值为 85008 .

评注 看到此题条件 $a_{n+5}+a_{n}>a_{n+2}+a_{n+3}$, 将其移项转为差的形式是平凡的想法. 在转化后进一步便可以推测使最大值与最小值差最小时应为数列两边几乎相等, 中间小于两边的特殊情形, 故在证明最小值时直接考虑两边的数与中间的数之差即可.

解答中有两点值得注意:

1. 将 $a_{n+5}+a_{n}>a_{n+2}+a_{n+3}$ 变为 $a_{n+5}-a_{n+2}>a_{n+3}-a_{n}$, 使不等式两边看作做整体时跨度为 2 , 以此少设一个数列.

2 . 在找 $a_{k}-a_{1}$ 时需 $k-1 \equiv 0(\bmod 6)$, 使 $a_{k}-a_{1}$ 中 $b_{i}, c_{i}$ 个数相等, 另一边同样.

题 5 对任意正整数 $n$, 求出所有满足如下条件的不小于 1 且不超过 $2 n^{2}$ 的整数 $k$ : 在 $2 n \times 2 n$ 的表格中, 任选 $k$ 个不同的格子, 并将这些格子涂成黑色, 其
他所有格子都涂成白色. 这时我们记录下同时有白格子和黑格子的 $2 \times 2$ 的子表格的个数. 那么, 在所有选格子的方法中, 这种子表格的个数最小值恰为 $2 n-1$.

解 $k$ 的所有可能值为 $n^{2}-r(0 \leq r \leq n-1)$ 及 $2 n t\left(\frac{n}{2}<t \leq n, t \in \mathbb{N}^{+}\right)$.
I. $k \leq n^{2}-n$ (此处不考虑 $n=1$ ).

可设 $k=p n+q$, 其中 $0 \leq p \leq n-2,1 \leq q \leq n$, 并将第 $i$ 行, 第 $j$ 列的方格记为 $(i, j)$.

现把方格 $(i, j)(1 \leq i \leq p, 1 \leq j \leq n)$ 和方格 $(p+1, j)(1 \leq j \leq q)$ 涂黑 (如下图).



此时一共涂黑了 $p n+q=k$ 个方格, 且异色表格共有 $p+n$ 个(为叙述方便, 将四个方格不全同色的 $2 \times 2$ 子表格称为异色表格). 而 $p+n \leq 2 n-2$, 知 $k \leq n^{2}-n$时不符合要求.

II. $n^{2}-n+1 \leq k \leq 2 n^{2}$.

我们证明异色表格的个数不少于 $2 n-1$ 个, 并分析取等条件.

先给出一些定义:

定义 1 我们称黑色方格 $A, B$ 同属于 1 个连通分支, 当且仅当存在正整数 $s$ 及 $(s-1)$ 个黑色方格 $C_{1}, C_{2}, \cdots, C_{s-1}$, 使得对任意 $1 \leq i \leq s, C_{i-1}$ 和 $C_{i}$都有公共顶点 $\left(C_{0}=A, C_{s}=B\right)$. 如下图, $A, B$ 即属于同一连通分支.



那么, 所有涂成黑色的方格可划分为若干个连通分支, 且每一个 $2 \times 2$ 子表格中, 所有黑色方格(若存在)都来自于同一连通分支, 此时称这个子表格属于这个连通分支, 显然每个异色表格恰属于一个连通分支.
定义 2 我们称一个连通分支是横(纵)向广阔的, 若每个列(行)中都至少有一格方格属于这个连通分支.

定义 3 我们称两个异色方格的公共边(若存在)为分割边, 并称该分割边属于以它为边界的黑色方格所在的连通分支.

下面分 3 种情况讨论.

(1) 每一个连通分支均既不是横向广阔的, 也不是纵向广阔的.

设共有 $m$ 个连通分支, 每个连通分支各有 $k_{1}, k_{2}, \cdots, k_{m}$ 个方格, 则 $k \geq m$且 $\sum_{i=1}^{m} k_{i}=k$

先证一引理:

引理 若一个连通分支既不是横向广阔的, 也不是纵向广阔的, 且它有 $l$ 个方格, 则至少有 $2 \sqrt{l}-1$ 个异色表格属于它.

证明 考虑包含该连通分支的最小子表格. 设其水平边长为 $a$, 坚直边长为 $b$. 由于该连通分支既不是横向广阔也不是纵向广阔的, 故可设这个子表格的左边界和上边界均不是原表格的边界, 如下图.



由这个子表格的最小性知, 这个子表格的任意一行, 列中均有黑色方格属于这个连通分支. 考虑这个子表格中每一行最左边的黑格的左边界及每一列最上面的黑格的上边界(这里的黑格均在该连通分支范围内讨论). 这 $(a+b)$ 条边均为分割边 (如上图中加粗的 $(a+b)$ 条即为所取), 且不构成回路. 因此这些边的端点数(不计重数)不少于 $a+b+1$. 又至多有其中 2 个端点在边界上(如上图中即为 $\left.X_{1}, Y_{1}\right)$, 并注意到以下事实:

若一个不在边界上的顶点是属于该连通分支的分割边的端点, 则以它为中心的 $2 \times 2$ 子表格是异色表格, 且属于原连通分支.

因此, 属于该连通分支的异色表格的个数不少于

$$
a+b-1 \stackrel{A-G}{\geq} 2 \sqrt{a b}-1 \geq 2 \sqrt{l}-1
$$

引理得证.

回到原题, 由引理知

异色表格总个数 $\geq \sum_{i=1}^{m}\left(2 \sqrt{k_{i}}-1\right)$

$$
\begin{aligned}
& \geq 2 \sqrt{k-m+1}+m-2 \quad\left(\text { 由 } \sqrt{a}+\sqrt{b} \geq \sqrt{a+b-1}+1, a, b \in \mathbb{Z}^{+}\right) \\
& =2 \sqrt{k}-1+(m-1)\left(1-\frac{2}{\sqrt{k-m+1}+\sqrt{k}}\right) \\
& \geq 2 \sqrt{k}-1 \quad(\text { 由 } m \geq 1, \sqrt{k-m+1}+\sqrt{k} \geq 1+\sqrt{m} \geq 2) \\
& \geq 2 \sqrt{n^{2}-n+1}-1 \\
& >2 n-2 .
\end{aligned}
$$

因此异色表格至少有 $(2 n-1)$ 个. 若恰有 $(2 n-1)$ 个, 则 $2 \sqrt{k}-1 \leq 2 n-1$. 知 $k \leq n^{2}$, 并同 I 中构造知 $n^{2}-n+1 \leq k \leq n^{2}$ 时 $(2 n-1)$ 可取到.

(2) 有一个横向广阔但不纵向广阔的连通分支.

考虑这个连通分支. 由其不纵向广阔及连通性可设原表格中第一行无黑色方格属于该连通分支.

对于每一列, 考虑该连通分支中位于这一列最上方的方格的上边界. 由此得到 $2 n$ 条分割边 (如下图). 易知其至少有 $(2 n+1)$ 个不同端点且至多有 2 个端点在边界上(如图中即 $X_{2}, Y_{2}$ ). 因此结合 $(*)$ 知属于该连通分支的异色表格个数不小于 $2 n+1-2=2 n-1$ 个.



若异色表格恰有 $(2 n-1)$ 个, 则这个连通分支唯一, 其水平的分割边有且仅有上述的 $2 n$ 条边, 且这 $2 n$ 条边都在同一条水平线上. 因此, 被涂黑的方格是连续若干行中所有方格, 即 $2 n \mid k$, 且易知此时可取到 $2 n-1$.

(3) 有一个既横向广阔又纵向广阔的连通分支.

我们称某行(列)为黑行(列), 若该行(列)所有方格均被涂黑. 考虑该连通分支, 现对于每一个不是黑行(列)的行(列), 在这一行(列)中选取两个相邻且异色的方格的公共边(即分割边).

记黑行有 $r$ 个, 黑列有 $c$ 个, 则一共选取了 $(4 n-r-c)$ 条边. 由于每行, 列
均只取一条, 知不会构成回路. 因此, 它们至少有 $(4 n-r-c+1)$ 个不同端点. 又边界上的端点至多 4 个(容易验证每条边界上至多一个). 故由 (*) 知, 属于该连通分支的异色表格个数不少于 $4 n-r-c-3$.

又这 $r$ 个黑行, $c$ 个黑列中 $(2 n r+2 n c-r c)$ 个方格均为黑的, 故有

$$
2 n r+2 n c-r c \leq k \leq 2 n^{2},
$$

整理即

$$
(2 n-r)(2 n-c) \geq 2 n^{2}
$$

从而

$$
4 n-r-c-3=(2 n-r)+(2 n-c)-3 \stackrel{A-G}{\geq} 2 \sqrt{2} n-3
$$

当 $n \geq 3$ 时, $2 \sqrt{2} n-3>2 n-1$, 不能取等.

当 $n=1$ 时, 易知 $k=2$ 满足条件.

当 $n=2$ 时, 假设异色表格不多于 3 个. 由 $2 \sqrt{2} n-3>2$, 知恰为 3 个, 即 $4 n-r-c-3 \leq 3$, 知 $r+c \geq 2$. 而

$$
2 n-r+2 n-c \geq 2 \sqrt{(2 n-r)(2 n-c)}>5
$$

知 $r+c<3$, 故 $r+c=2$. 存在下列两种情况:
i. $(r, c)=(2,0)$ 或 $(0,2)$. 不妨设 $r=2$, 则由 $2 r n=2 n^{2}$ 知不是黑行的行均无黑格. 这与纵向广阔性矛盾.

ii. $(r, c)=(1,1)$, 继续考虑 $(3)$ 证明中取的分割边, 知它们的端点中有 4 个在边界上. 因此第 1 行, 第 4 行; 第 1 列, 第 4 列均有白格. 故可不妨设第 2 行, 第 2 列为黑行, 黑列. 如下图, 除这 7 个黑格外, 至多只有一个黑格被涂黑. 因此, 下图中 4 个以“・”标记的各点均可作异色表格的中心.



综上, 此情况只有 $n=1, k=2$ 可取等.

综上所述, 仅有 $k=n^{2}-n+1, \cdots, n^{2}$ 及 $2 n \mid k, k \geq n^{2}$ 两种情况符合题设要求(注意到 $n=1, k=2$ 情形包含在内).

即所求 $k$ 为 $n^{2}-r(0 \leq r \leq n-1)$ 及 $2 n t\left(\frac{n}{2}<t \leq n, t \in \mathbb{N}^{+}\right)$.
评注 本题容易入手. 由题设自然联想到的是讨论异色表格如何计数的问题, 进而发现核心在于计数异色方格的中心格点, 但尝试证明时则会发现细节其实较多, 如下:

1. 需严格定义连通分支概念. 值得注意的是, 若将类似于 “四”的两个黑色方格定义在两个连通分支中, 这两个连通分支会存在共同顶点, 将造成一定的麻烦.
2. 需考虑边界的影响. 易知中心格点是不处于边界上的, 于是需要对连通分支是否具有横(纵)向广阔性分三类进行讨论.

3 . 如何找到满足条件的 $2 n-1$ 个格点.

而本做法的精彩之处在于:

1. 用边刻画点. 这是考虑到引理中 “ $a+b-1$ ”的产生. 同时注意到取等条件, 只选取一侧的边进行考虑是理想的(两侧均考虑同样会造成麻烦).
2. 两处放缩. 第一处将 $a+b-1$ 直接放成 $2 \sqrt{l}-1$, 看似大胆, 实则有利于后续的放缩, 且在 $k \geq n^{2}-n+1$ 的前提下是合理的;第二处则是由于明确情况 (3) 无法取等, 利用 $k \leq 2 n^{2}$ 明确下界.

简而言之, 本题核心要求在于合理叙述. 若能找到一个合适的找点方式, 就会有一个理想的解答.


[^0]:    修订日期: 2021-03-08.

