# 新星夏令营若干组合问题分析 

冯跃峰

我们通过若干组合问题的分析, 介绍数学解题中一些常用思考方法.

## 1. 特征拓广

假定少数对象具有共同特征 $A$, 将 $A$ 拓广为 $B$, 使 $A \subseteq B$, 则在 $B$ 的意义上,所有对象都具有特征 $B$.

比如, 将“相等”拓广为“同余”, “有序数组相等”拓广为“集合相等”, “全等”拓广为“相似”等.

例 1. 设 $f(n)$ 是定义在正整数集上的函数, 且对任何自然数 $n$, 有

$$
\begin{gathered}
f(1)=f(2)=1, \quad f(3 n)=f(n)+2014 \\
f(3 n+1)=3 f(n)+2015, \quad f(3 n+2)=5 f(n)+2016
\end{gathered}
$$

试问: 序列 $\{f(n)\}(1 \leq n \leq 2015)$ 有多少项为偶数？证明你的结论. (原创题)

分析与解: 首先, 从解题目标考虑, 我们能否将原问题化为一种与之等价的简单形式?

注意到我们只关心数列 $\{f(n)\}$ 中项的奇偶性, 而由数学归纳法可知, $f(n)$为自然数, 从而可用模 2 来处理题给的递归关系, 使其变得简单.

在模 2 的意义下, 我们有

$$
\begin{gathered}
f(1)=f(2)=1, \quad f(3 n) \equiv f(n), \\
f(3 n+1) \equiv f(n)+1, \quad f(3 n+2) \equiv f(n) .
\end{gathered}
$$

为了计算序列 $\{f(n)\}(1 \leq n \leq 2015)$ 有多少项为偶数, 先从初值开始试验, $f(n)$ 的前面若干个值的奇偶性如下表所示, 其中 1 表示奇数, 0 表示偶数:

| $n$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| $f(n)$ | 1 | 1 | 1 | 0 | 1 | 1 | 0 | 1 | 1 | 0 | 1 | 0 | 1 | 0 | 1 | 0 | 1 | 1 |

我们观察使 $f(n)$ 为偶的 $n$ 构成的关键子列:

$$
4,7,10,12,14,16,18
$$

我们似乎难以发现该子列各项的共同特征.

于是, 我们想换一种进制的数来试试. 换哪种进制的数呢? - 3 进制数!

为什么不是 2 进制数?一因为题给的递归关系是以模 3 分类的!

那么, 这里的“模 3 分类”与 “ 3 进制数”这两个“ 3 ”纯属某种巧合, 还是有必然联系?

确实是有紧密联系的: 如果题给的递归关系是以模 3 分类的, 则将各数用 3 进制表示后, 递归关系的运用也是很方便的.

实际上, 由 $n$ 的 3 进制表示可以得到 $3 n, 3 n+1,3 n+2$ 的 3 进制表示.

设 $n=\left(a_{k} a_{k-1} \cdots a_{1} a_{0}\right)_{(3)}$, 其中 $a_{k} \neq 0$, 则

$$
\begin{gathered}
3 n=\left(a_{k} a_{k-1} \cdots a_{1} a_{0} 0\right)_{(3)}, \\
3 n+1=\left(a_{k} a_{k-1} \cdots a_{1} a_{0} 1\right)_{(3)}, \\
3 n+2=\left(a_{k} a_{k-1} \cdots a_{1} a_{0} 2\right)_{(3)} .
\end{gathered}
$$

现在, 我们将上表中的数都用 3 进制表示, 看能否有新的发现:

| $n$ | 1 | 2 | 10 | 11 | 12 | 20 | 21 | 22 | 100 | 101 | 102 | 110 | 111 | 112 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| $f(n)$ | 1 | 1 | 1 | 0 | 1 | 1 | 0 | 1 | 1 | 0 | 1 | 0 | 1 | 0 |

此时, 表中 $f(n)$ 为偶的项的规律还比较隐蔽, 仔细观察那些使 $f(n)$ 为偶的三进制数构成的子列:

$$
\text { 11,21, 101, 110,112, }
$$

你能否发现它们的共同特征?

先看前面 3 个数: 11,21 与 101 的共同点是个位数相同, 但第 4 个数 110 却不具备这一特点, 从而个位相同的特征不是普适的.

我们将 110 与其中的 101 比较, 其共同点是首位相同, 而末两位数字的集合相同 (只是排列顺序不同). 我们逐步拓宽 “相同”的意义: “个位数相同”拓展到 “末两位数字的集合相同”.

我们再看后 3 个数: 101, 110, 112 的末两位数字, 尽管它们不尽相同, 但其和的奇偶性相同. 进一步拓宽 “相同”的意义: “末两位数字的集合相同”拓展到“后若干位数字和的奇偶性相同”.
推而广之, 我们发现, 上述所有数去除第一个数字后, 剩下数字的和都是奇数.

那么, 使 $f(n)$ 为奇的三进制数 $n$ 构成的子列是否也具有类似的性质呢? 我们将上表中的 3 进制数的第一个数码划掉, 得到如下简化数表:

$$
\begin{array}{ccccccccccccccc}
n^{\prime} & 0 & 0 & 0 & 1 & 2 & 0 & 1 & 2 & 0 & 1 & 2 & 10 & 11 & 12 \\
f(n) & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0
\end{array}
$$

则 $n^{\prime}$ 与 $f(n)$ 的奇偶性有明显规律: $f(n)$ 与 $n^{\prime}$ 的 3 进制数字之和不同奇偶.

我们用 $\overline{a_{k} a_{k-1} \cdots a_{1} a_{0}}$ 表示 $n$ 的三进制数: $n=\left(a_{k} a_{k-1} \cdots a_{1} a_{0}\right)_{(3)}$, 其中 $a_{k} \neq 0$. 定义: $S^{-}(n)=a_{k-1}+a_{k-2}+\cdots+a_{1}+a_{0}$, 其中规定, 当 $k=0(n$ 为一位三进制数) 时, $S^{-}(n)=0$.

这样, 我们有下面的

引理 对任何正整数 $n, f(n)$ 与 $S^{-}(n)$ 不同奇偶, 即

$$
f(n) \equiv S^{-}(n)+1 \quad(\bmod 2)
$$

证明：当 $n=1$ 时, 结论显然成立. 设结论对小于 $n$ 的正整数成立, 考虑 $n$的情形. 为证明 $f(n) \equiv S^{-}(n)+1(\bmod 2)$, 可分别计算 $f(n), S^{-}(n)$.

其中 $S^{-}(n)$ 利用定义很容易计算, 只需要知道 $n$ 的三进制表示即可. 于是,我们设 $n=\overline{a_{k} a_{k-1} \cdots a_{1} a_{0}}\left(a_{k} \neq 0\right)$, 则 $S^{-}(n)=a_{k-1}+a_{k-2}+\cdots+a_{1}+a_{0}$.

下面计算 $f(n)$, 这只需利用递归关系, 化为小于 $n$ 的情形以利用归纳假设.为了利用递归关系, 需要将 $n$ 的三进制表示 $n=\overline{a_{k} a_{k-1} \cdots a_{1} a_{0}}\left(a_{k} \neq 0\right)$ 化成 $3 m+r$ 的形式. 怎样化? 将其末位数字单独分离出来即可!

$$
n=\overline{a_{k} a_{k-1} \cdots a_{1} a_{0}}=\overline{a_{k} a_{k-1} \cdots a_{1} 0}+a_{0}=3 \overline{a_{k} a_{k-1} \cdots a_{1}}+a_{0} .
$$

下面只需对 $a_{0}$ 的值进行分类讨论, 便可利用递归关系.

(i) 若 $a_{0}=0$, 则 $n=\overline{a_{k} a_{k-1} \cdots a_{1} 0}=3 \overline{a_{k} a_{k-1} \cdots a_{1}}$, 此时,

$$
\begin{aligned}
f(n) & =f\left(3 \overline{a_{k} a_{k-1} \cdots a_{1}}\right) \stackrel{\text { 递归关系 }}{=} f\left(\overline{a_{k} a_{k-1} \cdots a_{1}}\right) \stackrel{\text { 归纳假设 }}{=} S^{-}\left(\overline{a_{k} a_{k-1} \cdots a_{1}}\right)+1 \\
& =a_{k-1}+a_{k-2}+\cdots+a_{1}+1 \equiv S^{-}(n)+1(\bmod 2),
\end{aligned}
$$

所以结论成立.

(ii) 若 $a_{0}=1$, 则 $n=\overline{a_{k} a_{k-1} \cdots a_{1} 1}=3 \overline{a_{k} a_{k-1} \cdots a_{1}}+1$, 此时,

$$
\begin{aligned}
& f(n)=f\left(3 \overline{a_{k} a_{k-1} \cdots a_{1}}+1\right) \stackrel{\text { 递归关系 }}{=} f\left(\overline{a_{k} a_{k-1} \cdots a_{1}}\right)+1 \\
& \text { 归纳假设 } S^{-}\left(\overline{a_{k} a_{k-1} \cdots a_{1}}\right)+1+1
\end{aligned}
$$

$$
=a_{k-1}+a_{k-2}+\cdots+a_{1}+2 \equiv S^{-}(n)+1(\bmod 2),
$$

所以结论成立.

(iii) 若 $a_{0}=2$, 则 $n=\overline{a_{k} a_{k-1} \cdots a_{1} 2}=3 \overline{a_{k} a_{k-1} \cdots a_{1}}+2$, 此时,

$$
\begin{aligned}
f(n) & =f\left(3 \overline{a_{k} a_{k-1} \cdots a_{1}}+2\right) \stackrel{\text { 递归关系 }}{=} f\left(\overline{a_{k} a_{k-1} \cdots a_{1}}\right) \stackrel{\text { 归纳假设 }}{=} S^{-}\left(\overline{a_{k} a_{k-1} \cdots a_{1}}\right)+1 \\
& =a_{k-1}+a_{k-2}+\cdots+a_{1}+1 \equiv S^{-}(n)+1(\bmod 2),
\end{aligned}
$$

所以结论成立. 引理得证.

下面计算序列 $\{f(n)\}(1 \leq n \leq 2015)$ 中为偶数的项的个数, 由引理, 只需计算 $S^{-}(n)$ 为奇数的 $n(1 \leq n \leq 2015)$ 的个数.

因为 $2015=(2202122)_{(3)}$, 从而合乎条件的 $n$ 的 3 进制表示至多有 7 位. 考察其中的任意一个合乎条件的 $n$ 的 3 进制数 $x$, 设 $n=\left(a_{k} a_{k-1} \cdots a_{1} a_{0}\right)_{(3)}\left(0 \leq k \leq 6, a_{k} \neq 0\right), S^{-}(n)=a_{k-1}+a_{k-2}+\cdots+a_{1}+a_{0}$,

(1) 当 $k=0$ 时, 因为 $S^{-}(n)=0$ 是偶数, 从而这样的 3 进制数 $n$ 不存在.

(2) 当 $k=1$ 时, $n=\overline{a_{1} a_{0}}\left(a_{1} \neq 0\right)$, 此时 $S^{-}(n)=a_{0}$ 为奇, 从而 $a_{0}=1$, 而 $a_{1} \in\{1,2\}$ 有 2 种取值, 所以这样的 $n$ 有 2 个.

(3) 当 $k=2$ 时, $n=\overline{a_{2} a_{1} a_{0}}\left(a_{2} \neq 0\right)$, 此时 $S^{-}(n)=a_{1}+a_{0}$ 为奇, 所以 $a_{0}, a_{1}$中有奇数个 1 . 在 $a_{0}, a_{1}$ 中取一个数为奇数有 $\mathrm{C}_{2}^{1}$ 种方法, 而另一个取偶数, 可为 0 或 2 , 有 2 种方法, 又 $a_{2} \in\{1,2\}$ 有 2 种取值, 所以这样的 $n$ 有 $2 \mathrm{C}_{2}^{1} 2^{1}=8$ 个.

(4) 当 $k=3$ 时, $n=\overline{a_{3} a_{2} a_{1} a_{0}}\left(a_{3} \neq 0\right)$, 此时 $S^{-}(n)=a_{2}+a_{1}+a_{0}$ 为奇, 所以 $a_{0}, a_{1}, a_{2}$ 中有奇数个 1 . 当有 1 个 1 时, 在 $a_{0}, a_{1}, a_{2}$ 中取一个数为奇数有 $\mathrm{C}_{3}^{1}$ 种方法, 而另 2 个都取偶数, 有 $2^{2}$ 种方法, 又 $a_{3} \in\{1,2\}$ 有 2 种取值, 所以这样的 $n$ 有 $2 \mathrm{C}_{3}^{1} 2^{2}$ 个. 当有 3 个 1 时, 在 $a_{0}, a_{1}, a_{2}$ 中取 3 个数为奇数有 $\mathrm{C}_{3}^{3}$ 种方法, 又 $a_{3} \in\{1,2\}$ 有 2 种取值, 所以这样的 $n$ 有 $2 \mathrm{C}_{3}^{3} 2^{0}$ 个. 所以此时的 $n$ 共有 $2\left(\mathrm{C}_{3}^{1} 2^{2}+\mathrm{C}_{3}^{3} 2^{0}\right)=26$ 个.

(5) 当 $k=4$ 时, 类似地, $n$ 共有 $2\left(\mathrm{C}_{4}^{1} 2^{3}+\mathrm{C}_{4}^{3} 2^{1}\right)=80$ 个.

(6) 当 $k=5$ 时, 类似地, $n$ 共有 $2\left(\mathrm{C}_{5}^{1} 2^{4}+\mathrm{C}_{5}^{3} 2^{2}+\mathrm{C}_{5}^{5} 2^{0}\right)=242$ 个.

(7) 当 $k=6$ 时, 设 $n=\overline{a_{6} a_{5} \cdots a_{1} a_{0}}\left(a_{6} \neq 0\right)$, 此时, $S^{-}(n)=a_{5}+a_{4}+\cdots+a_{0}$为奇.

(i) 如果 $a_{6}=1$, 则 $a_{5}, a_{4}, \cdots, a_{0}$ 可任取奇数个 1 , 从而这样的 $n$ 共有 $\mathrm{C}_{6}^{1} 2^{5}+\mathrm{C}_{6}^{3} 2^{3}+\mathrm{C}_{6}^{5} 2^{1}=364$ 个.

(ii) 如果 $a_{6}=2$, 则当 $a_{5}=0$ 时, $a_{4}, a_{3}, \cdots, a_{0}$ 可任取奇数个 1 , 从而这样的
$n$ 共有 $\mathrm{C}_{5}^{1} 2^{4}+\mathrm{C}_{5}^{3} 2^{2}+\mathrm{C}_{5}^{5} 2^{0}=121$ 个.

当 $a_{5}=1$ 时, $a_{4}, a_{3}, \cdots, a_{0}$ 可任取偶数个 1 , 从而这样的 $n$ 共有 $\mathrm{C}_{5}^{0} 2^{5}+\mathrm{C}_{5}^{2} 2^{3}+$ $\mathrm{C}_{5}^{4} 2^{1}=122$ 个.

当 $a_{5}=2$ 时, 必有 $a_{4}=0$. 有以下情况:

$a_{3}=0$ 时, $a_{2}, a_{1}, a_{0}$ 可任取奇数个 1 , 这样的 $n$ 有 $\mathrm{C}_{3}^{1} 2^{2}+\mathrm{C}_{3}^{3} 2^{0}=13$ 个.

$a_{3}=1$ 时, $a_{2}, a_{1}, a_{0}$ 可任取偶数个 1 , 这样的 $n$ 有 $\mathrm{C}_{3}^{0} 2^{3}+\mathrm{C}_{3}^{2} 2^{1}=14$ 个.

$a_{3}=2, a_{2}=0$ 时, $a_{1}, a_{0}$ 可任取奇数个 1 , 这样的 $n$ 有 $\mathrm{C}_{2}^{1} 2^{1}=4$ 个.

$a_{3}=2, a_{2}=1$ 时, $a_{1}, a_{0}$ 可任取偶数个 1 , 这样的 $n$ 有 $\mathrm{C}_{2}^{0} 2^{2}+\mathrm{C}_{2}^{2} 2^{0}=5$ 个.

综上所述, 序列 $\{f(n)\}(1 \leq n \leq 2015)$ 中为偶数的项的个数:

$S=2+8+26+80+242+364+121+122+13+14+4+5=1001$.

当然, 本题还有更简单的方法, 这里就不讨论了, 留给大家思考.

## 2. 同构分组

将对象分成若干组, 使每个组与原问题结构相同, 这样便可将 “ $n$ 的问题” 转化为“小于 $n$ 的问题”解决.

例 2. 对于由 $n$ 个整数构成的有序数组 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 定义如下操作 $T$ :

$$
\left(a_{1}, a_{2}, \cdots, a_{n}\right) \rightarrow\left(a_{1}+a_{2}, a_{2}+a_{3}, \cdots, a_{n}+a_{1}\right) .
$$

对于有序数组 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 如果对任何 $i(1 \leq i \leq n), a_{i}$ 与 $a_{i}+1$ 的奇偶性都不同, 则称 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$ 是“交错的”. 如果存在有限次操作, 使 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$可变成“交错的”, 则称 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$ 是“可交错的”.

对给定的正整数 $n=2^{k}\left(k \in \mathbf{N}^{*}\right)$, 试问:

(1) 哪些状态 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$ 是可交错的 (有多少项为奇, 多少项为偶, 其排列顺序如何)?

(2) 如果对任何可交错的初始状态, 都可经过不超过 $r$ 次操作变成交错的状态, 那么 $r$ 的最小值是多少? (原创题)

分析与解: 首先将问题简化. 因为我们只关心各个数的奇偶性, 从而可以用 0 表示其中的偶数, 1 表示其中的奇数, 则题中的状态都可以表示为一个长为 $n$的 $0-1$ 排列 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)\left(a_{i} \in\{0,1\}\right)$.

先考虑 (1), 不难发现, 可交错的初始状态 $\left(a_{1}, a_{2}, \cdots a_{n}\right)$ 有很多, 而不可交错的初始状态则很少, 所以我们宜从反面考虑哪些状态是不可交错的.

有两个显然的不可交错的初始状态: $(0,0, \cdots, 0),(1,1, \cdots, 1)$.
由于我们再也找不到其他的不可交错的初始状态, 从而猜想其他初始状态 (至少有一个 0 且至少有一个 1 的状态) 都是可交错的.

为了证明这一猜想, 我们来模拟操作.

设最初状态为 $A_{0}=\left(a_{1}, a_{2}, \cdots, a_{n}\right)\left(a_{i} \in\{0,1\}, a_{i}\right.$ 不全为 0 也不全为 1$)$, 对之操作 $t(t \in N)$ 次后得到的状态记为 $A_{t}$.

注意到初始排列的长度并不完全确定 ( $n=2^{k}$ 是未定常数), 可从特例开始模拟操作, 由此发现规律。

当 $k=1$ 时, 初始状态本质上是唯一的: $A_{0}=(0,1)$. 此时, 无须操作, 其本身就是交错的.

当 $k=2$ 时, $A_{0}=\left(a_{1}, a_{2}, a_{3}, a_{4}\right)\left(a_{i} \in\{0,1\}, a_{i}\right.$ 不全为 0 也不全为 1$)$,

$$
\begin{aligned}
& A_{1}=\left(a_{1}+a_{2}, a_{2}+a_{3}, a_{3}+a_{4}, a_{4}+a_{1}\right), \\
& A_{2}=\left(a_{1}+a_{3}, a_{2}+a_{4}, a_{3}+a_{1}, a_{4}+a_{2}\right), \\
& A_{3}=\left(a_{1}+a_{2}+a_{3}+a_{4}, a_{1}+a_{2}+a_{3}+a_{4}, a_{1}+a_{2}+a_{3}+a_{4}, a_{1}+a_{2}+a_{3}+a_{4}\right), \\
& A_{4}=(0,0,0,0) .
\end{aligned}
$$

此时, 尽管我们难以看清状态在何时变成交错的, 但我们发现, 状态操作 $2^{2}$ 次后变成全为 0 .

进一步思考发现，由全为 0 的状态向前逆推, 即可发现前面状态中必有交错状态.

实际上, 初始状态 $A_{0}$ 中各项不全为 0 , 若能变成全为 0 , 则必定存在一个最小的正整数 $t$, 使操作 $t$ 次后得到的状态 $A_{t}$ 各项全为 0 . 由 $t$ 的最小性, 状态 $A_{t-1}$中至少有一个项为奇, 但由状态 $A_{t}$ 各项全为 0 可知, $A_{t-1}$ 中任何两个相邻的项同奇偶, 从而 $A_{t-1}$ 中各项全为 1 . 又初始状态不是全为 1 , 从而 $A_{t-1}$ 不是初始状态, 必有前一状态 $A_{t-2}$, 且 $A_{t-2}$ 中任何两个相邻的项不同奇偶, 从而 $A_{t-2}$ 是交错的.

由此可见, 我们可更换解题目标: 证明“不全为 0 也不全为 1 ”的 $0-1$ 排列都可操作到全为 0 .

注意到“不全为 0 也不全为 1 ”的要求是为了保证前面出现交错状态, 而 0 - 1 排列变成全为 0 则无需这一要求. 所以我们推广命题, 证明任何 $0-1$ 排列都可操作到全为 0 .

这样的目标比原来的目标更清晰明了. 由上面的特例, 可以猜想:

当 $n=2^{k}\left(k \in \mathbf{N}^{*}\right)$ 时, 对任何 $0-1$ 排列 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 总可以通过 $2^{k}$ 次
操作, 使之变成全为 0 .

对 $k$ 归纳. 当 $k=1,2$ 时, 前面已证结论成立.

设结论对 $k$ 成立, 考虑 $k+1$ 的情形. 注意到 $k+1$ 时的 $0-1$ 排列长度为 $2^{k+1}$, 为了利用归纳假设, 我们希望能将其分割为两个长度为 $2^{k}$ 的 $0-1$ 排列. 如何分割, 先模拟操作, 看能否发现某种规律可用于上述分割.

设最初状态为 $A_{0}=\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 那么,

$$
\begin{aligned}
& A_{1}=\left(a_{1}+a_{2}, a_{2}+a_{3}, \cdots, a_{n}+a_{1}\right), \\
& A_{2}=\left(a_{1}+a_{3}, a_{2}+a_{4}, \cdots, a_{n}+a_{2}\right) .
\end{aligned}
$$

从总体上看, $A_{2}$ 没有明显的规律, 但若考察 $A_{2}$ 的一个子列, 则可发现其中隐含的规律.

我们可这样思考: 为了利用归纳假设, 我们想把 $A_{2}$ 中的分量分成两组, 那么, 应将哪些数作为一组?

显然, 应将奇数项作为一组, 偶数项作为另一组, 因为奇数项中的字母的下标都是奇数, 偶数项中的字母的下标都是偶数.

分别观察这两个组:

第一组: $a_{1}+a_{3}, a_{3}+a_{5}, a_{5}+a_{7}, \cdots, a_{n-3}+a_{n-1}$;

第二组: $a_{2}+a_{4}, a_{4}+a_{6}, a_{6}+a_{8}, \cdots, a_{n-2}+a_{n}$.

如果我们还没有发现其中的规律, 则将初始状态也分成类似的两组:

初始状态第一组: $a_{1}, a_{3}, a_{5}, a_{7}, \cdots, a_{n-3}, a_{n-1}$;

初始状态第二组: $a_{2}, a_{4}, a_{6}, a_{8}, \cdots, a_{n-2}, a_{n}$.

由此可发现, 前面两次操作可以看成是按如下两个步骤完成的.

第一步: 将原序列分解为如下两个长为 $2^{k-1}$ 的子列: 一个是序号为奇数的项构成的序列, 另一个是序号为偶数的项构成的序列, 对这两个序列分别按照题给的操作规则分别操作一次.

第二步: 将序号为奇数的项构成的序列操作后的各项按原来的顺序依次排列在奇号位上, 序号为偶数的项构成的序列操作后的各项按原来的顺序依次排列在偶号位上, 还原成长为 $2^{k}$ 的序列.

我们将上述两个步骤合并看成一个大操作, 该大操作是由连续两个原来的操作叠合而成的.

将长为 $2^{k+1}$ 的初始状态 $A_{0}=\left(a_{1}, a_{2}, \cdots, a_{2^{k+1}}\right)$ 分解为两个长为 $2^{k}$ 的初始状态:

$$
B_{0}=\left(a_{1}, a_{3}, \cdots, a_{2^{k+1}-1}\right), C_{0}=\left(a_{2}, a_{4}, \cdots, a_{2^{k+1}}\right)
$$

由归纳假设, 可分别经过 $2^{k}$ 次操作, 使 $B_{0}=\left(a_{1}, a_{3}, \cdots, a_{2^{k+1}-1}\right), C_{0}=$ $\left(a_{2}, a_{4}, \cdots, a_{2^{k+1}}\right)$, 分别变成各项全为 0 . 这等价于长为 $2^{k+1}$ 的初始状态 $A_{0}=$ $\left(a_{1}, a_{2}, \cdots, a_{2^{k+1}}\right)$ 可经过 $2^{k}$ 次“大操作”, 使变成各项全为 0 , 即可通过 $2 \cdot 2^{k}=2^{k+1}$次原操作, 使变成各项全为 0 , 结论成立.

综上所述, 所有可交错的状态为 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 其中 $a_{1}, a_{2}, \cdots, a_{n}$ 的奇偶性不全相同.

（2）考察极端情形, 可构造一种初始状态, 使交错状态难以形成. 最难形成交错状态的莫过于 $(0,0, \cdots, 0)$, 但它不是可交错状态. 此外, 与其相接近的状态: $(0,0, \cdots, 0,1)$, 也是较难形成交错状态的.

下面证明: 初始状态 $A_{0}=(0,0, \cdots, 0,1)$ 至少要经过 $n-2$ 次操作才能变成交错状态.

我们模拟操作, 依次得到各状态为:

$$
\begin{aligned}
& A_{1}=(0,0, \cdots, 0,0,0,1,1), \\
& A_{2}=(0,0, \cdots, 0,0,1,0,1), \\
& A_{3}=(0,0, \cdots, 0,1,1,0,1) .
\end{aligned}
$$

观察其中的关键元素: 排在状态最左边的一连串的 “ 0 ”, 每次操作使这样一连串的 “ 0 ” 中 0 的个数减少 1 . 为叙述问题方便, 我们称状态最左边一连串的 “ 0 ” 的个数为该状态的“特征值”.

不难发现, 每次操作, 都使状态的“特征值”减少 1 . 于是, 我们对操作次数 $t$归纳证明:

当 $t \leq n-1$ 时, 对状态 $A_{0}=(0,0, \cdots, 0,1)$ 操作 $t$ 次后, 得到状态 $A_{t}=$ $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 其特征值为 $n-t-1$.

当 $t=1$ 时结论显然成立. 假定结论对 $t \leq n-2$ 成立, 即对 $A_{0}$ 操作 $t$ 次后得到的状态为:

$$
A_{t}=\left(0,0, \cdots, 0, a_{n-t}, a_{n-t+1}, \cdots, a_{n}\right),
$$

其中 $a_{n-t}=1$.

考虑 $t+1$ 的情形, 再对上述状态 $A_{t}$ 操作一次, 我们有

$$
A_{t+1}=\left(0,0, \cdots, 0,1, b_{n-t}, b_{n-t+1}, \cdots, b_{n}\right)
$$

所以结论成立.

特别地, 令 $t=n-1$, 可知对 $A_{0}=(0,0, \cdots, 0,1)$ 操作 $n-1$ 后, 得到的状态为:

$$
A_{n-1}=\left(1, c_{2}, c_{3}, \cdots, c_{n}\right) .
$$

显然, 前 $n-1$ 个状态 $A_{1}, A_{2}, \cdots, A_{n-1}$ 都至少有一个项为 1 , 从而都不是各项全为 0 的状态, 所以状态 $A_{0}=(0,0, \cdots, 0,1)$ 至少要操作 $n$ 后才能变成各项全为 0 的状态.

进一步可知, $A_{0}=(0,0, \cdots, 0,1)$ 至少要操作 $n-1$ 后才能变成各项全为 1 的状态, 至少要操作 $n-2$ 后才能变成交错状态.

又由上面所证, 任何 0-1 排列都可经过 $n$ 次操作变成各项全为 0 的状态, 从而可交错状态都可以经过不多于 $n-2$ 后变成交错状态.

综上所述, 操作次数 $r$ 的最小值为 $n-2$.

## 3. 合力逼近

为了证明某个命题成立, 可考察该命题成立下可产生的若干结果, 得到命题成立的若干必要条件, 然后由多个必要条件导致原命题成立.

例 3. 用 $d(n)$ 表示正整数 $n$ 的最大奇约数, 比如 $d(2)=1, d(3)=3$, 定义:

$$
F(n)=\frac{d(1)+d(2)+\cdots+d(n)}{1+2+\cdots+n} .
$$

如果 $n$ 满足 $F(n)<\frac{2}{3}, F(n)=\frac{2}{3}, F(n)>\frac{2}{3}$, 则分别称 $n$ 是弱数, 中数与强数. 试求出所有的弱数, 中数与强数. (原创题)

分析与解: 我们先求中数, 因为解方程比解不等式容易. 为此, 我们先求几个较小的中数, 由此探索中数的分布规律.

将所有的中数按由小到大的顺序排成一个序列, 记第 $i$ 个中数为 $a_{i}(i=$ $1,2, \cdots)$, 则容易知道, $a_{1}=2$.

实际上, $F(1)=\frac{d(1)}{1}=1$ 不合要求, 所以 $a_{1} \neq 1 . F(2)=\frac{d(1)+d(2)}{1+2}=\frac{1+1}{1+2}=\frac{2}{3}$合乎要求, 所以 $a_{1}=2$.

类似地, 经计算可知, 数列前若干项为:

$$
a_{1}=2, a_{2}=6, a_{3}=14, a_{4}=30, \cdots
$$

注意到 $a_{2}=2 a_{1}+2, a_{3}=2 a_{2}+2, a_{4}=2 a_{3}+2$, 由此猜想, 对一切正整数 $n$,有 $a_{n+1}=2 a_{n}+2$.
为证明上述猜想, 我们将其结论分拆为如下 3 个引理 (3 个必要条件).

首先, 由于 $a_{1}=2$, 再结合 $a_{n+1}=2 a_{n}+2$, 可知对一切 $n, a_{n}$ 为偶数. 由此得到如下的:

引理 1 中数必定是偶数.

实际上, 因为每个 $d(k)(1 \leq k \leq n)$ 都为奇数, 所以我们有

$$
d(1)+d(2)+\cdots+d(n) \equiv 1+1+\cdots+1 \equiv n(\bmod 2)
$$

所以,

$$
\begin{aligned}
n & \equiv d(1)+d(2)+\cdots+d(n) \\
& \equiv 3[d(1)+d(2)+\cdots+d(n)] \\
& \equiv 2(1+2+\cdots+n) \equiv 0(\bmod 2)
\end{aligned}
$$

即 $n$ 为偶数.

为了说明数列 $\left\{a_{n}\right\}$ 包含所有的中数, 我们需要证明下面的

引理 2 当 $n$ 为偶数时, $n$ 是中数当且仅当 $2 n+2$ 是中数.

实际上, 记

$$
D(n)=d(1)+d(2)+\cdots+d(n), \quad S(n)=1+2+\cdots+n
$$

则 $F(n)=\frac{2}{3}$, 等价于 $3 D(n)=2 S(n)$.

当 $n$ 为偶数时, 我们有

$$
\begin{aligned}
D(2 n+2)= & {[d(1)+d(3)+\cdots+d(2 n+1)] } \\
& +[d(2)+d(4)+\cdots+d(2 n+2)] \quad(\text { 奇偶分开处理 }) \\
= & {[1+3+\cdots+(2 n+1)]+[d(1)+d(2)+\cdots+d(n+1)] } \\
= & (n+1)^{2}+[D(n)+d(n+1)] \\
= & (n+1)^{2}+(n+1)+D(n) . \quad(\text { 因为 } n+1 \text { 为奇数 })
\end{aligned}
$$

从而

$$
3 D(2 n+2)=3(n+1)^{2}+3(n+1)+3 D(n)=(n+1)(3 n+6)+3 D(n),
$$

又

$$
2 S(2 n+2)=2[1+2 \cdots+(2 n+2)]=(2 n+2)(2 n+3)=(n+1)(4 n+6) \text {. }
$$

因此

$$
\begin{aligned}
3 D(2 n+2)-2 S(2 n+2) & =(n+1)(3 n+6)+3 D(n)-(n+1)(4 n+6) \\
& =3 D(n)-n(n+1)=3 D(n)-2 S(n) .
\end{aligned}
$$

所以,

$$
\begin{aligned}
n \text { 是中数 } & \Leftrightarrow 3 D(n)-2 S(n)=0 \\
& \Leftrightarrow 3 D(2 n+2)-2 S(2 n+2)=0 \\
& \Leftrightarrow 2 n+2 \text { 是中数. }
\end{aligned}
$$

最后, 为了保证任何一个中数都必定是按上述递归关系得到, 我们需要证明如下的

引理 3 若 $2 n+2$ 是中数, 则 $n$ 必是偶数.

用反证法, 假定 $n$ 是奇数, 且 $2 n+2$ 是中数. 令 $n=2 k-1$, 则 $2 n+2=4 k$,于是, 由 $2 n+2=4 k$ 是中数, 有

$$
3 D(4 k)=2 S(4 k)=4 k(4 k+1)=16 k^{2}+4 k .
$$

另一方面, 由 $D(4 k)$ 的定义, 有

$$
\begin{aligned}
3 D(4 k) & =3[1+3+\cdots+(4 k-1)]+3[d(1)+d(2)+\cdots+d(2 k)] \\
& =3(2 k)^{2}+3 D(2 k)=12 k^{2}+3 D(2 k) .
\end{aligned}
$$

比较以上两式, 得

$$
3 D(2 k)=4 k^{2}+4 k>4 k^{2}+2 k=2 k(2 k+1)=2 S(2 k) .
$$

由此可见, $2 k$ 是强数.

如果能证明任何正偶数 $n$ 都不是强数, 则由 (*) 式便产生矛盾, 引理 3 获证.于是, 我们只需证明对任何偶数 $n$, 有

$$
3 D(n) \leq 2 S(n)
$$

注意到前面的讨论, 当 $n$ 为偶数时, 我们可把 $D(n)$ 的问题转化为 $D\left(\frac{n}{2}\right)$ 的问题处理, 此时, $n$ 所含有的 2 的幂次数降低 1 , 于是, 不妨设 $2^{r} \leq n<2^{r}+1(r \in$ $\left.\mathbf{N}^{*}\right)$, 即 $2^{r} \leq n \leq 2^{r+1}-1\left(r \in \mathbf{N}^{*}\right)$. 又 $n$ 为偶数, 所以 $2^{r} \leq n \leq 2^{r+1}-2\left(r \in \mathbf{N}^{*}\right)$.

对 $r$ 归纳 (分批归纳法). 当 $r=1$ 时, $n=2$, 此时 $3 D(2)=6=2 S(2)$, 结论 $(* *)$ 成立.
设结论 (**) 对正整数 $r$ 成立, 考察 $r+1$ 的情形, 此时 $2^{r+1} \leq n \leq 2^{r+2}-2$.若 $n \equiv 0(\bmod 4)$, 则 $\frac{n}{2}$ 为偶数, $2^{r} \leq \frac{n}{2} \leq 2^{r+1}-2$, 此时

$$
\begin{aligned}
D(n)= & {[d(1)+d(3)+\cdots+d(n-1)] } \\
& +[d(2)+d(4)+\cdots+d(n)] \\
= & {[1+3+\cdots+(n-1)]+\left[d(1)+d(2)+\cdots+d\left(\frac{n}{2}\right)\right] } \\
= & \left(\frac{n}{2}\right)^{2}+D\left(\frac{n}{2}\right) \leq\left(\frac{n}{2}\right)^{2}+\frac{\frac{n}{2} \cdot\left(\frac{n}{2}+1\right)}{3} \quad(\text { 归纳假设) } \\
= & \frac{n^{2}}{4}+\frac{n^{2}+2 n}{12}=\frac{4 n^{2}+2 n}{12}<\frac{4 n^{2}+4 n}{12}=\frac{n(n+1)}{3}=\frac{2 S(n)}{3},
\end{aligned}
$$

结论成立.

若 $n \equiv 2(\bmod 4)$, 则 $\frac{n}{2}$ 为奇数, $\frac{n-2}{2}$ 为偶数, $2^{r} \leq \frac{n-2}{2} \leq 2^{r+1}-2$, 此时

$$
\begin{aligned}
D(n)= & d(1)+d(3)+\cdots+d(n-1)] \\
& +[d(2)+d(4)+\cdots+d(n-2)]+d(n) \\
= & {[1+3+\cdots+(n-1)]+\left[d(1)+d(2)+\cdots+d\left(\frac{n-2}{2}\right)\right]+\frac{n}{2} } \\
= & \left(\frac{n}{2}\right)^{2}+\frac{n}{2}+D\left(\frac{n-2}{2}\right) \leq\left(\frac{n}{2}\right)^{2}+\frac{n}{2}+\frac{\frac{n}{2} \cdot\left(\frac{n}{2}\right)}{3} \text { (归纳假设) } \\
= & \frac{n^{2}}{4}+\frac{n}{2}+\frac{n^{2}-2 n}{12}=\frac{4 n^{2}+4 n}{12}=\frac{n(n+1)}{3}=\frac{2 S(n)}{3},
\end{aligned}
$$

结论成立.

所以任何正偶数 $n$ 都不是强数, 这与 $(*)$ 式矛盾, 从而引理 3 获证.

最后证明: 所有“中数”构成序列 $a_{n}$, 其中

$$
a_{1}=2, a_{n}=2 a_{n-1}+2 \text {. }
$$

一方面, 由引理 2 可知, 数列 $a_{n}$ 中的数都是中数.

另一方面, 我们证明所有中数都在上述数列 $a_{n}$ 中.

实际上, 假定 $x$ 是中数, 则由引理 $1, x$ 是偶数.

若 $x>2$, 令 $x_{1}=\frac{x-2}{2}$, 则 $x=2 x_{1}+2$. 由引理 $3, x_{1}$ 是正偶数, 再由引理 2 , $x_{1}$ 是中数.

一般地, 若 $x_{i}$ 为中数, 且 $x_{i}>2$, 则令 $x_{i+1}=\frac{x_{i}-2}{2}$, 由此得到一个递减的正整数序列:

$$
x_{1}>x_{2}>\cdots>x_{i}>\cdots,
$$

其中 $x_{1}, x_{2}, \cdots, x_{i}$ 都是中数.

由于序列不能无穷递降, 从而必定到某个时刻, 有 $x_{i}=2$, 从而 $x$ 是数列 $a_{n}$
中的一个项.

容易知道, 数列 $a_{n}$ 的通项为:

$$
a_{n}=2_{n+1}-2\left(n \in \mathbf{N}^{*}\right) .
$$

实际上,

$$
a_{n}+2=2 a_{n-1}+4=2\left(a_{n-1}+2\right)=2^{2}\left(a_{n-2}+2\right)=\cdots=2^{n-1}\left(a_{1}+2\right)=2^{n+1} .
$$

所以, $a_{n}=2^{n+1}-2$.

故所有中数为 $a_{n}=2^{n+1}-2\left(n \in \mathbf{N}^{*}\right)$.

又上面已经证明, 任何正偶数 $n$ 都不是强数, 于是, 集合

$$
A=\left\{x \text { 为正偶数 } \mid x \neq 2^{n+1}-2\left(n \in \mathbf{N}^{*}\right)\right\} \text {. }
$$

中的数都是弱数.

剩下的问题是, 哪些奇数是强数? 哪些奇数是弱数?

我们猜想: 所有正奇数 $2 n+1$ 都是强数, 即对任何自然数 $n$, 有

$$
3 D(2 n+1)>2 S(2 n+1) .
$$

我们曾将这一结论作为新星夏令营的一个练习, 后来收到十余份正确的解答. 其中以王瑞、彭任锋等的证明最为简单. 这里, 我们综合这些解答, 给出该结论证明的一个思路分析.

首先, $n=0$ 时不等式显然成立, 从而只需证明不等式对任何正整数 $n$ 成立.

此外, 由引理 1 可知, $2 n+1$ 不是中数, 从而只需证明对任何正整数 $n$, 有

$$
3 D(2 n+1) \geq 2 S(2 n+1)=(2 n+1)(2 n+2) .
$$

再注意到

$$
D(2 n+1)=D(2 n)+d(2 n+1)=D(2 n)+2 n+1,
$$

不等式又化为

$$
3 D(2 n) \geq(2 n+1)(2 n+2)-3(2 n+1)=(2 n)^{2}-1
$$

找一个充分条件, 我们证明对任何正整数 $n$, 有

$$
3 D(n)+1 \geq n^{2}
$$

对 $n$ 归纳. 当 $n=1$ 时结论显然成立. 设结论对小于 $n$ 的正整数成立, 考虑 $n$ 的情形.

(1) 若 $n$ 为奇数, 则 $d(n)=n$, 由归纳假设, 有

$$
3 D(n)+1=3 D(n-1)+1+3 d(n) \geq(n-1)^{2}+3 n=n^{2}+n+1>n^{2},
$$

结论成立.

(2) 若 $n$ 为偶数, 则由归纳假设, 有

$$
\begin{aligned}
3 D(n)+1= & 3[d(1)+d(3)+\cdots+d(n-1)] \\
& +3[d(2)+d(4)+\cdots+d(n)]+1 \\
= & 3[1+3+\cdots+(n-1)]+3\left[d(1)+d(2)+\cdots+d\left(\frac{n}{2}\right)\right]+1 \\
= & 3\left(\frac{n}{2}\right)^{2}+3 D\left(\frac{n}{2}\right)+1 \geq 3\left(\frac{n}{2}\right)^{2}+\left(\frac{n}{2}\right)^{2}=n^{2},
\end{aligned}
$$

结论成立.

综上所述, 所有中数为 $2^{n+1}-2\left(n \in \mathbf{N}^{*}\right)$, 所有弱数为除 $2^{n+1}-2\left(n \in \mathbf{N}^{*}\right)$外的偶数, 而一切奇数都是强数.

## 4. 分批归纳

按照一定的规则, 将全体自然数分成若干类, 然后对自然数一类一类地归纳,我们称之为分批归纳. 分批归纳的表现形式是对组的序号进行归纳: 设 $n$ 在第 $i$个类时命题成立, 然后证明 $n$ 在第 $i+1$ 个类时命题也成立.

分批归纳的一种常见形式是利用一个无穷序列 $a_{r}$, 将全体自然数分成若干类, 其中第 $r$ 类的自然数满足: $a_{r} \leq n<a_{r+1}$, 我们称这样的无穷序列 $a_{r}$ 为全体自然数的划分序列.

例 4. 有 $n$ 个人围成一圈召开圆桌会议, 其中 $n$ 是给定的大于 1 的整数, 会议间隙, 服务员向与会人员销售 50 元一张的午餐券. 假定其中恰好有 $r(1 \leq r<n)$个人手中持有 100 元币, 其余的人手中都是持有 50 元币, 而服务员在销售午餐券时自己没有带钱. 如果不管 $n$ 个人在圆桌旁如何排列, 服务员都可从某个人开始,依任一方向绕圆桌一周 (包括顺时钟和逆时钟方向) 销售午餐券, 使 $n$ 个人都购买上午餐券而不会出现找补困难的情况, 求 $r$ 的最大值. (原创题)

分析与证明: 将持有 50 元币的人记为 1 , 持有 100 元币的人记为 -1 , 则问题等价于 $n$ 个数排列成一个圆圈, 其中恰好有 $r$ 个 -1 , 其余都为 1 . 不管 $n$ 个数在圆周上如何排列, 都能从某个数开始, 依任一方向绕圆一周依次将各个数相加,使任何时刻得到的和 $S_{i}(i=1,2, \cdots, n)$, 都不是负数, 求 $r$ 的最大值.

研究特例, 当 $n=2$ 时, 显然 $r_{\text {max }}=1$, 此时从 1 开始求和即可.
当 $n=3$ 时, 如果 $r=2$, 则圆排列只有唯一方式, 为 $(1,-1,-1)$, 此时 $S_{2}=1-2=-1<0$, 不合要求, 所以 $r \leq 1$. 当 $r=1$, 则圆排列只有唯一方式,为 $(1,1,-1)$, 此时从任意一个 1 开始求和, 有 $S_{i} \geq 0(i=1,2,3)$, 合乎要求, 所以 $r_{\max }=1$.

当 $n=4$ 时, 如果 $r=2$, 则当圆排列为 $(1,1,-1,-1)$ 时, 此时有一个方向的 $S_{2}=-1<0$, 不合要求, 所以 $r \leq 1$. 当 $r=1$, 则圆排列为 $(1,1,1,-1)$, 此时从任意一个 1 开始求和, 有 $S_{i} \geq 0(i=1,2,3)$, 合乎要求, 所以 $r_{\text {max }}=1$.

当 $n=5$ 时, 如果 $r=3$, 则 $S_{5}=2-3=-1<0$, 不合要求, 所以 $r \leq 2$. 当 $r=2$, 圆排列有两种情况, 为 $(1,1,1,-1,-1)$ 或 $(1,1,-1,1,-1)$. 此时从任意一个 1 开始求和, 都有 $S_{i} \geq 0(i=1,2, \cdots, 5)$, 合乎要求, 所以 $r_{\text {max }}=2$.

归纳上述情况, 我们猜想 $r_{\text {max }}=\left[\frac{n+1}{3}\right]$.

为叙述问题方便, 我们给出如下定义: 如果圆周上 $n$ 个数, 其中至多 $k$ 个为 -1 , 其余都为 1 , 可以从某一个 1 开始依任一方向绕圆一周依次将各个数相加, 使使任何时刻得到的和 $S_{i}(i=1,2, \cdots, n)$ 都非负, 则称圆周上这个 1 所在的位置为“好点”。

为方便计算高斯函数值, 我们取划分序列： $\{3 k-1\}$, 限定 $3 k-1 \leq n<$ $3(k+1)-1$, 即 $3 k-1 \leq n \leq 3 k+1$. 只需证明: 当 $3 k-1 \leq n \leq 3 k+1$ 时, $r_{\max }=k$.

首先证明，当 $3 k-1 \leq n \leq 3 k+1$ 时， $r \leq k$.

实际上, 反设 $r \geq k+1$, 因为 $3 k-1 \leq n \leq 3 k+1$, 则圆周上 1 的个数为

$$
n-r \leq 3 k+1-(k+1)=2 k \text {. }
$$

在圆周上将所有 1 排在一起, 所有 -1 排在一起, 则对任何一个 1 , 它的两侧中至少有一侧不多于 $k$ (包括本身)个 1 , 于是, 从它开始向不多于 $k$ 个 1 的方向依次求和, 则当加到最后一个 -1 时,

$$
S \leq k-(k+1)=-1<0 .
$$

于是, 从任何一个 1 所在的位置都不是好点, 而-1 所在的位置都不是好点, 矛盾.所以 $r \leq k$.

其次证明, 当 $3 k-1 \leq n \leq 3 k+1$ 时, $r=k$ 合乎要求.

对 $k$ 归纳. 当 $k=1$ 时, 由前面的结果可知, 结论成立.

当 $k=2$ 时, 圆周上 $5 \leq n \leq 7$ 个点, 其中 $n-2$ 个为 1,2 个为 -1 , 我们考虑如何利用 $k=1$ 的情形.
需要去掉 3 个点, 使剩下 5 个点中只有一个 -1 , 从而去掉的 3 点中要有一个为 -1 .

任取一个 - 1 , 另外再“任意” (以后优化)去掉 2 个 1 , 将这 3 个点一齐去掉, 在剩下的 5 个点中有一个 -1 , 因而一定有好点, 记为 $P$.

现将取出的 3 个点放回原处, 我们期望 $P$ 仍是好点. 从反面考虑, 在什么情况下 $P$ 不是好点?

当 $P$ 按某一方向运动到去掉的 -1 时, 当时的“和” $S \leq 0$, 与 -1 相加后得到负数.

如何使上述情况不出现?一优化假设: 当取定一个去掉的 -1 时, 另外去掉的 2 个 1 是该 -1 两侧与它距离最近的两个 1 .

这样, 因为 $P$ 不是与所取出的 -1 距离最近的点, 因而从 $P$ 出发依圆周任一方向前进时, 必先遇到添回的 +1 , 然后再遇到添回的 -1 , 故 $P$ 仍是好点.

设结论对 $k$ 成立, 即圆周上 $n$ 个数 $(3 k-1 \leq n \leq 3 k+1)$, 其中至多 $k$ 个为 -1 , 其余都为 1 , 则圆周上必定存在好点.

考虑 $k+1$ 的情形, 此时圆周上 $n$ 个数 $(3 k+2 \leq n \leq 3 k+4)$, 其中至多 $k+1$个为 -1 , 其余都为 1 .

现在需要去掉 3 个数, 使剩下 $n-3$ 个数中至多有 $k$ 个 -1 , 从而去掉的 3 个数中要有一个为 -1 , 另 2 个为 1 .

任意去掉一个 -1 , 在该 -1 两侧分别取一个与它距离最近的 1 , 去掉该 -1 和这两个 1 , 则剩下的剩下 $n-3$ 个数中至多有 $k$ 个 -1 , 注意到 $3 k-1 \leq n-3 \leq 3 k+1$,由归纳假设, 一定有好点, 记为 $P$.

现将去掉的 3 个点放回原处, 因为 $P$ 不是与所去掉的 -1 距离最近的点, 因而从 $P$ 出发依圆周任一方求和时, 必先加上添回的 +1 , 然后再加上添回的 -1 , 从而其仍然永远非负, 所以 $P$ 仍是好点. 这说明, $n=k+1$ 时命题成立.

综上所述, $r_{\max }=\left[\frac{n+1}{3}\right]$.

## 5. 容量参数

集合中的元素个数称为该集合的容量, 将某个集合的容量用一个参数表示,我们称该参数为容量参数.

引入容量参数, 可使那些类似于 “至多有 ...", “至少有 ..." 等一些范围估计得到精确的表示, 且方便参与相关运算. 此外, 引入容量参数, 还可使含有一些不确定因素的有关对象相对确定.
例 5. 在凸 $n$ 边形的顶点处放置一些火柴, 每次操作允许将某个顶点处移动两根火柴, 分别放到它两侧相邻顶点处各一根. 求证: 如果若干次移动后, 各顶点处的火柴数恢复到和原来一样, 那么操作的次数为 $n$ 的倍数. (第 20 届全俄数学奥林匹克试题)

分析与证明: 设凸 $n$ 边形的各顶点依次为 $A_{1}, A_{2}, \cdots, A_{n}$. 本题有一个陷阱: 按通常的想法, 可设最初的状态为 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 其中 $a_{i}$ 是顶点 $A_{i}$ 处的火柴根数 $(1 \leq i \leq n)$. 然后模拟操作, 假定某次操作是顶点 $A_{i}$ 处的火柴挪动 2 根到顶点 $A_{i-1}, A_{i+1}$ 处各一根, 则称该次操作是对顶点 $A_{i}$ 进行的, 其操作可以表示为

$\left(a_{1}, a_{2}, \cdots, a_{n}\right) \rightarrow\left(a_{1}, a_{2}, \cdots, a_{i}-2, a_{i}-1+1, a_{i}-2, a_{i}+1+1, a_{i}+2, \cdots, a_{n}\right)$.

但由于每次操作对哪个顶点操作并不确定, 上述操作过程无法再模拟下去,更难以发现操作状态的通式.

造成上述解题困难的原因, 是我们没有真正把握好解题目标. 因为我们并不需要知道操作的各个状态, 而只要确定最终的状态与初始状态完全一致时操作次数的特征: 为 $n$ 的倍数. 因此, 我们的容量参数的引入, 要与操作次数密切相关.显然, 光凭顶点处火柴的根数, 时无法建立其与操作次数的联系的. 于是, 我们改变策略, 将容量参数由原来的“顶点处火柴的根数”改变为“顶点处操作的次数”:设操作结束时, 顶点 $A_{i}$ 处进行了 $a_{i}$ 次操作 $(i=1,2, \cdots, n)$, 那么, 操作的总次数为

$$
S=a_{1}+a_{2}+\cdots+a_{n} .
$$

显然, 操作结束后顶点 $A_{i}$ 处的火柴减少 $2 a_{i}$ 根, 增加 $a_{i-1}+a_{i+1}$, 其火柴增量为 $a_{i-1}+a_{i+1}-2 a_{i}$, 其中 $a_{i}$ 的下标均按模 $n$ 理解.

依题意, $A_{i}$ 处火柴数不变, 所以 $2 a_{i}=a_{i-1}+a_{i+1}(1 \leq i \leq n)$.

为证明 $S=a_{1}+a_{2}+\cdots+a_{n}$ 为 $n$ 的倍数, 我们还需要发掘 $a_{1}, a_{2}, \cdots, a_{n}$ 的特征.

研究方程 $2 a_{i}=a_{i-1}+a_{i+1}$ 的直观意义. 由此你能看出点什么(关于大小的信息)?

由方程可知, $a_{i-1}, a_{i}, a_{i+1}(1 \leq i \leq n)$ 成等差数列, 而等差数列是单调的, 不妨设 $a_{1} \leq a_{2} \leq a_{3}$. 进而由 $a_{4}-a_{3}=a_{3}-a_{2}$, 有 $a_{2} \leq a_{3} \leq a_{4}$, 如此下去, 有

$$
a_{1} \leq a_{2} \leq a_{3} \leq \cdots \leq a_{n-1} \leq a_{n} \leq a_{1}
$$

所以不等式等号成立, 即 $a_{1}=a_{2}=\cdots=a_{n}$.

故操作的总次数 $S=a_{1}+a_{2}+\cdots+a_{n}=n a_{1}$ 为 $n$ 的倍数, 命题获证.

在上海新星夏令营中, 学员林道哲给出了该题的一个巧妙解答, 其关键是引入的容量参数不仅仅是顶点处火柴的根数, 而是一种复合参数, 从而方便建立参数与操作次数的联系.

对于状态 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)$, 其中 $a_{i}$ 表示顶点 $A_{i}$ 处火柴的根数. 我们设法定义状态的一个特征值:

$$
S=f\left(a_{1}, a_{2}, \cdots, a_{n}\right)
$$

使其满足: 每次操作中 $S$ 的增量 $\triangle S$ 在模 $n$ 的意义上是一个不为 0 的常数 $c$. 这样, 操作 $t$ 次以后, $S$ 的增量的和为 $t c(\bmod n)$.

如果状态又回到原来的形式, 那么 $t c \equiv 0(\bmod n)$. 只要选取 $f$, 使 $(n, c)=1$,便有 $n \mid t$, 结论获证.

现在我们考虑选择怎样的 $f$ 才能满足上述要求.

如果简单地取 $f$ 为各顶点处火柴数的总和:

$$
S=f\left(a_{1}, a_{2}, \cdots, a_{n}\right)=a_{1}+a_{2}+\cdots+a_{n}
$$

则它显然不合乎要求, 因为 $S$ 在操作中增量为 0 , 不能建立其与操作次数的联系.

为了使 $S$ 在操作中的增量不为 0 , 想象对每一根火柴定义一个权重, 不妨设第 $\mathrm{i}$ 个顶点处的权重为 $x_{i}$, 令

$$
S=f\left(a_{1}, a_{2}, \cdots, a_{n}\right)=a_{1} x_{1}+a_{2} x_{2}+\cdots+a_{n} x_{n}
$$

那么, 对第 $i$ 个顶点操作一次, 状态的特征值 $S$ 的改变量为

$$
\triangle S \equiv x_{i-1}+x_{i+1}-2 x_{i}(\bmod n) .
$$

现在考虑取怎样的 $x_{1}, x_{2}, \cdots, x_{n}$, 能存在常数 $c$, 使对任何 $1 \leq i \leq n$, 有

$$
\triangle S \equiv x_{i-1}+x_{i+1}-2 x_{i} \equiv c(\bmod n) .
$$

从简单入手, 尝试取 $x_{i}$ 为关于 $i$ 的多项式, 则易知, 一次多项式使 $\triangle S$ 为 0 ,不合要求, 而二次多项式都合符要求. 于是, 取 $x_{i}$ 为关于 $i$ 的最简二次多项式: $x_{i}=i^{2}$, 即令

$$
S=f\left(a_{1}, a_{2}, \cdots, a_{n}\right)=a_{1} \cdot 1^{2}+a_{2} \cdot 2^{2}+\cdots+a_{n} \cdot n^{2}
$$

其中 $a_{i}$ 表示顶点 $A_{i}$ 处火柴的根数.
考察任意一次操作, 不妨设是将顶点 $A_{i}$ 处的火柴移动到两侧, 有以下情况:

若 $2 \leq i \leq n$, 则 $\triangle S=(i-1)^{2}+(i+1)^{2}-2 i^{2}=2$;

若 $i=1$, 则 $\triangle S=n^{2}+2^{2}-2 \cdot 1^{2}=n^{2}+2$;

若 $i=n$, 则 $\triangle S=(n-1)^{2}+1^{2}-2 n^{2}=2-2 n+n^{2}$.

这样, 当 $n$ 为奇数时, 因为

$$
2 \equiv n^{2}+2 \equiv 2-2 n+n^{2}(\bmod n)
$$

所以不论哪种情况, 都有 $\triangle S \equiv 2(\bmod n)$. 假定操作 $t$ 次后又回到初始状态, 则有 $2 t \equiv 0(\bmod n)$, 所以 $n \mid 2 t$. 又 $(n, 2)=1$, 所以 $n \mid t$, 结论成立.

当 $n$ 为偶数时, $2 n \mid n^{2}$. 此时因为

$$
2 \equiv n^{2}+2 \equiv 2-2 n+n^{2}(\bmod 2 n)
$$

所以不论哪种情况, 都有 $\triangle S \equiv 2(\bmod 2 n)$. 假定操作 $t$ 次后又回到初始状态, 则有 $2 t \equiv 0(\bmod 2 n)$, 所以 $2 n \mid 2 t$, 即 $n \mid t$, 结论成立.

综上所述, 命题获证.

最后, 借此机会, 我们纠正一下新星夏令营《组合问题选讲》中例 20 的一个打印错误, 正确的题目为:

设 $a_{1}=1, a_{2}=4, a_{n+1}=2 a_{n}-a_{n-1}+\frac{1}{n}\left(a_{n}-a_{n-1}+1\right)$, 对给定的正整数 $p$,令

$$
d_{n}=\left(a_{n}+p, a_{n+1}+p\right),
$$

求证: $\left\{d_{n}\right\}$ 是周期数列, 并求出 $d_{n}$ 的所有可能取值.

