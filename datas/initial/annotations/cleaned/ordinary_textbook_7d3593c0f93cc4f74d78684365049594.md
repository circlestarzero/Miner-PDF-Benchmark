# 一道伊朗不等式的最佳上界 

廖昱博<br>(中国人民大学附属中学, 100080)<br>指导教师: 张端阳

1999 年伊朗第三轮有如下不等式问题:

问题 设实数 $x_{1}, x_{2}, \cdots, x_{n} \in[-1,1]$, 满足 $x_{1}+x_{2}+\cdots+x_{n}=0$. 求证:

(1) 存在 $\sigma:\{1,2, \cdots, n\} \rightarrow\{1,2, \cdots, n\}$, 使得对任意 $1 \leq i \leq j \leq n$, 均有

$$
\left|x_{\sigma(i)}+x_{\sigma(i+1)}+\cdots+x_{\sigma(j)}\right|<2-\frac{1}{n} .
$$

(2)（1）中的上界不能改为 $2-\frac{4}{n}$.

这道题形式简洁自然, 放在今天仍有一定的难度. 本文给出最佳的上界, 即

定理 给定正整数 $n$. 设实数 $x_{1}, x_{2}, \cdots, x_{n} \in[-1,1]$, 满足 $x_{1}+x_{2}+\cdots+x_{n}=$ 0 . 若存在 $x_{1}, x_{2}, \cdots, x_{n}$ 的一个排列 $y_{1}, y_{2}, \cdots, y_{n}$, 满足对任意 $1 \leq i \leq j \leq n$,均有 $\left|y_{i}+y_{i+1}+\cdots+y_{j}\right| \leq \lambda$, 则 $\lambda$ 的最小值为 $\lambda_{n}$, 其中

$$
\lambda_{n}= \begin{cases}2-\frac{4}{n+1}, & n \text { 是奇数, } \\ 2-\frac{4}{n}, & n \text { 是大于 } 2 \text { 的偶数, } \\ 1, & n=2 .\end{cases}
$$

证明 当 $n=1$ 时, 显然 $\lambda$ 的最小值为 0 .

当 $n=2$ 时, 显然 $\lambda=1$ 时不等式成立. 又当 $x_{1}=-1, x_{2}=1$ 时, $\lambda \geq 1$, 所以 $\lambda$ 的最小值为 1 .

下设 $n \geq 3$.

（一）构造.

当 $n$ 是奇数时, 取 $\frac{n-1}{2}$ 个 $1 、 \frac{n+1}{2}$ 个 $-\frac{n-1}{n+1}$. 则要么存在 $i(1 \leq i \leq n-1)$

修订日期: 2022-05-25.
使 $y_{i}=y_{i+1}=-\frac{n-1}{n+1}$ (此时 $\left.\left|y_{i}+y_{i+1}\right|=2-\frac{4}{n+1}\right)$, 要么 $y_{1}=y_{n}=-\frac{n-1}{n+1}$ (此时 $\left.\left|y_{2}+\cdots+y_{n-1}\right|=2-\frac{4}{n+1}\right)$.

当 $n$ 是偶数时, 取 $\frac{n-2}{2}$ 个 $1 、 \frac{n}{2}$ 个 $-\frac{n-2}{n}$ 和 1 个 0 . 则忽略这个 0 时与 $n$ 是奇数时相同, 添回 0 后不改变相邻若干项的和.

## (二) 证明.

对 $n$ 归纳.

当 $n=1,2$ 时已证. 假设 $n-1$ 时成立, 来看 $n$ 时的情形.

(1) 若存在 $x_{i} \geq 0, x_{j}<0$, 使得 $x_{i}-x_{j} \leq \lambda_{n}$, 则将 $x_{i}$ 与 $x_{j}$ 合并为 $x_{i}+x_{j}$.由归纳假设（这时 $x_{i}+x_{j} \in[-1,1]$ ），得到排列 $z_{1}, z_{2}, \cdots, z_{n-1}$, 满足对任意 $1 \leq u \leq v \leq n-1$, 有 $\left|z_{u}+\cdots+z_{v}\right| \leq \lambda_{n-1} \leq \lambda_{n}$.

记 $S_{w}=z_{1}+\cdots+z_{w}$, 其中 $S_{0}=0$. 则对任意 $0 \leq u \leq v \leq n-1$, 有 $\left|S_{v}-S_{u}\right| \leq \lambda_{n}$, 于是 $S_{0}, \cdots, S_{n-1}$ 包含在一段长为 $\lambda_{n}$ 的区间 $I$ 中.

设 $z_{k}=x_{i}+x_{j}$, 考察如下两个排列:

$$
\begin{aligned}
& z_{1}, \cdots, z_{k-1}, x_{i}, x_{j}, z_{k+1}, \cdots, z_{n} \\
& z_{1}, \cdots, z_{k-1}, x_{j}, x_{i}, z_{k+1}, \cdots, z_{n} .
\end{aligned}
$$

前者对应的部分和为

$$
S_{0}, S_{1}, \cdots, S_{k-1}, S_{k-1}+x_{i}, S_{k}, S_{k+1}, \cdots, S_{n-1}
$$

后者对应的部分和为

$$
S_{0}, S_{1}, \cdots, S_{k-1}, S_{k-1}+x_{j}, S_{k}, S_{k+1}, \cdots, S_{n-1}
$$

因为 $x_{i} \geq 0, x_{j}<0, x_{i}-x_{j} \leq \lambda_{n}$ 、I 的长度为 $\lambda_{n}$ 且 $S_{k-1} \in I$, 所以 $S_{k-1}+$ $x_{i}, S_{k-1}+x_{j}$ 中必有一个属于 $I$, 对应的排列合题.

(2) 若对任意 $x_{i} \geq 0, x_{j}<0$ 均有 $x_{i}-x_{j}>\lambda_{n}$.

(i) 若 $n$ 是偶数, 记 $n=2 m$, 则 $m \geq 2, \lambda_{n}=2-\frac{2}{m}$.

对任意 $x_{i} \geq 0, x_{j}<0$, 由 $x_{i}-x_{j}>\lambda_{n}$ 知

$$
x_{i}>\lambda_{n}-1=1-\frac{2}{m}, \quad x_{j}<1-\lambda_{n}=-1+\frac{2}{m},
$$

进而 $-\frac{2}{m}<x_{i}+x_{j}<\frac{2}{m}$.

由对称性, 不妨设 $x_{1}, \cdots, x_{n}$ 中正数的个数 $t \geq m$.

情形 1: 若 $t \geq m+2$, 则

$$
0=x_{1}+\cdots+x_{n}>(m+2)\left(1-\frac{2}{m}\right)+(m-2)(-1)=2-\frac{4}{m},
$$

矛盾!
情形 2 : 若 $t=m+1$, 考虑如下排列:



对于任意一个连续段, 设其中有 $a$ 个正数、 $b$ 个负数, 则 $a-b \in\{-1,0,1,2\}$.

若 $a-b=-1$, 则只能在前一半或后一半, 于是 $a \leq\left\lceil\frac{m-1}{2}\right\rceil-1 \leq \frac{m-2}{2}$. 所以

$\mid$ 和 $|\leq| a$ 个“正负对”之和 $|+|$ 一个负数 $\left\lvert\, \leq \frac{m-2}{2} \cdot \frac{2}{m}+1=2-\frac{2}{m}\right.$.

若 $a-b=0$, 则因为 $b \leq m-1$, 所以

$$
\mid \text { 和 }|=| b \text { 个“正负对”之和 } \left\lvert\, \leq(m-1) \cdot \frac{2}{m}=2-\frac{2}{m}\right. \text {. }
$$

若 $a-b=1$, 则因为 $b \leq m-1$, 所以

$$
\text { 和 } \geq b \text { 个“正负对”之和 } \geq(m-1)\left(-\frac{2}{m}\right)=-2+\frac{2}{m} \text {. }
$$

注意到该连续段的补中正数也比负数多 1 个, 所以同理可知其和也不小于 $-2+\frac{2}{m}$, 故该连续段的和不大于 $2-\frac{2}{m}$.

若 $a-b=2$, 则将 $a-b=0$ 时的情形取补即可.

综上, 情形 2 证毕.

情形 3: 若 $t=m$, 考虑如下排列:

$$
\underbrace{\text { 正负正负 } \cdots \text { 正负. }}_{m \text { 对 }}
$$

对于任意一个连续段, 设其中有 $a$ 个正数、 $b$ 个负数, 则 $a-b \in\{-1,0,1\}$.

若 $a-b=0$, 当 $a=m$ 时, 和 $=0$; 当 $a \leq m-1$ 时,

$$
\mid \text { 和 }|=| a \text { 个“正负对”之和 } \left\lvert\, \leq(m-1) \cdot \frac{2}{m}=2-\frac{2}{m}\right. \text {. }
$$

若 $a-b= \pm 1$, 则考虑取补知可不妨设 $\min \{a, b\} \leq \frac{m-1}{2}$. 再不妨设 $a-b=1$,则 $b \leq \frac{m-1}{2}$.

若 $b \leq \frac{m-2}{2}$, 则

$\mid$ 和 $|\leq| b$ 个 “正负对”之和 $|+|$ 一个正数 $\left\lvert\, \leq \frac{m-2}{2} \cdot \frac{2}{m}+1=2-\frac{2}{m}\right.$.

若 $b=\frac{m-1}{2}$, 则

$$
\begin{aligned}
\mid \text { 和 } \mid & \left.=\frac{1}{2} \right\rvert\, \text { 和 }- \text { 补的和 } \mid \\
& =\frac{1}{2} \left\lvert\, \frac{m+1}{2}\right. \text { 个“正减负” }+\frac{m-1}{2} \text { 个“负减正” } \mid \\
& \leq \frac{1}{2}\left|\frac{m+1}{2} \cdot 2-\frac{m-1}{2}\left(2-\frac{2}{m}\right)\right| \\
& =\frac{3}{2}-\frac{1}{2 m} \leq 2-\frac{2}{m},
\end{aligned}
$$

其中最后一步是因为此时 $m$ 是奇数.

综上, 情形 3 证毕.

(ii) 若 $n$ 是奇数, 记 $n=2 m+1$, 则 $\lambda_{n}=2-\frac{2}{m+1}$.

由 $x_{i}-x_{j}>\lambda_{n}$ 知

$$
x_{i}>\lambda_{n}-1=1-\frac{2}{m+1}, \quad x_{j}<1-\lambda_{n}=-1+\frac{2}{m+1},
$$

进而 $-\frac{2}{m+1}<x_{i}+x_{j}<\frac{2}{m+1}$.

由对称性, 不妨设 $x_{1}, \cdots, x_{n}$ 中正数的个数 $t \geq m+1$.

若 $t \geq m+2$, 则

$$
0=x_{1}+\cdots+x_{n}>(m+2)\left(1-\frac{2}{m+1}\right)+(m-1)(-1)=1-\frac{2}{m+1},
$$

矛盾! 因此 $t=m+1$.

考虑如下排列:

$$
\underbrace{\text { 正负正负 } \cdots \text { 正负 }}_{m \text { 对 }} \text { 正, }
$$

记为 $y_{1}, y_{2}, \cdots, y_{2 m+1}$, 其中

$$
\begin{gathered}
y_{1} \leq y_{3} \leq \cdots \leq y_{2\left[\frac{m}{2}\right]+1}, \quad y_{2 m+1-2\left[\frac{m}{2}\right]} \geq y_{2 m+3-2\left[\frac{m}{2}\right]} \geq \cdots \geq y_{2 m+1} \\
y_{2} \leq y_{4} \leq \cdots \leq y_{2\left[\frac{m}{2}\right]}, \quad y_{2 m+2-2\left[\frac{m}{2}\right]} \geq y_{2 m+4-2\left[\frac{m}{2}\right]} \geq \cdots \geq y_{2 m}
\end{gathered}
$$

且 $y_{1}, y_{2 m+1}$ 是最小的两个正数.

考虑和的绝对值最大的一个连续段 (如有多个, 取最短的一个), 设为 $y_{i}, y_{i+1}, \cdots, y_{j}$. 设其中有 $a$ 个正数、 $b$ 个负数, 则 $a-b \in\{-1,0,1\}$.

若 $a-b=0$, 则因为 $b \leq m$, 所以

$$
\mid \text { 和 }|=| b \text { 个“正负对”之和 } \left\lvert\, \leq m \cdot \frac{2}{m+1}=2-\frac{2}{m+1}\right. \text {. }
$$

若 $a-b=1$, 则将 $a-b=0$ 时的情形取补即可.

若 $a-b=-1$ 且 $a \leq \frac{m-1}{2}$, 则

$\mid$ 和 $|\leq| a$ 个“正负对”之和 $|+|$ 一个负数 $\left\lvert\, \leq \frac{m-1}{2} \cdot \frac{2}{m+1}+1=2-\frac{2}{m+1}\right.$.

若 $a-b=-1$ 且 $a \geq \frac{m}{2}$, 则 $j-i+1=a+b \geq m+1$, 于是 $j-i \geq m$. 由 $a-b=-1$ 及排列的取法知 $i, j$ 均为偶数, 于是 $j \leq 2 m$, 进而 $i \leq j-m \leq m$,再由 $i$ 是偶数知 $i \leq 2\left[\frac{m}{2}\right]$.

记 $y_{i}+y_{i+1}+\cdots+y_{j}=S$.

若 $S \geq 0$, 则 $y_{i+1}+\cdots+y_{j}>S$, 与 $|S|$ 最大矛盾!

故 $S<0$, 由 $|S|$ 最大且最短知 $y_{i+2}+\cdots+y_{j}>S$, 于是 $y_{i}+y_{i+1}<0$. 若
$i \geq 4$, 则还有 $y_{i-2}+\cdots+y_{j} \geq S$, 于是 $y_{i-2}+y_{i-1} \geq 0$. 这与 $y_{i-2} \leq y_{i}, y_{i-1} \leq y_{i+1}$矛盾! 其中用到 $i \leq 2\left[\frac{m}{2}\right]$. 故 $i=2$, 同理 $j=2 m$. 于是

$$
\begin{aligned}
-S & =y_{1}+y_{2 m+1} \leq \frac{2}{m+1} \cdot \text { 所有正数之和 } \\
& =-\frac{2}{m+1} \cdot \text { 所有负数之和 } \\
& \leq-\frac{2}{m+1} \cdot(-m)=2-\frac{2}{m+1} .
\end{aligned}
$$

综上, 完成证明.

