$$
\text { 数学新星网 } \% \text { 冯跃峰专栏 }
$$

# 序号函数 

冯跃峰

对于离散点集问题, 一种常见的处理方式, 是对已知点适当编号, 然后借助代数手法, 发掘点集的性质.

一种常用的编号方式, 就是用相应的参数刻画点的位置, 使各点之间具有某种顺序. 我们称这样的编号为“序号”.

如果序号涉及 $k$ 个参数, 则称之为 $k$ 维序号, 记为 $\left(x_{1}, x_{2}, \cdots, x_{k}\right)$, 它类似于 $k$ 维空间中点的坐标.

此外, 代数手法也是多种多样的, 本文介绍一种行之有效的处理方式: 引入序号函数.

所谓“序号函数”, 就是对 $k$ 维序号 $\left(x_{1}, x_{2}, \cdots, x_{k}\right)$ 中的参数进行适当运算, 使每个点都对应一个数值, 记为 $f\left(x_{1}, x_{2}, \cdots, x_{k}\right)$. 然后通过对其函数值 $f\left(x_{1}, x_{2}, \cdots, x_{k}\right)$ 隐含性质或特征的发掘与研究, 找到解决问题的途径.

序号函数可以有效刻画点集特征, 从而方便我们对点集进行规划和安排. 下面举一个例子来说明.

问题 设 $X=\left\{\left(x_{1}, x_{2}, \cdots, x_{n}\right) \mid x_{1}, x_{2}, \cdots, x_{n} \in \mathbb{Z}\right\}$ 是 $n$ 维空间所有格点的集合, 对 $X$ 中任意两个格点 $A\left(x_{1}, x_{2}, \cdots, x_{n}\right), B\left(y_{1}, y_{2}, \cdots, y_{n}\right)$, 定义它们的距离为: $|A-B|=\left|x_{1}-y_{1}\right|+\left|x_{2}-y_{2}\right|+\cdots+\left|x_{n}-y_{n}\right|$.

求 $r$ 的最小值, 使得能将 $X$ 中的点 $r$-染色, 分别满足以下要求:

(1) 任何两个同色的格点 $A, B$, 满足 $|A-B| \geq 2$;

(2) 任何两个同色的格点 $A, B$, 满足 $|A-B| \geq 3$. (原创题)

【题感】从目标看, 本题属于 “存在型” 组合极值, 但条件不提供算法, 宜从等式入手: 构造一种色数尽可能少的染色, 由此猜出色数的最小值.

从规则看, 染色方法是由“距离”不等式 $|A-B| \geq 2$ 限定的. 而该不等式的反面容量远远小于正面容量 $([2,+\infty)$ 与 1 之间的显著差别 $)$, 可采用补集思考:[^0]只需适当染色, 使满足 $|A-B|=1$ 的任意两点 $A, B$ 都异色. 一这可采用局部扩展策略.

从条件看, $n$ 维空间过于抽象, 不妨从特例开始, 先考察 2 维空间的格点集合.

【研究特例】(1) 先考虑 $n=2$ 的情形.

【局部扩展】取点 $A$ 为红色, 则由条件可知, $A$ 的邻点都不是红色. 因为 $A$的任何两个邻点的距离都是 2 , 可采用最简单的构造: 将其邻点都染蓝色.

如此下去, 发现相间染色 (类似于国际象棋盘) 合乎要求.

【本质推广】现在的问题是, 在 $n$ 维空间中能否有类似的“相间染色”, 使同色点 $A, B$ 满足: $|A-B| \geq 2$ ?

“相间” 是一种几何上的位置刻画: 在特定排序中间隔一个对象. 但对于高于 3 维的空间, “相间”没有确切的含义. 我们需要一种更广泛的本质描述, 以便推广到高维空间.

由此想到棋盘中奇偶格的定义: 当 $i+j$ 为奇 (偶) 时, 称格 $a_{i j}$ 为奇 (偶) 格.

早在 1987 年 1 月, 笔者在《中等数学》上发表的“格阵”一文, 首次给出这一定义, 目的是想说明: 用格的“奇偶性”代替“黑白染色”, 具有更广泛的意义. 但当时有人由于没有看清这一点, 对其做法不以为然, 讱讽为“故意将文章写得别人看不懂"一一其实是他们不懂我的心, 我当然也就不以为意.

实际上, 格的奇偶性可以推广到任何高维空间, 也揭示了黑白相间染色的本质. 引入序号函数: 坐标分量之和, 则高维空间中相邻两点对应的函数值不同奇偶一一这也是我编拟这道题的初衰.

【序号函数】对于格点 $A\left(x_{1}, x_{2}, \cdots, x_{n}\right)$, 其所有邻点可表示为 $\left(x_{1}, x_{2}, \cdots\right.$, $\left.x_{i-1}, x_{i} \pm 1, x_{i+1}, \cdots, x_{n}\right)$. 定义 $f(A)=x_{1}+x_{2}+\cdots+x_{n}$ 为 $A$ 的特征值, 则对任何相邻两点 $A, B$, 有 $f(A), f(B)$ 不同奇偶.

这样, 将特征值为奇数的点染红色, 特征值为偶数的点染蓝色, 则染色合乎要求. 问题 (1) 迎刃而解.

【新写】(1) 首先, 因为所有点不全同色, 所以 $r \geq 2$.

其次, 当 $r=2$ 时, 对格点 $A\left(x_{1}, x_{2}, \cdots, x_{n}\right)$, 称 $f(A)=f\left(x_{1}, x_{2}, \cdots, x_{n}\right)=$ $x_{1}+x_{2}+\cdots+x_{n}$ 为 $A$ 的特征值.

因为相邻两点 (距离为 1 ) 的坐标恰有一个分量相差 1 , 其他分量都相同, 从而相邻点的特征值不同奇偶. 于是, 将特征值为奇数的点染红色, 特征值为偶数的点染蓝色, 则染色合乎要求.
实际上, 如果 $A, B$ 同色, 则由染色规则知, 它们不相邻, 从而 $|A-B| \geq 2$.综上所述, $r$ 的最小值为 2 .

下面考虑 (2), 求 $r$ 的最小值, 使任何两个同色的格点 $A, B$, 满足 $|A-B| \geq 3$.

【研究特例】先考虑 $n=2$ 的情形.

【局部扩展】取点 $A$ 为 1 色, 则由条件可知, $A$ 的邻点都不是 1 色. 而且 $A$的 4 个邻点两两异色. 否则, 设 $A$ 的两个邻点 $B, C$ 同色,但 $|B-C|=2<3$, 矛盾. 由此可见, $r \geq 5$.

如果 $r=5$, 不妨设 $A$ 的 4 个邻点分别为 $2,3,4,5$ 色, 这 5 个点形成一个以 $A$为中心的“十字架”.

如此下去, 发现染色使每个“十字架”中的点两两异色时合乎要求.

值得指出的是, 这并不是“染色方法”, 仅仅是“目标要求”, 因为它并没有告诉我们如何染色. 构造中务必注意: 不能用“目标要求”代替具体构造.

如何使每个“十字架” 中的点两两异色? 关键是引入点的序号函数: 每个点都对应一个函数值, 使每个“十字架” 的点对应函数值都属于不同类 (这当然需要函数值互异).

【以简驭繁】先尝试最简单的函数: $f(x, y)=x+y$.

因为以 $(x, y)$ 为中心的“十字架”的其他 4 个点为 $(x \pm 1, y),(x, y \pm 1)$, 但由上述定义, 有

$$
f(x+1, y)=x+y+1=f(x, y+1) \text {, }
$$

不合要求.

如何修改函数, 使 $(x+1, y)$ 与 $(x, y+1)$ 的函数值不同?一一这稍作改变,将 $y$ 的系数更改为 2 即可.

【改进函数】令 $f(x, y)=x+2 y$ 即可, 此时, 5 个特征值为:

$$
\begin{gathered}
f(x, y)=x+2 y, f(x+1, y)=x+2 y+1, f(x-1, y)=x+2 y-1, \\
f(x, y+1)=x+2 y+2, f(x, y-1)=x+2 y-2,
\end{gathered}
$$

它们构成模 5 的完系.

将特征值属于模 5 的同一个剩余类中点染同一种颜色, 可知 5 种颜色足够.从而 $r$ 的最小值为 5 .

如何推广到 $n$ 维空间?一一希望找到一个类似的“十字架”.

【发掘特征】“十字架” 的特征是 (不能迁移形状, 只能迁移特征)：一个点及其所有邻点构成的集合.
要学会用数学语言对有关形象进行描述, 它通常可一字不改地推广到高维空间。这是一种非常重要的基本功.

【特征迁移】对 $n$ 维空间, 考察任意一个点 $A$, 由 $A$ 及其所有邻点构成的集合称为一个“群”, 其中点 $A$ 为该群的中心. 注意: 邻点的邻点不能归入同一个群.

【符号刻画】对 $A \in X$, 称集合 $Q(A)=\{P \in X|| P-A \mid \leq 1\}$ 是以 $A$ 为中心的一个群.

显然, 以 $A$ 为中心的群中任何两点的距离不大于 2 , 这是因为 $P, Q$ 到 $A$ 的距离都不大于 1 .

【平凡估计】对于点 $A_{0}\left(x_{1}, x_{2}, \cdots, x_{n}\right)$, 它有 $2 n$ 个邻点: $\left(x_{1}, x_{2}, \cdots\right.$, $\left.x_{i-1}, x_{i} \pm 1, x_{i+1}, \cdots, x_{n}\right)(1 \leq i \leq 2 n)$, 若染色合乎要求, 则这 $2 n+1$ 个点两两异色, 所以 $r \geq 2 n+1$.

下面构造一种含有 $2 n+1$ 种颜色的染色, 使任何两个同色点的距离不小于 3 , 这只需将 2 维空间的序号函数迁移到 $n$ 维空间即可.

【归纳通式】将 2 维空间的序号函数 $f(x, y)=x+2 y$, 直接迁移到 $n$ 维空间, 变为 $f\left(x_{1}, x_{2}, \cdots, x_{n}\right)=x_{1}+2 x_{2}+\cdots+n x_{n}$.

【染色方案】每个“群”中所有点的特征值构成模 $2 n+1$ 的完系, 将特征值模 $2 n+1$ 同余的点染同一种颜色, 可知 $2 n+1$ 种颜色足够, 从而 $r$ 的最小值为 $2 n+1$.

【新写】(2) 对 $A \in X$, 称集合 $Q(A)=\{P \in X|| P-A \mid \leq 1\}$ 是以 $A$ 为中心的一个群. 考察以 $A_{0}\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ 为中心的群, 它的另 $2 n$ 个点为 $A_{i}\left(x_{1}, x_{2}, \cdots, x_{i-1}, x_{i}+1, x_{i+1}, \cdots, x_{n}\right), A_{n+i}\left(x_{1}, x_{2}, \cdots, x_{i-1}, x_{i}-1, x_{i+1}, \cdots, x_{n}\right)$ $(1 \leq i \leq n)$, 若染色合乎要求, 则这 $2 n+1$ 个点两两异色.

实际上, 由 $\left|A_{0}-A_{i}\right|=1<3(1 \leq i \leq 2 n)$, 知 $A_{0}$ 与 $A_{i}$ 异色: 由 $\left|A_{i}-A_{j}\right|=$ $2<3(1 \leq i<j \leq 2 n)$, 知 $A_{i}$ 与 $A_{j}$ 异色. 所以 $r \geq 2 n+1$.

当 $r=2 n+1$ 时, 对格点 $A\left(x_{1}, x_{2}, \cdots, x_{n}\right)$, 称 $f(A)=f\left(x_{1}, x_{2}, \cdots, x_{n}\right)=$ $x_{1}+2 x_{2}+\cdots+n x_{n}$ 为 $A$ 的特征值, 则以 $A$ 为中心的群中各点的特征值分别为 $f(A), f(A) \pm 1, f(A) \pm 2, \cdots, f(A) \pm n$, 它们构成模 $2 n+1$ 的完系.

将特征值模 $2 n+1$ 的余数为 $i(1 \leq i \leq 2 n+1)$ 的点染第 $i$ 种颜色, 则每一个群中没有同色点.

下面证明染色合乎要求. 实际上, 如果 $|A-B| \leq 2$, 则 $A, B$ 或者相邻, 或者同为某个点的邻点. 从而 $A, B$ 属于同一个群, 由染色规则知 $A, B$ 异色.
由此可见, 若 $A, B$ 同色, 则 $|A-B| \geq 3$, 所以 $r=2 n+1$ 合乎条件.

综上所述, $r$ 的最小值为 $2 n+1$.

遗留问题 (I) 求 $r$ 的最小值, 对任何两个同色的格点 $A, B$, 有 $|A-B| \geq 4$.

（II）我们还可进一步考虑, 求 $r$ 的最小值, 对任何两个同色的格点 $A, B$, 有 $|A-B| \geq k$ ( $k$ 是给定的大于 1 的整数).

期待大家给出好的结果, 并欢迎交流与指正!


[^0]:    修订日期: 2020-02-25.

