$$
\text { 数学新星网 } * \text { 教师专栏 }
$$

# 组合数的余数分布 

王彬

(北京工商大学数学系, 100048)

我们有时会考虑组合数 $\mathrm{C}_{n}^{k}$ 模某个数 $M$ 的余数. 这类问题的思路一般是先把 $M$ 分解质因数 $M=p_{1}^{\alpha_{1}} \cdots p_{l}^{\alpha_{l}}$, 然后分别考虑组合数 $\mathrm{C}_{n}^{k}$ 模每个素数幕 $p_{i}^{\alpha_{i}}$ 的余数, 再利用中国剩余定理计算出组合数模 $M$ 的余数.

在考虑组合数 $\mathrm{C}_{n}^{k}$ 模 $p^{\alpha}$ 的余数时, 如果是模单素数 $p$ 的话则利用 Lucas 定理可以直接得到结果. 若是模素数幂 $p^{\alpha}$ 则稍微麻烦一些, 这时一般会考虑 $n !, k !,(n-k) !$ 这三个阶乘所含的 $p$ 的方幂数, 以及它们分别除掉自己所含 $p$ 的方幂之后, 考虑剩下的部分模 $p^{\alpha}$ 的余数. 这样的问题有时需要具体分析数字 $n, k$ 与 $n-k$ 的 $p$ 进制展开的 “字符串” 的排列性质.

本文主要考虑一批组合数除以某个数 $M$ 的余数分布, 所谓分布就是说这一批余数中有多少个 1 , 多少个 $2, \cdots$ 这样的问题, 我们只关心总数, 不关心每个余数具体是哪个. (这里分布的概念和概率论中随机变量的分布概念是类似的).所谓 “一批” 组合数, 本文主要是考虑 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 这样底数相同的一组组合数. 我觉得它们比较自然, 是比较容易想到的一组组合数, 同时它们对应的母函数 $(x+y)^{n}$ 非常简洁.

对于组合数的余数分布问题, 如果是一般的模 $M$, 我觉得是比较困难的, 目前没有太好的办法. 所以本文只考虑 $M$ 是素数幂并且是很简单的素数幕的情形, 主要是考虑模 2 和模 4 的余数分布, 以及一部分模 8 的分布问题. 这也算是抛砖引玉, 希望有兴趣的同学能够继续探索.

## I. 模 2 的余数分布

我们先考虑最简单的情形: 模 2 的余数也就是奇偶性问题.

对于组合数 $\mathrm{C}_{n}^{k}$ 的奇偶性问题, 一般有两种考虑思路, 一个是放在二项式系数中看, 一个是考虑 $\mathrm{C}_{n}^{k}=\frac{n !}{k ! \times(n-k) !}$ 看分子分母中各含有多少个 2 的方幂.

收稿日期: 2017-01-01； 修订日期: 2017-03-06.
我们把一个正整数 $x$ 含有 2 的方幂数记作 $\nu_{2}(x)$. 阶乘 $n$ ! 含有多少 2 的方幂? 这等于把 $1,2, \cdots, n$ 这些数的方幂数加起来, 换个方向看就是统计有多少个 2 的倍数, 多少个 4 的倍数, $\cdots$, 把这些答案加起来 (若某个数 $k$ 的 $\nu_{2}(k)=r$,则它在前 $r$ 个答案中各贡献了 1). 所以

$$
\nu_{2}(n !)=\left\lfloor\frac{n}{2}\right\rfloor+\left\lfloor\frac{n}{4}\right\rfloor+\cdots+\left\lfloor\frac{n}{2^{k}}\right\rfloor+\cdots .
$$

为了计算这个和式, 我们一般会考虑 $n$ 的二进制展开, (因为除以 2 的操作在二进制下很容易表示, 就像十进制下把一个数除以 10 很方便). 为此我们假设: $n=c_{m} 2^{m}+c_{m-1} 2^{m-1}+\cdots+c_{1} 2^{1}+c_{0} 2^{0}=\left(c_{m} c_{m-1} \cdots c_{1} c_{0}\right)_{2}$, 其中每一位数字都是 0 或 1 , 并且记数字和 $s(n)=c_{m}+c_{m-1}+\cdots+c_{1}+c_{0}$, 这样计算 $\nu_{2}(n !)$的结果就变成了:

$$
\begin{aligned}
\nu_{2}(n !) & =\left\lfloor\frac{n}{2}\right\rfloor+\left\lfloor\frac{n}{4}\right\rfloor+\cdots+\left\lfloor\frac{n}{2^{k}}\right\rfloor+\cdots \\
& =\left(c_{m} 2^{m-1}+\cdots+c_{1} 2^{0}\right)+\left(c_{m} 2^{m-2}+\cdots+c_{2} 2^{0}\right)+\cdots+\left(c_{m} 2^{0}\right) \\
& =c_{m}\left(2^{m-1}+\cdots+2^{0}\right)+\cdots+c_{2}\left(2^{1}+2^{0}\right)+c_{1}\left(2^{0}\right)+c_{0}(0) \\
& =c_{m}\left(2^{m}-1\right)+\cdots+c_{1}(2-1)+c_{0}(1-1) \\
& =n-\left(c_{m}+\cdots+c_{1}+c_{0}\right)=n-s(n) .
\end{aligned}
$$

对于组合数 $\mathrm{C}_{n}^{k}=\frac{n !}{k ! \times(n-k) !}$ 的奇偶性问题, 需要分别考虑分子分母含有 2 的方幂数并比较大小, 分子中 $\nu_{2}(n !)=n-s(n)$, 分母中

$$
\begin{aligned}
\nu_{2}(k ! \times(n-k) !) & =\nu_{2}(k !)+\nu_{2}((n-k) !) \\
& =k-s(k)+(n-k)-s(n-k) .
\end{aligned}
$$

组合数 $\mathrm{C}_{n}^{k}$ 是奇数等价于分子分母含有 2 的方幂相等, 即 $s(k)+s(n-k)=$ $s(n)$, 这等价于做二进制加法 $k+(n-k)=n$ 时不进位. (进位次数与数字和很有关系, 十进制下做加法每进一次位数字和减少 9, 二进制下每进一次位则数字和减少 1). 这样考虑组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中有多少个奇数等价于: 非负整数 $a+b=n$ 二进制加法不进位的情况有多少种.

假设 $n$ 的二进制展开中的所有 $s(n)$ 个 1 的位置分别是 $i_{1}, i_{2}, \cdots, i_{s(n)}$, 即 $n=2^{i_{1}}+2^{i_{2}}+\cdots+2^{i_{s(n)}}$. 二进制加法不进位, 则当 $n$ 的某一数位取 0 时, $a, b$ 在该位置必须都取 0 , 当 $n$ 的某一数位取 1 时, $a, b$ 在该位置一定是一个 0 和一个 1. 这类似于把 $n$ 看成集合 $C=\left\{i_{1}, i_{2}, \cdots, i_{s(n)}\right\}$, 然后把 $C$ 进行分拆: $C=A \cup B, A \cap B=\emptyset$. 分拆方法数等于集合 $C$ 的子集个数, 即 2 的 $s(n)$ 次方.
组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中恰有 $2^{s(n)}$ 个奇数, 同时有 $n+1-2^{s(n)}$ 个偶数. 这一点也可以从二项式展开的角度来看, 即 $(x+y)^{n}$ 的展开式的系数的奇偶性问题. 多项式系数的奇偶性即是把系数模 2 来看, 把偶数看成 0 , 把奇数看成 1 , 系数的取值范围就是 $\{0,1\}$, (这时多项式被看成是有限域 $F_{2}=\{0,1\}$ 上的多项式). 这个角度的好处是可以把多项式 $(x+y)^{n}$ 表示成是若干个因子的乘积, 我们设法选取形式简洁的因子, 使得乘积的形式简明. 由于 $(x+y)^{n}$ 的因子只能是 $(x+y)^{k}$ 的形式, 接下来我们考察 $k$ 取什么值时结果形式简单. (下面式子中的同余符号是系数模 2 意义下的同余)

$$
\begin{aligned}
& (x+y)^{2}=x^{2}+2 x y+y^{2} \equiv x^{2}+y^{2} ; \\
& (x+y)^{3}=x^{3}+3 x^{2} y+3 x y^{2}+y^{3} \equiv x^{3}+x^{2} y+x y^{2}+y^{3} ; \\
& (x+y)^{4}=x^{4}+4 x^{3} y+6 x^{2} y^{2}+4 x y^{4}+y^{4} \equiv x^{4}+y^{4} ; \\
& (x+y)^{5}=(x+y)^{4}(x+y) \equiv\left(x^{4}+y^{4}\right)(x+y) \equiv x^{5}+x^{4} y+x y^{4}+y^{5} ; \\
& (x+y)^{8}=(x+y)^{4}(x+y)^{4} \equiv\left(x^{4}+y^{4}\right)\left(x^{4}+y^{4}\right)=x^{8}+2 x^{4} y^{4}+y^{8} \equiv x^{8}+y^{8} .
\end{aligned}
$$

通过观察可以看出: 在系数模 2 意义下, $(x+y)^{k}$ 的形式在次数 $k$ 是 2 的方幕时最简洁, 即 $(x+y)^{2^{m}} \equiv x^{2^{m}}+y^{2^{m}}$. 其余情形可以考虑把 $(x+y)^{n}$ 分解成几个简洁形式的乘积. 这样, 由 $n=2^{i_{1}}+2^{i_{2}}+\cdots+2^{i_{s(n)}}$, 我们有:

$$
\begin{aligned}
(x+y)^{n} & =(x+y)^{2^{i_{1}}} \times(x+y)^{2^{i_{2}}} \times \cdots \times(x+y)^{2^{i_{s(n)}}} \\
& \equiv\left(x^{2^{i_{1}}}+y^{2^{i_{1}}}\right) \times\left(x^{2^{i_{2}}}+y^{2^{i_{2}}}\right) \times \cdots \times\left(x^{2^{i_{s(n)}}}+y^{2^{i_{s(n)}}}\right)
\end{aligned}
$$

上式右端在乘法式子有 $s(n)$ 个括号, 每个括号中有两项, 乘法展开会得到 $2^{s(n)}$ 个项, 由于每一项中 $x$ 的次数都取不同的二进制数, 因而 $2^{s(n)}$ 个项的形式互不相同, 无法合并同类项. 这样展开式中一共有 $2^{s(n)}$ 个奇数系数, 即组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中恰有 $2^{s(n)}$ 个奇数.

## II. 模 4 的余数分布

我们已经讨论了组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 奇偶性的分布, 接下来考虑它们模 4 的余数分布. 这一问题相当于继续在 $2^{s(n)}$ 个奇数中区分其中有多少 $4 k+1$ 型,有多少 $4 k-1$ 型; 在 $n+1-2^{s(n)}$ 个偶数中区分其中有多少 $4 k+2$ 型, 有多少 $4 k$ 型. 为了方便叙述, 我们考虑一个具体例子, 即 $\mathrm{C}_{2012}^{0}, \mathrm{C}_{2012}^{1}, \cdots, \mathrm{C}_{2012}^{2012}$ 的模 4 余数分布.

这个例子有个小故事: 2012 年我首次参加 CGMO 命题, 本来计划出一个
题是考虑组合数 $\mathrm{C}_{2012}^{0}, \mathrm{C}_{2012}^{1}, \cdots, \mathrm{C}_{2012}^{2012}$ 模 2012 的余数的加和. 2012 分解质因数为 $2012=2^{2} \times 503$, 组合数模质数 503 的余数分布比较简单, 这个题目主要是考察模 4 的余数分布情况. 后来委员会觉得这个题目太难, 改为考虑组合数中有多少个 2012 的倍数, 这样主要是考虑 4 的倍数的个数, 难度降低很多.

## 1. 多项式系数的分析

$$
n=2012 \text { 二进制表示为: } 2012=(11111011100)_{2} \text {, 数字和 } s(n)=8 \text {, 也就是 }
$$

说组合数中有 $2^{8}=256$ 个奇数, 有 $2013-2^{8}=1757$ 个偶数. 考虑模 4 的余数分布, 就需要把奇偶性分析的方法再推进一步, 我们之前考虑多项式系数的奇偶性, 现在就需要进一步考虑多项式系数模 4 的结果, 基本思路仍然是把 $(x+y)^{n}$分成一些形式简洁的因子的乘积. 模 4 意义下哪些 $(x+y)^{k}$ 形式简单呢? 答案与之前一样, 仍是次数 $k$ 等于 2 的方幕时形式简洁. (下面式子中的同余符号是系数模 4 意义下的同余):

$$
\begin{aligned}
& (x+y)^{2}=x^{2}+2 x y+y^{2} \equiv x^{2}+y^{2} \\
& (x+y)^{4}=x^{4}+4 x^{3} y+6 x^{2} y^{2}+4 x y^{4}+y^{4} \equiv x^{4}+y^{4} \\
& (x+y)^{8} \equiv\left(x^{4}+2 x^{2} y^{2}+y^{4}\right)^{2}=\left(x^{2}+y^{2}\right)^{4} \equiv x^{8}+2 x^{4} y^{4}+y^{8} \\
& (x+y)^{16} \equiv\left(x^{4}+2 x^{2} y^{2}+y^{4}\right)^{4}=\left(x^{2}+y^{2}\right)^{8} \equiv x^{16}+2 x^{8} y^{8}+y^{16}
\end{aligned}
$$

这样一来, $(x+y)^{2^{m}} \equiv x^{2^{m}}+2 x^{2^{m-1}} y^{2^{m-1}}+y^{2^{m}}=\left(x^{2^{m-1}}+y^{2^{m-1}}\right)^{2}$,

$$
\begin{aligned}
& (x+y)^{2012} \\
= & (x+y)^{1024}(x+y)^{512}(x+y)^{256}(x+y)^{128}(x+y)^{64}(x+y)^{16}(x+y)^{8}(x+y)^{4} \\
\equiv & \left(x^{512}+y^{512}\right)^{2}\left(x^{256}+y^{256}\right)^{2}\left(x^{128}+y^{218}\right)^{2}\left(x^{64}+y^{64}\right)^{2}\left(x^{32}+y^{32}\right)^{2} \\
& \times\left(x^{8}+y^{8}\right)^{2}\left(x^{4}+y^{4}\right)^{2}\left(x^{2}+y^{2}\right)^{2} \\
= & A \times B,
\end{aligned}
$$

其中 $A=\left(x^{512}+y^{512}\right)^{2}\left(x^{256}+y^{256}\right)^{2}\left(x^{128}+y^{128}\right)^{2}\left(x^{64}+y^{64}\right)^{2}\left(x^{32}+y^{32}\right)^{2}$.

若记 $X=x^{32}, Y=y^{32}$, 则 $A=\left(X^{31}+X^{30} Y+\cdots+Y^{31}\right)^{2}, A$ 的展开式的非 0 系数分别为: $1,2,3, \cdots, 31,32,31, \cdots, 3,2,1$, 其中模 4 余 1 、模 4 余 2 、模 4 余 3 的系数各有 16 个, 其余系数全是 4 的倍数. 且 $A$ 中有效的项的 $x$ 次数与 $y$ 次数都是 32 的倍数 (有效的项指系数不是 4 的倍数或者说模 4 非 0 的项).

另一方面, $B=\left(x^{8}+y^{8}\right)^{2}\left(x^{4}+y^{4}\right)^{2}\left(x^{2}+y^{2}\right)^{2}, B$ 的展开式中非 0 系数分别为 $1,2, \cdots, 7,8,7, \cdots, 2,1$, 这些系数中模 4 余 1 、模 4 余 2 、模 4 余 3 各有 4
个, 其余系数都是 4 的倍数. 并且 $B$ 中的项的 $x$ 次数与 $y$ 次数都小于 32 , 这样当计算 $A \times B$ 时, 任意在 $A$ 和 $B$ 中各取一个有效项乘积后的结果形式都互不相同, 即不能合并同类项.

我们考虑 $(x+y)^{2012} \equiv A \times B$ 展开式的系数模 4 余数的分布, 即考虑各个有效项的乘积搭配结果:

模 4 余 1 的系数可以由 $1 \times 1$ 或 $3 \times 3$ 得到, 共 $16 \times 4+16 \times 4=128$ 项;

模 4 余 3 的系数可以由 $1 \times 3$ 或 $3 \times 1$ 得到, 共 $16 \times 4+16 \times 4=128$ 项;

模 4 余 2 的系数可以由 $1 \times 2$ 或 $3 \times 2$ 或 $2 \times 1$ 或 $2 \times 3$ 得到, 共 $16 \times 4+$ $16 \times 4+16 \times 4+16 \times 4=256$ 项;

其余二项式系数都是 4 的倍数, 共 $2013-128-128-256=1501$ 项.

以上就是组合数 $\mathrm{C}_{2012}^{0}, \mathrm{C}_{2012}^{1}, \cdots, \mathrm{C}_{2012}^{2012}$ 的模 4 余数分布. 上面的方法是把 $n$的二进制展开式中, 连续的 1 对应的因式放在一起相乘来处理. 可以看出这样做使得不同的连续的 1 的段对应的乘积因式是相互独立的 (即相乘时不会出现合并同类项), 因此只需考虑每个连续的 1 的段对应的乘积因式的形式, 或其余数分布.

一般情况下, 组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中的 $2^{s(n)}$ 个奇数, 如果 $n$ 的二进制展开式中有至少连续两个 1 , 则组合数中 $2^{s(n)}$ 个奇数是 $4 k+1$ 型与 $4 k-1$ 型各占一半, 因为上述方法得到的 “连续段乘积” 中, 至少存在一个是其中的奇数系数 $4 k+1$ 型与 $4 k-1$ 型各占一半, 因此各个 “连续段乘积” 相乘搭配后, 总体的奇数系数中也一定是两种型号各占一半; 相反如果 $n$ 的二进制展开式中没有连续两个 1 出现, 则每个 “连续段乘积” 中的奇数系数都是 $4 k+1$ 型, 这样整体相乘后的 $2^{s(n)}$ 个奇数系数全都是 $4 k+1$ 型, 没有 $4 k-1$ 型.

## 2. 二进制加法的分析

我们之前用 $\mathrm{C}_{n}^{k}=\frac{n !}{k ! \times(n-k) !}$ 的分子分母所含 2 的方幂来分析奇偶性, 这一方法也可以进一步分析模 4 余数分布. 方幂分析在考虑偶数组合数是 $4 k+2$型还是 $4 k$ 型时比较简便, 设 $n=\left(c_{m} c_{m-1} \cdots c_{1} c_{0}\right)_{2}$, 组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中的 $n+1-2^{s(n)}$ 个偶数中, $4 k+2$ 型组合数 $\mathrm{C}_{n}^{a}$ 等价于 $a+b=n$ 时 $\nu_{2}(n !)=$ $\nu_{2}(a !)+\nu_{2}(b !)+1$, 即 $s(a)+s(b)=s(n)+1$, 即二进制加法只进一次位.

设二进制表示 $a=\left(a_{m} a_{m-1} \cdots a_{1} a_{0}\right)_{2}, b=\left(b_{m} b_{m-1} \cdots b_{1} b_{0}\right)_{2}$, (首位 $a_{m}, b_{m}$甚至 $c_{m}$ 可以为 0 ), 考虑这唯一进位的位置, 假设是第 $i$ 位向第 $i+1$ 位进位,由于第 $i-1$ 位没有向第 $i$ 位进位, 则 $a_{i}+b_{i}=c_{i}+2$, 这只能是 $a_{i}=b_{i}=1$,
$c_{i}=0$; 同时由于第 $i+1$ 位没有向更高位进位, 则 $a_{i+1}+b_{i+1}+1=c_{i+1}$, 这只能是 $a_{i+1}=b_{i+1}=0, c_{i-1}=1$. 这意味着唯一的进位必须发生在 $n$ 的相邻两位是 “ 10 ” 的地方 (即 $c_{i+1}=1, c_{i}=0$ ). 当位置选定后, 那两位的 $a, b$ 均为 “ 01 ”,同时 $a, b$ 的其他位置需满足 $c_{i}=0$ 时 $a_{i}, b_{i}$ 均为 $0, c_{i}=1$ 时 $a_{i}, b_{i}$ 一个 0 一个 1 任意选择, 这样每个可能进位位置恰好对应 $2^{s(n)-1}$ 个 $a+b=n$.

唯一进位位置的选择方式数等于 $n$ 的展开式中连续的 0 的段数, 因为每段连续的 0 恰好对应一个这段开头处的 “ 10 ” . 例如 $n=2012=(11111011100)_{2}$时, 可以在第 1 位向第 2 位进位, 或第 5 位向第六位进位, 一共两个 “ 10 ” 的可选位置, 每种进位位置有 $2^{s(n)-1}=128$ 个 $a+b=n$, 因此共有 256 个 $4 k+2$ 型组合数.

接下来对奇数组合数的模 4 余数分析, 仅仅考虑阶乘含 2 的方幂数是不够的, 还需要进一步考虑阶乘把所含 2 的方幂除掉之后 (简称缩水), 剩下的奇数部分是 $4 k+1$ 型还是 $4 k-1$ 型的. 为此我们定义符号: $h(x) \equiv \frac{x}{2^{\nu_{2}(x)}}(\bmod 4)$ 来表示一个正整数 $x$ 的奇数部分的类型, $h(x)$ 取值为 $\{1,-1\}$, 我们注意 $h$ 函数保持乘法关系, 即 $h(x y)=h(x) h(y)$.

对于阶乘 $n$ ! 的类型, $h(n !)=h(1) \times h(2) \times \cdots \times h(n)$, 按照 $1 \sim n$ 中的含 2 的方幂分类来看, 它等于 $1 \sim n$ 中奇数乘积, $1 \sim n$ 中 $4 k+2$ 型数乘积 (等价于 $1 \sim \frac{n}{2}$ 中所有奇数的乘积), $1 \sim n$ 中 $8 k+4$ 型数乘积 (等价于 $1 \sim \frac{n}{4}$ 中所有奇数的乘积), $\cdots$, 以上这些乘积类型的乘积. 我们定义 $f(n)$ 表示 $1 \sim n$ 中所有奇数的乘积, 则

![](https://cdn.mathpix.com/cropped/2024_02_26_fe0678bd726f97fcd47bg-06.jpg?height=108&width=974&top_left_y=1711&top_left_x=541)

为此我们考虑 $f(n)$ 模 4 的余数与 $n$ 的关系, 我们发现连续 4 个奇数乘积模 4 余 1 , (事实上乘积模 8 也余 1$)$, 因此 $f(n+8) \equiv f(n)(\bmod 4)$, 这样只需考虑 $n$ 的二进制展开的末三位 $n(\bmod 8) \equiv\left(c_{2} c_{1} c_{0}\right)_{2}$ 即可知 $f(n)$ 的类型. 同时, $\left\lfloor\frac{n}{2}\right\rfloor$ 是 $n$ 的二进制去掉最后一位, $f\left(\left\lfloor\frac{n}{2}\right\rfloor\right)$ 只需考虑 $\left\lfloor\frac{n}{2}\right\rfloor(\bmod 8) \equiv\left(c_{3} c_{2} c_{1}\right)_{2}$ 即可, $\cdots, f\left(\frac{n}{2^{m}}\right)$ 的类型, 只需考虑 $\left\lfloor\frac{n}{2^{m}}\right\rfloor(\bmod 8) \equiv\left(00 c_{m}\right)_{2}$ 即可. 具体计算得到:

$$
\begin{aligned}
f(8 k) & \equiv f(8 k+1) \equiv f(8 k+2) \equiv f(8 k+7) \equiv 1 \quad(\bmod 4) ; \\
f(8 k+3) & \equiv f(8 k+4) \equiv f(8 k+5) \equiv f(8 k+6) \equiv-1 \quad(\bmod 4) .
\end{aligned}
$$

我们对二进制中的连续三位定义符号 $g$ :

$$
g(000)=+1, \quad g(001)=+1, \quad g(010)=+1, \quad g(011)=-1
$$

$$
g(100)=-1, \quad g(101)=-1, \quad g(110)=-1, \quad g(111)=+1
$$

这样对 $n=\left(c_{m} \cdots c_{1} c_{0}\right)_{2}, h(n !) \equiv g\left(c_{2} c_{1} c_{0}\right) \times g\left(c_{3} c_{2} c_{1}\right) \times \cdots \times g\left(00 c_{m}\right)$.

若 $\mathrm{C}_{n}^{a}=\frac{n !}{a ! \times b !}$ 是奇数 $(a+b=n)$, 则二进制加法不进位, $\left(a_{m} a_{m-1} \cdots a_{1} a_{0}\right)_{2}+$ $\left(b_{m} b_{m-1} \cdots b_{1} b_{0}\right)_{2}=\left(c_{m} c_{m-1} \cdots c_{1} c_{0}\right)_{2}$, 不进位的 $2^{s(n)}$ 种情况, 相当于把 $n=$ $\left(c_{m} \cdots c_{1} c_{0}\right)_{2}$ 中的 $s(n)$ 个 1 分配到 $a, b$ 两边的方法数.

接下来计算 $h\left(\mathrm{C}_{n}^{a}\right) \equiv \frac{h(n !)}{h(a !) \times h(b !)},(h(x)$ 保持乘积关系, 这一点很重要 $)$.

$h\left(\mathrm{C}_{n}^{a}\right) \equiv \frac{g\left(c_{2} c_{1} c_{0}\right)}{g\left(a_{2} a_{1} a_{0}\right) \times g\left(b_{2} b_{1} b_{0}\right)} \times \frac{g\left(c_{3} c_{2} c_{1}\right)}{g\left(a_{3} a_{2} a_{1}\right) \times g\left(b_{3} b_{2} b_{1}\right)} \times \cdots \times \frac{g\left(00 c_{m}\right)}{g\left(00 a_{m}\right) \times g\left(00 b_{m}\right)}$.

记 $g_{i}=\frac{g\left(c_{i+2} c_{i+1} c_{i}\right)}{g\left(a_{i+2} a_{i+1} a_{i}\right) \times g\left(b_{i+2} b_{i+1} b_{i}\right)}$, 在 $C=\left(c_{i+2} c_{i+1} c_{i}\right)$ 固定, 且 $a+b$ 不进位即 $A+B=\left(a_{i+2} a_{i+1} a_{i}\right)+\left(b_{i+2} b_{i+1} b_{i}\right)$ 不进位的前提下, 考虑 $g_{i}$ 的可能取值:

若 $C=\left(c_{i+2} c_{i+1} c_{i}\right)=(000),(001),(010),(100)$ 时, 由于 $A+B=C$ 不进位, $A, B$ 一定是一个为 $(000)$, 另一个等于 $C$, 这时 $g_{i}=+1$;

若 $C=(110), A+B=(000)+(110)$ 或 $(100)+(010)$ 时均有 $g_{i}=+1$;

若 $C=(101), A+B=(000)+(101)$ 或 $(100)+(001)$ 时均有 $g_{i}=+1$;

以上的六种情况 $g_{i}$ 一定等于正 1 . 还有两种情况:

$C=(011)$ 时, $A+B=(000)+(011)$ 时 $g_{i}=+1, A+B=(010)+(001)$ 时 $g_{i}=-1$;

$C=(111)$ 时, $A+B=(000)+(111)$ 或 $(100)+(011)$ 时 $g_{i}=+1, A+B=$ $(110)+(001)$ 或 $(101)+(010)$ 时 $g_{i}=-1$;

在最后的两种情况中, 若后两位的 1 被分配在 $A, B$ 两边, 则 $g_{i}=-1$, 若后两位的 1 被分配在同一边, 则 $g_{i}=+1$. ( $g_{i}$ 和第一位的 0 或 1 如何分配无关).

总之, 若 $n$ 的二进制表示中相邻两位 $c_{i+1} c_{i}$ 都是 1 且两个 1 被分配在 $a, b$两边时, 会导致 $g_{i}=-1$, 其余情况都有 $g_{i}=+1$. 这样, 把 $n=\left(c_{m} \cdots c_{1} c_{0}\right)_{2}$ 中的 $s(n)$ 个 1 分配到 $a, b$ 两边时, 总的 $h\left(\mathrm{C}_{n}^{a}\right) \equiv g_{0} \times \cdots \times g_{m}$ 的取值取决于把连续两位的 1 分配在 $a, b$ 两边的情况出现奇数次还是偶数次. 如果 $\left(c_{m} \cdots c_{1} c_{0}\right)$ 中有连续两位的 1 , 不妨设 $c_{k+1}=c_{k}=1$, 则当我们把 $\left(c_{m} \cdots c_{k+1}\right)$ 中的 1 的归属不变, 把 $\left(c_{k} \cdots c_{0}\right)$ 中的 1 的归属全部改变时, 符号 $h\left(\mathrm{C}_{n}^{a}\right) \equiv g_{0} \times \cdots \times g_{m}$ 恰好在 $g_{k}$ 处改变, 其余 $g_{i}$ 不变, $h\left(\mathrm{C}_{n}^{a}\right)$ 恰好反号, 这说明所有 $2^{s(n)}$ 种分配方式中, 即 $2^{s(n)}$ 个奇数组合数中, $4 k+1$ 型与 $4 k-1$ 型之间可以一一对应, 因此各占一半.如果 $\left(c_{m} \cdots c_{1} c_{0}\right)$ 没有连续两位的 1 , 则 $h\left(\mathrm{C}_{n}^{a}\right) \equiv g_{0} \times \cdots \times g_{m}$ 中所有 $g_{i}=+1$,即所有 $2^{s(n)}$ 个奇数组合数都是 $4 k+1$ 型的.

## 3. 一个投机取巧的方法

对于 $n=2012=(11111011100)_{2}$, 显然是有连续的 1 的情况, 因此 256 个奇数组合数中, $4 k+1$ 型与 $4 k-1$ 型各占一半, 各 128 个. 关于 2012 的例子有一个 “投机取巧” 的方法, 由于 $\mathrm{C}_{2012}^{k}$ 是奇数则 $k$ 一定是 4 的倍数, 这样只需证明 $\mathrm{C}_{2012}^{8 k}$ 与 $\mathrm{C}_{2012}^{8 k+4}$ 中若至少有一个是奇数, 则一定都是奇数且模 4 余 1 和余 3 各一个即可. 为此只需证明 $4 \mid \mathrm{C}_{2012}^{8 k}+\mathrm{C}_{2012}^{8 k+4}$ :

$$
\begin{aligned}
& \mathrm{C}_{2012}^{8 k} \times(2012-8 k)(2010-8 k)(2009-8 k) \\
= & \mathrm{C}_{2012}^{8 k+4} \times(8 k+1)(8 k+2)(8 k+3)(8 k+4)
\end{aligned}
$$

两边除掉一些 2 的方幂后得到:

$$
\begin{aligned}
& \mathrm{C}_{2012}^{8 k} \times(503-2 k)(2011-8 k)(1005-4 k)(2009-8 k) \\
= & \mathrm{C}_{2012}^{8 k+4} \times(8 k+1)(4 k+1)(8 k+3)(2 k+1),
\end{aligned}
$$

两边模 4 之后可得:

$$
\mathrm{C}_{2012}^{8 k} \times(2 k+3) \times 3 \times 1 \times 1 \equiv \mathrm{C}_{2012}^{8 k+4} \times 1 \times 1 \times 3 \times(2 k+1) \quad(\bmod 4)
$$

$(2 k+1)$ 与 $(2 k+3)$ 模 4 恰好是一个余 1 一个余 3 , 可推出: $4 \mid \mathrm{C}_{2012}^{8 k}+\mathrm{C}_{2012}^{8 k+4}$.

这个 “投机取巧” 的方法实际上是由于 2012 模 16 余 12 , 即二进制后四位是 “ 1100 ” $8 k$ 与 $8 k+4$ 之间恰好是改变了倒数第三位的 1 的归属.

## III. 模 8 的余数分布

前面分析奇数组合数模 4 的余数时, 我们考虑阶乘的奇数部分的类型, 这一方法还可以进一步分析组合数模 8 的余数. 我们目前可以得到 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$中的 $2^{s(n)}$ 个奇数的模 8 余数分布, 其余的偶数组合数仍需要在 $4 k+2$ 型中区分 $8 k+2$ 与 $8 k+6$, 以及在 $4 k$ 型中区分 $8 k+4$ 与 $8 k$, 这部分工作可能结果比较繁琐, 目前尚未展开.

当考虑模 8 的余数时, 把 $h(x)$ 函数的设定扩展一下, $h(x) \equiv \frac{x}{2^{\nu_{2}(x)}}(\bmod 8)$, $h(x)$ 取值为 $\{1,3,5,7\}$, 并且仍然保持乘法关系: $h(x y) \equiv h(x) h(y)$, 集合 $\{1,3,5,7\}$ 也就是模 8 的缩系比较有意思: $3^{2} \equiv 5^{2} \equiv 7^{2} \equiv 1,3 \times 5 \times 7 \equiv 1$, 它实际上是一个同构于 $\mathbf{Z}_{2} \times \mathbf{Z}_{2}$ 的群, $3,5,7$ 在乘法计算中上具有对称的地位.

我们仍然有:

![](https://cdn.mathpix.com/cropped/2024_02_26_fe0678bd726f97fcd47bg-08.jpg?height=101&width=955&top_left_y=2525&top_left_x=556)
并且 $f(n+8) \equiv f(n)(\bmod 8)$, 再模 8 具体计算可得:

$$
\begin{aligned}
& f(8 k) \equiv f(8 k+1) \equiv f(8 k+2) \equiv f(8 k+7) \equiv 1 \quad(\bmod 8) ; \\
& f(8 k+3) \equiv f(8 k+4) \equiv 3 \quad(\bmod 8) ; \\
& f(8 k+5) \equiv f(8 k+6) \equiv 7 \quad(\bmod 8) .
\end{aligned}
$$

重新定义符号:

$$
\begin{aligned}
& g(000) \equiv 1, \quad g(001) \equiv 1, \quad g(010) \equiv 1, \quad g(011) \equiv 3 \\
& g(100) \equiv 3, \quad g(101) \equiv 7, \quad g(110) \equiv 7, \quad g(111) \equiv 1 .
\end{aligned}
$$

我们仍然有:

$h\left(\mathrm{C}_{n}^{a}\right) \equiv \frac{g\left(c_{2} c_{1} c_{0}\right)}{g\left(a_{2} a_{1} a_{0}\right) \times g\left(b_{2} b_{1} b_{0}\right)} \times \frac{g\left(c_{3} c_{2} c_{1}\right)}{g\left(a_{3} a_{2} a_{1}\right) \times g\left(b_{3} b_{2} b_{1}\right)} \times \cdots \times \frac{g\left(00 c_{m}\right)}{g\left(00 a_{m}\right) \times g\left(00 b_{m}\right)}$.

仍然考虑在 $C=\left(c_{i+2} c_{i+1} c_{i}\right)$ 固定, 且 $A+B=\left(a_{i+2} a_{i+1} a_{i}\right)+\left(b_{i+2} b_{i+1} b_{i}\right)$ 不进位的情况下, 考虑 $g_{i}=\frac{g\left(c_{i+2} c_{i+1} c_{i}\right)}{g\left(a_{i+2} a_{i+1} a_{i}\right) \times g\left(b_{i+2} b_{i+1} b_{i}\right)}$ 的可能取值.

若 $A, B$ 之一取 (000), 则另一个等于 $C$, 此时 $g_{i}=1$. 当 $C$ 中至多只有一个 1 时, 即 $C=(000),(001),(010),(100)$ 时一定是这种情况.

若 $C=(110), A+B=(100)+(010)$ 时, $g_{i}=5$;

若 $C=(101), A+B=(100)+(001)$ 时, $g_{i}=5$;

若 $C=(011), A+B=(010)+(001)$ 时, $g_{i}=3$;

若 $C=(111), A+B=(100)+(011)$ 时, $g_{i}=1$;

若 $C=(111), A+B=(110)+(001)$ 或 $(101)+(010)$ 时 $g_{i}=7$.

设 $n=\left(c_{m} \cdots c_{1} c_{0}\right)_{2}$ 中的 $s=s(n)$ 个 1 的位置从后往前依次为 $\left\{i_{1}, i_{2}, \cdots, i_{s}\right\}$, $a+b=n$ 不进位的所有情形即对应把这 $s$ 个 1 分配到 $a, b$ 两边. 我们注意到, $g_{i}$ 的取值与位置相邻或靠近的两个 1 的归属有关, 若两个 1 归属相同即同时属于 $a$ 或同时属于 $b$ 时, $g_{i}$ 一定等于 1 , 若归属不同则 $g_{i}$ 可能取其它值. 因此我们记录 1 的归属, 用 $\alpha_{1}, \cdots, \alpha_{s-1}$ 表示 $s-1$ 对邻近的 1 的归属是否相同, 即对 $k=1, \cdots, s-1$, 若 $c_{i_{k}}$ 与 $c_{i_{k+1}}$ 处的 1 都属于 $a$ 或都属于 $b$ 则记 $\alpha_{k}=0$, 若归属不同则记 $\alpha_{k}=1$. 这样 $a, b$ 的 1 的分配情况由 $\alpha_{1}, \cdots, \alpha_{s-1}$ 及首个 1 的归属情况所决定. 这样遍历所有 $2^{s}$ 个 $a+b=n$ 不进位情形相当于两倍的遍历 $\alpha_{1}, \cdots, \alpha_{s-1}$ 的所有取值 $\{0,1\}^{s-1}$, 注意这时各个 $\alpha$ 之间取值有独立性. 下面我们具体分析每个 $g_{i}$ 与这些 $\alpha$ 之间的关系.

若 $C=(110)$, 设这两个 1 是 $c_{i_{k+1}}$ 与 $c_{i_{k}}$ 位置, 则此 $g_{i}=5^{\alpha_{k}}$, 因为若两个 1 归属相同, $\alpha_{k}=0, g_{i}=5^{\alpha_{k}}=1$, 若两个 1 归属不同, $\alpha_{k}=1, g_{i}=5^{\alpha_{k}}=5$;
若 $C=(101)$, 设这两个 1 是 $c_{i_{k+1}}$ 与 $c_{i_{k}}$ 位置, 则此 $g_{i}=5^{\alpha_{k}}$;

若 $C=(011)$, 设这两个 1 是 $c_{i_{k+1}}$ 与 $c_{i_{k}}$ 位置, 则此 $g_{i}=3^{\alpha_{k}}$;

若 $C=(111)$, 设这三个 1 是 $c_{i_{k+2}} 、 c_{i_{k+1}}$ 与 $c_{i_{k}}$ 位置, 则 $g_{i}=7^{\alpha_{k}}$, 这是因为后两个 1 归属相同则 $g_{i}=1$, 归属不同则 $g_{i}=7$, 与第一个 1 的归属无关.

我们注意到所有 $g_{i}$ 的形式都是指数上关于 $\alpha_{1}, \cdots, \alpha_{s-1}$ 线性的, 因此乘起来之后 $h\left(\mathrm{C}_{n}^{a}\right) \equiv g_{0} \times \cdots \times g_{m}$ 仍然是指数上关于 $\alpha_{1}, \cdots, \alpha_{s-1}$ 线性, 比如类似于 $h\left(\mathrm{C}_{n}^{a}\right) \equiv 3^{\alpha} \times 5^{\beta} \equiv 3^{\alpha+\beta} \times 7^{\beta} \equiv 5^{\alpha+\beta} \times 7^{\alpha}$ 的形式, 其中 $\alpha, \beta$ 是 $\alpha_{1}, \cdots, \alpha_{s-1}$ 的线性组合, 这里线性很重要. 下面我们具体考虑每个 $\alpha_{k}$ 对 $h\left(C_{n}^{a}\right)$ 的影响:

考虑 $\alpha_{k}$, 即 $c_{i_{k}}$ 与 $c_{i_{k+1}}$ 处的 1 的归属情况, 若 $i_{k+1}-i_{k} \geq 3$, 即这两个 1 之间距离远至少隔着两个 0 , 这时 $\alpha_{k}$ 的取值与所有 $g_{i}$ 无关;

若 $i_{k+1}-i_{k}=2$, 则局部是 “ 101 ” 的形状, 这时 $g_{i_{k}}=5^{\alpha_{k}}$, 其余 $g_{i}\left(i \neq i_{k}\right)$与 $\alpha_{k}$ 无关, $\alpha_{k}$ 对 $h\left(\mathrm{C}_{n}^{a}\right)$ 的贡献是 $5^{\alpha_{k}}$;

若 $i_{k+1}-i_{k}=1$, 则局部是 “ 11 ” , 还需考虑 “ 11 ” 两侧是 0 还是 1 :

若是 “ 0110 ”, 则 $\alpha_{k}$ 影响 $g_{i_{k}}=3^{\alpha_{k}}, g_{i_{k}-1}=5^{\alpha_{k}}, \alpha_{k}$ 的总贡献是 $7^{\alpha_{k}}$;

若是 “ $0111 ”$, 则 $\alpha_{k}$ 影响 $g_{i_{k}}=3^{\alpha_{k}},\left(g_{i_{k}-1}=7^{\alpha_{k-1}}\right), \alpha_{k}$ 的总贡献是 $3^{\alpha_{k}}$;

若是 “ 1110 ”, 则 $\alpha_{k}$ 影响 $g_{i_{k}}=7^{\alpha_{k}}, g_{i_{k}-1}=5^{\alpha_{k}}, \alpha_{k}$ 的总贡献是 $3^{\alpha_{k}}$;

若是 “ $1111 ”$, 则 $\alpha_{k}$ 影响 $g_{i_{k}}=7^{\alpha_{k}},\left(g_{i_{k}-1}=7^{\alpha_{k-1}}\right), \alpha_{k}$ 的总贡献是 $7^{\alpha_{k}}$;

此外还有个特殊情况就是 $i_{k+1}, i_{k}$ 恰好是最后两位, 即 $k=1, i_{1}=0, i_{2}=1$,这时若 $n$ 的后三位是 “ 011 ” 则 $\alpha_{k}=\alpha_{1}$ 影响 $g_{0}=3^{\alpha_{k}}$, 对 $h\left(\mathrm{C}_{n}^{a}\right)$ 的总贡献是 $3^{\alpha_{k}}$; 若 $n$ 的后三位是 “ 111 ” 则 $\alpha_{k}=\alpha_{1}$ 影响 $g_{0}=7^{\alpha_{k}}$, 总贡献是 $7^{\alpha_{k}}$.

每个 $\alpha_{k}$ 对 $h\left(\mathrm{C}_{n}^{a}\right)$ 的贡献都是 $\mathrm{C}^{\alpha_{k}}(c \in\{1,3,5,7\})$ 的形式, 我们把这个 $c$ 称作 $\alpha_{k}$ 的贡献因子. 若邻近两个 1 之间距离大于 2 则贡献因子等于 1 ; 若邻近两个 1 之间距离等于 2 则贡献因子等于 5 ; 若邻近两个 1 之间距离等于 1 则贡献因子等于 3 或 7.

$h\left(\mathrm{C}_{n}^{a}\right)$ 的分布由 $s-1$ 个贡献因子的情况决定:

若所有贡献因子都是 1 , 即 $h\left(\mathrm{C}_{n}^{a}\right) \equiv 1$, 这时所有奇数组合数都是 $8 k+1$ 型;

若贡献因子中有 3 ,但没有 5 和 7 , 即 $h\left(\mathrm{C}_{n}^{a}\right) \equiv 3^{\alpha}$, 这时所有奇数组合数是 $8 k+1$ 型与 $8 k+3$ 型各占一半;

若贡献因子中有 5 , 但没有 3 和 7 , 即 $h\left(\mathrm{C}_{n}^{a}\right) \equiv 5^{\beta}$, 这时所有奇数组合数是 $8 k+1$ 型与 $8 k+5$ 型各占一半;

若贡献因子中有 7 , 但没有 3 和 5 , 即 $h\left(\mathrm{C}_{n}^{a}\right) \equiv 7^{\gamma}$, 这时所有奇数组合数是 $8 k+1$ 型与 $8 k+7$ 型各占一半;
若贡献因子中含有 $\{3,5,7\}$ 中的至少两个, 即 $h\left(\mathrm{C}_{n}^{a}\right)$ 可以表示为: $3^{\alpha} \times 5^{\beta}$或 $3^{\alpha} \times 7^{\gamma}$ 或 $5^{\beta} \times 7^{\gamma}$ 或 $3^{\alpha} \times 5^{\beta} \times 7^{\gamma}$ 的形式, 这时所有奇数组合数是四种类型各占四分之一. 以上 $\alpha, \beta, \gamma$ 表示 $\alpha_{1}, \cdots, \alpha_{s-1}$ 的非 0 线性组合.

我们从连续的 1 的段的角度来看贡献因子, 若某一段只有一个 1 , 则没有贡献因子; 若这段有两个 1 , 则有一个贡献因子 7 ; 若这段有三个 1 , 则有两个贡献因子 3 ; 若这段有四个或更多的 1 , 则会出现贡献因子 3 和 7 . 一个特殊情况是对于末尾的最后一段 1 ( 后面没有 0 ), 若是连续两个 1 则贡献因子只有一个 3 ,连续三个或更多 1 则贡献因子既有 3 又有 7 . 两段 1 之间由一些 0 隔开, 若隔着一个 0 则这里出现一个贡献因子 5 ; 若隔着两个或更多的 0 则只有贡献因子 1 .

对于 $n=\left(c_{m} \cdots c_{1} c_{0}\right)_{2}$ 我们可以总结出组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中的 $2^{s(n)}$ 个奇数组合数的模 8 余数分布情况:

- 全是 $8 k+1$ 型, 即贡献因子全是 1 , 即二进制表示中所有 $s(n)$ 个 1 都分开且两两之间都至少隔着两个 0 ;
- $8 k+1$ 型与 $8 k+5$ 型均分, 即贡献因子全是 1 或 5 , 即所有 $s(n)$ 个 1 都分开且存在两个 1 之间只隔着一个 0 ;
- $8 k+1$ 型与 $8 k+3$ 型均分, 即贡献因子全是 1 或 3 , 即所有连续的 1 的段都是单独的 “ $\cdots 010 \cdots$ ” 或三连的 “ $\cdots 01110 \cdots$ ” (若是最后一段 1 且之后没有 0 则必须是 “ $\cdots 011$ ”), 同时两个连续的 1 的段之间都至少隔着两个 0 ;
- $8 k+1$ 型与 $8 k+7$ 型均分, 即贡献因子全是 1 或 7 , 即所有连续的 1 的段都是单独的 “ $\cdots 010 \cdots$ ” 或二连的 “ $\cdots 0110 \cdots$ ” (若是最后一段 1 且之后没有 0 则必须是 “ $\cdots 01$ ”), 同时两个连续的 1 的段之间都至少隔着两个 0 ;
- $8 k+1,8 k+3,8 k+5,8 k+7$ 四种类型均分, 即贡献因子包含 $\{3,5,7\}$ 中的至少两个, 即除了上述几种 case 以外的所有情形.

至此, 我们得到了 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 中奇数组合数的模 8 余数分布. 对于偶数组合数的余数情况, 我们尚需要对 $a+b=n$ 只进了一次位的 $4 k+2$ 型组合数继续分析其奇数部分是 $4 k+1$ 型还是 $4 k-1$ 型, 以及分析 $a+b=n$ 恰好进两次位的情况总数. 后续这些问题的结果我估计仍然是可以转化为与 $n$ 的二进制表示中连续的 1 的段有关的情况, 但结果可能比较繁琐. 这些问题留给有兴趣的同学吧.

## IV. 后续的问题

我们考虑了组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 模 2 , 模 4 与模 8 的余数分布的问题.
这些问题的结果比较简洁, 尤其是奇数组合数的余数分布比较整齐, 这某种意义上得益于余数可以表示成指数部分是线性的形式, 或者说做到了分离变量.我感觉如果是模 16 就不一定有这么好的运气了.

有兴趣的同学也可以考虑组合数 $\mathrm{C}_{n}^{0}, \mathrm{C}_{n}^{1}, \cdots, \mathrm{C}_{n}^{n}$ 模奇素数 $p$ 或奇素数平方 $p^{2}$, 比如模 3 或模 9 的余数分布. 这个问题可能比模 8 的问题更难一些, 因为连续九个整数中的六个不是 3 的倍数的数的乘积是模 9 余 -1 的, 这样 $f$ 函数的周期性就会差一些, 原来的进制加法分析的套路可能失效.

其实对于组合数的余数分布, 如果模不是素数幂的话将会非常困难. 比如考虑模 6 的余数分布, 这相当于考虑模 2 的余数分布与模 3 的余数分布之间的相依结构, 或者说这两者的联合分布. 直观地看, 模 2 和模 3 的余数分别与二进制和三进制有关, 但一个数的二进制表示与三进制表示之间好像很难找到关系.

