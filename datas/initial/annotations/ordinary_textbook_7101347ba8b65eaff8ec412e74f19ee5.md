$$
\text { 数学新星网 } \% \text { 冯跃峰专栏 }
$$

# 一道“五难” 数论题浅析 

冯跃峰

2018 年全国高中数学联赛加试中, 有一道个人认为是质量非常高的数论题,题目如下:

题数列 $\left\{a_{n}\right\}$ 定义如下: $a_{1}$ 是任意正整数, $a_{n+1}$ 是与 $\sum_{i=1}^{n} a_{i}$ 互质, 且异于 $a_{1}, a_{2}, \cdots, a_{n}$ 的最小正整数. 试证: 每个正整数都在数列 $\left\{a_{n}\right\}$ 中出现.

本题有较大的难度, 我们称之为“五难”问题一至少有 5 个难点.

说其难, 并非是它涉及什么高深的数论知识背景, 而是指思维层面上一些作法难于想到. 相反地, 本题几乎无需用到数论中的相关定理.

本文的目的, 就是发掘本题在突破这些难点上的独特思路及相应的处理手法.

首先, 从目标看, 即使是取一个具体的数, 比如 2018 , 你也无从判断它是否属于 $W$ (数列 $\left\{a_{n}\right\}$ 各项组成的集合).

本题的独特之处就在于：证某个具体的正整数出现在题给数列 $W$ 中却很困难, 而证所有正整数出现在数列 $W$ 中则反而可行(以面带点)! 因为我们有一个强有力的工具: 数学归纳法一在归纳假设(某个数属于 $W$ )的前提下, 可顺利推出下一个数也属于 $W$, 这是解题的第一个难点.

其次, 从条件看, 直接对 $n$ 归纳是不可取的, 因为“正整数 $n$ 属于 $W$ ”与 “正整数 $n+1$ 属于 $W$ "之间并没有递推关系, 题中给出的递归是 $a_{n+1}$ 与前 $n$ 项 $a_{1}, a_{2}, \cdots, a_{n}$ 之间的联系, 无法直接用于判断 “正整数 $n+1$ 也属于 $W$ ”.

应对谁进行归纳? 题中并没有更多的归纳对象可供选择, 这是第二个难点,这也是本题最关键的难点之一.

实际上, 我们不能对正整数一个个归纳, 只能对正整数的某种属性归纳(分批归纳, 同一属性批次含多个正整数).

修订日期: 2020-02-05.
应考察正整数的什么属性呢? 不妨取一个具体的数列 $\left\{a_{n}\right\}$ 来研究, 从中发现与“递归”相关的性质.

【研究特例】取 $a_{1}=1$, 则易知数列前若干项为:

$$
1,2,4,3,7,5,9, \cdots
$$

该序列各项之间似乎没有什么联系, 但这些项却有一个共同点, 你发现了吗？一可考察其标准分解式.

【发掘规律】这些数都只含有一个质因数, 为 $p^{\alpha}$ 形式的数.

它启发我们产生这样的设想: 对于只含有一个质因数的正整数 $p^{\alpha}$, 可以统一于一个批次中一次性证明其都属于 $W$.

由此想到所选择归纳对象是：正整数 $n$ 的不同质因数个数一突破本题最大的难点.

【分批归纳】对正整数含有不同质因数的个数 $\tau$ 进行归纳.

当 $\tau=1$ 时, 正整数为 $p^{\alpha}$ 形式, 我们证明任何 $p^{\alpha}$ 形式的数都在数列中.

要证明 $p^{\alpha} \in W$, 可想象 $p^{\alpha}=a_{j}$. 这自然想到验证 $p^{\alpha}$ 满足 $a_{j}$ 定义中的 “三性":

(1) 互异性: $a_{j}$ 异于 $a_{1}, a_{2}, \cdots, a_{j-1}$;

(2) 互素性: $\left(a_{j}, S_{j-1}\right)=1$;

(3) 最小性: $a_{j}$ 是满足 (1) (2) 的最小正整数.

但数列 $\left\{a_{n}\right\}$ 及 $p^{\alpha}$ 都没有具体给定, 难以从正面找到合乎 (1) (2) (3) 的正整数 $j$, 只能从反面行验证某个条件“不满足”, 由反设 “ $p^{\alpha} \notin W$ ”, 导出矛盾. 一这是本题的第三个难点.

【反面思考】反设 $p^{\alpha} \notin W$, 则显然 $p^{\alpha}$ 满足 (1), 所以 $p^{\alpha}$ 不能同时满足 (2)和 (3).

这能产生怎样的“有用信息”呢？它还非常隐蔽, 很难进一步推理. 一这是本题的第四个难点, 也是本题的另一个关键之处.

尽管不能直接由 “ $p^{\alpha}$ 不能同时满足 (2) 和 (3) ”导出相关结论, 但也可以看出一些端倪. 比如, 我们期待 $p^{\alpha}$ 不满足 (2), 即

$$
\left(p^{\alpha}, S_{j-1}\right) \neq 1
$$

因为由此可得出 $p \mid S_{j-1}$ (有用信息).

现在麻烦的是, 我们不能先让 $p^{\alpha}$ 满足 (3), 因为满足 (3) 是以满足 (1) (2) 为
前提的. 所以,我们期待适当选取关联对象 $a_{j}$, 由 $a_{j}$ 满足 (3) 来 “倒逼” $p^{\alpha}$ 不满足 (2), 这是本题的另一个最难之处.

为利用 $a_{j}$ 的 “最小性”, 想到取 $p^{\alpha}<a_{j}$. 因为这样一来, $p^{\alpha}$ 比 $a_{j}$ 更小, 再 “嵌入”一个“反证法” (反设 $p^{\alpha}$ 满足 (2) ) 则可导出与 $a_{j}$ 的“最小性”矛盾.

【关联性质】取数列中的一个项 $a_{j}$, 使 $p^{\alpha}<a_{j}$, 则有

$$
\left(p^{\alpha}, S_{j-1}\right) \neq 1, \text { (产生有用信息 ) }
$$

否则与 $a_{j}$ 的最小性矛盾.

现在的问题是, 这样的 $a_{j}$ 存在吗? 回答是肯定的, 利用数列的无限性即可.

【反面剔除】因为不超过 $p^{\alpha}$ 的正整数只有有限个, 必定存在正整数 $N$, 使 $j \geq N+1$ 时, 恒有 $p^{\alpha}<a_{j}$.

取 $j=N+1$, 可知

$$
\left(p^{\alpha}, S_{N}\right) \neq 1
$$

否则与 $a_{N+1}$ 的最小性矛盾, 所以 $p \mid S_{N}$. 取 $j=N+2$, 类似可知,

$$
\left(p^{\alpha}, S_{N+1}\right) \neq 1
$$

即 $p \mid S_{N+1}$. 但

$$
\left(S_{N+1}, S_{N}\right)=\left(S_{N+1}-S_{N}, S_{N}\right)=\left(a_{N+1}, S_{N}\right)=1
$$

与 $p$ 是 “公约数”矛盾.

所以, $\tau=1$ 时结论成立.

值得指出的是, 此处的归纳法, “奠基”比“递推”更难. 完成了奠基, 后面的递推就非常顺畅了, 几乎与前面的推理类似, 当然需稍作优化(还有最后一个难点).

设 $\tau<k(k \geq 2)$ 时结论成立, 考察 $\tau=k$ 的情形.

与 $\tau=1$ 时类似, 难以从正面证明相应的正整数属于 $W$, 宜从反面入手.

【平凡拓广】反设存在正整数

$$
x=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{k}^{\alpha_{k}} \notin W \text {. }
$$

这里 $\alpha_{i}$ 是正整数, 以保证 $x$ 含有 $k$ 个不同质因数. 取关联条件:设正整数 $j$, 满足 $x<a_{j}$, 则必有

$$
\left(x, S_{j-1}\right) \neq 1
$$

否则与 $a_{j}$ 的最小性矛盾.

【反面剔除】同样, 因为不超过 $x=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{k}^{\alpha_{k}}$ 的正整数只有有限个,
必定存在正整数 $N$, 使 $j \geq N+1$ 时, 恒有

$$
x=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{k}^{\alpha_{k}}<a_{j} .
$$

类似地, $\left(x, S_{j-1}\right) \neq 1$ (否则与 $a_{j}$ 的最小性矛盾).

所以, 存在 $1 \leq i \leq k$, 使

$$
p_{i} \mid S_{j-1}(\forall j \geq N+1) \text {. }
$$

【差异分析】注意到这里的 $p_{i}$ 有不同取值(因为 $x$ 含有的质因数不唯一),与 $j$ 相关, 从而不能说明所有 $S_{j}(j \geq N+1)$ 有公共质因数.

由此想到, 找一个公共的约数

$$
p \in p_{1}, p_{2}, \cdots, p_{k},
$$

及两个相邻的部分和: $S_{j}, S_{j-1}$, 使

$$
p\left|S_{j}, p\right| S_{j-1}(j \geq N+1)
$$

这样, 便可与 $\left(S_{j-1}, S_{j}\right)=1$ 矛盾.

如何找到公共的约数 $p$ ? 这当然要恰当地利用归纳假设——这是本题的第 5 个难点.

【角色分析】所谓 $\tau=k-1$ 成立, 就是所有形如

$$
y=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}\left(\beta_{i}>0\right)
$$

的正整数都属于 $W$, 取其中一个

$$
y=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}=a_{j}
$$

这里取定的 $j$, 假定能使前面的 $(*)$ 式仍然成立, 这也只需 $j$ 满足

$$
x=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{k}^{\alpha_{k}}<a_{j},
$$

即 $j \geq N+1$.

对这样的 $j$, 仍存在 $1 \leq i \leq k$, 使 $p_{i} \mid S_{j-1}$. 但由数列定义

$$
\left(a_{j}, S_{j-1}\right)=1,
$$

这表明 $p_{i}(1 \leq i \leq k-1)$ 都不能是 $S_{j-1}$ 的约数.

由此可见, 满足 “ $p_{i} \mid S_{j-1}$ ” 中的 $p_{i}$ 不能是 $p_{1}, p_{2}, \cdots, p_{k-1}$ 之一, 只能是剩下的唯一质因子 $p_{k}$, 它便是我们要找的作为公共质因子 $p$.

【目标转换】这样, 子目标变为:存在 $j \geq N+1$, 使

$$
p_{k}\left|S_{j}, p_{k}\right| S_{j-1} \text {. }
$$

对上面选定的 $j\left(y \in W\right.$ 推得 $\left.y=a_{j}\right)$, 并未保证 $j \geq N+1$, 需要优化.

【优化假设】显然, 为保证 $j \geq N+1$, 只需 $y=a_{j}$ 异于 $a_{1}, a_{2}, \cdots, a_{N}$.

此外, (*)中的 “ $p_{i} \mid S_{j-1}$ ” 是由 “ $x<a_{j}$ ” 推得的, 为了存在 $1 \leq i \leq k$, 使 $p_{i} \mid S_{j-1}$, 必须 $x<a_{j}$, 即

$$
p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{k}^{\alpha_{k}}=x<a_{j}=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}
$$

所以, 归纳假设中所取的正整数 $y$ 应同时满足: $y>x$, 且 $y$ 异于 $a_{1}, a_{2}, \cdots, a_{N}$ (以保证 $j \geq N+1$ ), 这两点能否同时做到? 一类似进行反面剔除即可.

【反面剔除】注意到 $y$ 的 “表达式”中的指数 $\beta_{i}(1 \leq i \leq k-1)$ 可任意大,从而

$$
y=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}
$$

可任意大, 取 $y=a_{j}>x$, 且 $y=a_{j}$ 异于 $a_{1}, a_{2}, \cdots, a_{N}$ 是可行的.

对于上述“优化” 选定的 $y=a_{j}$, 有 $a_{j}>x$, 且 $j \geq N+1$.

但 $x$ 异于 $a_{1}, a_{2}, \cdots, a_{j-1}$ (因为 $x$ 不属于 $W$ ), 所以 $\left(x, S_{j-1}\right) \neq 1$ (否则与 $a_{j}$ 的最小性矛盾), 即存在 $1 \leq i \leq k$, 使 $p_{i} \mid S_{j-1}$.

进一步, $j+1 \geq N+1$, 且 $a_{j}>x$, 对上述取定的 $j$, 又存在存在 $1 \leq t \leq k$,使 $p_{t} \mid S_{j}$.

由数列定义, 有

$$
\left(a_{j}, S_{j-1}\right)=1
$$

进而有，

$$
\left(a_{j}, S_{j}\right)=\left(a_{j}, S_{j}-a_{j}\right)=\left(a_{j}, S_{j-1}\right)=1 .
$$

再注意到

$$
a_{j}=y=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}
$$

含有质因数 $p_{1}, p_{2}, \cdots, p_{k-1}$, 所以 $S_{j}, S_{j-1}$ 都不含质因数 $p_{1}, p_{2}, \cdots, p_{k-1}$. 只能是 $i=t=k$, 即 $p_{k}\left|S_{j-1}, p_{k}\right| S_{j}$.

但

$$
\left(S_{j}, S_{j-1}\right)=\left(S_{j}-S_{j-1}, S_{j-1}\right)=\left(a_{j}, S_{j-1}\right)=1,
$$

矛盾.

【新写】设数列 $\left\{a_{n}\right\}$ 各项组成的集合为 $W$, 我们证明任何正整数都属于 $W$. 对正整数所含不同质因数个数 $\tau$ 归纳. 当 $\tau=1$ 时, 假定存在 $p^{\alpha} \notin W$, 因为
不超过 $p^{\alpha}$ 的正整数只有有限个, 必存在正整数 $N, N+1$, 使

$$
p^{\alpha}<a_{N+1}, p^{\alpha}<a_{N}+2 .
$$

易知 $\left(p^{\alpha}, S_{N}\right) \neq 1$, 否则与 $a_{N+1}$ 的最小性矛盾, 所以 $p \mid S_{N}$. 同理, $p \mid S_{N+1}$.但

$$
\left(S_{N+1}, S_{N}\right)=\left(S_{N+1}-S_{N}, S_{N}\right)=\left(a_{N+1}, S_{N}\right)=1,
$$

矛盾.

所以, $\tau=1$ 时结论成立.

设 $\tau<k(k \geq 2)$ 时结论成立, 考察 $\tau=k$ 的情形.

假定存在正整数

$$
x=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{k}^{\alpha_{k}} \notin W
$$

必存在正整数 $N$, 使 $n \geq N+1$ 时, $a_{n}>x$.

由归纳假设, 形如 $p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}$ 的数都属于 $W$, 这样的数有无穷多, 可取正整数

$$
a_{j}=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}
$$

使 $a_{j}$ 异于 $a_{1}, a_{2}, \cdots, a_{N}$ (即 $j \geq N+1$ ), 且 $a_{j}>x$.

但 $x$ 异于 $a_{1}, a_{2}, \cdots, a_{j-1}$ (因为 $x$ 不属于 $W$ ), 所以 $\left(x, S_{j-1}\right) \neq 1$ (否则与 $a_{j}$ 的最小性矛盾), 即存在 $1 \leq i \leq k$, 使 $p_{i} \mid S_{j-1}$.

进一步, $j+1 \geq N+1$, 且 $a_{j}+1>x$, 对上述取定的 $j$, 又存在存在 $1 \leq t \leq k$,使 $p_{t} \mid S_{j}$.

由数列定义, $\left(a_{j}, S_{j-1}\right)=1$, 进而

$$
\left(a_{j}, S_{j}\right)=\left(a_{j}, S_{j}-a_{j}\right)=\left(a_{j}, S_{j-1}\right)=1,
$$

并注意到

$$
a_{j}=y=p_{1}^{\beta_{1}} p_{2}^{\beta_{2}} \cdots p_{k-1}^{\beta_{k-1}}
$$

含有质因数 $p_{1}, p_{2}, \cdots, p_{k-1}$, 所以 $S_{j}, S_{j-1}$ 都不含质因数 $p_{1}, p_{2}, \cdots, p_{k-1}$. 只能是 $i=t=k$, 即 $p_{k}\left|S_{j-1}, p_{k}\right| S_{j}$. 但

$$
\left(S_{j}, S_{j-1}\right)=\left(S_{j}-S_{j-1}, S_{j-1}\right)=\left(a_{j}, S_{j-1}\right)=1,
$$

矛盾, 故 $\tau=k$ 时结论成立, 命题获证.

