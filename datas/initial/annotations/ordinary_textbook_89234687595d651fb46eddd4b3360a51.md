数学新星网 $\%$ 教师专栏

www.nsmath.cn/jszl

# 2023 年中国数学奥林匹克希望联盟夏令营加试试题解答与评析 

董子超 ${ }^{1}$ 吴茁 ${ }^{2}$<br>(1. 卡耐基梅隆大学; 2. 华威大学)

2023 年中国数学奥林匹克希望联盟夏令营于 7 月 17 日开幕, 7 月 23 日闭幕,由河北省石家庄第二中学承办. 本次夏令营活动一共组织了三场测试, 其中第一第三场是传统的高中联赛模拟, 而第二场是有所创新的测试 (在 4 个小时内考六道解答题). 本文整理这些试题以及解答 (不含一试).

以下的题号 a.b 表示第 $\mathrm{a}$ 场考试的第 $\mathrm{b}$ 题.

本文的第一作者作为夏令营加试命题组组长, 感谢希望联盟总教练北京十一学校张浩老师的信任, 感谢北京大学贾镐铮, 重庆市巴蜀中学刘艺, 江苏省苏州中学吴吴, 陕西省西安市高新一中杨光, 辽宁省实验中学张桐 (姓氏顺序) 等老师在加试命题工作中付出的辛苦劳动.

## I. 试 题

1.1 设 $a_{1}, a_{2}, \cdots, a_{18}$ 均为非零实数. 求下式的最小可能值:

$$
S=\sum_{i=1}^{18} \sum_{j=1}^{18} \frac{\left(a_{i}+a_{j}\right)^{2}\left(1+a_{i}^{2} a_{j}^{2}\right)}{a_{i}^{2} a_{j}^{2}}
$$

(北京十一学校 许文昌 供题)

1.2 如图, 在 $\triangle A B C$ 中, $\angle A=90^{\circ}, I$ 是内心, 内切圆 $\omega$ 与 $C A, A B$ 边分别相切于 $E, F$. 点 $M$ 是 $B C$ 边的中点, 线段 $E F$ 上的一点 $R$ 使得 $\angle I R F=\angle I M B$.设 $P, Q$ 两点分别为线段 $B I, C I$ 的中点. 证明: $P R=Q R$.

(北京大学 邹听雨 供题)

1.3 求最大的实数 $c$, 满足: 对任意正整数 $n>1$, 均存在 $\{1,2, \cdots, n\}$ 的子集 $A$, 使得 $|A| \geq c n$, 且对任意 $x, y, z \in A$ (允许相同), 均有 $n$ 不是 $x+y-z$ 的约
数.

(华威大学 吴茁 供题)

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-02.jpg?height=414&width=774&top_left_y=364&top_left_x=641)

1.2 题图

1.4 设 $\left\{x_{k}\right\}=\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ 为有限项的实数数列. 称 $\left\{x_{k}\right\}$ 为 $N-$ 数列, 是指: 存在 $1 \leq i \leq j \leq n$, 使得 $\left(x_{1}, \cdots, x_{i}\right)$ 严格递增且 $\left(x_{i}, \cdots, x_{j}\right),\left(x_{j}, \cdots, x_{n}\right)$ 分别严格单调. 求最大的正整数 $m$, 使得任何 $1,2, \cdots, 2023$ 的排列都有 $m$ 项的 $N$-子列.

注: 数列 $\left(x_{1}, \cdots, x_{p}\right)$ 的子列即形如 $\left(x_{i_{1}}, \cdots, x_{i_{q}}\right)$ 的数列, 其中下标 $1 \leq i_{1}<$ $\cdots<i_{q} \leq n$.

(卡耐基梅隆大学 董子超 供题)

2.1 在平面直角坐标系中, 甲乙二人在下面的点集 $P$ 上面玩一个游戏:

$$
P=\{(x, y) \mid x, y \in\{0, \pm 1, \pm 2\}\} .
$$

甲将 $P$ 的 25 个点中的 13 个染为红色. 乙手中有一个探测器, 可以探知以下各直线上红点的个数.

(1) 五条坚直线 $x=0, \pm 1, \pm 2$;

(2) 五条水平线 $y=0, \pm 1, \pm 2$;

(3) 九条斜线 $x+y=0, \pm 1, \pm 2, \pm 3, \pm 4$;

(4) 九条斜线 $x-y=0, \pm 1, \pm 2, \pm 3, \pm 4$.

问：乙是否总能确定 $P$ 中所有红点的位置? 证明你的结论.

(卡耐基梅隆大学 董子超 供题)

2.2 给定锐角 $\triangle A B C$, 其中 $A B<A C<B C$.

(1) 请用尺规作出内切圆在 $B C$ 边上的切点 $H$ (无需作内切圆), 使得作图过程中出现的不同圆和直线的总数不超过 6 . (这里可以认为直线 $A B, B C, C A$ 都是已知的. )

(2) 请用尺规作图确定点 $P$, 使得四边形 $A B P C$ 既有外接圆又有内切圆. (不需要解释熟知的尺规作图操作, 如构作平行线, 垂线, 角平分线等等.)
注: 需要分别证明 (1) 所作点 $H$ 与 (2) 所作点 $P$ 满足要求.

(华威大学 吴茁供题)

2.3 给定正整数 $n$, 记 $\omega=\mathrm{e}^{\frac{2 \pi \mathrm{i}}{n}}$. 设 $z$ 为复数, 求下式的最小可能值:

$$
S=\sum_{k=1}^{n}\left|\prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)\right|
$$

(华威大学 吴茁供题)

2.4 是否存在正整数的严格递增等差数列 $a_{1}, a_{2}, \cdots, a_{2023}$, 使得

$$
\nu_{2}\left(\mathrm{C}_{a_{2}}^{a_{1}}\right), \quad \nu_{2}\left(\mathrm{C}_{a_{3}}^{a_{2}}\right), \quad \cdots, \quad \nu_{2}\left(\mathrm{C}_{a_{2023}}^{a_{2022}}\right)
$$

构成公差为 2023 的等差数列? 证明你的结论.

注: 对正整数 $n$, 记 $\nu_{2}(n)$ 为 $n$ 所含素因子 2 的个数, 即最大的正整数 $k$ 使 $2^{k} \mid n$ 且 $2^{k+1} \nmid n$.

(北京大学 贾镐铮 供题)

2.5 在 $\triangle A B C$ 中, 已知 $A B<A C, D$ 在形内运动, 且满足 $A B \cdot C D=A C \cdot B D$.证明: 存在定点 $O$, 使得可以将 $\triangle A B D, \triangle A C D$ 的内心, 旁心共 8 个点分成两组,满足: 每组的 4 个点共圆, 且它们所共两圆的根轴恒过点 $O$.

(北京大学 贾镐铮 苏州中学 吴吴 巴蜀中学 徐炜杰 供题)

2.6 设 $A, B, C$ 均为实数集合. 证明:

$$
|A+B+C|^{2} \leq|A+B\|B+C\| C+A| .
$$

这里 $X+Y=\{x+y \mid x \in X, y \in Y\}$.

(卡耐基梅隆大学 董子超 供题)

3.1 如图, 两圆 $\Omega_{1}, \Omega_{2}$ 相交于 $X, Y$ 两点, 它们各自的圆心分别为 $O_{1}, O_{2}$. 圆 $\Omega_{1}$ 上的一点 $A$, 圆 $\Omega_{2}$ 上的一点 $B$ 使 $A B$ 是 $\Omega_{1}, \Omega_{2}$ 的公切线. 过 $X$ 分别作 $\Omega_{1}, \Omega_{2}$ 的切线与直线 $O_{1} O_{2}$ 交于 $K, L$ 两点. 证明: $A K, B L, X Y$ 三线共点.

(卡耐基梅隆大学董子超 北京大学邹听雨供题)

3.2 设 $a_{1}, a_{2}, \cdots, a_{100}$ 是和为 1000 的 100 个正整数. 记

$$
S=a_{1} a_{2}+a_{2} a_{3}+\cdots+a_{99} a_{100} .
$$

求 $S$ 的最大值, 并确定使 $S$ 取到最大值的所有可能数组 $\left(a_{1}, a_{2}, \cdots, a_{100}\right)$ 的个数.

(华威大学吴茁供题)

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-04.jpg?height=645&width=854&top_left_y=226&top_left_x=607)

3.1 题图

3.3 求最大的正整数 $n$, 使得平面直角坐标系 $x O y$ 内存在 $n$ 个各边平行于坐标轴的矩形区域 $C_{1}, C_{2}, \cdots, C_{n}$ (不含边界), 满足: 若 $i \neq j$, 则 $C_{i}, C_{j}$ 无公共点当且仅当 $i+j$ 是完全平方数.

(华威大学 吴茁供题)

3.4 给定奇素数 $p$ 使得 $p \not \equiv 3(\bmod 8)$. 定义集合

$$
Q=\left\{x^{2} \text { 模 } p \text { 所得余数 } \mid x=1,2, \cdots, p-1\right\} \text {. }
$$

证明: 可以将 $Q$ 中的所有元素排列在圆周上, 使得相邻两个元素的和模 $p$ 的余数不属于 $Q$.

(卡耐基梅隆大学 董子超 十一学校王志博 供题)

## II . 解答与评注

1.1 设 $a_{1}, a_{2}, \cdots, a_{18}$ 均为非零实数. 求下式的最小可能值:

$$
S=\sum_{i=1}^{18} \sum_{j=1}^{18} \frac{\left(a_{i}+a_{j}\right)^{2}\left(1+a_{i}^{2} a_{j}^{2}\right)}{a_{i}^{2} a_{j}^{2}}
$$

解 所求 $S$ 的最小值为 1296 .

一方面, 当 $\left(a_{1}, a_{2}, \cdots, a_{18}\right)=(\underbrace{1, \cdots, 1}_{9}, \underbrace{-1, \cdots,-1}_{9})$ 时, 不难验证 $S=1296$.另一方面, 我们说明 $S \geq 1296$.

事实上, 当 $a_{i}, a_{j}$ 同号, 即 $a_{i} a_{j}>0$ 时, 设 $\left(\left|a_{i}\right|,\left|a_{j}\right|\right)=(x, y)$ 且 $x, y>0$, 则

$$
\frac{\left(a_{i}+a_{j}\right)^{2}\left(1+a_{i}^{2} a_{j}^{2}\right)}{a_{i}^{2} a_{j}^{2}}=\frac{(x+y)^{2}\left(1+x^{2} y^{2}\right)}{x^{2} y^{2}} \geq \frac{(2 \sqrt{x y})^{2}(2 x y)}{x^{2} y^{2}}=8,
$$

其中的“ $\geq$ ”用到了均值不等式.

由 $(*)$ 得

$$
\begin{aligned}
S & =\sum_{i=1}^{18} \sum_{j=1}^{18} \frac{\left(a_{i}+a_{j}\right)^{2}\left(1+a_{i}^{2} a_{j}^{2}\right)}{a_{i}^{2} a_{j}^{2}} \geq \sum_{\substack{1 \leq i, j \leq 18 \\
a_{i} a_{j}>0}} \frac{\left(a_{i}+a_{j}\right)^{2}\left(1+a_{i}^{2} a_{j}^{2}\right)}{a_{i}^{2} a_{j}^{2}} \\
& \geq 8 \sum_{i=1}^{18} \sum_{j=1}^{18} \mathbf{1}_{\left\{a_{i} a_{j}>0\right\}}=8\left(n_{+}^{2}+n_{-}^{2}\right) \geq 8\left(9^{2}+9^{2}\right)=1296,
\end{aligned}
$$

其中 $n_{+}, n_{-}$分别表示 $a_{1}, a_{2}, \cdots, a_{18}$ 中正数和负数的个数, 最后一个 “ $\geq$ "用到了 $f(x)=x^{2}$ 的凸性.

综上所述, $S$ 的最小可能值为 1296 .

评注 本题的难度略低于常规的联赛第一题, 考场平均得分 29.52/40. 不难看出只当 $a_{i}, a_{j}$ 同号时它们才对 $S$ 产生本质的贡献，由此作正负分离并应用均值不等式很容易解决问题。值得一提的是，一部分考生因没有想清楚求和的范围导致答案算错失分.

1.2 如图, 在 $\triangle A B C$ 中, $\angle A=90^{\circ}, I$ 是内心, 内切圆 $\omega$ 与 $C A, A B$ 边分别相切于 $E, F$. 点 $M$ 是 $B C$ 边的中点, 线段 $E F$ 上的一点 $R$ 使得 $\angle I R F=\angle I M B$.设 $P, Q$ 两点分别为线段 $B I, C I$ 的中点. 证明: $P R=Q R$.

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-05.jpg?height=471&width=882&top_left_y=1546&top_left_x=581)

证明 分别延长 $B I, C I$ 交直线 $E, F$ 于 $U, V$. 连 $I E, I F, B V, C U, P V, Q U$.

因为 $\angle A=90^{\circ}$, 所以由内心的性质可得 $\angle A E F=\angle A F E=45^{\circ}, \angle B I C=$ $135^{\circ}$. 于是

$$
\angle B F V=\angle A F E=45^{\circ}=180^{\circ}-\angle B I C=\angle B I V,
$$

故 $B, I, F, V$ 四点共圆. 这表明 $\angle B V I=\angle B F I=90^{\circ}$.

同理可得 $\angle C U I=90^{\circ}$, 故 $B, C, U, V$ 四点共圆, 且 $\triangle I B V, \triangle I C U$ 都是等腰直角三角形.
因为 $P, Q$ 分别为 $B I, C I$ 的中点, 所以 $\angle U P V=\angle U Q V=90^{\circ}$, 故 $P, Q, U, V$ 四点共圆.

注意到 $\triangle I B C(M) \sim \triangle I V U(R)$, 则 $R$ 是线段 $U V$ 的中点. 又因为 $U V$ 是圆 $(P Q U V)$ 的直径, 所以 $R$ 是圆心, 因此 $R P, R Q$ 都是半径, 故 $R P=R Q$.

评注 本题的难度介于常规的联赛第一二题之间, 考场平均得分 $27.22 / 40$. 这题的重要考点即解答中的 $U, V$ 两点 (有时被称为伊朗点), 它们关联许多条优雅的几何性质. 如果不熟悉这一结构的话, 在阅卷过程中我们也看到过不少其它的几何做法以及解析几何, 三角函数等计算做法.

1.3 求最大的实数 $c$, 满足: 对任意正整数 $n>1$, 均存在 $\{1,2, \cdots, n\}$ 的子集 $A$, 使得 $|A| \geq c n$, 且对任意 $x, y, z \in A$ (允许相同), 均有 $n$ 不是 $x+y-z$ 的约数.

解 所求最大的实数 $c=\frac{2}{7}$.

一方面, 我们说明: 若 $n=7$, 则 $|A| \leq 2$, 从而 $c \leq \frac{2}{7}$.

显然 $7 \notin A$. 又因为 $|A \cap\{1,2,4\}| \leq 1$ 且 $|A \cap\{3,5,6\}| \leq 1$, 所以 $|A| \leq 2$.

另一方面, 我们说明 $c=\frac{2}{7}$ 满足要求.

取 $A=\left(\frac{n}{3}, \frac{2 n}{3}\right] \cap \mathbb{Z}$. 则 $x, y, z \in A$ 蕴含 $0<x+y-z<n$, 故 $n \nmid x+y-z$.

当 $n=3 k-1\left(k \in \mathbb{N}_{+}\right)$时, 易见 $\frac{|A|}{n}=\frac{k}{3 k-1}>\frac{2}{7}$.

当 $n=3 k\left(k \in \mathbb{N}_{+}\right)$时，易见 $\frac{|A|}{n}=\frac{k}{3 k}>\frac{2}{7}$.

当 $n=3 k+1\left(k \in \mathbb{N}_{+}\right)$时, 易见 $\frac{|A|}{n}=\frac{k}{3 k+1}$,

- 若 $k \geq 2$, 则 $\frac{|A|}{n}=\frac{k}{3 k+1} \geq \frac{2}{7}$.
- 若 $k=1$, 则重新选取 $A=\{1,3\}$ 即 $|A|>\frac{2 n}{7}$.

综合以上讨论可知 $c=\frac{2}{7}$ 满足要求.

综上所述, 满足要求的最大实数 $c=\frac{2}{7}$.

评注 本题的难度介于常规的联赛第二三题之间, 考场平均得分 $15.28 / 50$. 解题的关键在于通过探索较小的情形猜出答案. 只要多花一点时间尝试, 就不至于凭直觉认为答案是 $\frac{1}{3}$ 进而南辕北辙无功而返. 创作这个问题的灵感来自对最大无和子集的经典研究结果, 参见文献 [3].

1.4 设 $\left\{x_{k}\right\}=\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ 为有限项的实数数列. 称 $\left\{x_{k}\right\}$ 为 $N-$ 数列, 是指: 存在 $1 \leq i \leq j \leq n$, 使得 $\left(x_{1}, \cdots, x_{i}\right)$ 严格递增且 $\left(x_{i}, \cdots, x_{j}\right),\left(x_{j}, \cdots, x_{n}\right)$ 分别严格单调. 求最大的正整数 $m$ ，使得任何 $1,2, \cdots, 2023$ 的排列都有 $m$ 项的 $N$-子列。

注: 数列 $\left(x_{1}, \cdots, x_{p}\right)$ 的子列即形如 $\left(x_{i_{1}}, \cdots, x_{i_{q}}\right)$ 的数列, 其中下标 $1 \leq i_{1}<$
$\cdots<i_{q} \leq n$.

解 所求最大的正整数 $m=89$.

一方面, 我们通过构造说明 $m \leq 89$.

考虑 $1,2, \cdots, 2023$ 的排列

$$
\left\{a_{k}\right\}=(\underbrace{45,44, \cdots, 1}_{\text {段落 } 1}, \underbrace{90,89, \cdots, 46}_{\text {段洛 } 2}, \cdots, \underbrace{2023,2022, \cdots, 1981}_{\text {段落 } 45}) .
$$

设 $\left\{x_{l}\right\}=\left(x_{1}, \cdots, x_{m}\right)$ 是 $\left\{a_{k}\right\}$ 的 $N$-子列, 其中下标 $1 \leq i \leq j \leq m$ 使子列 $\left(x_{1}, \cdots, x_{i}\right)$ 严格递增, 子列 $\left(x_{i}, \cdots, x_{j}\right)$ 严格递减且 $\left(x_{j}, \cdots, x_{m}\right)$ 严格单调. 此时 $\left(x_{i}, \cdots, x_{j}\right)$ 必定含于某个段落 $t$, 从而

$$
\left\{\begin{array}{l}
i \leq t \\
j-i+1 \leq 45 \\
m-j+1 \leq 46-t
\end{array} \Longrightarrow m \leq 89\right.
$$

另一方面, 我们说明 $1,2, \cdots, 2023$ 的任何排列 $\left\{x_{k}\right\}$ 都有 89 项的 $N$-子列.

设 $\left\{y_{k}\right\}=\left(y_{1}, y_{2}, \cdots, y_{n}\right)$ 为有限项的实数数列. 称 $\left\{y_{k}\right\}$ 为 $V-$ 数列, 是指: 存在下标 $1 \leq i \leq n$, 使得 $\left(y_{1}, \cdots, y_{i}\right)$ 严格递减且 $\left(y_{i}, \cdots, y_{n}\right)$ 是严格单调.

引理 若正整数 $t$ 使得 $n>1+2+\cdots+(t-1)$, 则 $\left\{y_{k}\right\}$ 有 $t$ 项的 $V-$ 子列.

证明 对任意 $s=1,2, \cdots, n$, 定义

- $u(s)$ 为 $\left\{y_{k}\right\}$ 终于 $y_{s}$ 的严格递减子列之最大项数;
- $v(s)$ 为 $\left\{y_{k}\right\}$ 始于 $y_{s}$ 的严格递增子列之最大项数.

不难看出 $s \mapsto(u(s), v(s))$ 是单射, 那么根据 $n>1+2+\cdots+(t-1)$ 可知: $u(\hat{s})+v(\hat{s}) \geq t+1$ 对至少一个 $\hat{s} \in\{1,2, \cdots, n\}$ 成立. 这表明 $y_{\hat{s}}$ 含于 $t$ 项的 $V$-子列, 引理得证.

回到原题. 对任意 $s=1,2, \cdots, n$, 定义

- $u(s)$ 为 $\left\{x_{k}\right\}$ 终于 $x_{s}$ 的严格递增子列之最大项数;
- $v(s)$ 为 $\left\{x_{k}\right\}$ 始于 $x_{s}$ 的 $\mathrm{V}$-子列之最大项数.

易知 $f: s \mapsto(u(s), v(s))$ 是 $\{1,2, \cdots, 2023\} \rightarrow \mathbb{N}_{+}^{2}$ 的单射. 记 $f$ 的像集为 $F$.

断言 对任意正整数 $\lambda$, 使得 $v(s) \leq \lambda$ 的正整数 $s$ 的个数不超过 $1+2+\cdots+\lambda$.

证明 根据引理, 若上述 $s$ 的个数大于 $1+2+\cdots+\lambda$, 则这些下标 $s$ 诱导的子列 $\left\{x_{s_{l}}\right\}$ 之中又存在 $\lambda+1$ 项的 $V-$ 子列 $\left(x_{s_{l_{1}}}, \cdots, x_{s_{l_{\lambda+1}}}\right)$, 从而 $v\left(s_{l_{1}}\right) \geq \lambda+1$. 这与 $v\left(s_{l_{1}}\right) \leq \lambda$ 矛盾! 断言为真.

定义 $S=\left\{(u, v) \in \mathbb{N}_{+}^{2} \mid u+v \leq 89\right\}$. 在断言中取 $\lambda=44$, 注意到

$$
|F|=2023>44 \times 45=(1+2+\cdots+44)+(1+2+\cdots+44)
$$

$$
\geq|F \cap(S \cap\{v \geq 45\})|+|F \cap(S \cap\{v \leq 44\})|=|F \cap S|
$$

则存在 $\hat{s} \in\{1,2, \cdots, 2023\}$ 使得 $u(\hat{s})+v(\hat{s}) \geq 90$. 这表明 $x_{\hat{s}}$ 含于 89 项的 $\mathrm{N}-$ 数列.

综上所述, 满足要求的最大正整数 $m=89$.

评注 本题的难度远高于常规的联赛第四题, 考场平均得分 $1.22 / 50$. 根据问题的叙述容易想到经典的 Erdős-Szekeres 单调子列问题, 但是这题难在如何进行下去. 直接从单调子列入手很难刻画 $N-子$ 子列, 因而需要考虑介千二者之间的 $V-子$列. 显然 $V$-子列的问题更基础, 于是我们应该优先予以解决并找找感觉. 然而问题的又一大难点在于: 即便解决了 $V$-子列的问题, 得到了引理, 仍然不能直接解决原题. 这里我们再回头看取等条件发现一步优化从而提炼出断言后才能彻底解决问题.

本题取材于笔者在 2022 年参与指导的卡耐基梅隆大学 (CMU) 本科生暑期科研项目。

此外, 引理的结果是最优的, 这一点可以从以下数列 $\left(s_{k}=1+2+\cdots+k\right)$ 看出:

$$
(1, \underbrace{3,2}_{\text {段落 } 2}, \underbrace{6,5,4}_{\text {段落 } 3}, \cdots, \underbrace{s_{t-1}, s_{t-1}-1, \cdots, s_{t-2}+1}_{\text {段落 } t-1}) .
$$

2.1 在平面直角坐标系中, 甲乙二人在下面的点集 $P$ 上面玩一个游戏:

$$
P=\{(x, y) \mid x, y \in\{0, \pm 1, \pm 2\}\}
$$

甲将 $P$ 的 25 个点中的 13 个染为红色. 乙手中有一个探测器, 可以探知以下各直线上红点的个数.

(1) 五条坚直线 $x=0, \pm 1, \pm 2$;

(2) 五条水平线 $y=0, \pm 1, \pm 2$;

(3) 九条斜线 $x+y=0, \pm 1, \pm 2, \pm 3, \pm 4$;

(4) 九条斜线 $x-y=0, \pm 1, \pm 2, \pm 3, \pm 4$.

问: 乙是否总能确定 $P$ 中所有红点的位置? 证明你的结论.

解 结论是否定的. 甲可以采取以下的染色方式使乙无法确定红点的位置.
这是因为: 在以上两种染色方式下, 乙对 28 条直线进行探测得到的结果全部对应相同.

评注 本题是简单的组合构造题, 考场平均得分 $28.61 / 50$. 只要不执着地认为“结论是肯定的”就能解决问题. 本题源于对 2018 年美国国家队选拔考试 (USATST) 第 6 题的思考, 构造不唯一.

2.2 给定锐角 $\triangle A B C$, 其中 $A B<A C<B C$.

(1) 请用尺规作出内切圆在 $B C$ 边上的切点 $H$ (无需作内切圆), 使得作图过程中出现的不同圆和直线的总数不超过 6 . (这里可以认为直线 $A B, B C, C A$ 都是已知的. )

(2) 请用尺规作图确定点 $P$, 使得四边形 $A B P C$ 既有外接圆又有内切圆. (不需要解释熟知的尺规作图操作, 如构作平行线, 垂线, 角平分线等等.)

注: 需要分别证明 (1) 所作点 $H$ 与 (2) 所作点 $P$ 满足要求.

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-09.jpg?height=531&width=552&top_left_y=1168&top_left_x=752)

(1) 解 先分四步完成作图:

步骤 1: 以 $B$ 为圆心, 以 $A B$ 为半径作圆与 $B C$ 边交于点 $D$.

步骤 2: 以 $C$ 为圆心, 以 $A C$ 为半径作圆与 $B C$ 边交于点 $E$.

步骤 3: 分别以 $D, E$ 为圆心, 以大于 $\frac{1}{2} D E$ 的相同半径(例如 $D E$ )作两圆交于 $F, G$ 两点.

步骤 4: 连 $F G$ 交 $B C$ 边于点 $H$.

在作图过程中一共出现了 4 个圆和 1 条直线, 圆和直线的总数 $5<6$, 满足要求.

再证明 $H$ 满足要求: 设 $B C=a, C A=b, A B=c$, 则 $B D=c, C E=b$ 且 $D H=E H$ 从而 $B H=B D-D H=c-\frac{D E}{2}=c-\frac{B D+C E-B C}{2}=c-\frac{c+b-a}{2}=\frac{c+a-b}{2}$.
这表明 $H$ 是 $\triangle A B C$ 的内切圆在 $B C$ 边上的切点.

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-10.jpg?height=759&width=669&top_left_y=263&top_left_x=702)

(2) 解 取 $\triangle A B C$ 的内心 $I$, 连 $A I$. 过 $C$ 作 $C D / / A I$ 交 $A B$ 于 $D$. 作 $\triangle B C D$ 的外接圆 $\Omega$. 过 $I$ 作 $B C$ 的垂线交圆 $\Omega$ 的劣弧 $\widehat{B C}$ 于 $E$. 分别作 $B C$ 关于 $B E, C E$ 的对称直线交于 $P$.

下面证明点 $P$ 满足要求.

注意到 $B E, C E$ 分别为 $\angle P B C, \angle P C B$ 的角平分线, 则 $E$ 是 $\triangle B P C$ 的内心,从而

$\angle B P C=2 \angle B E C-180^{\circ}=2\left(180^{\circ}-\angle B D C\right)-180^{\circ}=2\left(180^{\circ}-\frac{A}{2}\right)-180^{\circ}=180^{\circ}-A$.

这表明 $A, B, P, C$ 四点共圆, 即四边形 $A B P C$ 有外接圆.

因为 $I E \perp B C$, 所以 $\triangle A B C$ 与 $\triangle P B C$ 各自的内切圆在 $B C$ 边上的切点重合, 故

$$
\frac{A B+B C-A C}{2}=\frac{P B+B C-P C}{2} \Longrightarrow A B+P C=A C+P B
$$

因此根据皮托 (Pitot) 定理可知四边形 $A B P C$ 有内切圆.

综上所述, 所作点 $P$ 使得四边形 $A B P C$ 既有外接圆又有内切圆, 满足要求.

评注 本题是中等难度的尺规作图平面几何题, 考场平均得分 28.39/50. 这题的 (1) 十分简单, 只要从 $B H$ 长度而不是构作内心的角度切入思考就能顺利解决.事实上, 这里对几何对象个数提出限制就是为了迫使考生分析 $B H$ 的长度, 进而为中等偏难的 (2) 做铺垫. 如果不熟悉双心四边形的几何性质 (我们相信绝大多数竞赛考生都不熟悉), 那么 (2) 的切入其实是有相当难度的, 但是如果从 (1) 汲取计算边长的灵感, 结合角度推导就能解决问题了. 在阅卷过程中, 我们也看到不少 $(2)$的另解, 但是它们的复杂程度都显著高于这里的解答, 因而就不再收录了。

2.3 给定正整数 $n$, 记 $\omega=\mathrm{e}^{\frac{2 \pi \mathrm{i}}{n}}$. 设 $z$ 为复数, 求下式的最小可能值:

$$
S=\sum_{k=1}^{n}\left|\prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)\right|
$$

解 所求 $S$ 的最小值为 $n$.

一方面, 取 $z=0$ 时可得

$$
S=\sum_{k=1}^{n}\left|\prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(-\omega^{j}\right)\right|=\sum_{k=1}^{n} 1=n
$$

另一方面, 我们说明 $S \geq n$.

对任意复数 $z \neq \omega, \omega^{2}, \cdots, \omega^{n}$, 注意到

$$
\prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)=\frac{\prod_{1 \leq j \leq n}\left(z-\omega^{j}\right)}{z-\omega^{k}}=\frac{z^{n}-1}{z-\omega^{k}}=\frac{z^{n}-\left(\omega^{k}\right)^{n}}{z-\omega^{k}}=\sum_{j=0}^{n-1}\left(\omega^{k}\right)^{j} z^{n-1-j}
$$

则上式的最左边与最右边作为关于 $z$ 的 $n-1$ 次多项式恒等.

因此

$$
\sum_{k=1}^{n} \omega^{k} \cdot \prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)=\sum_{k=1}^{n} \omega^{k} \cdot \sum_{j=0}^{n-1} \omega^{j k} z^{n-1-j}=\sum_{j=0}^{n-1} z^{n-1-j} \cdot \sum_{k=1}^{n} \omega^{(j+1) k}=n
$$

其中最后一个“ = ”用到了

$$
\sum_{k=1}^{n} \omega^{(j+1) k}= \begin{cases}0, & \text { 若 } j=0,1, \cdots, n-2, \\ n, & \text { 若 } j=n-1 .\end{cases}
$$

因此

$$
S=\sum_{k=1}^{n}\left|\prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)\right|=\sum_{k=1}^{n}\left|\omega^{k} \cdot \prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)\right| \geq\left|\sum_{k=1}^{n} \omega^{k} \cdot \prod_{\substack{1 \leq j \leq n \\ j \neq k}}\left(z-\omega^{j}\right)\right|=n
$$

综上所述, $S$ 的最小可能值为 $n$.

评注 本题是中等难度的复数题, 考场平均得分 $13.11 / 50$. 经过一些尝试不难猜出答案, 但是要证明 $S \geq n$ 需要一定的复数技巧。事实上, 对这个问题我们的工具基本只有绝对值(模长)不等式, 于是一个大胆的设想就是通过配凑一列模长 1 的复系数将 $S$ 的各个加项带权求和进而消去所有的含 $z$ 项. 这一点其实不难实现, 它只用到了单位根优良的代数性质。问题至此迎刃而解.

2.4 是否存在正整数的严格递增等差数列 $a_{1}, a_{2}, \cdots, a_{2023}$, 使得

$$
\nu_{2}\left(\mathrm{C}_{a_{2}}^{a_{1}}\right), \quad \nu_{2}\left(\mathrm{C}_{a_{3}}^{a_{2}}\right), \quad \cdots, \quad \nu_{2}\left(\mathrm{C}_{a_{2023}}^{a_{2022}}\right)
$$

构成公差为 2023 的等差数列? 证明你的结论.

注: 对正整数 $n$, 记 $\nu_{2}(n)$ 为 $n$ 所含素因子 2 的个数, 即最大的正整数 $k$ 使 $2^{k} \mid n$ 且 $2^{k+1} \nmid n$.

解 结论是肯定的.

取定正整数 $M>\left\lceil\log _{2} 2023\right\rceil+1$. 令 $N_{i}=2^{x_{i}}=(\overline{1 \underbrace{0 \cdots 0}_{x_{i}}})_{2}$, 其中 $x_{i} \geq M$ 是待定的正整数.

以下用 $\langle m\rangle_{i}$ 表示十进制正整数 $m$ 在二进制下所对应的长度为 $x_{i}$ 之字符串 (可能补 0$)$. 构造

$$
\begin{aligned}
& a_{1}=(\underbrace{\overline{0\left\langle N_{2022}-2022\right\rangle_{2022}}}_{\text {段落2022 }} \underbrace{0\left\langle N_{2021}-2021\right\rangle_{2021}}_{\text {段落2021 }} \cdots \underbrace{0\left\langle N_{2}-2\right\rangle_{2}}_{\text {段落 } 2} \underbrace{0\left\langle N_{1}-1\right\rangle_{1}}_{\text {段落1 }})_{2} \text {, }
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-12.jpg?height=163&width=760&top_left_y=1209&top_left_x=388)

这里多余的 0 仅仅用于将段落长度对齐. 对 $i=2,3, \cdots, 2023$, 令 $a_{i}=a_{1}+(i-1) d$,则二进制加法 $a_{i-1}+d=a_{i}$ 的进位次数是 $x_{i}+y_{i}$, 其中 $x_{i}, y_{i}$ 分别为段落 $i$ 和其余段落上的进位次数. 不难看出 $y_{i} \leq M$.

取 $x_{i}=2023(M+i)-y_{i}(i=1,2, \cdots, 2023)$, 则二进制下 $a_{i-1}+d=a_{i}$ 恰进位 $2023(M+i)$ 次. 根据库默尔 (Kummer) 定理可知 $\nu_{2}\left(\mathrm{C}_{a_{i+1}}^{a_{i}}\right)=2023(M+i)$, 故 $\nu_{2}\left(\mathrm{C}_{a_{2}}^{a_{1}}\right), \nu_{2}\left(\mathrm{C}_{a_{3}}^{a_{2}}\right), \cdots, \nu_{2}\left(\mathrm{C}_{a_{2023}}^{a_{2022}}\right)$ 构成公差为 2023 的等差数列.

评注 本题是困难的数论构造题, 考场平均得分 $3.28 / 50$. 这题的主要难点在于题面有点抽象, 且在不知道存在与否的前提下难以确定思考方向. 事实上, 数论中的结构灵活性往往比乍看上去要高得多, 因此面对这样的问题可以认为“存在”之可能性应高于“不存在”之可能性。如果从构造的角度入手思考, 那么根据库默尔(Kummer)定理我们就是要分析若干个形成等差数列的数在二进制下的加法. 为了使结构易于掌控, 一种合宜的切入方式就是将 $a_{1}, a_{2}, \cdots, a_{2023}$ 想象为若干个“间隔很远的段”. 这也就是说: 我们要试图调配段中的 0,1 生成等差数列, 同时考虑段与段之间插入足够多个 0 . 在这个基础上实现解答中的构造是不困难的, 我们认为:这个新颖的问题使绝大多数考生望而却步, 无法冷静下来思考分析有关联的数论结构进而寻找解决方案.

2.5 在 $\triangle A B C$ 中, 已知 $A B<A C, D$ 在形内运动, 且满足 $A B \cdot C D=A C \cdot B D$.证明：存在定点 $O$, 使得可以将 $\triangle A B D, \triangle A C D$ 的内心，旁心共 8 个点分成两组,满足: 每组的 4 个点共圆, 且它们所共两圆的根轴恒过点 $O$.

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-13.jpg?height=819&width=1402&top_left_y=433&top_left_x=333)

证明 如图将 8 个内心与旁心分别记作 $I_{1}, I_{2}, J_{1}, J_{2}, K_{1}, K_{2}, L_{1}, L_{2}$.

注意到 $\frac{A B}{B D}=\frac{A C}{C D}$, 则 $B I_{1} L_{1}, C I_{2} L_{2}, A D$ 三线共点(于 $U$ ). 又因为 $\angle I_{1} D L_{1}=$ $\angle I_{1} A L_{1}=90^{\circ}$, 所以 $A, I_{1}, D, L_{1}$ 四点共圆. 同理可知 $A, I_{2}, D, L_{2}$ 四点共圆.

由圆幕定理得 $U I_{1} \cdot U L_{1}=U A \cdot U D=U I_{2} \cdot U L_{2}$, 于是根据圆幂定理的逆定理得 $I_{1}, I_{2}, L_{1}, L_{2}$ 四点共圆. 类似地 (考虑 $K_{1} J_{1}, K_{2} J_{2}, A D$ 三线共点于 $V$ )有 $K_{1}, K_{2}, J_{2}, J_{1}$ 四点共圆.

点 $D$ 在 $\triangle A B C$ 的 $A$-阿波罗尼斯(Apollonius)圆上运动, 设该圆与 $B C$ 交于 $X, Y$, 则

$$
\frac{B X}{X C}=\frac{A B}{A C}=\frac{B D}{C D}=\frac{A B+B D}{A C+C D}
$$

根据内心的性质可知

$$
\left\{\begin{array}{l}
\frac{U I_{1}}{I_{1} B}=\frac{A D}{A B+B D} \\
\frac{U I_{2}}{I_{2} C}=\frac{A D}{A C+C D}
\end{array} \quad \Longrightarrow \frac{U I_{2}}{I_{2} C} \cdot \frac{C X}{X B} \cdot \frac{B I_{1}}{I_{1} U}=1\right.
$$

于是由梅涅劳斯(Menelaus)定理的逆定理得 $X, I_{1}, I_{2}$ 三点共线.

同理可得 $X \in I_{1} I_{2} \cap J_{1} J_{2} \cap K_{1} K_{2} \cap L_{1} L_{2}$. 类似地有 $Y \in I_{1} L_{2} \cap I_{2} L_{1} \cap J_{1} K_{2} \cap$ $J_{2} K_{1}$.

取线段 $X Y$ 的中点 $O$, 下面证明

$$
\operatorname{pow}\left(O,\left(I_{1} I_{2} L_{1} L_{2}\right)\right)=\operatorname{pow}\left(O,\left(J_{1} J_{2} K_{2} K_{1}\right)\right)
$$

从而定点 $O$ 在两圆的根轴上.

设 $\left(I_{1} I_{2} L_{1} L_{2}\right)$ 的圆心为 $M$, 半径为 $r$, 则由中线长公式得

$$
O M^{2}-r^{2}=\frac{1}{2}\left(X M^{2}-r^{2}\right)+\frac{1}{2}\left(Y M^{2}-r^{2}\right)-\frac{1}{4} X Y^{2} .
$$

取完全四边形 $X I_{1} Y I_{2} L_{1} L_{2}$ 的密克尔(Miquel) 点 $R$, 则

$$
\begin{aligned}
4 \operatorname{pow}\left(O,\left(I_{1} I_{2} L_{1} L_{2}\right)\right) & =2 \operatorname{pow}\left(X,\left(I_{1} I_{2} L_{1} L_{2}\right)\right)+2 \operatorname{pow}\left(Y,\left(I_{1} I_{2} L_{1} L_{2}\right)\right)-X Y^{2} \\
& =2\left(X I_{1} \cdot X I_{2}+Y I_{1} \cdot Y I_{2}\right)-X Y^{2} \\
& =2(X R \cdot X Y+Y R \cdot Y X)-X Y^{2} \\
& =X Y^{2} .
\end{aligned}
$$

类似地有 $4 \operatorname{pow}\left(O,\left(K_{1} K_{2} J_{2} J_{1}\right)\right)=X Y^{2}$, 这表明 $O$ 在两圆 $\left(I_{1} I_{2} L_{1} L_{2}\right),\left(K_{1} K_{2} J_{2} J_{1}\right)$的根轴上.

评注 本题是困难的非常规平面几何题, 考场平均得分 4.11/50. 这题是命题组的吴昊与贾镐铮两位老师根据徐炜杰同学提交的问题进行二次创作得到的, 它的主要难点在于画图. 在不借助作图软件的前提下, 想准确绘制 8 个内心旁心几乎是不可能完成的任务. 因此对共圆分组的思考不能只借助图形直观, 而是要理解几何结构中的对称性. 有了两个圆之后, 对 $O$ 的探寻应进一步挖掘 $D$ 的阿氏圆轨迹,最终结合共圆共线的分析以及对圆幂理论和密克(Miquel) 点结构的思考解决问题.

2.6 设 $A, B, C$ 均为实数集合. 证明:

$$
|A+B+C|^{2} \leq|A+B||B+C||C+A| .
$$

这里 $X+Y=\{x+y \mid x \in X, y \in Y\}$.

证明 对 $|A|$ 归纳. 当 $|A|=1$ 时, 要证明的不等式即

$$
|B+C|^{2} \leq|B||B+C||C| \Longleftarrow|B+C| \leq|B||C| \text {. }
$$

因为 $(b, c) \mapsto b+c$ 是 $B \times C \rightarrow B+C$ 的满射, 所以上式成立. 这就完成了归纳奠基.

假设比 $|A|$ 小的情形都已证明. 考虑 $|A|$ 的情形: 定义

$U=(A+B+C) \backslash\left(A^{\prime}+B+C\right), V=(A+B) \backslash\left(A^{\prime}+B\right), W=(A+C) \backslash\left(A^{\prime}+C\right)$.

任取 $\hat{a} \in A$. 记 $A^{\prime}=A \backslash\{\hat{a}\}$, 则

$$
\begin{aligned}
|A+B+C|^{2} & =\left(\left|A^{\prime}+B+C\right|+\left|(A+B+C) \backslash\left(A^{\prime}+B+C\right)\right|\right)^{2} \\
& \leq\left|A^{\prime}+B+C\right|^{2}+2|U|\left|A^{\prime}+B+C\right|+|U|^{2},
\end{aligned}
$$

$$
\begin{aligned}
& |A+B \| B+C||C+A| \\
= & \left(\left|A^{\prime}+B\right|+\left|(A+B) \backslash\left(A^{\prime}+B\right)\right|\right)|B+C|\left(\left|C+A^{\prime}\right|+\left|(C+A) \backslash\left(C+A^{\prime}\right)\right|\right) \\
= & \left|A^{\prime}+B\right||B+C|\left|C+A^{\prime}\right|+|B+C|\left(\left|A^{\prime}+B\right||W|+\left|C+A^{\prime}\right||V|\right)+|B+C||V||W|,
\end{aligned}
$$

从而只需证明

$$
\begin{aligned}
\left|A^{\prime}+B+C\right|^{2} & \leq\left|A^{\prime}+B\right||B+C|\left|C+A^{\prime}\right|, \\
2|U|\left|A^{\prime}+B+C\right| & \leq|B+C|\left(\left|A^{\prime}+B\right||W|+\left|C+A^{\prime}\right||V|\right), \\
|U|^{2} & \leq|B+C||V||W| .
\end{aligned}
$$

不等式 (1) 即归纳假设. 根据 (1)(3) 以及均值不等式即可证明不等式 (2).

下面证明不等式 (3). 因为 $U$ 中的数必定形如 $\hat{a}+b+c(b \in B, c \in C)$, 所以 $|U| \leq|B+C|$, 故只需证明 $|U| \leq|V||W|$.

考虑 $U \rightarrow B \times C$ 的映射 $\varphi: \hat{a}+b+c \mapsto(\hat{a}+b, \hat{a}+c)$, 若左边的表示不唯一则任选其中之一.

- 注意到 $\hat{a}+b+c=(\hat{a}+b)+(\hat{a}+c)-\hat{a}$, 则 $\varphi$ 是单射.
- 因为 $\hat{a}+b+c \notin A^{\prime}+B+C$, 所以 $\hat{a}+b \notin A^{\prime}+B$, 故 $\hat{a}+b \in V$.
- 因为 $\hat{a}+b+c \notin A^{\prime}+B+C$, 所以 $\hat{a}+c \notin A^{\prime}+C$, 故 $\hat{a}+c \in W$.

综合以上讨论可知 $|U| \leq|V||W|$, 从而 (3) 成立. 原命题得证.

评注 本题是极其困难的加性组合题, 考场平均得分 $0.11 / 50$. 想到归纳是相对自然的, 但是这题难在如何进行下去. 在分析归纳假设将要证的命题拆成 (1)(2)(3)三个不等式 (此处不是等价的转化, 沿着这个方向做需要勇气) 后, 显然归纳假设蕴含了 (1), 但是 (2)(3) 看起来没有头绪. 根据我们对加性组合题的经验可以想到构造对应证明 (3), 而这题最精妙的一点在于: 根据 (1)(3) 以及均值不等式可以直接证明 (2). 本题是 Yufei Zhao (赵宇飞)老师所著组合教材 [5] 的习题.

3.1 如图, 两圆 $\Omega_{1}, \Omega_{2}$ 相交于 $X, Y$ 两点, 它们各自的圆心分别为 $O_{1}, O_{2}$.圆 $\Omega_{1}$ 上的一点 $A$, 圆 $\Omega_{2}$ 上的一点 $B$ 使 $A B$ 是 $\Omega_{1}, \Omega_{2}$ 的公切线. 过 $X$ 分别作 $\Omega_{1}, \Omega_{2}$ 的切线与直线 $O_{1} O_{2}$ 交于 $K, L$ 两点. 证明: $A K, B L, X Y$ 三线共点.

证明 设直线 $X Y$ 交 $A B$ 于点 $M$. 设 $A K, B L$ 分别与圆 $\Omega_{1}, \Omega_{2}$ 交于点 $S, T$.连 $M S, M T$.

因为 $\Omega_{1}, \Omega_{2}$ 的根轴是 $X Y$, 所以 $M$ 是 $A B$ 的中点.

注意到 $X Y$ 是点 $K$ 关于圆 $\Omega_{1}$ 的极线, 则由配极原则可知点 $K$ 在 $M$ 关于圆 $\Omega_{1}$ 的极线 $l$ 上. 又因为极线 $l$ 经过点 $A$, 所以 $M S$ 与圆 $\Omega_{1}$ 相切, 故 $M A=M S$.

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-16.jpg?height=725&width=808&top_left_y=226&top_left_x=630)

同理可得 $M B=M T$, 于是 $A, B, S, T$ 四点共以 $M$ 为圆心的圆 $\omega$.

考虑三圆 $\Omega_{1}, \Omega_{2}, \omega$, 根据蒙日(Monge)定理可知: $A K, B L, X Y$ 三线共点.

评注 本题的难度介于常规的联赛第一二题之间, 考场平均得分 $25.89 / 40$. 从两圆相交的常识我们知道图中的 $M$ 点有较好的几何性质, 值得标出来分析. 随后解决问题最关键的一步在于敏锐地观察到 $M A=M B=M S=M T$ 这一性质. 若有这一中间结论则要证明的结论就是根心定理的直接推论，而中间结论的证明指向配极原则. 有了这些观察就不难解决问题了. 本题由 2019 年伊朗几何奥林匹克 (IGO) 高级组第 3 题改编而来, 它也有许多不同的几何或者计算证法, 这里不一而足.

3.2 设 $a_{1}, a_{2}, \cdots, a_{100}$ 是和为 1000 的 100 个正整数. 记

$$
S=a_{1} a_{2}+a_{2} a_{3}+\cdots+a_{99} a_{100} .
$$

求 $S$ 的最大值, 并确定使 $S$ 取到最大值的所有可能数组 $\left(a_{1}, a_{2}, \cdots, a_{100}\right)$ 的个数.

解 所求 $S$ 的最大值为 204399 , 使最大值取到的数组个数为 43201 .

204399 .

一方面, 当 $\left(a_{1}, a_{2}, a_{3}, a_{4}, \cdots, a_{100}\right)=(1,451,451, \underbrace{1, \cdots, 1}_{97})$ 时, 不难验证 $S=$

另一方面, 我们说明 $S \leq 204399$ 并对取等条件计数.

先证明 $S \leq 204399$. 设 $a_{i}=1+b_{i}(i=1,2, \cdots, 100)$, 则 $b_{1}+b_{2}+\cdots+b_{100}=900$,从而

$$
S=99+\sum_{i=1}^{100} b_{i}+\sum_{i=2}^{99} b_{i}+\sum_{i=1}^{99} b_{i} b_{i+1}
$$

$$
\leq 99+2 \sum_{i=1}^{100} b_{i}+\sum_{i=1}^{99} b_{i} b_{i+1}=1899+\sum_{i=1}^{99} b_{i} b_{i+1}
$$

由均值不等式得

$$
\sum_{i=1}^{99} b_{i} b_{i+1} \leq\left(\sum_{i=1}^{50} b_{2 i-1}\right)\left(\sum_{i=1}^{50} b_{2 i}\right) \leq \frac{1}{4}\left(\sum_{i=1}^{100} b_{i}\right)^{2}=202500,
$$

从而由 $(*)$ 得 $S \leq 204399$.

再确定取等条件的个数. 由 $(*)$ 得 $b_{1}=b_{100}=0$. 对于 $(* *)$,

- 由第一个 “ $\leq$ "可知: 除三项 $b_{i}, b_{i+1}, b_{i+2}$ 以外, 其余 $b_{i}$ 的值都是 0 .
- 由第二个“ $\leq$ "可知: $b_{1}+b_{3}+\cdots+b_{99}=b_{2}+b_{4}+\cdots+b_{100}=450$.

综合以上讨论可知: 所有取等条件可以分成两类.

- 其一是 $b_{j}=b_{j+1}=450$ 且其余 $b_{i}=0$, 如上所述的数组 $\left(b_{1}, b_{2}, \cdots, b_{100}\right)$ 共有 97 个;
- 其二是 $b_{j}=450$, 正整数 $b_{j-1}+b_{j+1}=450$, 其余 $b_{i}=0$ 者, 共 $96 \times 449=$ 43104 个.

因此取等条件的个数为 $97+43104=43201$.

评注 本题是相对简单的联赛第二题, 考场平均得分 $19.17 / 40$. 在与正整数最值相关的问题中，如果取等条件中包含大量的 1 , 利用换元 $a_{i}=1+b_{i}$ 来创造 0 进行放缩就是较为常用的手法. 值得一提的是, 在计数的部分若按照 $b_{j}=450$ 与非负整数 $b_{j-1}+b_{j+1}=450$ 分类则会因重复计数失分.

3.3 求最大的正整数 $n$, 使得平面直角坐标系 $x O y$ 内存在 $n$ 个各边平行于坐标轴的矩形区域 $C_{1}, C_{2}, \cdots, C_{n}$ (不含边界), 满足: 若 $i \neq j$, 则 $C_{i}, C_{j}$ 无公共点当且仅当 $i+j$ 是完全平方数.

解 所求最大的正整数 $n=6$.

称不含边界且各边平行于坐标轴的矩形区域为矩形, 两个矩形不交是指它们无公共点.

一方面, 当 $n=6$ 时, 须使 $C_{i}, C_{j}$ 不交当且仅当 $\{i, j\} \in\{\{1,3\},\{3,6\},\{4,5\}\}$.下图满足要求:

另一方面, 我们说明: 当 $n \geq 7$ 时均不存在满足要求的 $n$ 个矩形.

事实上, 只需证明满足要求的矩形 $C_{2}, C_{3}, C_{4}, C_{5}, C_{6}, C_{7}$ 不存在. 假设不然.

引理 若矩形 $X, Y$ 不交, 则存在平行于坐标轴的直线 $l$ 分隔 $X, Y$, 即 $X, Y$ 位于 $l$ 的两侧.

证明 不妨设矩形 $X, Y$ 的边界有公共线段 $s$, 这是因为:

![](https://cdn.mathpix.com/cropped/2024_02_26_aa9dff9e15d4d1eefbffg-18.jpg?height=536&width=552&top_left_y=226&top_left_x=752)

- 若 $X, Y$ 的边界无公共点, 则可以用 $X$ 的位似像替换 $X$, 使它们的边界有公共点;
- 若 $X, Y$ 的边界仅有一个公共点, 则可以对 $X$ 作拉伸使得它们的边界有公共线段.

此时容易看出线段 $s$ 所在的直线 $l$ 即分隔矩形 $X, Y$. 引理得证.

回到原题. 根据引理可知: 存在平行于坐标轴的直线 $l_{27}$ 与 $l_{36}$ 分别分隔 $C_{2}, C_{7}$ 与 $C_{3}, C_{6}$.

- 若 $l_{27} \| l_{36}$ (或重合), 则 $C_{2}, C_{7}$ 之一与 $C_{3}, C_{6}$ 之一无公共点, 矛盾!
- 若 $l_{27} \perp l_{36}$, 设它们交于点 $O$, 则 $O$ 同时位于 $C_{4}, C_{5}$ 的内部, 这是因为 $C_{4}, C_{5}$ 与 $C_{2}, C_{3}, C_{6}, C_{7}$ 分别都有公共点. 又因为 $4+5=9$ 是完全平方数, 所以 $C_{4}, C_{5}$ 不交, 矛盾!

综合以上讨论可知假设错误. 因此当 $n \geq 7$ 时均不存在满足要求的 $n$ 个矩形.

综上所述, 满足要求的最大正整数 $n=6$.

评注 本题的难度与常规的联赛第三题接近, 考场平均得分 17.78/50. 题中 “ $C_{i} \cap C_{j} \neq \varnothing$ 当且仅当 $i+j$ 时平方数”这样的条件太过离奇, 很难想象平方数与问题有本质的联系. 因此我们的思考方向应是诸矩形在相交关系下诱导的简单图结构. 事实上, 这类图不含 $K_{2,2,2}$ 子图, 讨论分隔直线不难论证. 基于这个观察即可解决问题. 本题源于组合几何中对相交图的研究, 参见文献 [4].

3.4 给定奇素数 $p$ 使得 $p \not \equiv 3(\bmod 8)$. 定义集合

$$
Q=\left\{x^{2} \text { 模 } p \text { 所得余数 } \mid x=1,2, \cdots, p-1\right\} \text {. }
$$

证明: 可以将 $Q$ 中的所有元素排列在圆周上, 使得相邻两个元素的和模 $p$ 的余数不属于 $Q$.

证明 以下解答混淆了 $\mathbb{R}$ 上的运算以及 $\mathbb{F}_{p}=\mathbb{Z} / p \mathbb{Z}$ 上的运算.
记 $Q=\left\{a_{1}, a_{2}, \cdots, a_{\frac{p-1}{2}}\right\}$. 以 $Q$ 为顶点集构作简单图 $G$, 其中

$$
\left\{a_{i}, a_{j}\right\} \in E \Longleftrightarrow a_{i}+a_{j} \notin Q .
$$

要证明的命题即图 $G$ 存在哈密顿 (Hamilton) 圈.

引理 $G$ 是正则图.

证明 设 $\{b \in Q \mid b+1 \in Q\}=\left\{b_{1}, b_{2}, \cdots, b_{k}\right\}$, 则对任意 $i=1,2, \cdots, \frac{p-1}{2}$,

$$
a_{i}+a_{j}=a_{s} \Longleftrightarrow a_{j} a_{i}^{-1} \in\left\{b_{1}, b_{2}, \cdots, b_{k}\right\} \Longleftrightarrow a_{j} \in\left\{a_{i} b_{1}, a_{2} b_{2}, \cdots, a_{i} b_{k}\right\} .
$$

若 2 是 $p$ 的平方剩余, 则 $1 \in\left\{b_{1}, b_{2}, \cdots, b_{k}\right\}$, 此时 $\operatorname{deg}_{G}\left(a_{i}\right)=\frac{p-1}{2}-k$. 若 2 是 $p$ 的非平方剩余, 则 $1 \notin\left\{b_{1}, b_{2}, \cdots, b_{k}\right\}$, 此时 $\operatorname{deg}_{G}\left(a_{i}\right)=\frac{p-1}{2}-k-1$. 根据 $i$ 的任意性可知 $G$ 是正则图. 引理得证.

回到原题. 由引理得 $G$ 是 $d$-正则图, 其中 $d=\frac{p-1}{2}-k$ 或 $\frac{p-1}{2}-k-1$. 只需证 $d>\frac{p-1}{4}$.

下面计算 $k$. 设 $x, y \in \mathbb{F}_{p} \backslash\{0\}$ 使得 $(b, b+1)=\left(x^{2}, y^{2}\right)$, 且 $x+y=t$, 则

$$
1+x^{2}=y^{2} \Longrightarrow(x-y)(x+y)=-1 \Longrightarrow x-y=-t^{-1} \text {, }
$$

其中 $t \neq 0$. 于是 $(x, y)=\left(\frac{t-t^{-1}}{2}, \frac{t+t^{-1}}{2}\right)$. 又因为 $x \neq 0$, 所以 $t \neq 0, \pm 1$. 对任意 $s \neq t$, 注意到

$$
\frac{s-s^{-1}}{2}=\frac{t-t^{-1}}{2} \Longleftrightarrow s t=-1
$$

则根据 $b$ 与 $x$ 之间以及 $x$ 与 $t$ 之间的对应关系, 对 -1 关于 $p$ 的平方剩余关系分类讨论可知:

- 若 $p \equiv 1(\bmod 4)$, 则 $x$ 的数量恰是 $\frac{p-5}{2}$, 从而 $k=\frac{p-5}{4}$.
- 若 $p \equiv 3(\bmod 4)$, 则 $x$ 的数量恰是 $\frac{p-3}{2}$, 从而 $k=\frac{p-3}{4}$.

综合以上讨论可得

$$
d=\left\{\begin{array}{lll}
\frac{p-1}{2}-k=\frac{p+3}{4} & p \equiv 1 & (\bmod 8), \\
\frac{p-1}{2}-k-1=\frac{p-1}{4} & p \equiv 5 & (\bmod 8), \\
\frac{p-1}{2}-k=\frac{p+1}{4} & p \equiv 7 & (\bmod 8),
\end{array}\right.
$$

对任意不同的 $a_{i}, a_{j} \in Q$, 因为

$$
\operatorname{deg}_{G}\left(a_{i}\right)+\operatorname{deg}_{G}\left(a_{j}\right)=(p-1)-2 k \geq \frac{p-1}{2}
$$

所以由狄拉克(Dirac)定理可知: 图 $G$ 存在哈密顿(Hamilton)圈, 原命题得证.

评注 本题的难度与常规的联赛第四题接近, 考场平均得分 $2.89 / 50$. 为了使解答初等化, 以上我们采用了对应的语言而非平方剩余勒让德(Legendre)符号的语言
进行叙述。事实上, 通过勒让德(Legendre)符号解决问题可以使思路更清晰. 这个问题取材于文献 [1].

在考场的试题版本中, 命题组因疏忽未考虑到 $G$ 中有自环对度数的影响, 在原卷上未添加条件 “ $p \not \equiv 3(\bmod 8)$ ”。当 $p \equiv 3(\bmod 8)$ 时, 我们不知怎样用狄拉克(Dirac) 定理解决问题. 在图论领域以下更深刻的结果可以解决此类情形(但这超出了数学竟赛的知识范围).

定理 (Jackson, [2]) 对 $n$ 个顶点 $d$-正则的简单图 $G$, 如果它连通, 且任意删去一顶点(以及其关联的所有边)所得的图仍连通, 那么 $d \geq \frac{n}{3}$ 蕴含 $G$ 有哈密顿(Hamilton)圈.

## 参考文献

[1] N. Alon and J. Bourgain. Additive patterns in multiplicative subgroups. Geom. Funct. Anal., 24(3):721 - 739, 2014.

[2] B. Jackson. Hamilton cycles in regular 2-connected graphs. J. Combin. Theory Ser. B, 29(1):27 - 46, 1980.

[3] A. H. Rhemtulla and A. P. Street. Maximal sum-free sets in finite abelian groups. Bull. Austral. Math. Soc., 2:289-297, 1970.

[4] I. Tomon and D. Zakharov. Turán-type results for intersection graphs of boxes. Combin. Probab. Comput., 30(6):982 - 987, 2021.

[5] Y. Zhao. Graph theory and additive combinatorics-exploring structure and randomness. Cambridge University Press, Cambridge, 2023.

