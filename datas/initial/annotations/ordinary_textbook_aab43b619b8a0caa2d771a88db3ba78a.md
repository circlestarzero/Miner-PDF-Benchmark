数学新星网 $\%$ 学生专栏

www.nsmath.cn/xszl

# 2023 年国家集训队第二轮选拔考试试题解析 

孙启傲 王淳稷

(上海市上海中学, 200237)

指导教师: 王广廷

本文给出 2023 年第 64 届 IMO 中国数学奥林匹克国家集训队第二轮选拔考试的试题与解答. 本次试题新颖有趣, 值得思考与研究. 因作者水平有限, 不当之处在所难免. 请读者不吝赐教.

## I. 试 题

13. 是否存在正无理数 $x$, 使得至多存在有限个正整数 $n$, 满足对任意整数 $1 \leq k \leq n$, 都有 $\{k x\} \geq \frac{1}{n+1}$ ?
14. 对非空有限实数集 $B$ 和实数 $x$, 定义

$$
d_{B}(x)=\min _{b \in B}|x-b|
$$

(1) 给定正整数 $m$. 求最小的实数 $\lambda$, 使得对任意正整数 $n$ 和任意实数 $x_{1}, x_{2}, \cdots, x_{n} \in[0,1]$, 都存在 $m$ 元实数集 $B$, 满足

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right) \leq \lambda n .
$$

(2) 设 $m$ 是正整数, $\varepsilon$ 是正实数. 求证: 存在正整数 $n$ 和非负实数 $x_{1}, x_{2}, \cdots, x_{n}$,满足对任意 $m$ 元实数集 $B$, 都有

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right)>(1-\varepsilon)\left(x_{1}+x_{2}+\cdots+x_{n}\right) .
$$

15. 对凸四边形 $A B C D$, 称其内部一点 $P$ 为平衡的, 如果:

(1) $P$ 不在 $A C, B D$ 上;

(2) 设 $A P, B P, C P, D P$ 分别交 $A B C D$ 的边界于点 $A^{\prime}, B^{\prime}, C^{\prime}, D^{\prime}$, 则

$$
A P \cdot P A^{\prime}=B P \cdot P B^{\prime}=C P \cdot P C^{\prime}=D P \cdot P D^{\prime} .
$$

求平衡点数目的最大可能值.

修订日期: 2023-05-26.

16. 如图, 圆 $\Gamma, \Gamma_{1}, \Gamma_{2}$ 两两外切, 且均与直线 $l$ 相切. 设 $\Gamma, \Gamma_{1}$ 切于点 $B_{1}$, $\Gamma, \Gamma_{2}$ 切于点 $B_{2}, \Gamma_{1}, \Gamma_{2}$ 切于点 $C . \Gamma, \Gamma_{1}, \Gamma_{2}$ 分别与 $l$ 切于点 $A, A_{1}, A_{2}$, 其中 $A$ 在线段 $A_{1} A_{2}$ 上. 设直线 $A_{1} C, A_{2} B_{2}$ 交于点 $D_{1}$, 直线 $A_{2} C, A_{1} B_{1}$ 交于点 $D_{2}$. 求证: $D_{1} D_{2} / / l$.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-02.jpg?height=420&width=600&top_left_y=544&top_left_x=728)

17. 是否存在两两不同的整数 $a_{1}, a_{2}, \cdots$, 同时满足:

(1) 对任意正整数 $k, a_{k^{2}}>0$ 且 $a_{k^{2}+k}<0$;

(2) 对任意正整数 $n, a_{n+1}-a_{n} \leq 2023 \sqrt{n}$ ?

18. 求最大的实数 $\lambda$, 使得对任意一个 100 阶双随机矩阵, 总可以从中选出 150 个元素, 并将其余 9850 个元素都改为 0 , 满足此时每行元素之和与每列元素之和都不小于 $\lambda$.

注: 一个 $n$ 阶双随机矩阵是一个 $n \times n$ 的方阵, 所有元素均为非负实数, 且每行元素之和与每列元素之和均为 1 .

19. 设 $A, B$ 是单位圆 $\omega$ 上的两个定点, 满足 $\sqrt{2}<A B<2 . P$ 是 $\omega$ 上的一个动点, 满足 $\triangle A B P$ 是锐角三角形且 $A P>A B>B P$. 设 $\triangle A B P$ 的垂心为 $H, S$是劣弧 $\overparen{A P}$ 上的一点, 满足 $S H=A H . T$ 是劣弧 $\overparen{A B}$ 上的一点, 满足 $T B / / A P$.设直线 $S T, B P$ 交于点 $Q$. 求证: 以 $H Q$ 为直径的圆经过一个定点.
20. 设整数 $a, b, d$ 满足 $|a| \geq 2, d \geq 0, b \geq(|a|+1)^{d+1}$. 设 $f(x)$ 是次数为 $d$ 的实系数多项式, 对每个正整数 $n$, 用 $r_{n}$ 表示 $\left[f(n) a^{n}\right]$ 模 $b$ 的余数. 求证: 若 $\left\{r_{n}\right\}$ 最终周期, 则 $f(x)$ 的系数都是有理数.
21. 给定整数 $n \geq 2$. 求最小的实数 $\lambda$, 使得对任意实数 $a_{1}, a_{2}, \cdots, a_{n}$ 及 $b$, 均有

$$
\lambda \sum_{i=1}^{n} \sqrt{\left|a_{i}-b\right|}+\sqrt{n\left|\sum_{i=1}^{n} a_{i}\right|} \geq \sum_{i=1}^{n} \sqrt{\left|a_{i}\right|}
$$

22. 求所有的函数 $f: \mathbb{Z} \rightarrow \mathbb{Z}$, 使得对任意整数 $a, b, c$, 均有

$$
2 f\left(a^{2}+b^{2}+c^{2}\right)-2 f(a b+b c+c a)=f(a-b)^{2}+f(b-c)^{2}+f(c-a)^{2} .
$$

23. 设 $p$ 是质数, 实数 $\lambda \in(0,1)$, 正整数 $s \leq t<\frac{\lambda p}{12} . S, T$ 分别是由 $s, t$ 个连续正整数构成的集合, 满足

$$
|\{(x, y) \in S \times T \mid k x \equiv y \quad(\bmod p)\}| \geq 1+\lambda s
$$

求证: 存在整数 $a, b$, 满足 $1 \leq a \leq \frac{1}{\lambda},|b| \leq \frac{t}{\lambda s}$, 且 $k a \equiv b(\bmod p)$.

24. 设 $n$ 是正整数. 初始时, 一个 $2 n \times 2 n$ 的方格表中有 $k$ 个黑格, 其余为白格. 允许进行如下两种操作:

(1) 若一个 $2 \times 2$ 正方形中恰有 3 个黑格,则可以将第 4 个也变为格;

(2) 若一个 $2 \times 2$ 正方形中恰有 2 个黑格,则可以将其中的黑格变为白格、白格变为黑格.

求最小的正整数 $k$, 使得有限次操作后所有格都是黑格.

## II. 解答与评注

13. 是否存在正无理数 $x$, 使得至多存在有限个正整数 $n$, 满足对任意整数 $1 \leq k \leq n$, 都有 $\{k x\} \geq \frac{1}{n+1}$ ?

## 解 不存在.

考虑数列 $\{x\},\{2 x\}, \cdots$ 中, 称某项 $\{k x\}$ 是极小的, 如果它比前面的项都小 (由于 $x$ 是无理数, 这些项两两不同).

设数列中所有极小的项 $\left\{a_{i} x\right\}, i=1,2, \cdots$, 其中 $a_{1}<a_{2}<\cdots$. 注意 $\{n x\}$ $\left(n \in \mathbb{Z}_{+}\right)$在 $(0,1)$ 上稠密, 所以极小项有无穷多个.

任取 $i \geq 2$. 我们来说明 $n=a_{i}-1$ 满足题目中的要求.

由于极小项的定义, 只需说明 $\left\{a_{i-1} x\right\} \geq \frac{1}{a_{i}}$.

考虑

$$
\left\{a_{i-1} a_{i} x\right\} \leq a_{i-1}\left\{a_{i} x\right\}<a_{i-1}\left\{a_{i-1} x\right\}<a_{i}\left\{a_{i-1} x\right\} .
$$

结合 $a_{i} \in \mathbb{Z}$ 就说明 $\left\{a_{i-1} x\right\} \geq \frac{1}{a_{i}}$. 于是满足题目要求的 $n$ 必定无穷多个.

评注 本题是一道较为简单的关于小数部分的题目. 本题做法多样, 但都需要取出数列的极小项, 并且这里给出的证明是最简单的一个. 尽管解答如此简短, 不过存在与不存在之间的“循环”也卡住了部分同学.

14. 对非空有限实数集 $B$ 和实数 $x$, 定义

$$
d_{B}(x)=\min _{b \in B}|x-b|
$$

(1) 给定正整数 $m$. 求最小的实数 $\lambda$, 使得对任意正整数 $n$ 和任意实数
$x_{1}, x_{2}, \cdots, x_{n} \in[0,1]$, 都存在 $m$ 元实数集 $B$, 满足

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right) \leq \lambda n .
$$

(2) 设 $m$ 是正整数, $\varepsilon$ 是正实数. 求证: 存在正整数 $n$ 和非负实数 $x_{1}, x_{2}, \cdots, x_{n}$,满足对任意 $m$ 元实数集 $B$, 都有

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right)>(1-\varepsilon)\left(x_{1}+x_{2}+\cdots+x_{n}\right) .
$$

解 (1) 答案为 $\frac{1}{4 m-2}$.

一方面, 考虑

$$
B_{1}=\left\{0, \frac{2}{2 m-1}, \cdots, \frac{2 m-2}{2 m-1}\right\}, B_{2}=\left\{\frac{1}{2 m-1}, \frac{3}{2 m-1}, \cdots, 1\right\} .
$$

注意到对任意 $x \in[0,1]$,

$$
d_{B_{1}}(x)+d_{B_{2}}(x)=\frac{1}{2 m-1} .
$$

故对任意一组 $x_{1}, x_{2}, \cdots, x_{n} \in[0,1]$, 都有

$$
d_{B_{1}}\left(x_{1}\right)+d_{B_{1}}\left(x_{2}\right)+\cdots+d_{B_{1}}\left(x_{n}\right) \leq \frac{1}{4 m-2} n
$$

或

$$
d_{B_{2}}\left(x_{1}\right)+d_{B_{2}}\left(x_{2}\right)+\cdots+d_{B_{2}}\left(x_{n}\right) \leq \frac{1}{4 m-2} n
$$

至少一个成立. 即 $\lambda=\frac{1}{4 m-2}$ 可行.

下面证明 $\lambda \geq \frac{1}{4 m-2}$.

考虑

$$
\left\{x_{1}, x_{2}, \cdots, x_{n}\right\}=\left\{0, \frac{1}{2 m-1}, \cdots, \frac{2 m-2}{2 m-1}, 1\right\}, n=2 m
$$

我们来证明任何 $m$ 元集合 $B=\left\{b_{1}<b_{2}<\cdots<b_{m}\right\}$, 均有

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right) \geq \frac{1}{4 m-2} n .
$$

为方便, 我们不妨“将坐标轴放大 $2 m-1$ 倍”, 即 $\left\{x_{1}, x_{2}, \cdots, x_{n}\right\}=\{0,1, \cdots$, $2 m-1\}$. 来证明

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right) \geq \frac{1}{2} n=m .
$$

令每个 $x_{i}$ 对应到 $B$ 中离它最近的元素. 若有左右各一个则对应左边那个.

考虑每个 $b_{i}$ 被对应了多少次. 设为 $t_{i}$ 次, $i=1,2, \cdots, m, \sum_{i=1}^{m} t_{i}=2 m$. 来计算所有对应到 $b_{i}$ 的数到它的距离之和.

当 $t_{i} \geq 2$ 时, 这 $t_{i}$ 个整数中最远的两个距离至少是 $t_{i}-1$.

这说明这两个数到 $t_{i}$ 距离之和至少是 $t_{i}-1$, 说明所有对应到 $b_{i}$ 的数到它的距离之和至少是 $t_{i}-1$.
事实上当 $t_{i}=0,1$ 时上面式子也显然正确. 于是对所有 $i$ 求和得到

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right) \geq \sum_{i=1}^{m}\left(t_{i}-1\right)=m
$$

于是所求 $\lambda$ 最小值是 $\frac{1}{4 m-2}$.

(2) 我们取

$$
n>2^{\frac{4 m}{\varepsilon}}, x_{i}=\frac{1}{i}
$$

我们不妨送给 $B$ 一个元素 0 . 并不妨设 $B$ 中元素非负.

假设 $B=\left\{0<y_{1}<\cdots<y_{m}\right\}$. 记 $F_{i}$ 表示 $x_{j}$ 到 0 的距离的总和减去到 $\left\{0, y_{i}\right\}$ 的距离的总和. (可以看作加入元素 $y_{i}$ 后距离之和的改良值.)

显然有

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right)>\sum_{j=1}^{n} x_{j}-\sum_{i=1}^{m} F_{i} .
$$

下面估计 $F_{j}$.

对于 $\frac{1}{j}>\frac{1}{2} y_{i}$ 的 $x_{j}=\frac{1}{j}$, 它对于 $F_{i}$ 的贡献至多是 $y_{i}$. 其余的 $x_{j}$ 则没有贡献. 而有贡献的 $x_{j}$ 个数至多是 $\frac{2}{y_{i}}$, 说明

$$
F_{j}<y_{j} \cdot \frac{2}{y_{i}}=2
$$

于是

$$
d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right)>\sum_{j=1}^{n} x_{j}-\sum_{i=1}^{m} F_{i}>\sum_{j=1}^{n} \frac{1}{j}-2 m
$$

当 $n>2^{\frac{4 m}{\varepsilon}}$ 时,

$$
\begin{aligned}
& \sum_{j=1}^{n} \frac{1}{j}>\frac{1}{2} \cdot \log _{2} n>\frac{1}{\varepsilon} \cdot 2 m \\
\Rightarrow & d_{B}\left(x_{1}\right)+d_{B}\left(x_{2}\right)+\cdots+d_{B}\left(x_{n}\right)>(1-\varepsilon)\left(x_{1}+x_{2}+\cdots+x_{n}\right) .
\end{aligned}
$$

得证.

评注 本题两小问的想法很不一样. 第一小问是求最佳常数, 通常我们会考虑均匀/加权分布或者散点式分布的情况, 而凑巧的是通过观察 $m$ 较小的情况发现均匀的散点分布就能达到目的. 证明中的前半部分较为简单, 而后半部分较难. 事实上, 后半部分也可以选取以下的构造来证明 $\lambda \geq \frac{1}{4 m-2}$ :

$$
n=2 m-1,\left\{x_{i}\right\}=\left\{0, \frac{1}{2 m-2}, \cdots, \frac{2 m-3}{2 m-2}, 1\right\} .
$$

其证明类似，留给读者思考.

第二小问则是去猜测要求的 $x_{i}$ 的分布, 运气较好的话能之间猜出倒数分布.并且倒数分布的证明似乎是最简单的.

15. 对凸四边形 $A B C D$, 称其内部一点 $P$ 为平衡的, 如果:

(1) $P$ 不在 $A C, B D$ 上;

(2) 设 $A P, B P, C P, D P$ 分别交 $A B C D$ 的边界于点 $A^{\prime}, B^{\prime}, C^{\prime}, D^{\prime}$, 则

$$
A P \cdot P A^{\prime}=B P \cdot P B^{\prime}=C P \cdot P C^{\prime}=D P \cdot P D^{\prime} .
$$

求平衡点数目的最大可能值.

解 对角线 $A C, B D$ 将四边形内部分成四个区域. 称以 $A B$ 为一边的区域是 $A B$ 区域.

下面考察 $A B$ 区域的平衡点.

过 $P$ 反演易得 $B^{\prime} P A^{\prime} C D$ 五点共圆. 由条件 $A B B^{\prime} A^{\prime}$ 也共圆, 结合 $A^{\prime} B^{\prime} C D$ 共圆知 $A B / / C D$.

也就是说, 若区域 $A B$ 内有平衡点, 必定有 $A B / / C D$.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-06.jpg?height=385&width=511&top_left_y=1121&top_left_x=801)

更进一步, 有

$$
\angle A B^{\prime} B=\angle A A^{\prime} B=\angle B B^{\prime} C .
$$

对称地有 $\angle A A^{\prime} B=\angle A A^{\prime} D$.

反过来, 如果线段 $A D$ 上存在一点 $B^{\prime}$ 满足 $\angle A B^{\prime} B=\angle B B^{\prime} C$, 作 $A B B^{\prime}$ 外接圆, 如果它和线段 $B C$ 有交点 $A^{\prime}$, 那么作 $A A^{\prime}, B B^{\prime}$ 交于点 $P$, 不难推得:

(1) $\angle A A^{\prime} B=\angle A A^{\prime} D$, (2) $P$ 是 $A B$ 区域平衡点.

回到原题: 若 $A B C D$ 两组对边都不平行, 则没有平衡点.

情形 1. 当 $A B C D$ 是梯形, $A B / / C D$. 不妨设 $D A, C B$ 延长线交于点 $T$.

此时只有 $A B, C D$ 区域才能有平衡点. 比如看 $A B$ 区域.

下面来看如何判断满足 $\angle A B^{\prime} B=\angle B B^{\prime} C$ 的 $B^{\prime}$ 是否存在.

事实上这等价于 $\angle T B^{\prime} B=\angle B B^{\prime} C$. 而这样的 $B^{\prime}$ 轨迹是一个阿波罗尼斯圆与边 $A D$ 的交点, 故 $B^{\prime}$ 至多两个. 这说明 $P$ 至多两个. 同理 $C D$ 区域平衡点也至多两个.

下面证明, $A B$ 区域至多一个平衡点.

$\angle C, \angle D$ 至少一个是锐角. 不妨设为 $\angle C$.
我们来证明满足 $\angle A B^{\prime} B=\angle B B^{\prime} C$ 的 $B^{\prime}$ 在线段 $A D$ 上至多一个.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-07.jpg?height=400&width=425&top_left_y=294&top_left_x=770)

对 $\triangle A B B^{\prime}, \triangle B B^{\prime} C$ 使用正弦定理知:

$$
\angle A B^{\prime} B=\angle B B^{\prime} C \Leftrightarrow A B \cdot \sin \angle A=B C \cdot \sin \angle B^{\prime} C B .
$$

即 $\sin \angle B^{\prime} C B$ 是一个定值. 但是 $\angle B^{\prime} C B<\angle C<90^{\circ}$, 说明 $\angle B^{\prime} C B$ 只有一种取值.故满足 $\angle A B^{\prime} B=\angle B B^{\prime} C$ 的 $B^{\prime}$ 在线段 $A D$ 上至多一个. 所以 $A B$ 区域至多一个平衡点.

所以梯形中至多三个平衡点.

顺便我们可以给出如下的构造: 令 $\triangle T C D$ 为正三角形, $\frac{A B}{C D}=\frac{2-\sqrt{3}}{2}-\varepsilon$.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-07.jpg?height=380&width=439&top_left_y=1369&top_left_x=820)

不难验证它在 $A B$ 区域有一个平衡点, 在 $C D$ 区域有两个平衡点.

情形 2. 当 $A B C D$ 是平行四边形.

比如考虑 $A B$ 区域的平衡点. 不妨设 $\angle B \leq 90^{\circ}$. 有

$$
\angle B^{\prime} B C=\angle A B^{\prime} B=\angle B B^{\prime} C \Rightarrow B C=B^{\prime} C .
$$

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-07.jpg?height=474&width=591&top_left_y=2213&top_left_x=790)
但是 $\angle B \leq 90^{\circ} \Rightarrow B^{\prime}$ 至多一个. 故 $A B$ 区域至多有一个平衡点.

同理四个区域各至多一个平衡点.

容易发现, $A B$ 区域的平衡点存在当且仅当 $C D$ 区域的平衡点存在 (两个图中心对称).

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-08.jpg?height=597&width=614&top_left_y=524&top_left_x=767)

由 $\angle B>90^{\circ}, B^{\prime}$ 存在需要 $C B>C D$.

所以 $A B, C D$ 区域的平衡点存在需要 $C B>C D$. 同理, $B C, A D$ 区域的平衡点存在需要 $B C<C D$.

这不可能同时成立, 故平行四边形至多有两个平衡点.

综上, 答案为 3 .

评注 本题是 (看似是若则题的) 较为繁琐的几何不等式. 其关键在于发现平衡点存在需要对边平行, 进而分两种情况讨论, 并给出平衡点的刻画.其用到的几何步骤不多且不难, 主要考查转化命题的能力.

16. 如图, 圆 $\Gamma, \Gamma_{1}, \Gamma_{2}$ 两两外切, 且均与直线 $l$ 相切. 设 $\Gamma, \Gamma_{1}$ 切于点 $B_{1}$, $\Gamma, \Gamma_{2}$ 切于点 $B_{2}, \Gamma_{1}, \Gamma_{2}$ 切于点 $C . \Gamma, \Gamma_{1}, \Gamma_{2}$ 分别与 $l$ 切于点 $A, A_{1}, A_{2}$, 其中 $A$ 在线段 $A_{1} A_{2}$ 上. 设直线 $A_{1} C, A_{2} B_{2}$ 交于点 $D_{1}$, 直线 $A_{2} C, A_{1} B_{1}$ 交于点 $D_{2}$. 求证: $D_{1} D_{2} / / l$.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-08.jpg?height=423&width=596&top_left_y=2190&top_left_x=730)
证明 设圆 $\Gamma$ 中 $A$ 的对径点为 $P$. 那么由 $\Gamma, \Gamma_{1}$ 关于 $B_{1}$ 位似知 $A_{1} B_{1} P$ 共线,同理 $A_{2} B_{2} P$ 共线.

由 Ceva 定理, 结论等价于证明 $C P$ 平分 $A_{1} A_{2}$. 这也等价于 $C P$ 是 $\Gamma_{1}, \Gamma_{2}$ 内公切线.

设三个圆的根心为 $E$, 作 $\Gamma, \Gamma_{1}$ 的内公切线交 $l$ 于 $D_{1}$, 类似地 $D_{2}$.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-09.jpg?height=756&width=1108&top_left_y=593&top_left_x=471)

则 $\Gamma$ 为 $\triangle E D_{1} D_{2}$ 的内切圆. 设 $E P$ 交 $A_{1} A_{2}$ 于 $M$.

则熟知由 $D_{1} A=M D_{2}$ 可得

$$
A_{1} M=A_{1} D_{1}+D_{1} M=D_{1} A+A D_{2}=M D_{2}+D_{2} A_{2}=M A_{2} .
$$

于是 $M$ 为 $A_{1} A_{2}$ 中点, 即 $P$ 在 $\Gamma_{1}, \Gamma_{2}$ 内公切线上. 得证.

评注 本题是简单的几何题. 在发现结论等价于 $C P$ 是 $\Gamma_{1}, \Gamma_{2}$ 内公切线之和即使计算也十分简单.

17. 是否存在两两不同的整数 $a_{1}, a_{2}, \cdots$, 同时满足:

(1) 对任意正整数 $k, a_{k^{2}}>0$ 且 $a_{k^{2}+k}<0$;

(2) 对任意正整数 $n, a_{n+1}-a_{n} \leq 2023 \sqrt{n}$ ?

解 不存在.

对于 $k \in \mathbb{Z}_{+}$, 设 $a_{k^{2}-k}$ 到 $a_{k^{2}+k}$ 中最大项为 $a_{t_{k}}$. 设 $a_{k^{2}}$ 到 $a_{(k+1)^{2}}$ 中最小项为 $a_{s_{k}}$. 则由条件, $a_{t_{k}}>0, a_{s_{k}}<0$.

待定 $n>10000$.

对 $k \in \mathbb{Z}_{+}$, 称 $k$ 是 “上好”的, 如果 $a_{t_{k}} \geq n$. 则对于这样的 $k$, 考虑 $a_{t_{k}}$ 到 $a_{k^{2}+k}$ 中, 两两差不超过 $4046 k$. 于是这些项中在 $1,2, \cdots, n$ 中至少有 $\frac{n}{4046 k}-1$ 项.
于是

$$
\begin{aligned}
& \sum_{k \leq n, k \text { 上好的 }}\left(\frac{n}{4046 k}-1\right) \leq n . \\
\Rightarrow & \sum_{k \leq n, k \text { 上好的 }} \frac{n}{4046 k} \leq 2 n . \\
\Rightarrow & \sum_{k \leq n, k \text { 上好的 }} \frac{1}{k} \leq 10000 .
\end{aligned}
$$

同样对于 $s_{k}$ 可定义“下好的”, 有

$$
\sum_{k \leq n, k \text { 下好的 }} \frac{1}{k} \leq 10000 .
$$

称 $k$ 是 “好的”，如果 $k$ 是上好的或者是下好的.

那么有

$$
\sum_{k \leq n, k \text { 好的 }} \frac{1}{k} \leq 20000 \text {. }
$$

对于坏的 $k$, 由定义知 $a_{k^{2}}$ 到 $a_{k^{2}+k}$ 都在 $(-n, n)$ 中.

$$
\Rightarrow \sum_{k \leq n, k \text { 坏的 }} k \leq 2 n \text {. }
$$

说明 $1, \cdots, n$ 中至多 $10 \sqrt{n}$ 个坏数.

$$
\Rightarrow \sum_{k \leq n, k \text { 好的 }} \frac{1}{k} \geq \frac{1}{10} \ln \frac{n}{10 \sqrt{n}} \text {. }
$$

当 $n$ 充分大时右式大于 20000 . 矛盾. 故不存在这样的数列.

评注 本题是中等难度的代数题, 大多数同学都很快猜到不存在. 本题的估计想法也比较自然, 即考虑占据绝对值小于 $n$ 的项的分布, 并利用调和级数发散性.

18. 求最大的实数 $\lambda$, 使得对任意一个 100 阶双随机矩阵, 总可以从中选出 150 个元素, 并将其余 9850 个元素都改为 0 , 满足此时每行元素之和与每列元素之和都不小于 $\lambda$.

注: 一个 $n$ 阶双随机矩阵是一个 $n \times n$ 的方阵, 所有元素均为非负实数, 且每行元素之和与每列元素之和均为 1 .

解 答案为 $\frac{17}{1900}=\frac{51}{75.76}$.

转化成图论语言: 对一个边非负赋值的二部图 $G=(A, B, E), A, B$ 各100个点且每点权为 1 , 总能取 $G$ 一个含至多 150 边的子图 $H$, 使得 $H$ 每点权至少是 $\lambda$.

一方面, 考虑以下的图:

$$
A=A_{1} \cup A_{2}, B=B_{1} \cup B_{2},
$$

$$
\left|A_{1}\right|=75,\left|A_{2}\right|=25,\left|B_{1}\right|=24,\left|B_{2}\right|=76 \text {. }
$$

$A_{1}, B_{1}$ 之间的边赋值 $\frac{1}{75} ; A_{1}, B_{2}$ 之间的边赋值 $\lambda=\frac{17}{1900} ; A_{2}, B_{1}$ 之间的边赋值 0 ; $A_{2}, B_{2}$ 之间的边赋值 $\frac{1}{76}$.

不难验证符合题意. 下面假设它有一个包含 150 边的子图 $H$ 使得每点权大于 $\lambda=\frac{17}{1900}$.

不妨设没有 $A_{2}, B_{1}$ 之间的边. 设 $B_{1}$ 在 $H$ 中连出 $a$ 边, $A_{2}$ 在 $H$ 中连出 $b$ 边.则 $A_{1}$ 中至少 $75-a$ 个点仅有与 $B_{2}$ 之间得到边, 故它们每点度至少为 $2 . \quad B_{2}$ 中至少 $76-b$ 个点仅有与 $A_{1}$ 之间得到边, 它们每点度至少为 2 . 于是总边数至少 $a+b+(75-a)+(76-b)=151$, 矛盾.

于是证明了 $\lambda \leq \frac{17}{1900}$. 下面证明 $\lambda=\frac{17}{1900}$ 可行.

引理 对于二部图 $G=(A, B, E), n \in \mathbb{Z}_{+}$, 若对于任何 $X \subset A$,

$$
|N(X)| \geq|X|-n
$$

则 $G$ 中有一个 $|A|-n$-匹配.

该引理是 Hall 定理的直接推论-一在 $B$ 中添加 $n$ 个点连向 $A$ 中所有点后利用 Hall 即可得到证明.

回到原题. 设 $G$ 中所有权重不小于 $\lambda$ 的边构成子图 $G^{\prime}$.

我们来证明 $G^{\prime}$ 符合引理中 $n=50$ 的条件, 从而由引理 $G^{\prime}$ 有一个 50-匹配.

假设某个 $X \subset A,|N(X)| \leq|X|-51$. 记 $|X|=a, a \geq 51$. 并记

$$
A \backslash X=Y, Z=N(X), B \backslash Z=W
$$

则 $X, W$ 之间每边权重小于 $\frac{17}{1900}$. $\Rightarrow W$ 中每点向 $Y$ 中权重至少 $1-\lambda a$.

但是 $Y$ 中每点向 $W$ 中权重至多是 1 , 于是有

$$
\begin{aligned}
|W|(1-\lambda a)< & |Y| \Rightarrow(151-a)(1-\lambda a)<(100-a) . \\
& \Leftrightarrow a(151-a)>75 \times 76 .
\end{aligned}
$$

但是 $a \in \mathbb{Z}_{+}$, 这不可能. 矛盾.

于是我们证明了存在 $G$ 的 50-匹配, 每边权重至少是 $\frac{17}{1900}$.

然后对于这 50 边没有碰到的共 100 个点, 取每个点连出权重最大的一条边 (该边权不小于 $\frac{1}{100}$ ).

这样取出了至多 150 边使得每点权重至少 $\frac{17}{1900}$.

综上答案为 $\frac{17}{1900}$.
评注 本题是较难的图论题. 入手点是猜测取出一个较大的 50 -匹配, 结合熟练使用 Hall 定理可以得到能保证取出权重多大的 50-匹配, 并且发现取等正好可以解决原问题。该做法可以将 150 换成任何一个 100 到 200 之间的整数。对于更大的情况读者可自行思考.

19. 设 $A, B$ 是单位圆 $\omega$ 上的两个定点, 满足 $\sqrt{2}<A B<2 . P$ 是 $\omega$ 上的一个动点, 满足 $\triangle A B P$ 是锐角三角形且 $A P>A B>B P$. 设 $\triangle A B P$ 的垂心为 $H, S$是劣弧 $\overparen{A P}$ 上的一点, 满足 $S H=A H . T$ 是劣弧 $\overparen{A B}$ 上的一点, 满足 $T B / / A P$.设直线 $S T, B P$ 交于点 $Q$. 求证: 以 $H Q$ 为直径的圆经过一个定点.

证明 设 $A B$ 中点为 $M$. 我们来证明以 $H Q$ 为直径的圆过点 $M$.

采用复数法, 以 $\omega$ 为单位圆建立复平面, 用各点小写字母表示其对应复数.

$$
\begin{aligned}
h=a+b+p, A S \perp O H & \Rightarrow a s=\frac{h-o}{\overline{h-o}}=\frac{(a+b+p) a b p}{a b+b p+a p} \\
& \Rightarrow s=\frac{(a+b+p) b p}{a b+b p+p a}
\end{aligned}
$$

这里利用了 $a, b, p$ 模长均为 1 .

$$
T B / / A P \Rightarrow t=\frac{a p}{b} .
$$

重新定义 $Q$ 在 $B P$ 上并且 $M Q \perp H M$, 来证明 $Q S T$ 共线.

$$
q+b p \bar{q}=b+p, \quad \frac{q-m}{\overline{q-m}}=-\frac{h-m}{\overline{h-m}} .
$$

联立得

$$
q=\frac{p(b+p)}{p+a} .
$$

只需证明 $q+s t \bar{q}=s+t$. 代入后, 这等价于

$$
\frac{p(b+p)}{p+a}+\frac{a^{2} p(b+p)(a+b+p)}{b(a b+a p+b p)(p+a)}=\frac{(a+b+p) b p}{a b+a p+p b}+\frac{a p}{b} .
$$

将分母带有 $a b+a p+b p$ 的两项移到一边通分:

$$
\frac{p(b(b+p)-a(p+a))}{b(p+a)}=\frac{p(a+b+p)\left(b^{2}(p+a)-a^{2}(b+p)\right)}{(a b+a p+b p) b(p+a)} .
$$

因式分解得证.

评注 本题是简单的几何题.由于单位圆上有很多点, 所以采用复数法将十分方便。

20. 设整数 $a, b, d$ 满足 $|a| \geq 2, d \geq 0, b \geq(|a|+1)^{d+1}$. 设 $f(x)$ 是次数为 $d$ 的实系数多项式, 对每个正整数 $n$, 用 $r_{n}$ 表示 $\left[f(n) a^{n}\right]$ 模 $b$ 的余数. 求证: 若 $\left\{r_{n}\right\}$ 最终周期, 则 $f(x)$ 的系数都是有理数.
证明 记 $\left[f(n) a^{n}\right]=x_{n},\left\{f(n) a^{n}\right\}=y_{n}$.

由条件, 存在 $N, T \in \mathbb{Z}_{+}$, 使得对任意 $n \geq N, x_{n+T}-x_{n}$ 被 $b$ 整除. 注意到 $a^{T} f(n+T)-f(n)$ 为 $d$ 次多项式, 记为 $g(n)$. 则 $a^{n} g(n)-\left(x_{n+T}-x_{n}\right) \in(-1,1)$.

考虑

$$
\begin{gathered}
\sum_{i=0}^{d+1}\left(a^{n+i} g(n+i)\right) \cdot a^{d+1-i}\left(\begin{array}{c}
d+1 \\
i
\end{array}\right)(-1)^{i}=0 \\
\Rightarrow \sum_{i=0}^{d+1}\left(a^{n+i} g(n+i)-\left(x_{n+T+i}-x_{n+i}\right)\right) \cdot a^{d+1-i}\left(\begin{array}{c}
d+1 \\
i
\end{array}\right)(-1)^{i} \equiv 0 \quad(\bmod b)
\end{gathered}
$$

对任何 $n \geq N$ 成立.

但是

$$
\begin{gathered}
\left|\sum_{i=0}^{d+1}\left(a^{n+i} g(n+i)-\left(x_{n+T+i}-x_{n+i}\right)\right) \cdot a^{d+1-i}\left(\begin{array}{c}
d+1 \\
i
\end{array}\right)(-1)^{i}\right| \\
<\sum_{i=0}^{d+1}\left|a^{d+1-i}\left(\begin{array}{c}
d+1 \\
i
\end{array}\right)\right| \leq(|a|+1)^{d+1} \leq b .
\end{gathered}
$$

所以

$$
\begin{gathered}
\sum_{i=0}^{d+1}\left(a^{n+i} g(n+i)-\left(x_{n+T+i}-x_{n+i}\right)\right) \cdot a^{d+1-i}\left(\begin{array}{c}
d+1 \\
i
\end{array}\right)(-1)^{i}=0 \\
\Rightarrow \sum_{i=0}^{d+1}\left(x_{n+T+i}-x_{n+i}\right) \cdot a^{d+1-i}\left(\begin{array}{c}
d+1 \\
i
\end{array}\right)(-1)^{i}=0
\end{gathered}
$$

对任何 $n \geq N$ 成立.

于是 $x_{n+T}-x_{n}$ 在 $n \geq N$ 是 $d+2$ 项递推数列, 特征值为 $d+1$ 重 $a$. 即 $x_{n+T}-x_{n}=a^{n} \cdot h(n), h(x)$ 为 $d$ 次多项式. 由插值公式以及 $x_{n} \in \mathbb{Z}_{+}$得 $h(x) \in \mathbb{Q}[x]$.所以 $a^{n}(h(n)-g(n)) \in(-1,1)$, 对任何 $n \geq N$.

这说明 $h(x) \equiv g(x)$. 再结合

$$
a^{T} f(n+T)-f(n)=g(n), h(x) \in \mathbb{Q}[x],|a| \geq 2
$$

容易推出 $f(x) \in \mathbb{Q}[x]$. 得证.

评注 本题是较简单的题目, 关键在于熟练运用递推数列性质以及放缩. 本题要证明的结论看似有些怪, 不过这提示我们从条件入手, 将整数、小数部分分开是经典的技巧。

21. 给定整数 $n \geq 2$. 求最小的实数 $\lambda$, 使得对任意实数 $a_{1}, a_{2}, \cdots, a_{n}$ 及 $b$, 均有

$$
\lambda \sum_{i=1}^{n} \sqrt{\left|a_{i}-b\right|}+\sqrt{n\left|\sum_{i=1}^{n} a_{i}\right|} \geq \sum_{i=1}^{n} \sqrt{\left|a_{i}\right|} .
$$

解 答案为 $\frac{n-1+\sqrt{n-1}}{\sqrt{n}}$. (记这个值为 $c$ ).

一方面, 取 $a_{1}=\cdots=a_{n-1}=-1=b, a_{n}=n-1$, 则有 $\lambda \geq c$.

下面证明 $\lambda=c$ 可行.

假设 $\sum_{i=1}^{n} a_{i}=n p \neq 0$, 考虑将 $a_{i}, b$ 同时减去 $p$. 此时 $\sum_{i=1}^{n} \sqrt{\left|a_{i}-b\right|}$ 不变, $\sum_{i=1}^{n} \sqrt{\left|a_{i}\right|}$ 至多减少 $n \sqrt{p}$ (因为 $\sqrt{|x+y|} \leq \sqrt{|x|}+\sqrt{|y|}$ ). 而 $\sqrt{n\left|\sum_{i=1}^{n} a_{i}\right|}$ 减少了 $n \sqrt{p}$. 故调整后 LHS-RHS 不增.

故不妨设 $\sum_{i=1}^{n} a_{i}=0$. 设 $a_{1}, \cdots, a_{n}$ 中有 $t$ 个非负数, $s$ 个负数. $s+t=n$. 设其中所有非负数的和为 $A$. 则由均值不等式,

$$
\sum_{i=1}^{n} \sqrt{\left|a_{i}\right|} \leq(\sqrt{s}+\sqrt{t}) \sqrt{A}
$$

对称地, 不妨设 $b \geq 0$. 注意到 $\sqrt{|x|}$ 是一个在除了奇异点 0 处之外上凸的函数. 有

$$
\begin{gathered}
\sum_{a_{i} \geq 0} \sqrt{\left|a_{i}-b\right|} \geq \sqrt{A-t b} \\
\sum_{a_{i}<0} \sqrt{\left|a_{i}-b\right|} \geq(s-1) \sqrt{b}+\sqrt{A+b}
\end{gathered}
$$

故

$$
\sum_{i=1}^{n} \sqrt{\left|a_{i}-b\right|} \geq \sqrt{A-t b}+(s-1) \sqrt{b}+\sqrt{A+b}
$$

再看上式右边在 $b$ 移动时何时取最小值: 仍然利用 $\sqrt{|x|}$ 是一个在除了奇异点 0 处之外上凸的函数. 有: $\sqrt{A-t b}+(s-1) \sqrt{b}+\sqrt{A+b}$ 当 $b=0$ 或者 $\frac{A}{t}$ 时取最小. 即

$$
\sum_{i=1}^{n} \sqrt{\left|a_{i}-b\right|} \geq \min \left\{2 \sqrt{A},(s-1) \sqrt{\frac{A}{t}}+\sqrt{\left(1+\frac{1}{t}\right) A}\right\} .
$$

于是我们只需证明:

$$
c \min \left\{2 \sqrt{A},(s-1) \sqrt{\frac{A}{t}}+\sqrt{\left(1+\frac{1}{t}\right) A}\right\} \geq(\sqrt{s}+\sqrt{t}) \sqrt{A}
$$

显然 $2 c \geq \sqrt{2 n} \geq \sqrt{s}+\sqrt{t}$.

下面证

$$
c(s-1) \sqrt{\frac{1}{t}}+\sqrt{1+\frac{1}{t}} \geq \sqrt{s}+\sqrt{t}
$$

这等价于

$$
\frac{s-1+\sqrt{t+1}}{\sqrt{n}} \geq \frac{\sqrt{s t}+t}{n-1+\sqrt{n-1}} .
$$

等价于

$$
\frac{s-1+\sqrt{t+1}-\sqrt{n}}{\sqrt{n}} \geq \frac{\sqrt{s t}+t-(n-1+\sqrt{n-1})}{n-1+\sqrt{n-1}} .
$$

注意到

$$
\begin{gathered}
s-1+\sqrt{t+1}-\sqrt{n} \geq s-1-\sqrt{s-1} \\
\sqrt{s t}+t-(n-1+\sqrt{n-1}) \leq \sqrt{s t}-s \leq \sqrt{n-1}(\sqrt{s}-1)
\end{gathered}
$$

并且

$$
\frac{s-1-\sqrt{s-1}}{\sqrt{n}} \geq \frac{\sqrt{n-1}(\sqrt{s}-1)}{n-1+\sqrt{n-1}}
$$

对于所有 $s \geq 4$ 均成立.

对于 $s=1,2,3$ 直接代入

$$
c(s-1) \sqrt{\frac{1}{t}}+\sqrt{1+\frac{1}{t}} \geq \sqrt{s}+\sqrt{t}
$$

容易检验. ( $s=1$ 时取等号.)

综上, 答案为 $\frac{n-1+\sqrt{n-1}}{\sqrt{n}}$.

评注 本题是较困难的代数题. 第一步把和调整成 0 能够极大地简化放缩 (如果没有发现这一点也可以做出来, 但是过程将十分繁琐). 事实上, 本题的结论还是比较松的, 可以直接使用均值不等式将右侧放缩. 之后利用凸性可以很好地进行放缩左边。

22. 求所有的函数 $f: \mathbb{Z} \rightarrow \mathbb{Z}$, 使得对任意整数 $a, b, c$, 均有

$$
2 f\left(a^{2}+b^{2}+c^{2}\right)-2 f(a b+b c+c a)=f(a-b)^{2}+f(b-c)^{2}+f(c-a)^{2} .
$$

解 $f(x) \equiv x$ 或者 $f(x) \equiv 0$.

检验: 前者, $\mathrm{LHS}=\mathrm{RHS}=2 \sum a^{2}+2 \sum a b$. 后者, $\mathrm{LHS}=\mathrm{RHS}=0$.

下面证明 $f(x) \equiv x$ 或者 $f(x) \equiv 0$.

记条件为 $P(a, b, c)$.

$$
\begin{gathered}
P(a, 0,0) \Rightarrow 2 f\left(a^{2}\right)=f(a)^{2}+f(-a)^{2} . \\
P(a, a, 0) \Rightarrow f\left(2 a^{2}\right)=2 f\left(a^{2}\right) .
\end{gathered}
$$

于是 $2 f(1)=f(1)^{2}+f(-1)^{2}, f(2)=2 f(1)$. 又

$$
P(1,-1,0) \Rightarrow 2 f(2)-2 f(-1)=f(2)^{2}+2 f(-1)^{2} \text {. }
$$

联立得 $f(1)=1$ 或 0 .

$$
\begin{gathered}
P(a, b, c), P(a, c, b) \Rightarrow \forall x+y+z=0, x, y, z \in \mathbb{Z} \\
f(x)^{2}+f(y)^{2}+f(z)^{2}=f(-x)^{2}+f(-y)^{2}+f(-z)^{2}
\end{gathered}
$$

记 $g(x)=f(x)^{2}-f(-x)^{2}$, 则

$$
\forall x+y+z=0, x, y, z \in \mathbb{Z}, g(x)+g(y)+g(z)=0
$$

容易说明 $g(n)=c n, c$ 为常数.

情形 1. $f(1)=1$. 此时 $f(-1)=-1 \Rightarrow g(1)=0$.

故 $g \equiv 0, f(-x)= \pm f(x)$. 结合 $2 f\left(a^{2}\right)=f(a)^{2}+f(-a)^{2} \Rightarrow f\left(a^{2}\right)=f(a)^{2}$. 结合 $f\left(2 a^{2}\right)=2 f\left(a^{2}\right) \Rightarrow f(2 a)= \pm 2 f(a)$.

$$
P(a, 1,0)-P(a,-1,0) \Rightarrow 2 f(a)+f(a-1)^{2}=2 f(-a)+f(a+1)^{2} .
$$

记之为 (1) 式.

$$
\begin{gathered}
P(a, 2,-1)-P(-a, 2,-1) \\
\Rightarrow 2 f(a-2)+f(a-2)^{2}+f(a+1)^{2}=2 f(-a-2)+f(a+2)^{2}+f(a-1)^{2} .
\end{gathered}
$$

记之为 $(2)$ 式.

称 $n$ 好的, 如果 $f(n)=n$. 下面对 $n$ 归纳证明 $n,-n$ 是好的.

(1) 式中 $a=3$ 并注意到 $f(2)=2, f(4)= \pm 4$, 得 $f(3)-f(-3)=6$

$\Rightarrow 3,-3$ 是好的.

(1) 式中令 $a=2$ 即得 -2 是好的.

$n=0,1,2,3$ 已经成立. 假设小于 $n$ 时结论成立, 考虑 $n$ 时.

若 $n$ 是奇数, (1) 中令 $a=n$ 并由归假, $f(n)-f(-n)=2 n \Rightarrow n,-n$ 是好的.

若 $n$ 是偶数, 则由归假 $f(n), f(-n)= \pm n$. 同上知 $n+1,-(n+1)$ 是好的. 在 (1) 中令 $a=n$ 即得 $n,-n$ 是好的. 于是 $f(n) \equiv n$.

情形 2. $f(1)=0$. 此时 $f(-1)=0 \Rightarrow g(1)=0$, 故 $g \equiv 0, f(-x)= \pm f(x)$. 结合 $2 f\left(a^{2}\right)=f(a)^{2}+f(-a)^{2} \Rightarrow f\left(a^{2}\right)=f(a)^{2}$. 结合 $f\left(2 a^{2}\right)=2 f\left(a^{2}\right) \Rightarrow f(2 a)=$ $\pm 2 f(a)$.

称 $n$ 好的, 如果 $f(n)=0$. 下面对 $n$ 归纳证明 $n,-n$ 是好的.

$n=0,1,2$ 已经成立. 假设小于 $n$ 时结论成立, 考虑 $n$ 时.

若 $n$ 是奇数, (1) 中令 $a=n-1$ 并由归假 $\Rightarrow n$ 是好的. 故 $-n$ 是好的.

若 $n$ 为偶数, 直接由归假以及 $f(2 a)= \pm 2 f(a)$ 得 $n,-n$ 好.

于是 $f(n) \equiv 0$.

综上有 $f(x) \equiv x$ 或者 $f(x) \equiv 0$.

评注 本题是有一定难度的整数型函数方程. 其难点在于 $\sum a^{2}$ 并不好控制, 所以笔者的想法是消去该项. 有了这个想法就可以完成归纳. 本题还可以利用三平方和定理来刻画 $\sum a^{2}$.

23. 设 $p$ 是质数, 实数 $\lambda \in(0,1)$, 正整数 $s \leq t<\frac{\lambda p}{12} . S, T$ 分别是由 $s, t$ 个连续正整数构成的集合, 满足

$$
|\{(x, y) \in S \times T \mid k x \equiv y \quad(\bmod p)\}| \geq 1+\lambda s
$$

求证: 存在整数 $a, b$, 满足 $1 \leq a \leq \frac{1}{\lambda},|b| \leq \frac{t}{\lambda s}$, 且 $k a \equiv b(\bmod p)$.

证明 取最小的正整数 $a$, 使得 $k a(\bmod p)$ 落在 $\left[-\frac{t}{\lambda s}, \frac{t}{\lambda s}\right]$ 中.

一方面, 由抽屉原理,

$$
\{(x, y) \in S \times T \mid k x \equiv y \quad(\bmod p)\}
$$

中至少 $1+\lambda s$ 个元素有两个对应的 $y$ 的差至多 $\frac{t}{\lambda s}$, 说明存在 $S$ 中两个数的差乘 $k$ 后落在 $\left[-\frac{t}{\lambda s}, \frac{t}{\lambda s}\right]$ 中.

故 $a \leq s$.

假设 $a>\frac{1}{\lambda}$. 不妨设 $k a(\bmod p)$ 落在 $\left[0, \frac{t}{\lambda s}\right]$ 中. 将 $S$ 中的元素按 $\bmod a$ 分类. 注意到 $(n+a) k(\bmod p)$ 落在 $n k(\bmod p)$ 后面至多 $\frac{t}{\lambda s}$ 的位置. 每一类至多 $\frac{s}{a}+1$ 个数, 故每一类乘 $k$ 后 $\bmod p$ 落在一段长度至多

$$
\frac{t}{\lambda s} \cdot \frac{s}{a} \leq t
$$

的区间中.

称 $S$ 中 $\bmod a$ 一类是好的, 如果这类中有某个数乘 $k$ 后落在 $T$ 中. 对每个好类, 取 $S$ 中 $\bmod a$ 该类中最小的数. 设所有 $l+1$ 个好类对应 $x_{0}, \cdots, x_{l} \in S$. 那么这 $l+1$ 个数两两差小于 $a$.

显然至少一个好类. 如果只有一个好类, 那么

$$
|\{(x, y) \in S \times T \mid k x \equiv y \quad(\bmod p)\}| \leq \frac{s}{a}+1<1+\lambda s
$$

矛盾! 所以 $l \in \mathbb{Z}_{+}$.

注意每一类的数 “升序排列” 并且总长度不会超过 $t$, 并且结合好类的定义, 推出 $k x_{0}, \cdots, k x_{l}(\bmod p)$ 落在一段长度不超过 $2 t$ 的区间内. 于是存在 $k x_{0}, \cdots, k x_{l}$ 中两者, $\bmod p$ 的差至多是 $\frac{2 t}{l}$.

不妨设为 $b k(\bmod p) \in\left[-\frac{2 t}{l}, \frac{2 t}{l}\right]$. 其中 $b$ 是那两个 $x_{i}$ 的差, $b \in \mathbb{Z}_{+}, b<a$.

设 $a=q b+r, q, r \in \mathbb{Z},|r| \leq \frac{b}{2}$. 记 $(x)$ 表示 $x(\bmod p)$ 的绝对值最小剩余 (即 $\left.(x) \in\left(-\frac{p}{2}, \frac{p}{2}\right).\right)$ 则 $b(r k) \equiv b r k \equiv r(b k)(\bmod p)$.

考虑

$$
\begin{aligned}
\mid\{(x, y) & \in S \times T \mid k x \equiv y \quad(\bmod p)\} \left\lvert\, \leq(l+1)\left(\frac{s}{a}+1\right)\right. \\
& \Rightarrow(1+l)\left(\frac{s}{a}+1\right) \geq 1+\lambda s \Rightarrow a \leq \frac{3 l}{\lambda}
\end{aligned}
$$

于是

$$
q|r(b k)|<a \cdot \frac{2 t}{l} \leq \frac{3 l}{\lambda} \cdot \frac{2 t}{l}<\frac{6 t}{\lambda} \leq \frac{p}{2} .
$$

若 $b(r k)=r(b k)$, 则 $(a k)=q(b k)+(r k)$, 但是 $|r| \leq \frac{b}{2}$, 推出

$$
(r k) \leq \frac{1}{2}(b k) \Rightarrow|(r k)|<|(a k)|,
$$

与 $a$ 最小性矛盾! 故 $|b(r k)| \geq p-|r(b k)|$. 所以 $|(r k)|=|(a k-q \cdot b k)|$ 中:

$$
\text { 左边 } \geq \frac{p-r \frac{2 t}{l}}{b} \text {, 右边 } \leq|(a k)|+q|(b k)| \leq \frac{t}{\lambda s}+q \frac{2 t}{l} \text {. }
$$

故有

$$
\begin{aligned}
\frac{p-r \frac{2 t}{l}}{b} \leq \frac{t}{\lambda s}+q \frac{2 t}{l} & \Rightarrow \frac{2 t}{l} \cdot(b q+r)+b \frac{t}{\lambda s} \geq p \\
& \Rightarrow \frac{2 t}{l} \cdot a+a \frac{t}{\lambda s} \geq p
\end{aligned}
$$

而

$$
a \frac{t}{\lambda s} \leq s \frac{t}{\lambda s}<\frac{p}{12}
$$

于是

$$
\frac{2 t}{l} \cdot a>\frac{11}{12} p \Rightarrow a>\frac{11 l}{2 \lambda}
$$

这与 $a \leq \frac{3 l}{\lambda}$ 矛盾!

综上得证.

评注 本题是难度较大的数论题. 在取出最小的 $a$ 之后, 入手点可以考虑特殊情况, 比如仅有一类或者两类触碰到 $T$ 的情况, 然后可以用类似的估计推广到更多类的情况. (其核心在于, 如果 $a$ 比较接近 $\frac{1}{\lambda}$ 时, 通过 $b$ 来放缩与 $a$ 最小性推矛盾)本题也可以通过对偶形式: 即一开始取出

$$
\left\{a k \bmod (p) \mid a \in \mathbb{Z}_{+}, a \leq \frac{1}{\lambda}\right\}
$$

中最小绝对剩余最小者。(这样做似乎过程更加简单)

从另一个角度的看法来自江城同学:

记 $(k x)$ 为 $k x$ 模 $p$ 的余数。

我们希望证明除非一些很特殊的情况， $(k x)(1 \leq x \leq r)$ 的分布是几乎均匀的（不同部分密度至多差常数倍)。

实际上，将这些数从小到大排序，相邻的差不超过三种，记为 $a, b, p-c$ ，其中 $a=b-c$ ，再设 $a=(u k), b=(v k), c=(w k)$ ，可以视作从某个 $x_{0}$ 开始，若小于 $p-u$ 则加上 $u,(k x)$ 加上 $a$, 否则若大于 $w$ 则减去 $w$ (可能视 $a, c$ 的大小关系相反，但不重要），剩下的情况加上 $v$ 。这样的一个过程中任意两个区间的密度比不超过 3 ，除非整个都是等差数列。

如果是等差数列容易得证，否则可以证明所有的 $(k x)$ 分布不超过总长的 $\frac{1}{3}$ ，用连分数表示或者各种方法也很容易推出矛盾。

24. 设 $n$ 是正整数. 初始时, 一个 $2 n \times 2 n$ 的方格表中有 $k$ 个黑格, 其余为白格. 允许进行如下两种操作:

(1) 若一个 $2 \times 2$ 正方形中恰有 3 个黑格,则可以将第 4 个也变为格;

(2) 若一个 $2 \times 2$ 正方形中恰有 2 个黑格, 则可以将其中的黑格变为白格、白格变为黑格.

求最小的正整数 $k$, 使得有限次操作后所有格都是黑格.

解 答案为 $n^{2}+n+1$.

考虑如下的构造: 染黑主对角线上 $2 n$ 格. 将方格表分成一些 $2 \times 2$.

对于主对角线下方的 $2 \times 2$, 染黑左下角的格.

对于主对角线上方的 $2 \times 2$, 染黑右上角的格.

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-19.jpg?height=563&width=560&top_left_y=1009&top_left_x=771)

我们来证明无论怎么进行 (2) 都无法进行 (1).

将表格红蓝相间二染色. 比如让图中对角线上的格是红格. 每个状态下, 将两个黑格连边, 当且仅当它们有公共顶点. 则图中有一些连通分支.

我们将对操作次数 $t$ 归纳证明: 第 $t$ 次操作后,

(a) 没有两个黑格有公共边; (这样每个连通分支是同色的)

(b) 每个红连通分支是一条左上一右下方向的链 (可以只有一个点) ;

(c) 每个蓝连通分支是一条左下一右上方向的链 (可以只有一个点).

$t=0$ 时成立.

假设结论对于 $t-1$ 时成立, 考虑对这个状态做一次操作 (2) 后的状态.

那么这次操作的 $2 \times 2$ 中一定是两个对角相邻的黑格.

假设违反了 $(a)$ : 假设出现了红格 $A$, 蓝格 $B$ 相邻. 由归假, 不妨设 $A$ 是新出现的. 这导致操作前违反 $(c)$, 矛盾!

假设违反了 $(b)$ : 假设出现了两个红格 $C, D$ 是左上一右下相邻的, 那么容易讨论发现操作前必定违反 $(a)$ 或 $(c)$.
![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-20.jpg?height=432&width=706&top_left_y=198&top_left_x=672)

同理也不可能违反 $(c)$.

于是无论怎么操作都不可能得到两黑格有公共边. 当然也不可能进行操作(1).于是 $k \geq n^{2}+n+1$.

下面证明, 如果有某种状态, 无论怎么进行 (2) 都无法达成一个 $2 \times 2$ 中有三个黑格, 并且整张表不全是黑格, 那么其中黑格至多是 $n^{2}+n$.

$n=1,2$ 显然. 下设 $n \geq 3$.

首先, 如果有限步操作后能出现两个黑格相邻(以下的相邻都指有公共边).

比如它们在同一行. 那么操作 (2) 允许它们上下平移.

注意到如果有一个 $a \times b$ 中全是黑格 $(a \geq 3, b \geq 2)$, 如下图, 可以进行操作 (1)

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-20.jpg?height=277&width=671&top_left_y=1421&top_left_x=681)

所以容易发现这两个相邻黑格所在的两列共至多 4 格.

否则: 可以将这两列所有格平移到一个 $2 \times b, b \geq 3$ 的矩形. 考虑该矩形所在的黑格连通块, 由于不能进行 (1), 这个连通块必定是一个矩形. 不妨设它没有贴合下边界, 那么可以运用上图的操作完成扩展. 矛盾!

并且这两行有至少三格, 则必恰为四格, 说明可以通过平移生成任何相邻两行的坚着相邻的两格. 这说明一共就只有四格, 成立.

于是每当我们看到这样的两格, 就将这两列删去. 至多删去了 2 个黑格.

如果既删去了行又删去了列, 说明可以操作使得既有两格横向相邻, 又有两个纵向相邻.

再由相邻两格可以平移, 可以将这两对黑格移动至相邻, 然后通过类似讨论可以操作 (1). 矛盾.

于是不妨设只删去了一些列. 并且剩下的表格中, 无论如何进行操作 (2) 都无
法得到两格相邻.

设删去了 $2 m$ 列, 剩下至多 $m+1$ 个列数之和 $2 n-2 m$ 的 $n$ 行的子表.

我们将证明: 对于相邻 (没被删去的) 三列, 设三列有 $a, b, c$ 个黑格,则

$$
a+2 b+c \leq 2 n+1 \text {. }
$$

首先 $a, b, c \leq n$. 故不妨设 $b>0$.

设中间一列黑格从上到下为 $A_{1}, A_{2}, \cdots, A_{b}$.

考虑 $A_{i}, A_{i+1}$ 之间的行(不包括这两格所在行), 设有 $l_{i}$ 行. $l_{i} \geq 1$. ( $A_{i}, A_{i+1}$ 所在行两边不是黑格.)

我们来证明其中至多 $l_{i}-1$ 个黑格.

这 $l_{i}$ 行中, 两边的行各至多 $\frac{l_{i}+1}{2}$ 个黑格.

如果其中正好 $l_{i}+1$ 个黑格, 那么 $A_{i}$ 左下角和右下角两格都是黑格, 可以进行操作使得两格黑格相邻, 矛盾!

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-21.jpg?height=443&width=240&top_left_y=1166&top_left_x=908)

下面证明不可能正好 $l_{i}$ 黑格.

若 $l_{i}$ 为奇数, 那么两边必各 $\frac{l_{i}+1}{2}, \frac{l_{i}-1}{2}$ 个黑格. 由于不出现上面这种结构, 所以一定是下图左边的结构:

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-21.jpg?height=762&width=554&top_left_y=1915&top_left_x=771)
如上图, 定义点 $B_{1}, \cdots, B_{l_{i}}$ 是这些黑格的左或右下角的顶点. 依次对于以 $B_{l_{i}}, \cdots, B_{1}$ 的 $2 \times 2$ 进行操作 $(2)$, 则如上图所示得到两黑格相邻, 矛盾!

若 $l_{i}$ 为偶数, 那么两边必各 $\frac{l_{i}}{2}$ 个黑格.

同样的, 由于不出现 “ $A_{i}$ 左下角和右下角两格都是黑格”或者 “ $A_{i+1}$ 左上角和右上角两格都是黑格”, 故一定是下图左侧结构或其左右对称:

![](https://cdn.mathpix.com/cropped/2024_02_26_115e7b2fa9095dd47682g-22.jpg?height=751&width=551&top_left_y=590&top_left_x=750)

如上图, 定义点 $B_{1}, \cdots, B_{l_{i}}$ 是这些黑格的左或右下角的顶点. 依次对于以 $B_{l_{i}}, \cdots, B_{1}$ 的 $2 \times 2$ 进行操作 $(2)$, 则如上图所示得到两黑格相邻, 矛盾!

于是我们证明了 $A_{i}, A_{i+1}$ 之间的行(不包括这两格所在行)至多 $l_{i}-1$ 个黑格.

对于 $A_{1}$ 上方 ( $A_{b}$ 下方) 的行 (设有 $l$ 行), 容易证明其中至多 $l$ 个黑格.

于是累加起来就有 $a+2 b+c \leq 2 n+1$.

还需要处理一些边角情况: 比如一张 $n$ 行的表格最左 (右) 边两列有 $a, b$ 个黑格.

来证明 $3 a+b \leq 3 n+1$.

设第二列黑格 $A_{1}, \cdots, A_{b}$. 考虑第一列黑格与它们对角相邻的次数, 设为 $k$.

则每个 $A_{i}$ 最多被对角相邻1次.

结合第一列黑格两两不相邻, 所以

$$
a \leq \frac{2 n-b-(b+1)}{2}+\frac{k+2}{2} \leq \frac{2 n+1-b}{2} .
$$

所以

$$
3 a+b \leq \frac{3}{2} \cdot(2 n+1) \Rightarrow 3 a+b \leq 3 n+1 .
$$

假设我们剩下 $t \leq m+1$ 个列数之和 $2 n-2 m$ 的 $n$ 行的子表.

设列数为 $x_{1}, x_{2}, \cdots, x_{t}, \sum_{i=1}^{t} x_{i}=2 n-2 m$.
对于一个 $n \times p$ 的表, $p \geq 2$, 设每列有 $a_{1}, \cdots, a_{p}$ 个黑格. 则有

$$
\begin{gathered}
3 a_{1}+a_{2} \leq 3 n+1 ; \\
a_{1}+2 a_{2}+a_{3} \leq 2 n+1 ; \\
a_{2}+2 a_{3}+a_{4} \leq 2 n+1 ; \\
\ldots \\
a_{p-2}+2 a_{p-1}+a_{p} \leq 2 n+1 ; \\
a_{p-1}+3 a_{p} \leq 3 n+1 .
\end{gathered}
$$

全部加起来, 得到总黑格数至多 $\frac{(p+1)(2 n+1)-1}{4}$.

对于 $n \times 1$ 至多 $n$ 个, 也满足上式.

对 $p=x_{1}, \cdots, x_{t}$ 求和得到: 总黑格数至多

$$
\begin{aligned}
\sum_{i=1}^{t} \frac{\left(x_{i}+1\right)(2 n+1)-1}{4} & =\frac{(2 n-2 m+t)(2 n+1)-t}{4} \\
& \leq \frac{(2 n-m+1)(2 n+1)-m-1}{4}
\end{aligned}
$$

加上我们删去的至多 $2 m$ 个, 共计至多

$$
\frac{4 n^{2}+4 n-m(2 n-6)}{4}
$$

个黑格. 当 $n \geq 3$ 已经成立.

于是我们证明了如果 $k \geq n^{2}+n+1$, 就一定能在有限次操作后黑格数量增加.于是有限步后变成全黑.

综上, 答案为 $n^{2}+n+1$.

评注：本题是难度较大的组合题. 其构造容易想到, 但是证明构造的正确性也有一定难度。对于证明部分, 先发现如果有两格相邻黑格会非常“亏”, 然后把问题“几乎”转化为不会出现相邻黑格. 笔者采用最朴素的技巧，即考虑若干行的关联, 并且上述的卡等估计是十分巧妙的. 最后只需要对照构造做一些边界情况即可.

另一种想法仍然来自江城同学:

答案: $n^{2}+n+1 . n=1$ 显然，现在假设 $n \geq 2$ 。

构造: 主对角线+下方所有两个坐标为奇数的点+上方所有两个坐标为偶数的点。

Lemma:如果 $m \times n$ 里面有大于 $(m+1)(n+1) / 4$ 个格子染黑，那么一定能操作使得两个黑格相邻。

Proof: 反证，假设不行，那么更不能有三个。考虑所有能到达的状态中， $\sum_{(x, y) \text { black }}(x+y)^{3}$ 最小的一种。那么没有两个格子形如 $(x, y),(x+1, y+1)$ ，否则可以换为 $(x, y+1),(x+1, y)$; 同样没有三个格子形如 $(x, y+1),(x+1, y),(x+2, y+2)$ ，否则可以通过两次对调换为 $(x, y),(x+2, y+1),(x+1, y+2)$ ，现在考虑每条形如 $x+y=c$ 的直线上连续的一段，假设有 $t+1$ 个 $(a+t, b), \cdots,(a, b+t)$ ，那么根据上面的讨论

$(a+t+1, b), \cdots,(a, b \dashv t+1),(a+t \dashv 1, b+1), \cdots,(b+1, a+t+1), \cdots,(a+t+1, b+2), \cdots,(a+2, b+t+1)$ 这 $3 t+3$ 个格子都不能有。并且，我们对应到的部分可以证明都是不交的，这就完成了引理的证明。

回到原题，如果能做出 $2 \times 2$ 里面有 3 个容易填满整个；现在根据引理能找出两个相邻的，不妨假设不同列，这个可以在那两列中自由移动。这样相邻的几列也最多一个，直到两边的列均为空。此时再在分出的两个子矩形里面这样继续，不断这样操作，可以证明不超过 $n^{2}+n$ 个，或者存在两个不同行相邻，这样可以移动使得一个 $2 \times 2$ 里面有三个。

运用寻找一个扩张使得两两不交的想法. 并且在这之前需要一个巧妙的调整来更好地刻画初始状态.

由于该场考试前两题难度较大, 导致有时间做出这题的同学很少。

