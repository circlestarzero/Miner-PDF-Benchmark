# 一道精美的组合几何构造问题 

冯跃峰

2019 年中国国家集训队测试题中有一个非常有趣的组合几何构造问题 (见《走向 IMO, 数学奥林匹克试题集锦, 2019》, p123-124):

【问题】在平面上给定 60 个点, 其中任意三点不共线. 证明: 可以把这 60 个点分成 20 个“两两不交” 的三点组 $\left\{A_{i}, B_{i}, C_{i}\right\}(1 \leq i \leq 20)$, 使得

$$
\bigcap_{i=1}^{20} \triangle A_{i} B_{i} C_{i} \neq \varnothing
$$

这里 $\triangle A_{i} B_{i} C_{i}$ 表示平面上 $\triangle A_{i} B_{i} C_{i}$ 的内部及边界上的所有点构成的点集.

一读到题目, 便被深深吸引. 它有明显的海莱定理背景, 似乎只需证明任何 3 个凸集 $\triangle A_{i} B_{i} C_{i}, \triangle A_{j} B_{j} C_{j}, \triangle A_{k} B_{k} C_{k}$ 的交非空即可. 但问题是, 题中没有给出具体的三角形, 而需要适当将已知点分组, 它类似于集合的划分, 因而它本质上属于构造问题. 更为重要的是, 直于海莱定理的固定结构, 解题并不能获得成功, 需要将其适当拓广, 方能达到目标, 这是本题最为迷人之处. 当然, 也许我们没有找到好的思路, 读者不妨试试, 能否直接构造 20 个三角形, 使任何 3 个三角形有公共点.

原解答相当巧妙, 读之深受启发. 本文试图还原其解答的探索过程, 并附带订正原解答过程中出现的一个小小疏漏.

【思路分析】解题的关键, 是采用撒网策略, 将三点集扩充为 $r$-点集：构造 20 个 $r$-点集的闭域 (凸包边界及内部所有点构成的集合称为闭域) $G_{i}(1 \leq i \leq 20)$, 使之有公共点, 其中 $r$ 待定.

由海莱定理, 这只需任何 3 个闭域 $G_{i}$ 的交非空, 进而只需任何 3 个 $r$-点集的交非空.

为此, 先考虑 $A \cap B \neq \varnothing$ 的充分条件. 由容斥原理可知,

$$
|A \cap B|=|A|+|B|-|A \cup B|,
$$[^0]所以 $A \cap B \neq \varnothing$ 的一个充分条件是 $|A|+|B|-|A \cup B|>0$, 即 $|A|+|B|>|A \cup B|$.

进而, $A \cap B \cap C \neq \varnothing$ 的一个充分条件是 $|A \cap B|+|C|>|A \cup B \cup C|$.

设 $A, B, C$ 都是题给 60 个点的 $r$-子集, 则 $|A \cup B \cup C| \leq 60$, 所以 $A \cap B \cap C \neq$ $\varnothing$ 的一个充分条件是 $|A \cap B|+|C|>60$. 而 $|C|=r$, 所以 $|A \cap B|>60-r$, 即

$$
|A|+|B|>|A \cup B|+60-r \text {. }
$$

再注意到 $|A \cup B| \leq 60$, 所以只需 $|A|+|B|>120-r$, 即 $2 r>120-r$, 解得 $r>40$, 取 $r=41$ 即可.

以上实际上证明了, 题给 60 个点的 41 元子集中任何 3 个都相交.

但现在还不能利用海莱定理, 因为“ 41 元子集”是离散点集. 为了将其变成凸集, 考察其闭域即可.

记 41-点集 $G_{i}$ 的凸包边界及其内部点的集合为 $\Omega_{i}(1 \leq i \leq 20)$ ，则 $G_{i} \subseteq \Omega_{i}$,而 $G_{i}(1 \leq i \leq 20)$ 中任何 3 个都相交, 从而 $\Omega_{i}(1 \leq i \leq 20)$ 中任何 3 个都相交.由海莱定理, 所有 $\bigcap_{i=1}^{20} \Omega_{i} \neq \varnothing$.

这与解题目标还相去甚远：凸集 $\Omega_{i}$ 并非 $\triangle A_{i} B_{i} C_{i}$ (边界及内部点构成的集合). 我们期望将 $\bigcap_{i=1}^{20} \Omega_{i} \neq \varnothing$ 优化为 $\bigcap_{i=1}^{20} \triangle A_{i} B_{i} C_{i} \neq \varnothing$. 这须再一次采用撒网策略, 考察所有的 41 点集的闭域, 因为仅 20 个闭域 $\Omega_{i}(1 \leq i \leq 20)$ 未必能找到所需的 $\bigcap_{i=1}^{20} \triangle A_{i} B_{i} C_{i} \neq \varnothing$.

考察题给 60 个点的所有 41 元子集, 共有 $m=\mathrm{C}_{60}^{41}$ 个. 由上所证, 这 $m$ 个凸集中任何 3 个都相交, 从而 $\bigcap_{i=1}^{m} \Omega_{i} \neq \varnothing$.

为找到凸集 $\triangle A_{i} B_{i} C_{i}(1 \leq i \leq 20)$, 使 $\bigcap_{i=1}^{20} \triangle A_{i} B_{i} C_{i} \neq \varnothing$, 容易想到, 让每个凸集 $\triangle A_{i} B_{i} C_{i}$ 都覆盖一个凸集 $\Omega_{i}(1 \leq i \leq 20)$. 这样, $m$ 个凸集 $\Omega_{i}(1 \leq i \leq m)$的公共点就是 20 个凸集 $\triangle A_{i} B_{i} C_{i}(1 \leq i \leq 20)$ 的公共点.

但这是无法实现的, 我们将其弱化为: 适当对已知点编号, 使每个三角 $\triangle A_{i} B_{i} C_{i}(1 \leq i \leq 20)$ 任何两边都 “跨越” (从一个顶点旋转到第三顶点) 41 个已知点.

设 $P$ 是所有凸集 $\Omega_{i}(1 \leq i \leq m)$ 的公共点, 取离 $P$ 最近的一个已知点为 $P_{1}$,作射线 $P P_{1}$, 则由于已知点中无 3 点共线, 射线上最多有 2 个已知点.

想象射线绕点 $P$ 按逆时针方向旋转一周, 依次越过的已知点分别为 $P_{1}, P_{2}, \cdots, P_{60}$, 其中规定, 当射线同时跨越 2 个点时, 离 $P$ 较近的点的下标小于离 $P$ 较远的点的下标. 特别地, 如果 $P$ 也是已知点, 则记 $P_{60}=P$.

为了使每个三角形 $\triangle_{i}=\left(P_{i} P_{j} P_{k}\right)$ 的任何两边都“合并跨越” 41 个已知点,
只需 $\triangle_{i}(1 \leq i \leq 20)$ 的三顶点的最大最小下标差: $k-i=40$.

此外, 为了使每个三角形 $\triangle_{i}=\left(P_{i} P_{j} P_{k}\right)(1 \leq i \leq 20)$ 中任何两个没有公共顶点, 想象其顶点下标 $j=f(i), k=g(i)$. 当 $i$ 跑遍 $1,2, \cdots, 20$ 时, $f(i)$ 跑遍 $21,22, \cdots, 40 ; g(i)$ 跑遍 $41,42, \cdots, 60$, 三个下标 $i, j, k$ 合并构成 $1,2, \cdots, 60$ 的一个排列.

由此可见, 取 $\triangle_{i}=\left(P_{i} P_{i+20} P_{i+40}\right)(1 \leq i \leq 20)$ 即可.

下面证明: 若 $P$ 是所有凸集 $\Omega_{i}(1 \leq i \leq m)$ 的公共点, 则

$$
P \in \triangle P_{i} P_{i+20} P_{i+40}(1 \leq i \leq 20)
$$

用反证法, 设存在 $1 \leq i \leq 20$, 使 $P \notin$ 凸集 $\triangle P_{i} P_{i+20} P_{i+40}$, 当然有 $P \notin$ $\left\{P_{i}, P_{i+20}, P_{i+40}\right\}$.

利用 $\triangle P_{i} P_{i+20} P_{i+40}$ 的凸性, 可用直线进行分隔 (在直线一侧). 于是, 存在过 $P$ 作直线 $L$, 使凸集 $\triangle P_{i} P_{i+20} P_{i+40}$ 位于 $L$ 的同一侧. 想象直线 $L$ 绕点 $P$ 按逆时针方向旋转, 从 $P P_{i}$ 转到 $\mathrm{PP}{ }_{i+40}$ 时, 根据已知点的排序规则, 其跨越的已知点依次为 $P_{i}, P_{i+1}, \ldots, P_{i+40}$.

上述 41 个已知点都位于 $L$ 的同一侧, 从而这 41 个点的凸包边界及其内部点构成的凸集 $\Omega_{i}(1 \leq i \leq m)$ 位于 $L$ 的同一侧. 但由 $P$ 的选取规则, 应有 $P \in \Omega_{i}$, 矛盾.

【注】上述证明最后一段存在漏洞. 尽管存在过 $P$ 作直线 $L$, 使凸集 $\triangle P_{i} P_{i+20} P_{i+40}$ 位于 $L$ 的同一侧. 但未必 $L$ 绕点 $P$ 按逆时针方向旋转, 从 $P P_{i}$ 转到 $P P_{i+40}$ 时, 跨越的 41 个已知点都位于 $L$ 的同一侧. 反例如下图所示:

![](https://cdn.mathpix.com/cropped/2024_02_26_a19a54d2433fdf95ecd5g-3.jpg?height=631&width=859&top_left_y=1798&top_left_x=610)

我们虽然发现了上述漏洞, 但苦于没有解决办法. 后来, 㫿振华教授给出了一个完美的修改方案, 其处理手法极为巧妙: 关键是将闭域转化为开域 (类似于
不等式改进为严格不等式) 重新进行估计.

组合几何中, 数据的细微改进, 常常起着至关重要的作用, 这个改进估计的手法就是一个典型的例子.

首先要考虑的是,如何改进前面得到的交集估计.由

$$
|A \cap B|=|A|+|B|-|A \cup B| \geq 41+41-60=22
$$

已推出 $A \cap B \cap C \neq \varnothing$. 稍作思考, 这一估计可改进为 $|A \cap B \cap C| \geq 3$.

实际上, 因为

$$
|A \cap B|=|A|+|B|-|A \cup B| \geq 41+41-60=22
$$

所以 $|\overline{A \cap B}| \leq 60-22=38$, 进而

$$
|A \cap B \cap C| \geq|C|-|\overline{A \cap B}| \geq 41-38=3 .
$$

这个数据“ “” 却有重大意义一 3 个已知点生成一个三角形, 任何三个凸包的交存在内部区域! 这是将闭域改进为开域的前提.

因为任何三个凸包的交中有 3 个已知点构成三角形, 于是任何 3 个凸包内部的交也非空, 由凯莱定理, 所有凸包内部的交非空 (含有一个上述三角形的内部)，其交是一个非线性的开集.

60 个点两两连线, 只有有限条直线, 不能覆盖上述开集, 可在该开集中选取一点 $\mathrm{P}$, 使其不在任何两个已知点确定的直线上 (当然 $\mathrm{P}$ 也就不是已知点).

下面验证这样选取的点 $P$ 属于每个 $\triangle P_{i} P_{i+20} P_{i+40}$, 这是水到渠成的, 采用反证法即可.

假设存在 $1 \leq i \leq 20$, 使 $P \notin \triangle P_{i} P_{i+20} P_{i+40}$, 则存在过 $P$ 的直线 $L$, 使 $\triangle P_{i} P_{i+20} P_{i+40}$ 位于 $L$ 的同一侧. 此时, 直线 $L$ 不包含 $\triangle P_{i} P_{i+20} P_{i+40}$ 的那一侧至多包含了 $\triangle P_{i} P_{i+20} P_{i+40}$ 相邻两顶点间按前述射线旋转所跨越的 19 个点, 从而 $L$ 的含 $\triangle P_{i} P_{i+20} P_{i+40}$ 的那一侧至少含有 41 个已知点, 设这 41 个点的凸包内部开区域为 $\Omega_{i}(1 \leq i \leq m)$. 由 $P$ 的选取规则, 应有 $P \in \Omega_{i}$, 矛盾.

所以 $P$ 是 20 个 $\triangle P_{i} P_{i+20} P_{i+40}(1 \leq i \leq 20)$ 的公共点, 命题获证.

【新写】记 $m=\mathrm{C}_{60}^{41}$, 对 $1 \leq i \leq m$, 设每 41 个已知点的凸包内部开区域为 $\Omega_{i}$.

对任意 3 个 41 点集 $A, B, C$, 有

$$
|A \cap B|=|A|+|B|-|A \cup B| \geq 41+41-60=22
$$

所以 $|\overline{A \cap B}| \leq 60-22=38$, 进而 $|A \cap B \cap C|=|C|-|\overline{A \cap B}| \geq 41-38=3$.
这说明任何三个凸包的交中含有 3 个已知点构成的三角形, 从而任何 3 个开集 $\Omega_{i}(1 \leq i \leq m)$ 的交也非空 (含有一个上述三角形的内部), 由凯莱定理, 所有 $m$ 个开集的交非空, 其交是一个非线性的开集.

60 个点形成的有限条直线, 不能覆盖上述开集, 可在该开集中选取一点 $P$,使其不在任何两个已知点确定的直线上. 以 $P$ 为端点作射线, 绕点 $P$ 按逆时针方向旋转一周, 则任何时刻射线至多通过一个已知点, 设其越过的已知点依次为 $P_{1}, P_{2}, \cdots, P_{60}$.

假设存在 $1 \leq i \leq 20$, 使 $P \notin \triangle P_{i} P_{i+20} P_{i+40}$, 则存在过 $P$ 的直线 $L$, 使 $\triangle P_{i} P_{i+20} P_{i+40}$ 位于 $L$ 的同一侧. 此时, 直线 $L$ 不包含 $\triangle P_{i} P_{i+20} P_{i+40}$ 的那一侧至多包含了 $\triangle P_{i} P_{i+20} P_{i+40}$ 相邻两顶点间按前述射线旋转所跨越的 19 个点, 从而 $L$ 的含 $\triangle P_{i} P_{i+20} P_{i+40}$ 的那一侧至少含有 41 个已知点, 设这 41 个点的凸包内部开区域为 $\Omega_{i}(1 \leq i \leq m)$. 由 $P$ 的选取规则, 应有 $P \in \Omega_{i}$, 矛盾.

所以 $P$ 是 20 个 $\triangle P_{i} P_{i+20} P_{i+40}(1 \leq i \leq 20)$ 的公共点, 命题获证.


[^0]:    修订日期: 2020-08-11.

