数学新星网 莫学生专栏

www.nsmath.cn/xszl

# 2023 年 IMO 试题解答与评析 

梁行健<br>(湖南师范大学附属中学, 410006)<br>指导教师: 汤礼达

2023 年第 64 届 IMO 于 7 月 $8-9$ 号在日本千叶举行. 这是中国队四年来第一次线下参赛. 本次考试的时间为北京时间 $8: 00-12: 30$, 金牌分数线为 32 分. 中国队再次夺得团体第一, 且六名队员均获得金牌, 其中有两个满分金牌.

本届 IMO 试题漂亮, 整体难度适中. 其中 1, 2, 4 三题为基础题, 3,5 为中档题, 6 为难题. 第一天整体难度不大, 第 3 题较为耗时. 第二天明显难于第一天, 其中第 5 题在解答过程的书写上有一定难度. 第 6 题是困难的几何题, 不仅考验思维而且耗时, 要想做出这个题, 就要尽快解决前两个问题, 留足时间.

本文将介绍本届 IMO 的试题及解答. 因笔者水平有限, 不当之处在所难免,敬请读者不吝赐教.

## I. 试 题

1. 求所有满足下述条件的合数 $n>1$ : 如果 $n$ 的所有正因子为 $d_{1}, d_{2}, \cdots, d_{k}$,这里 $1=d_{1}<d_{2}<\cdots<d_{k}=n$, 那么对每个 $1 \leq i \leq k-2$, 均有 $d_{i}$ 整除 $d_{i+1}+d_{i+2}$.
2. 在锐角三角形 $A B C$ 中, $A B<A C$. 设 $\Omega$ 为三角形 $A B C$ 的外接圆. 点 $S$ 是 $\Omega$ 上包含点 $A$ 的弧 $\overparen{C B}$ 的中点. 过点 $A$ 作垂直于 $B C$ 的直线与 $B S$ 交于点 $D$, 与圆 $\Omega$ 交于另一点 $E \neq A$. 过点 $D$ 且平行于 $B C$ 的直线与直线 $B E$ 交于点 $L$. 记 $\omega$ 为三角形 $B D L$ 的外接圆. 设 $\omega$ 与 $\Omega$ 交于另一点 $P \neq B$.

证明: $\omega$ 在点 $P$ 处的切线与直线 $B S$ 的交点在 $\angle B A C$ 的内角平分线上.

3. 对每个整数 $k \geq 2$, 求所有满足下述条件的无穷正整数序列 $a_{1}, a_{2}, \cdots$ :存在一个多项式 $P(x)=x^{k}+c_{k-1} x^{k-1}+\cdots+c_{1} x+c_{0}$, 这里 $c_{0}, c_{1}, \cdots, c_{k-1}$ 是

修订日期: 2023-08-06.
非负整数, 使得

$$
P\left(a_{n}\right)=a_{n+1} a_{n+2} \cdots a_{n+k}
$$

对所有整数 $n \geq 1$ 成立.

4. 设 $x_{1}, x_{2}, \cdots, x_{2023}$ 为两两不等的正实数, 使得对每个 $n=1,2, \cdots, 2023$,

$$
a_{n}=\sqrt{\left(x_{1}+x_{2}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}+\cdots+\frac{1}{x_{n}}\right)}
$$

都是一个整数. 证明: $a_{2023} \geq 3034$.

5. 设 $n$ 是一个正整数. 日式三角是将 $1+2+\cdots+n$ 个圆排成正三角形的形状, 使得对 $i=1,2, \cdots, n$, 从上到下的第 $i$ 行恰有 $i$ 个圆且其中恰有一个被染为红色. 在日式三角内, 忍者路径是指一串由 $n$ 个圆组成的序列, 从最上面一行的圆开始, 每次从当前圆连接到它下方相邻的两个圆之一，直至到达最下面一行的某个圆为止.下图为一个 $n=6$ 的日式三角, 其中画有一条包含两个红色圆的忍者路径. 求最大的整数 $k$ (用 $n$ 表示), 使得在每个日式三角中都存在一条忍者路径, 它包含至少 $k$ 个红色圆.

![](https://cdn.mathpix.com/cropped/2024_02_26_52516b9216510c724f97g-02.jpg?height=371&width=434&top_left_y=1322&top_left_x=820)

6. 设 $A B C$ 是一个正三角形. 点 $A_{1}, B_{1}, C_{1}$ 在三角形 $A B C$ 的内部, 且满足 $B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B$ 及 $\angle B A_{1} C+\angle C B_{1} A+\angle A C_{1} B=480^{\circ}$.设直线 $B C_{1}$ 与 $C B_{1}$ 交于点 $A_{2}$, 直线 $C A_{1}$ 与 $A C_{1}$ 交于点 $B_{2}$, 直线 $A B_{1}$ 与 $B A_{1}$交于点 $C_{2}$.

证明: 若三角形 $A_{1} B_{1} C_{1}$ 的三边长度两两不等, 则三角形 $A A_{1} A_{2}, B B_{1} B_{2}$和 $C C_{1} C_{2}$ 的外接圆都经过两个公共点.

## II. 解答与评注

题 1 求所有满足下述条件的合数 $n>1$ : 如果 $n$ 的所有正因子为 $d_{1}, d_{2}, \cdots$, $d_{k}$, 这里 $1=d_{1}<d_{2}<\cdots<d_{k}=n$, 那么对每个 $1 \leq i \leq k-2$, 均有 $d_{i}$ 整除 $d_{i+1}+d_{i+2}$.
解 所求为素数的方幂 $p^{\alpha}$ ( $p$ 为素数, $\alpha \geq 2$ ).

一方面, 若 $n$ 为某个素数 $p$ 的方幂, 则有 $d_{i}=p^{i-1}(1 \leq i \leq k)$. 因此

$$
d_{i+1}+d_{i+2}=p^{i-1} p(p+1)=d_{i} \cdot p(p+1),
$$

满足要求.

另一方面, 若 $n$ 不为素数方幕, 下证 $n$ 不合要求.

反证法, 假设这样的 $n$ 满足要求.

设 $n$ 的最小素因子为 $p . i$ 为最小的下标, 使得 $d_{i}$ 不为 $p$ 的方幕.

由 $i$ 的选取知. $p \nmid d_{i}$. (否则 $\frac{d_{i}}{p}$ 也不是 $p$ 的方幂, 而且比 $d_{i}$ 更小, 这与 $d_{i}$ 的选取矛盾)

由于 $d_{1}=1, d_{2}=p$. 故 $i \geq 3$. 又 $d\left|n \Rightarrow \frac{n}{d}\right| n$, 故对 $1 \leq j \leq k$ 必有 $d_{j} d_{k+1-j}=n$. 从而, 由 $d_{k+1-i} \mid d_{k+2-i}+d_{k+3-i}$, 知 $\frac{n}{d_{i}} \left\lvert\, \frac{n}{d_{i-1}}+\frac{n}{d_{i-2}}\right.$.

设 $n$ 含 $p$ 的幂次为 $\alpha$. 则由 $p \nmid d_{i}$ 知, $p^{\alpha} \left\lvert\, \frac{n}{d_{i}}\right.$. 从而 $p^{\alpha} \left\lvert\, \frac{n}{d_{i-1}}+\frac{n}{d_{i-2}}\right.$.

又对一切 $j<i$ 有 $d_{j}=p^{j-1}$, 故 $p^{\alpha} \left\lvert\, \frac{n}{p^{i-2}}(p+1)\right.$.

但 $i \geq 3$, 故 $\frac{n}{p^{i-2}}(p+1)$ 含 $p$ 的幂次为 $\alpha-i+2<\alpha$. 矛盾!

故 $n$ 不为素数幕时不合要求.

综上, 所求为所有素数方幂 $p^{\alpha}(\alpha \geq 2)$.

评注 本题是简单的数论题, 用很基础的知识点即可解决, 适合给数论初学者练习。

题 2 在锐角三角形 $A B C$ 中, $A B<A C$. 设 $\Omega$ 为三角形 $A B C$ 的外接圆.点 $S$ 是 $\Omega$ 上包含点 $A$ 的弧 $\overparen{C B}$ 的中点. 过点 $A$ 作垂直于 $B C$ 的直线与 $B S$ 交于点 $D$, 与圆 $\Omega$ 交于另一点 $E \neq A$. 过点 $D$ 且平行于 $B C$ 的直线与直线 $B E$交于点 $L$. 记 $\omega$ 为三角形 $B D L$ 的外接圆. 设 $\omega$ 与 $\Omega$ 交于另一点 $P \neq B$.

证明: $\omega$ 在点 $P$ 处的切线与直线 $B S$ 的交点在 $\angle B A C$ 的内角平分线上.

证明 设 $\Omega$ 的圆心为 $O, A O$ 交 $\Omega$ 于另一点 $A^{\prime}$, 交 $B S$ 于 $R$, 连接 $B P$.

由于 $D L / / B C$, 故

$$
\angle B P D=\angle B L D=\angle E B C=\angle E A C=90^{\circ}-\angle B C A=\angle B A A^{\prime}=\angle B P A^{\prime} .
$$

从而 $P, D, A^{\prime}$ 共线.

设 $\angle B A C$ 的平分线交 $B S$ 于 $T$. 由于

$$
\angle B A A^{\prime}=\angle E A C=90^{\circ}-\angle B C A,
$$

故 $A T$ 平分 $\angle D A R$.

![](https://cdn.mathpix.com/cropped/2024_02_26_52516b9216510c724f97g-04.jpg?height=660&width=780&top_left_y=218&top_left_x=638)

又 $S$ 为 $\widehat{B A C}$ 中点, 故 $S O \perp B C \Rightarrow S O / / A D$.

故有

$$
\frac{R T}{T D}=\frac{R A}{A D}=\frac{R O}{O S}=\frac{R O}{O A^{\prime}}
$$

因此 $A^{\prime} P / / O T$. 又 $\angle A P A^{\prime}=90^{\circ}$, 故 $A P \perp O T$. 从而 $O T$ 为 $A P$ 的垂直平分线 $\Rightarrow A T=P T$. 又

$$
\angle A D T=\angle B S O=\frac{1}{2} \angle B A C=\angle B A T
$$

故有 $\triangle B A T \backsim \triangle A D T \Rightarrow B T \cdot D T=A T^{2}=P T^{2}$.

故 $\odot(B D P)$ (即 $\omega)$ 与 $P T$ 相切. 证毕!

评注 本题是一道难度不大的几何题, 入手点比较宽, 但很难想到特别简单的方法。

题 3 对每个整数 $k \geq 2$, 求所有满足下述条件的无穷正整数序列 $a_{1}, a_{2}, \cdots$ :存在一个多项式 $P(x)=x^{k}+c_{k-1} x^{k-1}+\cdots+c_{1} x+c_{0}$, 这里 $c_{0}, c_{1}, \cdots, c_{k-1}$ 是非负整数, 使得

$$
P\left(a_{n}\right)=a_{n+1} a_{n+2} \cdots a_{n+k}
$$

对所有整数 $n \geq 1$ 成立.

解 所求为全体公差非负的等差数列.

一方面, 若 $\left\{a_{n}\right\}$ 是公差为 $d$ 的等差数列, 则

$$
P(x)=(x+d)(x+2 d) \cdots(x+k d),
$$

即满足要求.
另一方面, 任取正整数列 $a_{1}, a_{2}, \cdots, a_{n}$ 及多项式 $P(x)=x^{k}+c_{k-1} x^{k-1}+$ $\cdots+c_{0}\left(c_{k-1}, \cdots, c_{0}\right.$ 为非负整数 $)$, 满足题中等式 $P\left(a_{n}\right)=a_{n+1} a_{n+2} \cdots a_{n+k}$.

下证一断言:

断言 序列 $\left\{a_{n}\right\}_{n \in \mathbb{Z}_{+}}$单调不减.

证明 反证法, 假设存在 $n \in \mathbb{Z}_{+}, a_{n}>a_{n+1}$.

首先. 注意到由题中等式可知对一切 $m \in \mathbb{Z}_{+}$有

$$
\frac{P\left(a_{m+1}\right)}{P\left(a_{m}\right)}=\frac{a_{m+2} a_{m+3} \cdots a_{m+k+1}}{a_{m+1} a_{m+2} \cdots a_{m+k}}=\frac{a_{m+k+1}}{a_{m+1}} .
$$

因此, 若 $a_{m}>a_{m+1}$, 则 $P\left(a_{m}\right)>P\left(a_{m+1}\right) \Rightarrow a_{m+k+1}<a_{m+1}$ (这里用到 $P(x)$每项系数均非负).

取 $m_{1} \geq m+1$ 为最小的正整数, 使得 $a_{m+1}>a_{m_{1}+1}$. (由 $(*)$ 知 $m_{1}$ 存在)则 $a_{m_{1}}>a_{m_{1}+1}$. 将 $m_{1}$ 记为 $f(m)$ (这里只有当 $a_{m}>a_{m+1}$ 时, $f(m)$ 才有定义).

用 $f^{(t)}(n)$ 表示 $\underbrace{f(f(\cdots f}_{t \text { 个 }}(n) \cdots))$, 则由上述分析有: 对任意 $t \in \mathbb{Z}_{+}, f^{(t)}(n)$是自定义的, 且 $a_{n+1}>a_{f(n)+1}>f_{f^{(2)}(n)+1}>\cdots$.

于是我们找出了一个严格递减的无穷正整数列 $\left\{a_{f^{(t)}(n)+1}\right\}_{t \in \mathbb{Z}_{+}}$.

矛盾! 故断言得证.

回到原题.

若 $P(x)=x^{k}$, 则由断言知, $\left\{a_{n}\right\}$ 为常数列, 下设 $P(x) \neq x^{k}$.

由断言, 对任意 $n \in \mathbb{Z}_{+}$及 $1 \leq i \leq k$, 有 $a_{n+1} a_{n+2} \cdots a_{n+k} \geq a_{n+i} \cdot a_{n}^{k-1}$. 而

$$
\begin{aligned}
a_{n+1} a_{n+2} \cdots a_{n+k}=P\left(a_{n}\right) & =a_{n}^{k}+a_{n}^{k-1} \cdot c_{k-1}+\cdots+c_{0} \\
& \leq a_{n}^{k-1}\left(a_{n}+\sum_{j=0}^{k-1} c_{j}\right) .
\end{aligned}
$$

因此

$$
a_{n+i} \leq a_{n}+c_{0}+c_{1}+\cdots+c_{k-1} .
$$

故

$$
\left(a_{n+1}-a_{n}, a_{n+2}-a_{n}, \cdots, a_{n+k}-a_{n}\right) \in\{0,1, \cdots, M\}^{k}
$$

其中 $M=\sum_{j=0}^{k-1} c_{j}$.

故由抽屉原理结合断言知, 存在 $0 \leq d_{1} \leq d_{2} \leq \cdots \leq d_{k}$ 使得存在无穷多个 $n \in \mathbb{Z}_{+}$. 使得对一切 $1 \leq i \leq k$ 有 $a_{n+i}=a_{n}+d_{i}$. 对这些 $n$ 有:

$$
P\left(a_{n}\right)=\left(a_{n}+d_{1}\right)\left(a_{n}+d_{2}\right) \cdots\left(a_{n}+d_{k}\right) .
$$

又 $P(x) \neq x^{k}$, 故 $a_{n+1}, \cdots, a_{n+k}$ 中必有一个大于 $a_{n}$, 从而 $\left\{a_{n}\right\}$ 无界.
由断言知, $a_{n}$ 趋向于正无穷. 因此, 上式中的 $a_{n}$ 有无穷多种取值. 从而

$$
P(x)=\left(x+d_{1}\right)\left(x+d_{2}\right) \cdots\left(x+d_{k}\right) .
$$

记 $S_{n}=\left\{a_{n+i}-a_{n} \mid 1 \leq i \leq k\right\}$ 为可重集, 则 $S_{n}$ 中每个元素均在集合 $\{0,1, \cdots, M\}$ 中.

故 $S_{n}$ 只有有限种取法. 若 $S_{n} \neq\left\{d_{1}, d_{2}, \cdots, d_{k}\right\}$, 又 $a_{n}$ 是非零多项式

$$
P(x)=\prod_{i=1}^{k}\left(x+\left(a_{n+i}-a_{n}\right)\right)=\prod_{i=1}^{k} a_{n+i}
$$

的根.

因此只有有限个 $m \in \mathbb{Z}_{+}$满足 $S_{m} \neq\left\{d_{1}, d_{2}, \cdots, d_{k}\right\}$, 从而存在 $N \in \mathbb{Z}_{+}$,使得一切 $n \geq N$ 均满足 $S_{n}=\left\{d_{1}, d_{2}, \cdots, d_{k}\right\}$.

因此对一切 $n \geq N, 1 \leq i \leq k$ 有 $a_{n+i}=a_{n}+d_{i}$. 又

$$
d_{i}=a_{n+i}-a_{n}=\sum_{j=1}^{i}\left(a_{n+j}-a_{n+j-1}\right)=i d_{1}
$$

故 $\left\{a_{n}\right\}_{n \geq N}$ 构成公差为 $d_{1}$ 的等差数列.

设整数 $a$ 满足 $a_{n}=a+n d_{1}$ 对一切 $n \geq N$ 成立. 下证: $a_{n}=a+n d_{1}$ 对一切 $n \in \mathbb{Z}_{+}$成立.

我们对 $s$ 归纳证明: $a_{n}=a+n d_{1}$ 对一切 $n \geq s$ 成立.

当 $s=N$ 时，命题显然成立.

假设 $s+1$ 时命题成立, $s$ 时有 $P\left(a_{s}\right)=a_{s+1} a_{s+2} \cdots a_{s+k}=P\left(a+s d_{1}\right)$.

又 $P(x)$ 在 $(0,+\infty)$ 上单调递增, 故 $a_{s}=a+s d_{1}$,

从而由归纳基本原理, 知结论成立.

故 $\left\{a_{n}\right\}$ 为等差数列, 且公差 $d_{1} \geq 0$.

综上, 所求为一切公差非负的等差数列.

评注 本题作为 IMO 第三题过于简单, $k=2$ 的特例就可以为证明提供许多有用的思路. 虽然难度不大, 但本题的复杂度和对细节处理的要求不容小䖊.

题 4 设 $x_{1}, x_{2}, \cdots, x_{2023}$ 为两两不等的正实数, 使得对每个 $n=1,2, \cdots, 2023$,

$$
a_{n}=\sqrt{\left(x_{1}+x_{2}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}+\cdots+\frac{1}{x_{n}}\right)}
$$

都是一个整数. 证明: $a_{2023} \geq 3034$.

证明 首先, 由 Cauchy 不等式知

$$
a_{n}=\sqrt{\left(\sum_{i=1}^{n-1} x_{i}+x_{n}\right)\left(\sum_{i=1}^{n-1} \frac{1}{x_{i}}+\frac{1}{x_{n}}\right)}
$$

$$
\geq \sqrt{\left(\sum_{i=1}^{n-1} x_{i}\right)\left(\sum_{i=1}^{n-1} \frac{1}{x_{i}}\right)}+\sqrt{x_{n} \cdot \frac{1}{x_{n}}}=a_{n-1}+1 .
$$

等号成立当且仅当

$$
x_{n}^{2}=\frac{\sum_{i=1}^{n-1} x_{i}}{\sum_{i=1}^{n-1} \frac{1}{x_{i}}}=\left(\sum_{i=1}^{n-1} x_{i}\right)^{2} \cdot \frac{1}{a_{n-1}^{2}} \Leftrightarrow x_{n}=\frac{\sum_{i=1}^{n-1} x_{i}}{a_{n-1}}
$$

下证对一切 $n \geq 2$ 有 $a_{n+1}-a_{n-1} \geq 3$.

若不然, 则 $a_{n+1}-a_{n}=a_{n}-a_{n-1}=1$, 从而

$$
x_{n}=\frac{\sum_{i=1}^{n-1} x_{i}}{a_{n-1}}, \quad x_{n+1}=\frac{\sum_{i=1}^{n-1} x_{i}+x_{n}}{a_{n}}=\frac{a_{n-1} x_{n}+x_{n}}{a_{n-1}+1}=x_{n}
$$

但这与 $x_{1}, \cdots, x_{n+1}$ 互不相同矛盾!

故 $a_{n+1}-a_{n-1} \geq 3$, 从而

$$
a_{2023}=a_{1}+\sum_{i=1}^{1001}\left(a_{2 i+1}-a_{2 i-1}\right) \geq 1+1011 \times 3=3034
$$

故证毕!

评注 本题是很好的柯西不等式练习题, 关键在于如何使用 $x_{1}, x_{2}, \cdots, x_{2023}$互异的条件.

题 5 设 $n$ 是一个正整数.日式三角是将 $1+2+\cdots+n$ 个圆排成正三角形的形状, 使得对 $i=1,2, \cdots, n$, 从上到下的第 $i$ 行恰有 $i$ 个圆且其中恰有一个被染为红色. 在日式三角内, 忍者路径是指一串由 $n$ 个圆组成的序列, 从最上面一行的圆开始, 每次从当前圆连接到它下方相邻的两个圆之一, 直至到达最下面一行的某个圆为止. 下图为一个 $n=6$ 的日式三角, 其中画有一条包含两个红色圆的忍者路径. 求最大的整数 $k$ (用 $n$ 表示), 使得在每个日式三角中都存在一条忍者路径, 它包含至少 $k$ 个红色圆.

解 所求为 $k_{\max }=\left[\log _{2} n\right]+1$.

一方面, 证明 $k_{\max } \leq\left[\log _{2} n\right]+1$.

为此, 只需证: 若 $n \leq 2^{k}-1$, 则可适当安排红圆, 使得每条忍者路经至多经过 $k$ 个红色圆.

$n=2^{k}-1$ 时, 可采取如下构造方式: (以下用 $(i, j)$ 表示第 $i$ 行起第 $j$ 个圆)

$(4,1)(5,3)(6,5)(7,7)$

$$
(8,1)(9,3) \cdots(15,15)
$$

$$
\left(2^{k-1}, 1\right)\left(2^{k-1}+1,3\right) \cdots\left(2^{k}-1,2^{k}-1\right) \text {, 记之为表 } A \text {. }
$$

易知对任一忍者路径, 表 $A$ 中的每一行至多有 1 个红圆在该路径上. 因此每条忍者路径至多有 $k$ 个红圆.

$n<2^{k}-1$ 时取 $n=2^{k}-1$ 时的日式三角的前 $n$ 行即可.

故 $k_{\max } \leq\left[\log _{2} n\right]+1$.

另一方面,下证 $k=\left[\log _{2} n\right]+1$ 满足要求.

用 $A_{i}$ 表示第 $i$ 行中的红圆, 对每个 $i \geq 2$. 定义 $A_{1}$ 到 $A_{i}$ 的距离为: 所有经过 $A_{i}$ 的忍者路径中, 路径的第 1 行至第 $(i-1)$ 行红圆个数的最大值.

(如图 1 中, $A_{1}$ 到 $A_{2}$ 的距离为 1 , 到 $A_{4}, A_{5}$ 的距离均为 2 )

![](https://cdn.mathpix.com/cropped/2024_02_26_52516b9216510c724f97g-08.jpg?height=397&width=466&top_left_y=1104&top_left_x=812)

图 $1 n=7$ 时构造

用 $S_{d}$ 表示集合 $\left\{A_{i} \mid A_{1}\right.$ 到 $A_{i}$ 距离为 $\left.d\right\}$. 则任一忍者路径至多包含 $S_{d}$ 中的一个元素.

（假设包含 2 个元素 $A_{i}, A_{j}$. 不妨设 $A_{i}$ 在前, 则可通过调整该路径在 $A_{i}$ 之前的部分, 使得 $A_{i}$ 之前有 $d$ 个红圆, 则 $A_{j}$ 之前的红圆数大于 $d$ 个. 这与 $S_{d}$ 的定义矛盾.)

设 $A_{i}$ 为 $S_{d}$ 中下标最小的圆. 记 $A_{i}$ 为圆 $(i, j)$, 则下述 $i$ 个集合覆盖整个日式三角:

$$
\begin{aligned}
& \{(p, q) \mid q \leq p \leq n, q \leq j-1\} \\
& \{(p, p-q) \mid p \leq n, 0 \leq p-q \leq i-j-1\} \\
& \{(p+i, q+j) \mid 0 \leq q \leq p\}
\end{aligned}
$$

则前 $(i-1)$ 个集合呈条状. 每个这样的集合均可被一条忍者路径覆盖. 故每个这样的集合中至多有一个来自 $S_{d}$ 的圆.

![](https://cdn.mathpix.com/cropped/2024_02_26_52516b9216510c724f97g-09.jpg?height=320&width=579&top_left_y=203&top_left_x=747)

图 2 日式三角被 $i$ 个集合覆盖

最后一个集合中, 因为 $(i, j)$ 已经属于 $S_{d}$. 故该集合中不可能有其它的元素. 因此有 $\left|S_{d}\right| \leq i$.

现在记 $S_{d}$ 中元素的最小下标为 $i_{d}$, 则有 $i_{0}<i_{1}<i_{2}<\cdots$ (规定 $i_{0}=1$ ).故

$$
\begin{aligned}
& i_{d}-1 \leq\left|S_{1}\right|+\left|S_{2}\right|+\cdots+\left|S_{d-1}\right| \leq i_{1}+i_{2}+\cdots+i_{d-1} . \\
& \Rightarrow i_{d} \leq i_{0}+i_{1}+\cdots+i_{d-1}+1
\end{aligned}
$$

当 $d=0$ 时, 显然满足要求,

若小于 $d$ 时成立, 则

$$
i_{d} \leq \sum_{i=0}^{d-1} 2^{i}+1=2^{d}
$$

由此式归纳, 可知 $i_{d} \leq 2^{d}, \Rightarrow\left|S_{d}\right| \leq 2^{d}$.

设 $t$ 为最大的正整数, 使 $S_{t} \neq \varnothing$. 则有

$$
\begin{aligned}
& n=\sum_{i=1}^{t}\left|S_{i}\right|+1 \leq 2+2^{2}+\cdots+2^{t}+1=2^{t+1}-1 \\
& \Rightarrow t \geq\left[\log _{2} n\right] .
\end{aligned}
$$

由 $S_{t}$ 的定义知, 存在一条过 $S_{t}$ 中某一元素的路径, 其红圆数不小于

$$
t+1 \geq\left[\log _{2} n\right]+1
$$

故所求为 $\left[\log _{2} n\right]+1$.

评注 本题是一个有趣的组合问题, 由构造就能产生按距离划分红圆的想法,之后关于类的大小(即 $\left|S_{i}\right|$ ) 的上界估计也有一定的技巧性, 很适合作为冬令营的训练题.

题 6 设 $A B C$ 是一个正三角形. 点 $A_{1}, B_{1}, C_{1}$ 在三角形 $A B C$ 的内部, 且满足 $B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B$ 及 $\angle B A_{1} C+\angle C B_{1} A+\angle A C_{1} B=480^{\circ}$.设直线 $B C_{1}$ 与 $C B_{1}$ 交于点 $A_{2}$, 直线 $C A_{1}$ 与 $A C_{1}$ 交于点 $B_{2}$, 直线 $A B_{1}$ 与 $B A_{1}$交于点 $C_{2}$.
证明: 若三角形 $A_{1} B_{1} C_{1}$ 的三边长度两两不等, 则三角形 $A A_{1} A_{2}, B B_{1} B_{2}$和 $C C_{1} C_{2}$ 的外接圆都经过两个公共点.

![](https://cdn.mathpix.com/cropped/2024_02_26_52516b9216510c724f97g-10.jpg?height=637&width=1154&top_left_y=361&top_left_x=454)

证明 首先, 我们有

$$
\begin{aligned}
& \angle B C A_{1}+ \angle B A C_{1}+\angle C A B_{1}=90^{\circ}-\frac{\angle B A_{1} C}{2}+90^{\circ}-\frac{\angle B C_{1} A}{2}+90^{\circ}-\frac{\angle C B_{1} A}{2} \\
&=270^{\circ}-\frac{\angle B A_{1} C+\angle B C_{1} A+\angle C B_{1} A}{2}=30^{\circ} . \\
& \Rightarrow \angle A B_{2} C=\angle A B C+\angle B A C_{1}+\angle B C A_{1}=90^{\circ}-\angle B_{1} A C . \\
& \Rightarrow B_{1} \text { 为 } \triangle A B_{2} C \text { 的外心. }
\end{aligned}
$$

同理 $A_{2} 、 C_{1}$ 分别为 $\triangle B A_{2} C 、 \triangle A C_{2} B$ 的外心. 因此

$$
\angle A_{1} A_{2} B_{1}=90^{\circ}-\angle A_{2} B C=90^{\circ}-\angle B_{2} A C=\angle B_{1} B_{2} A_{1} .
$$

故 $A_{1} 、 B_{1} 、 A_{2} 、 B_{2}$ 共圆. 同理 $B_{1} 、 C_{1} 、 B_{2} 、 C_{2}$ 共圆, $C_{1}, A_{1}, C_{2}, A_{2}$ 共圆.

假设 $A_{1}, B_{1}, C_{1}, A_{2}, B_{2}, C_{2}$ 六点共圆, 则

$$
\begin{aligned}
& \angle C_{1} A_{2} B_{1}+\angle B_{1} C_{2} A_{1}+\angle A_{1} B_{2} C_{1} \\
= & 180^{\circ}-\angle C_{1} A_{1} B_{1}+180^{\circ}-\angle A_{1} C_{1} B_{1}+180^{\circ}-\angle C_{1} B_{1} A_{1} \\
= & 540^{\circ}-180^{\circ}=360^{\circ} .
\end{aligned}
$$

但

$\angle C_{1} A_{2} B_{1}+\angle B_{1} C_{2} A_{1}+\angle C_{1} B_{2} A_{1}=\frac{1}{2}\left(\angle B A_{1} C+\angle B C_{1} A+\angle C B_{1} A\right)=240^{\circ}$,

矛盾! 故 $A_{1}, B_{1}, C_{1}, A_{2}, B_{2}, C_{2}$ 六点不共圆.

从而, 对 $\odot\left(A_{1} B_{1} A_{2} B_{2}\right), \odot\left(B_{1} C_{1} B_{2} C_{2}\right), \odot\left(C_{1} A_{1} C_{2} A_{2}\right)$ 用根心定理知, $A_{1} A_{2} 、 B_{1} B_{2} 、 C_{1} C_{2}$ 三线共点. 设所共点为 $P$, 则 $P$ 到 $\odot\left(A A_{1} A_{2}\right), \odot\left(B B_{1} B_{2}\right)$, $\odot\left(C C_{1} C_{2}\right)$ 的幕相等.

由于 $P$ 关于 $\odot\left(B B_{1} B_{2}\right)$ 、 $\odot\left(C C_{1} C_{2}\right)$ 等幂且在这两圆内部. 故 $\odot\left(B B_{1} B_{2}\right)$,
$\odot\left(C C_{1} C_{2}\right)$ 有两个交点 $X, Y$, 对这两个圆及 $\odot\left(B_{1} B_{2} C_{1}\right)$ 用根心定理, 知 $X 、 P 、 Y$ 共线, 且 $X P \cdot P Y=A_{2} P \cdot A_{1} P . \Rightarrow A_{1}, A_{2}, X, Y$ 共圆.

下只需证 $A 、 A_{1} 、 X 、 Y$ 共圆.

为此, 以 $A_{1}$ 为反演中心, 任意非零反演幂反演, 反演后, $A_{1}$ 在 $B C$ 中垂线上, 且为 $\odot\left(A B C_{2}\right) 、 \odot\left(A C B_{2}\right)$ 的另一交点. 而 $C_{1} 、 B_{1}$ 分别为 $A$ 关于 $B C_{2} 、 C B_{2}$ 的对称点. 在反演后的图中, 只需证 $A_{1}$ 到 $\odot\left(B B_{1} A\right) 、 \odot\left(C C_{1} A\right)$的幂相等. (下面忽略原图, 在反演后的图中讨论)

![](https://cdn.mathpix.com/cropped/2024_02_26_52516b9216510c724f97g-11.jpg?height=708&width=953&top_left_y=748&top_left_x=563)

设 $\odot\left(B B_{1} A\right)$ 、 $\odot\left(C C_{1} A\right)$ 与 $B A_{1} 、 C A_{1}$ 分别另交于 $U 、 V$.

由 $B A_{1}=A C$, 只需 $A_{1} U=A_{1} V$, 即 $U 、 V$ 关于 $A A_{1}$ 对称.

首先 $\angle B_{2} U B=\angle B_{2} B_{1} B=\angle B_{2} B_{1} A-\angle B B_{1} A=\angle C_{1} A B_{1}-30^{\circ}$. (因为 $C$为 $\triangle A B B_{1}$ 的外心.)

同理 $\angle C_{2} V C=\angle C_{1} A B_{1}-30^{\circ}$.

故 $\angle B_{2} U B=\angle C_{2} V C$. 只需证 $C_{2}$ 关于 $A A_{1}$ 的对称点 $C_{2}^{\prime}$ 在 $B_{2} U$ 上.

又

$\angle A B U=150^{\circ}-\angle B A_{1} A=150^{\circ}-\angle B C_{2} A=60^{\circ}+\angle C_{1} A B_{1}=90^{\circ}+\angle B_{2} U B$,

故 $B_{2} U \perp A B$. 只需证 $B_{2} C_{2}^{\prime} \perp A B$.

又

$$
\angle A C_{2}^{\prime} C=\angle A C_{2} B=\angle A A_{1} B=\angle A A_{1} C=\angle A B_{2} C,
$$

故 $A, C, C_{2}^{\prime}, B_{1}$ 共圆.

$$
\begin{aligned}
& \Rightarrow \angle A B_{2} C_{2}^{\prime}=180^{\circ}-\angle C_{2}^{\prime} C A=180^{\circ}-\angle C_{2} B A=90^{\circ}+\angle B A B_{2} . \\
& \Rightarrow B_{2} C_{2}^{\prime} \perp A B .
\end{aligned}
$$

故原命题成立. 证毕!

评注 本题构型优雅, 但难度很大, 发现一个根心(即 $P$ 点)后, 有多种不同的可行的思路, 但它还是一道颇有难度的题目. 此外, 因为原题要求证明三个圆相交, 所以还要注意对圆的位置关系进行讨论.

