数学新星网 类教师专栏

www.nsmath.cn/jszl

# 2020 年圣彼得堡数学竞赛组合题解析 

$$
\text { 王广廷 }
$$

(上海市上海中学, 200231)

圣彼得堡数学竞赛是非常有影响力的城市学数学竞赛, 曾被称为全球“难度最大”的数学竞赛, 其组合问题有难度, 选材丰富, 立意新颖, 也从一个侧面反映出俄罗斯是传统数学强国和数学竞赛强国.

我们选取了 2020 年圣彼得堡数学竞赛的 7 道组合题给出了解答和评析. 其中第 $1,2,3$ 题是九年级的竞赛题, 第 4,5 题是十年级的竞赛题, 第 6,7 题是十一年级的竞赛题. 其中第 $1,2,6$ 题是容易的组合题, 第 $3,4,5,7$ 题是中等难度的组合题.

## I. 试 题

1. 在一个 300 行 25 列的表格中, 甲将所有格三染色. 随后, 乙对表格中每一行声明一种颜色, 并将该行中所有被染这种颜色的格子打上标记, 然后所有包含标记的列会被删去, 这里甲希望最后留下的列数越少越好, 而乙希望留下的列数越多越好. 问: 乙最多可以保证留下多少列?
2. 我们标记平面直角坐标系内的点 $(1,1),(2,3),(4,5),(999,111)$. 此后, 我们将按照以下规则继续标记其它点:

(1) 若 $(a, b)$ 被标记, 则可标记 $(b, a)$ 和 $(a-b, a+b)$;

(2) 若 $(a, b)$ 和 $(c, d)$ 都被标记, 则可标记 $(a d+b c, 4 a c-4 b d)$.

问: 能否在有限步内标记直线 $y=2 x$ 上的某点?

3. 令 $G$ 是一个含有 400 个顶点的图. 对于 $G$ 的每条边 $A B$, 我们称由 $A B$和顶点 $A, B$ 连出的所有边构成的子图为一个“乌贼子图”. 现在 $G$ 的每条边被赋值为 1 或 -1 , 且已知 $G$ 的任何 “乌贼子图” 中的边赋值之和至少为 1 . 求证: $G$中所有边赋值之和至少为 $-10^{4}$.

修订日期: 2020-08-25.

4. 甲有 100 块石头, 外形各不相同, 且重量也互不相同. 甲可以通过外形分别石头, 但无法得知它们的重量. 现在开始每天晚上将 10 块石头 (由甲选取)放在窗台上, 而也可后善良精灵会出现, 并将 10 跨块石头按重量从小到大排列.另一方面, 如果甲家中有淘气精灵, 那他会在天亮前交换某两块石头的位置 (操作一定会进行, 且在善良精灵之后). 甲知道两个精灵的行为方式, 但不知道家中是否有淘气精灵. 问: 甲能否在有限时间内确定自己家中是否有淘气精灵?
5. 在一个社交网络上, 每名用户至多有 10 个朋友 (假设朋友是相互的), 且这个社交网络是连通的. 求证: 可以将所有用户分成若干组, 满足如下条件:

(1) 每名用户恰好属于一个组;

(2) 每个组内是连通的;

(3) 一个组人数在 1 到 100 内, 其它组人数在 100 到 900 内.

6. 在一个 $100 \times 100$ 的棋盘上,一个“近视车”可以攻击与它同行或同列且距离不超过 60 格的方格. 在棋盘上至多可以放置多少个互不攻击的“近视车”?
7. 在一个国家中有 $N$ 个城市和 $N$ 个贵族. 每个贵族拥有一座城市. 现在每个贵族在某些城市之间修了公路, 且一个贵族在任意两座城市之间至多修一条路 (注意两个城市之间可以有多条公路,但它们属于不同的贵族). 假设所有贵族共修了 $d$ 条公路. 现在一些贵族想要形成“集团”，使得集团内的城市之间可以通过集团内的公路相连接 (途中允许经过集团外的城市只要公路属于集团即可). 然而, 贵族们发现任何多于一个且少于 $N$ 个贵族都无法形成集团. 求此条件下 $d$ 的最大值.

## II . 解答与评注

第 1 题 在一个 300 行 25 列的表格中, 甲将所有格三染色. 随后, 乙对表格中每一行声明一种颜色, 并将该行中所有被染这种颜色的格子打上标记, 然后所有包含标记的列会被删去, 这里甲希望最后留下的列数越少越好, 而乙希望留下的列数越多越好. 问: 乙最多可以保证留下多少列?

解 乙最多可以保证留下 2 列.

将 3 种颜色分别记为 $1,2,3$. 注意到 $\mathrm{C}_{25}^{2}=300$, 故甲可将 300 行中的每一行对应一个数组 $\{i, j\}(1 \leq i<j \leq 25)$. 在这一行中甲将 $i$ 格染 1 色, $j$ 格染 2 色,其余格均染 3 色.
乙若在任一行中声明 3 色, 则至多留下两列, 若乙在任一行中都声明了 1,2 色, 若留下了至少两列 $a, b(a<b)$, 则在数组 $a, b$ 对应的行中乙未声明任何颜色,矛盾!

无论如何, 乙至多留下两列.

由于有 3 种颜色, 乙可以在每行声明不在第 24,25 列中的颜色, 这样一定可以留下两列. 故乙最多可保证留下两列.

评注 这是一道较容易的组合题. 从; 两个角度着手构造: 一方面选某种颜色, 在其所在行占了绝大多数格. 另一方面其余颜色在整个 300 行的考虑下占了绝大多数列. 注意到 $\mathrm{C}_{25}^{2}=300$ 也可有助于考虑行与二元组的对应, 从而使得问题解决.

第 2 题 我们标记平面直角坐标系内的点 $(1,1),(2,3),(4,5),(999,111)$. 此后, 我们将按照以下规则继续标记其它点:

(1) 若 $(a, b)$ 被标记, 则可标记 $(b, a)$ 和 $(a-b, a+b)$;

(2) 若 $(a, b)$ 和 $(c, d)$ 都被标记, 则可标记 $(a d+b c, 4 a c-4 b d)$.

问: 能否在有限步内标记直线 $y=2 x$ 上的某点?

解 首先证明下面的引理:

引理 在操作过程中出现的点 $(x, y)$ 满足: 5 不整除 $x^{2}+y^{2}$.

证明 注意到, 初始时, 5 不整除 $1^{2}+1^{2}, 2^{2}+3^{2}, 4^{2}+5^{2}, 999^{2}+111^{2}$.

下面分两种情形:

(1) 若 5 不整除 $a^{2}+b^{2}$, 则 5 不整除 $b^{2}+a^{2}$ 以及 $(a-b)^{2}+(a+b)^{2}=2\left(a^{2}+b^{2}\right)$,故操作 (1) 保证引理成立.

(2) 若 5 不整除 $b^{2}+a^{2}, 5$ 也不整除 $c^{2}+d^{2}$, 注意到

$$
\begin{aligned}
(a d+b c)^{2}+(4 a c-4 b d)^{2} & \equiv(a d+b c)^{2}+(a c-b d)^{2} \quad(\bmod 5) \\
& =\left(a^{2}+b^{2}\right)\left(c^{2}+d^{2}\right) \neq 0 \quad(\bmod 5) .
\end{aligned}
$$

操作 $(2)$ 也保证引理成立.

综上可得, 引理得证.

回到原题, 注意到 $y=2 x$ 上的所有整点 $\left(x_{0}, y_{0}\right)$ 均有 $5 \mid\left(x_{0}^{2}+y_{0}^{2}\right)$, 故在有限步内不可能标记直线 $y=2 x$ 上的点.

评注 本题的关键在于熟悉两个恒等式: $(a+b)^{2}+(a-b)^{2}=2\left(a^{2}+b^{2}\right)$ 以及 $(a b+c d)^{2}+(a d-b c)^{2}=\left(a^{2}+b^{2}\right)\left(c^{2}+d^{2}\right)$. 然后考虑平方和的不变量, 用模
第 3 题 令 $G$ 是一个含有 400 个顶点的图. 对于 $G$ 的每条边 $A B$, 我们称由 $A B$ 和顶点 $A, B$ 连出的所有边构成的子图为一个“乌贼子图”. 现在 $G$ 的每条边被赋值为 1 或 -1 , 且已知 $G$ 的任何“乌贼子图” 中的边赋值之和至少为 1 . 求证: $G$ 中所有边赋值之和至少为 $-10^{4}$.

证明 (颜川皓) 取图 $G$ 的一组最大匹配 $A_{1} B_{1}, A_{2} B_{2}, \cdots, A_{k} B_{k}(0 \leq k \leq$ 200). 考虑任一点 $X$, 记 $d(X)$ 为 点 $X$ 所连出边的赋值之和. 故要证原问题, 只需证明:

$$
\sum d(X) \geq-20000
$$

由题意知, 若两点 $X, Y$ 相连, 则 $d(X)+d(Y) \geq 0$, 于是 $d\left(A_{i}\right)+d\left(B_{i}\right) \geq 0$.

对另一点 $C$, 若 $C$ 与 $A_{1}, A_{2}, \cdots, A_{k}, B_{1}, B_{2}, \cdots, B_{k}$ 中至少 $k+1$ 个点相连,则必有 $C$ 与某对 $\left(A_{i}, B_{i}\right)$ 相连, 故

$$
d(C)+d\left(A_{i}\right) \geq 0, d(C)+d\left(B_{i}\right) \geq 0
$$

故

$$
d(C)+d\left(A_{i}\right)+d\left(B_{i}\right) \geq 0 .
$$

又另两点 $C, D$ 不可能均与 $A_{i}, B_{i}$ 相连, 否则有更大的匹配(将 $A_{i} C, B_{i} D$ 替换 $\left.A_{i} B_{i}\right)$, 因此, 可将 $A_{i}, B_{i}$ 分为一组且可将所有度大于等于 $k+1$ 的点加入一个 $\left(A_{i}, B_{i}\right)$ 的组(其中 $A_{i}, B_{i}$ 均与其相连), 则每一组内的和大于等于 0 , 而剩下的点的度小于等于 $k$. 故

$$
\begin{aligned}
\sum d(X) & \geq-k(400-2 k) \\
& =-2(k(200-k)) \\
& \geq-20000
\end{aligned}
$$

故原问题得证.

评注 本题是一个中等难度的图论题, 容易想到用每个点连边的赋值和来刻画有些奇怪的条件和结论, 注意到三角形圈的结构保证度数和不小于 0 . 于是可考虑选取最大匹配, 之后便是常规的讨论.

第 4 题 甲有 100 块石头, 外形各不相同, 且重量也互不相同. 甲可以通过外形分别石头, 但无法得知它们的重量. 现在开始每天晚上将 10 块石头 (由甲选取) 放在窗台上, 而也可后善良精灵会出现, 并将 10 跨块石头按重量从小到大
排列. 另一方面, 如果甲家中有淘气精灵, 那他会在天亮前交换某两块石头的位置 (操作一定会进行, 且在善良精灵之后). 甲知道两个精灵的行为方式, 但不知道家中是否有淘气精灵. 问：甲能否在有限时间内确定自己家中是否有淘气精灵?

解 (颜川皓) 甲可以确定家中是否有淘气精灵.

将石头标号为 $A_{1}, A_{2}, \cdots, A_{100}$, 下面给出甲的策略:

甲在 $\mathrm{C}_{100}^{10}$ 天内依次挑选的所有的 10 块石头的子集, 甲选择相信这些石头的排序为正确的, 若其中产生了矛盾, 则甲可得知一定存在淘气精灵; 若其中没有产生矛盾, 则甲可以得到一个所有的石头的从轻到重的排序. 不妨设为 $A_{1}<A_{2}<\cdots<A_{100}$ (这是因为任意两块石头的重量互不相同).

设石头重量的真实排序为: $A_{\sigma(1)}<A_{\sigma(2)}<\cdots<A_{\sigma(100)}$, 其中 $\sigma$ 为 $1,2, \cdots, 100$ 的一个置换.

若存在淘气精灵, 则对 $1,2, \cdots, 100$ 中的任意不同的正整数 $x_{1}<x_{2}<\cdots<$ $x_{10}$, 有 $\sigma\left(x_{1}\right), \sigma\left(x_{2}\right), \cdots, \sigma\left(x_{10}\right)$ 恰经过一次交换可变为从小到大的排列. 不妨设 $\sigma(1), \sigma(2), \cdots, \sigma(10)$ 中交换的为 $\sigma(a), \sigma(b), \sigma(11), \sigma(12), \cdots, \sigma(20)$ 中交换的为 $\sigma(c), \sigma(d)$, 则考虑包含 $\sigma(a), \sigma(b), \sigma(c), \sigma(d)$ 的 10 块石头,知这与淘气精灵的行动方式不符.

故甲在 $\mathrm{C}_{100}^{10}$ 天后一定知道是否存在淘气精灵.

评注 该问题只需考虑将 $\mathrm{C}_{100}^{10}$ 种情况圈查询是否能发现, 在从正面推有难度的情况下, 考虑用反证法得到更强的条件. 即存在淘气精灵下看似正确的排列，再分析可导出矛盾。

第 5 题 在一个社交网络上, 每名用户至多有 10 个朋友 (假设朋友是相互的), 且这个社交网络是连通的. 求证: 可以将所有用户分成若干组, 满足如下条件:

（1）每名用户恰好属于一个组;

(2) 每个组内是连通的;

(3)一个组人数在 1 到 100 内，其它组人数在 100 到 900 内.

证明 (黄凤麟) 用图论语言描述原问题: 将用户视作顶点, 按是否为朋友关系进行了连边, 得到图 $G(V, E)$.

下面对顶点的个数 $|V|$ 进行归纳. 当 $|V| \leq 100$ 时, 显然成立, 直接将这 100
个点全部划分成一组即可.

当 $100<|V| \leq 901$ 时, 取 $G$ 的一颗生成树的一个叶子结点, 将其单独划分为一组, 其余点划分成一组即可.

下设 $|V| \geq 902$, 且 $|V|$ 较小时均成立.

我们希望将图 $G$ 的顶点集 $V$ 划分成两个不交的部分 $V_{1}, V_{2}$, 即 $V_{1} \cup V_{2}=$ $V, V_{1} \cap V_{2}=\emptyset$, 其中 $100 \leq\left|V_{1}\right| \leq 900$, 且图 $G$ 在 $V_{1}, V_{2}$ 上的诱导子图是连通的.

由图 $G$ 连通性, 知可以从图 $G$ 的任意结点开始搜索得到一棵有根生成树 $T$, 设 $A_{0}$ 为其根.

下面分两种情况进行讨论:

(1) 若 $A_{0}$ 的子结点的子树的大小均小于 100 , 则任取一棵子树单独作为一组, 剩下的顶点作为一组即可;

(2) 若 $A_{0}$ 有一个子节点 $A_{1}$ 的子树的大小大于等于 100 , 若其小于等于 900 ,则取出该子树即可; 若其大于等于 901 , 则由于 $A_{1}$ 至多有 9 个子节点, 必有一个子节点 $A_{2}$, 其子树的大小大于等于 100 . 以此类推, 总可以找到一颗在 100 到 900 之间的子树, 结合归纳假设, 知成立.

综上可知, 原问题成立.

评注 注意到连通性的要求, 可考虑图的生成树. 这样 $V$ 及其子孙的诱导子图必连通, 此后由每点度数限制及 $901=100 \times 9+1$ 联想到用抽屈原理向下递归找子树即可。

第 6 题 在一个 $100 \times 100$ 的棋盘上,一个“近视车”可以攻击与它同行或同列且距离不超过 60 格的方格. 在棋盘上至多可以放置多少个互不攻击的“近视车"?

## 解 近视车的最大值为 178 .

首先给出 178 的构造:

用 $(i, j)$ 表示方格表中第 $i$ 行, 第 $j$ 列的方格. 则当近视车在如下格子中时满足条件:

$$
\begin{aligned}
& (i, 61+i), i=1,2, \cdots, 39 ; \\
& (i, i-61), i=62,63, \cdots, 100 ; \\
& (i, i), i=1,2, \cdots, 100 .
\end{aligned}
$$

下面说明 178 是最大值.

将 $100 \times 100$ 的方格表分成如下 4 块: 在 I 中至多放 61 个车, IV 中至多放

| IV | II |
| :---: | :---: |
| III |  |
|  |  |

39 个车, II,III 中每行, 每列至多有一个车, 记至多有 39 个车. 所以, 至多共有 178 个车.

评注 这是一道简单的组合题, 注意到 $i \times 61$ 长方形中至多有 $i$ 个近视车.尝试用这样的图形尽量划分 $100 \times 100$ 即可. 构造在此划分下也是相对自然的.

第 7 题 在一个国家中有 $N$ 个城市和 $N$ 个贵族。每个贵族拥有一座城市.现在每个贵族在某些城市之间修了公路, 且一个贵族在任意两座城市之间至多修一条路 (注意两个城市之间可以有多条公路, 但它们属于不同的贵族). 假设所有贵族共修了 $d$ 条公路。现在一些贵族想要形成“集团”，使得集团内的城市之间可以通过集团内的公路相连接 (途中允许经过集团外的城市只要公路属于集团即可). 然而，贵族们发现任何多于一个且少于 $N$ 个贵族都无法形成集团.求此条件下 $d$ 的最大值.

解 (颜川皓) $d$ 的最大值为 $\mathrm{C}_{n}^{3}$.

首先给出构造: 将城市编号为 $1,2, \cdots, N$, 对每三个满足 $i<j<k$ 的三元组, 在 $j, k$ 之间连第 $i$ 色的道路, 则共有 $\mathrm{C}_{n}^{3}$ 条道路. 对任意 $i_{1}<i_{2}<\cdots<i_{t}, i_{1}$无法与 $i_{2}, i_{3}, \cdots, i_{t}$ 用 $i_{1}, i_{2}, \cdots, i_{t}$ 色道路相连, 故不存在集团, 故上述构造满足要求。

下面用归纳法证明: $d \leq \mathrm{C}_{n}^{3}$.

当 $n=2$ 时, 无公路, 显然成立.

当 $n=3$ 时, 至多有一条公路, 成立.

假设 $n-1$ 时成立, 即 $d \leq \mathrm{C}_{n-1}^{3}$. 下面考虑 $n$ 的情况, 只需证明: 存在一个城市 $i, i$ 色道路和 $i$ 连出道路数目之和不超过 $\mathrm{C}_{n-1}^{2}$.

将每个 $i$ 连到 $j$ 的 $k$ 色道路对应无序数对 $(j, k)$, 则 $j$ 与 $k$ 之间无 $i$ 色道路(否则 $i, j, k$ 形成集团), 而每一对 $(j, k)$ 至多被对应一次, 否则若被对应两次,即有 $i$ 连向 $j$ 的 $k$ 色道路和 $i$ 连向 $k$ 的 $j$ 色道路, 则 $j, k$ 形成集团, 又 $i$ 不会连出 $i$ 色道路, 于是每一条 $i$ 连出的道路都会对应一个未连 $i$ 色道路的数对 $(j, k)(j, k \neq i)$, 故这三类道路共至多有 $\mathrm{C}_{n-1}^{2}$ 条.
即 $n$ 时成立. 由归纳法原理知, $d \leq \mathrm{C}_{n}^{3}$.

综上可知, $d$ 的最大值为 $\mathrm{C}_{n}^{3}$.

评注 将题目转化为图论语言并用染色代替建路是自然地. 从最基本的“集团” 入手, 知 $u v$ 间边不由 $u v$ 修建, $u$ 也不能像 $v w$ 两点发出的 $N$ 色的路. 这样考察 $u$ 色路与 $u$ 出发的路知它们被三人(二人)集团制约，由此可得关于路数的上界，而更大集团难以下手处理，容易想到用归纳法证明。另一方面,对小的情况试验可得到按顺序设计路的构造。

