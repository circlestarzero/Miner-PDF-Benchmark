# 2021 年全俄数学竞赛试题解答和评析 

江城

(上海市上海中学, 200231)

指导教师: 王广廷

## I. 试 题

## 一、九年级

9.1 圆周上给定 1000 个点, 每个点用 $k$ 种颜色之一染色, 已知在任意 5 条两两相交的线段中(其端点是 10 个互不相同的点), 至少有 3 条线段, 其中每条线段的两个端点颜色不同. 求 $k$ 的最小可能值.

9.2 设 $n$ 是一个正整数, 一个整数 $a>2$ 称为 “ $n$-可分解的”, 如果 $a^{n}-2^{n}$可被每个形如 $a^{d}+2^{d}$ 的数整除, 其中 $0<d<n$ 为 $n$ 的因数. 求所有合数 $n$, 使得存在一个 $n-$ 可分解的数.

9.3 给定一条直线上有 $n+1$ 条不同的线段,使得这 $n+1$ 条线段有一个公共点. 求证: 其中必存在两条线段 $I$ 和 $J$, 使得 $I$ 和 $J$ 的公共部分的长度不小于 $\frac{n-1}{n} d$, 其中 $d$ 为线段 $I$ 的长度.

9.4 在锐角 $\triangle A B C$ 中, $D$ 是 $A B$ 上一点, $E$ 是 $B C$ 延长线上一点, 已知过 $E$且与 $A B$ 平行的直线与 $\triangle A D C$ 的外接圆相切. 证明: 点 $E$ 关于 $\triangle B C D$ 外接圆的切线(与射线 $B A$ 相交)在 $\angle A B E$ 内部截得的三角形与 $\triangle A B C$ 相似.

9.5 已知实数 $a$ 和正实数 $b$ 满足二次方程 $x^{2}+a x+b=0$ 有两个不等的实根, 且恰有一实根在区间 $[-1,1]$ 内. 证明: 恰有一个实根在区间 $(-b, b)$ 内.

9.6 在非等腰锐角 $\triangle A B C$ 中, $\angle A B C=60^{\circ}$, 在三角形内有一个点 $T$ 满足 $\angle A T B=\angle B T C=\angle A T C=120^{\circ}, M$ 为 $\triangle A B C$ 的重心, 记 $T M$ 与圆 $A T C$ 的另一交点为 $K$. 求 $\frac{T M}{M K}$ 的值.

修订日期: 2021-09-29.

9.7 已知正整数 $n>20$ 及 $k>1$, 满足 $n$ 被 $k^{2}$ 整除. 求证: 存在正整数 $a, b, c$, 使得 $n=a b+b c+c a$.

9.8 一百名智者玩如下游戏: 他们以某种固定的顺序在在房间里待着, 智者一个接一个的进入房间. 当智者进入房间时, 房间中的守卫从集合 $\{1,2,3\}$ 选择两个任意不同的数告诉智者. 然后智者选择一个数, 告诉守卫, 然后离开房间, 下一个智者进入, 依次类推. 比赛期间, 在智者选择一个号码之前, 他可以询问守卫, 前两个智者选择的号码是什么. 在游戏中, 智者不能互相交谈. 最后, 当每个人都结束时, 如果 100 个所选数字的总和恰好是 200 , 则该游戏将被视为失败;否则成功. 证明: 智者可以制定策略, 依次赢得比赛.

## 二、十年级

10.1 在平行四边形 $A B C D$ 的边 $B C$ 上依次排列着四点 $B, E, F, C$, 设 $A C, B D$ 交于 $O$. 若 $A E, D F$ 和 $\odot(A O D)$ 相切, 证明它们同时和 $\odot(E O F)$ 相切.

10.2 求所有正整数组成的集合 $\left\{x_{1}, x_{2}, \cdots, x_{20}\right\}$, 满足

$$
x_{i+2}^{2}=\operatorname{lcm}\left(x_{i}, x_{i+1}\right)+\operatorname{lcm}\left(x_{i-1}, x_{i}\right),
$$

其中 $i=1,2, \cdots, 20, x_{0}=x_{20}, x_{1}=x_{21}, x_{2}=x_{22}$.

10.3 某国家有 $N$ 个城市, 其中一些城市对通过双向航线互相连接(每对城市之间最多一条航线), 每条航线都属于 $k$ 个公司之一. 已知现在可以从任意一个城市通过航线到任意的另一个城市, 但当删除任意一家航空公司的所有航线后, 便无法做到了. 对固定的 $N, k$, 求该国家航线的最大可能值.

10.4 给定正整数 $n \geq 4$, 有 $2 n+4$ 张编号依次为 $1,2, \cdots, 2 n+4$ 的卡片. 在编号为 $m$ 的卡片上写有实数 $a_{m}$, 使得 $\left\lfloor a_{m}\right\rfloor=m$. 求证: 可以从中选出四张卡片,使得其中两张卡片上的数字之和与剩下的两张卡片上的数字之差小于 $\frac{1}{n-\sqrt{\frac{n}{2}}}$.

10.5 一位老师和他的 30 个学生在一个无限单元网格上进行如下游戏: 从老师开始, 接着 30 个学生各进行一次操作, 然后又轮到老师, 已知这样进行下去. 每个人在一次操作中可以在网格中选取一条单元边(即两个相邻单元的公共边)进行染色, 每条边不能重复染色. 如果在若干次操作后, 网格上存在一个 $1 \times 2$ 或 $2 \times 1$ 矩形, 其整个边框都被染色, 但内部的一条单元边未被染色, 则老师获胜. 求证: 老师有获胜的策略.

10.6 给定一个实系数多项式 $P(x)$, 其次数 $n>1$. 已知方程 $P(P(P(x)))=$
$P(x)$ 有 $n^{3}$ 个不同的实根. 求证: 这些实根可以被分为算术平均数相等的两组.

10.7 同 9 年级第 7 题.

10.8 五边形 $A B C D E$ 内接于 $\odot \omega$, 令 $X, Y$ 为直线 $C D$ 和射线 $A B, A E$的交点, $P$ 为线段 $E X, B Y$ 的交点, $E X, B Y$ 再次交 $\omega$ 于 $Q, R . A^{\prime}$ 为 $A$ 关于 $C D$ 的对称点. $\odot(P Q R), \odot\left(A^{\prime} X Y\right)$ 交于两点. 证明: 可以标记两点 $M, N$ 使得 $C M, D N$ 的交点在 $\odot(P Q R)$ 上.

## 三、十一年级

11.1 对于某些正整数 $n>m, n$ 能表示成 $m$ 的 2021 个非负整数次幂之和,也可表示成 $m+1$ 的 2021 个非负整数次幂之和. 求正整数 $m$ 的最大可能值.

11.2 设 $P(x)$ 为次数 $n>1$ 的非零多项式, 且所有系数均为非负数.已知 $y=P(x)$ 为奇函数. 问: 在 $y=P(x)$ 的图像上 $G$ 上是否存在 $n$ 个点 $A_{1}, A_{2}, \cdots, A_{n}$ 满足: $G$ 在 $A_{1}$ 处的切线经过 $A_{2}$, 在 $A_{2}$ 处的切线经过 $A_{3}, \cdots$, $G$ 在 $A_{n}$ 处的切线经过 $A_{1}$ ?

11.3 某种语言只含有三个字母 $A, B, C$. 一个字母序列被称作一个单词当且仅当它恰好含有 100 个字母, 使得其中 40 个字母是辅音字母(即 $B$ 和 $C$ ), 而剩余 60 个字母全为 $A$. 最多可以选取多少个不同的单词, 对于其中任意两个单词, 都存在一个相同的位置, 使得这两个单词在该位置上恰好是两个不同的辅音字母?

$11.4 \triangle A B C$ 中, 角平分线 $A A_{1}, C C_{1}$ 交于 $I$, 过 $B$ 平行于 $A C$ 的直线与 $A A_{1}, C C_{1}$ 分别交于点 $A_{2}, C_{2}$, 设 $\triangle A C_{1} C_{2}, \triangle C A_{1} A_{2}$ 的外心为 $O_{a}, O_{c}$, 证明: $\angle O_{a} B O_{c}=\angle A I C$.

11.5 一位老师和他的 30 个学生在一个无限单元网格上进行如下游戏: 从老师开始, 接着 30 个学生各进行一次操作, 然后又轮到老师, 已知这样进行下去. 每个人在一次操作中可以在网格中选取一条单元边(即两个相邻单元的公共边)进行染色, 每条边不能重复染色. 如果在若干次操作后, 网格上存在一个 $1 \times 2$ 或 $2 \times 1$ 矩形, 其整个边框都被染色, 但内部的一条单元边未被染色, 则老师获胜. 问: 谁有获胜的策略?

11.6 在四面体 $S A B C$ 中, 任意两条边的长度都不相等. 在平面 $B C S$ 中,作 $S$ 关于 $B C$ 的中垂线的对称点 $A^{\prime}$, 类似的定义 $B^{\prime}, C^{\prime}$. 证明: 平面 $A B C$,
$A B^{\prime} C^{\prime}, A^{\prime} B C^{\prime}, A^{\prime} B^{\prime} C$ 经过同一点.

11.7 求 $(1,2, \cdots, 2021)$ 的所有排列 $\left(a_{1}, a_{2}, \cdots, a_{2021}\right)$, 使得对任意满足 $|m-n|>20^{21}$ 的正整数 $m, n$, 都有以下不等式成立:

$$
\sum_{i=1}^{2021} \operatorname{gcd}\left(m+i, n+a_{i}\right)<2|m-n|
$$

11.8 已知有 100 名女生, 每名女生都有 100 个球, 共有 10000 个球, 其中共有 100 种颜色, 每种颜色的球恰有 100 个. 她们可以进行如下操作: 两名女生可以互相交换 1 个球(例如甲给乙 1 个球, 乙给甲 1 个球). 证明: 存在一系列的操作, 每个球最多交换一次, 最后, 每个女孩都有 100 色颜色互不相同的球.

## II. 解答与评注

## 一、九年级

9.1 圆周上给定 1000 个点, 每个点用 $k$ 种颜色之一染色, 已知在任意 5 条两两相交的线段中(其端点是 10 个互不相同的点), 至少有 3 条线段, 其中每条线段的两个端点颜色不同. 求 $k$ 的最小可能值.

解 $k$ 的最小可能值为 143 .

构造如下: 将 1000 个点分为连续的 143 段, 其中 142 段有 7 个点, 1 段有 6 个点. 每段点染一种颜色, 则这样的构造满足要求.

假设条件不满足, 即存在 5 条两两相交的弦, 至多有 2 条两端点异色. 设这 5 条弦的 10 个端点为 $A_{1}, \cdots, A_{10}$, 这些点在圆上顺次排列, 由假设知这些弦为 $A_{i} A_{i+5}(1 \leq i \leq 5)$. 不妨设 3 条同色弦为 $A_{1} A_{6}, A_{i_{1}} A_{i_{1}+5}, A_{i_{2}} A_{i_{2}+5}$. 注意到 $A_{1} A_{6}$ 将圆周分为两部分, 假设 $\widehat{A_{1} A_{2} A_{6}}$ 的点数 $<\widehat{A_{1} A_{10} A_{6}}$ 的点数.

由于每段同色点连续, 故 $A_{1}, A_{2}, \cdots, A_{6}$ 均同色, 由于 $A_{i_{1}+5}, A_{i_{2}+5}$ 也与它们同色, 于是这样就有 8 个同色点, 矛盾.

下证 $k \geq 143$. 事实上, 若有 8 个同色点, 顺时针排列为 $B_{1}, \cdots, B_{8}$. 不妨设 $\widehat{B_{8} B_{1}}$ 上点最多. 设 $C, D \in \widehat{B_{8} B_{1}}$ 且 $B_{8}, C, D, B_{1}$ 顺次排列. 考虑 $B_{1} B_{6}, B_{2} B_{7}$, $B_{3} B_{8}, B_{4} D, B_{5} C$, 这五条线段两两相交,则有至少 3 条同色弦 $B_{1} B_{6}, B_{2} B_{7}, B_{3} B_{8}$,矛盾。

因此每种颜色至多 7 个点, 于是 $k \geq\left\lceil\frac{1000}{7}\right\rceil=143$.

综上可得, $k_{\text {min }}=143$.

评注 这是一道简单的组合题, 只需考虑一种颜色即可.

9.2 设 $n$ 是一个正整数, 一个整数 $a>2$ 称为 “ $n$-可分解的”, 如果 $a^{n}-2^{n}$可被每个形如 $a^{d}+2^{d}$ 的数整除, 其中 $0<d<n$ 为 $n$ 的因数. 求所有合数 $n$, 使得存在一个 $n-$ 可分解的数.

解 设合数 $n$ 满足存在 $a>2$ 使得对任意 $n$ 的约数 $d$, 有 $a^{d}+2^{d} \mid a^{n}-2^{n}$.

若 $n=2^{k}$, 则

$$
a^{n}-2^{n}=\prod_{i=0}^{k-1}\left(a^{2^{i}}+2^{2^{i}}\right)(a-2)
$$

则对任意 $0 \leq i \leq k-1$, 有 $\left(a^{2^{i}}+2^{2^{i}}\right) \mid a^{n}-2^{n}$.

下面证明 $n$ 为 2 的幕.

若 $n$ 有奇素因子 $p$, 令 $d=\frac{n}{p}$, 则 $0<d<n$ 为 $n$ 的约数. 注意到

$$
a^{n}-2^{n}=a^{d p}-2^{d p} \equiv\left(-2^{d}\right)^{p}-2^{d p} \equiv-2^{d p+1} \quad\left(\bmod a^{d}+2^{d}\right),
$$

故可设 $a^{d}+2^{d}=2^{m}, m>d$, 则 $a^{d}=2^{d}\left(2^{m-d}-1\right)$. 因为 $d \geq 2$, 所以 $2 \mid a$. 令 $a=2 b(b \geq 2), b^{d}=2^{m-d}-1$, 则 $m-d \geq 3$, 于是 $4 \mid b^{d}+1$. 即 $2 \nmid b, 2 \nmid d$. 故

$$
b+1 \mid b^{d}+1=2^{m-d}
$$

因此 $b=2^{c}-1(c \geq 2)$.

注意到

$$
\begin{aligned}
\left(2^{c}-1\right)^{d}+1 & =\sum_{k=2}^{d}\left(\begin{array}{l}
d \\
k
\end{array}\right) 2^{c k}(-1)^{d-k}+d 2^{c}(-1)^{d-1}+(-1)^{d}+1 \\
& =\sum_{k=2}^{d}\left(\begin{array}{l}
d \\
k
\end{array}\right) 2^{c k}(-1)^{d-k}+d 2^{c},
\end{aligned}
$$

其中 $2^{2 c} \left\lvert\, \sum_{k=2}^{d}\left(\begin{array}{l}d \\ k\end{array}\right) 2^{c k}(-1)^{d-k}\right.$, 所以

$$
\nu_{2}\left(\left(2^{c}-1\right)^{d}+1\right)=c+\nu_{2}(d)
$$

故

$$
\left(2^{c}-1\right)^{d}+1=2^{c+\nu_{2}(d)}
$$

与 $d \geq 2$ 矛盾. 所以 $n$ 无奇素因子, 故 $n=2^{k}(k \geq 2)$.

评注 这是一道简单的数论问题, 只用考虑熟知的 $a+b \mid a^{t}+b^{t}$ 在 $t$ 为奇数时成立.

9.3 给定一条直线上有 $n+1$ 条不同的线段, 使得这 $n+1$ 条线段有一个公共点. 求证: 其中必存在两条线段 $I$ 和 $J$, 使得 $I$ 和 $J$ 的公共部分的长度不小于 $\frac{n-1}{n} d$, 其中 $d$ 为线段 $I$ 的长度.
证明 在直线上任意规定一个正方向. 设所有线段的 $2 n+2$ 个端点(可以重合)从左至右为 $A_{1}, \cdots, A_{2 n+2}$.

若某两条线段有包含关系, 则问题得证. 否则设 $n+1$ 条线段的公共点为 $C$.每条线段在 $C$ 的左右两侧(含 $C$ ) 各有一个端点, 于是 $C$ 左右端点数相等, 即 $C$在 $A_{n+1} A_{n+2}$ 上(当 $A_{n+1}=A_{n+2}$ 时, $C=A_{n+1}$ ).

设包含端点 $A_{1}$ 的线段是 $A_{1} A_{t}(t \geq n+2)$, 若 $t \neq n+2$, 设包含端点为 $A_{n+2}$的线段为 $A_{s} A_{n+2}$, 则 $1<s \leq n+1, A_{s} A_{m+2} \subseteq A_{1} A_{t}$, 矛盾. 所以 $t=n+2$.

同理可得: $n+1$ 条线段恰为 $A_{1} A_{n+2}, A_{2} A_{n+3}, \cdots, A_{n+1} A_{2 n+2}$.

设 $A_{i} A_{i+1}(1 \leq i \leq 2 n+1)$ 中最短的是 $A_{i_{0}} A_{i_{0}+1}$. 由对称性, 不妨设 $i_{0} \leq n+1$.令

$$
I=A_{i_{0}} A_{i_{0}+n+1}, J=A_{i_{0}+1} A_{i_{0}+n+2}
$$

由最小性知对任意 $1 \leq j \leq 2 n+1$, 有 $A_{j} A_{j+1} \geq A_{i_{0}} A_{i_{0}+1}$. 故

$$
|J \cap I|=A_{i_{0}+1} A_{i_{0}+n+1} \geq(n-1) A_{i_{0}} A_{i_{0}+1}
$$

其中 $|I|$ 表示线段长度,故

$$
|J \cap I| \geq \frac{n-1}{n}|I|
$$

评注 这是一道简单的组合问题, 想到可以不妨假设所有区间互不包含之后写出几个不等式就能探索到找出最小的区间进行证明.

9.4 在锐角 $\triangle A B C$ 中, $D$ 是 $A B$ 上一点, $E$ 是 $B C$ 延长线上一点, 已知过 $E$且与 $A B$ 平行的直线与 $\triangle A D C$ 的外接圆相切. 证明: 点 $E$ 关于 $\triangle B C D$ 外接圆的切线(与射线 $B A$ 相交)在 $\angle A B E$ 内部截得的三角形与 $\triangle A B C$ 相似.



证明 设 $\odot(A D C)$ 中弧 $\widehat{A C D}$ 的中点为 $G$, 由条件可知 $G E$ 为该圆的切线且 $G E \| A B$.
联结 $G A$, 并设 $G D$ 与 $\odot B C D$ 交于 $T$, 由 $B, C, D, T$ 四点共圆知

$$
\angle C B D+\angle C T D=180^{\circ} .
$$

又因为 $G E / / A B$ 故 $\angle G E C+\angle E B D=180^{\circ}$, 结合 $\angle G T C+\angle C T D=180^{\circ}$ 知 $\angle G E C+\angle G T C=180^{\circ}$, 故 $G, E, C, T$ 四点共圆. 故

$$
\angle E T C=\angle E G C=\angle G D C=\angle T D C
$$

倒数第二个等号是因为 $G E$ 是 $\odot(G C D)$ 的切线, 这表明 $E T$ 与 $\odot(B C D)$ 相切.

而

$$
\angle T E C=\angle T G C=\angle D G C=\angle C A D=\angle C A B,
$$

再结合公共角 $\angle A B C$ 就得到了结论.

评注 这是一道中等难度的几何问题, 只用猜到图中的共线和共圆即可.

9.5 已知实数 $a$ 和正实数 $b$ 满足二次方程 $x^{2}+a x+b=0$ 有两个不等的实根, 且恰有一实根在区间 $[-1,1]$ 内. 证明: 恰有一个实根在区间 $(-b, b)$ 内.

证明 设二次方程 $x^{2}+a x+b=0$ 的两个实根为 $x_{1}, x_{2}$, 且满足 $0 \leq\left|x_{1}\right| \leq$ $1<\left|x_{2}\right|$, 则由韦达定理, 知 $x_{1} x_{2}=b$.

若 $|b| \leq 1$, 则 $\left|x_{2}\right|>1>|b|,\left|x_{1}\right|=\frac{|b|}{\left|x_{2}\right|}<|b| ;$

若 $|b|>1$, 则 $\left|x_{1}\right| \leq 1<b,\left|x_{2}\right|=\frac{|b|}{\left|x_{1}\right|} \geq|b|$,

所以原问题得证.

评注 这是一个简单的代数问题, 考虑韦达定理可以直接解决.

9.6 在非等腰锐角 $\triangle A B C$ 中, $\angle A B C=60^{\circ}$, 在三角形内有一个点 $T$ 满足 $\angle A T B=\angle B T C=\angle A T C=120^{\circ}, M$ 为 $\triangle A B C$ 的重心, 记 $T M$ 与圆 $A T C$ 的另一交点为 $K$. 求 $\frac{T M}{M K}$ 的值.


解 如图所示, 考虑以 $M$ 为位似中心, 位似比为 -2 的位似变换 $f$, 设 $A, B, C$的像分别为 $A_{1}, B_{1}, C_{1}$, 重新定义 $K$ 为 $T$ 的像. 由 $T$ 为 $\triangle A B C$ 的费马点, 则 $K$为 $\triangle A_{1} B_{1} C_{1}$ 的费马点. 因此,

$$
\angle C_{1} K B_{1}=\angle B_{1} K A_{1}=120^{\circ} .
$$

再结合 $\angle C_{1} B_{1} A_{1}=60^{\circ}$ 可知 $\angle K C_{1} B_{1}=\angle K B_{1} A_{1}$, 因此 $\triangle C_{1} K B_{1}, \triangle K B_{1} A_{1}$相似, 再注意到 $A, C$ 为对应边的中点, 是一对相似对应点, 知

$$
\angle A K C=\angle C_{1} K B_{1}=120^{\circ} .
$$

这表明 $K$ 在 $\odot(A T C)$ 上, 再结合位似知 $K, T, M$ 共线, 那么这个 $K$ 就是原来定义中的 $K$, 这表明 $\frac{T M}{M K}$ 为位似比 $\frac{1}{2}$.

评注 这是一道较为简单的几何问题, 思路也很多. 笔者考虑的是猜出答案为 $\frac{1}{2}$ 之后直接考虑位似消点, 位似之后图形性质非常多, 很容易解决. 同时图形内还可以通过构造调和解决问题。

9.7 已知正整数 $n>20$ 及 $k>1$, 满足 $n$ 被 $k^{2}$ 整除. 求证: 存在正整数 $a, b, c$, 使得 $n=a b+b c+c a$.

证明 取 $k$ 的最小素因子 $p$, 设 $n=t p^{2}$. 下面分两种情况进行讨论:

(1) 当 $t=p-1$, 由 $n \geq 20$, 知 $p \geq 5$, 则令

$$
(a, b, c)=\left(6, p-3, p^{2}-4 p+6\right)
$$

即满足条件.

(2) 当 $t \neq p-1$. 设 $a$ 为 $p$ 模 $t+1$ 的余数, 则由 $p$ 为素数知 $a \neq 0$, 且 $a \leq p$.

我们希望找到对应的 $b, c$, 满足 $n+a^{2}=(a+b)(a+c)$, 注意到

$$
n+a^{2}=t p^{2}+a^{2} \equiv t p^{2}+p^{2} \equiv 0 \quad(\bmod t+1)
$$

那么

$$
n+a^{2}=(t+1) \frac{t p^{2}+a^{2}}{t+1} .
$$

由于 $a$ 为 $p$ 模 $t+1$ 的余数, 则 $a<t+1$, 并且

$$
\frac{t p^{2}+a^{2}}{t+1}>\frac{t a+a}{t+1}=a,
$$

则

$$
b=t+1-a, c=\frac{t p^{2}+a}{t+1}-a
$$

满足条件.
评注 这是一道较为困难的数论构造题. 可能做到的时候会去想三个数中有一个为常数, 然后分析余数, 但是这是走不通的. 此时可以想去构造恒等式, 这里有很多种想法. 笔者联想到了恒等式

$$
u(v+w)^{2}+(u v-w)^{2}=(u+1)\left(u v^{2}+w^{2}\right)
$$

但是一种更自然的方法是解答中所呈现的, 显然 $n+p^{2}$ 是 $t+1$ 的倍数, 但是 $p$有可能不小于 $t+1$, 那么将这个 $p$ 对 $t+1$ 取模之后就得到了所需要的 $a$. 最后发现要解决 $t=p-1$ 的情况, 这时只用凑出一个 $a$ 为常数即可, 方法应该有很多.

9.8 一百名智者玩如下游戏: 他们以某种固定的顺序在在房间里待着, 智者一个接一个的进入房间。当智者进入房间时, 房间中的守卫从集合 $\{1,2,3\}$ 选择两个任意不同的数告诉智者. 然后智者选择一个数, 告诉守卫, 然后离开房间, 下一个智者进入, 依次类推。比赛期间, 在智者选择一个号码之前, 他可以询问守卫, 前两个智者选择的号码是什么. 在游戏中, 智者不能互相交谈. 最后, 当每个人都结束时, 如果 100 个所选数字的总和恰好是 200 , 则该游戏将被视为失败;否则成功. 证明: 智者可以制定策略, 依次赢得比赛.

证明 我们首先构造一个大致的策略, 每一个智者根据前两个人选的数, 心里想好两个数, 并在守卫给他的两个数中找一个和他心里想的两个数中一样的报给守卫, 也就是给出两个数, 让守卫选择一个.

现在具体说明究竟是什么数, 首先用 $-1,0,1$ 代替 $1,2,3$, 那么只需最后的和不是 0 . 设 $a_{i}$ 为第 $i$ 个人报的数, 补充定义 $a_{0}=a_{-1}=0$, 那么我们有如下策略: 对 $1 \leq n \leq 99$, 如果 $a_{n-1}=1, a_{n-2} \neq 1$, 则 $a_{n}$ 在 $\{1,-1\}$ 中选一个, 否则在 $\{0,1\}$ 中选择一个.

可以发现, 在 $\left\{a_{n}\right\}(1 \leq n \leq 99)$ 这个数列中, 1 的出现方式是, 要么出现至少两个连续的 1 , 要么 1 之后紧跟一个 -1 . 首先可以发现对于任意的 $t$, 前 $t$ 个人报出的数的和都是非负的. 这样, 在第 100 个人做决策时, 如果 $a_{99}=1$, 那么直接让守卫在 $\{0,1\}$ 中做出选择, 最后的和为 $\left(a_{1}+\cdots+a_{98}\right)+1+a_{100} \geq 1$; 否则 $a_{1}, a_{2}, \cdots, a_{99}$ 中的非零数一定能划分成一些长度至少为 2 的连续的 1 , 以及 1 之后紧跟一个 -1 , 这样前 99 个数的和要么是 0 , 要么不小于 2 , 上帝在 $\{-1,1\}$中间选一个数之后和一定不是 0 , 则原问题得证.

评注 这是一道较为困难的构造题. 首先可以注意到解答的第一句话是本题的一个简单的等价转换.

做平移变换之后就变成让一个数不等于 0 , 称 “和” 为现在写下的所有数的
和. 那么就有很多思路, 例如奇偶性, 大小关系, 模 3 的余数等等关系. 不过经过若干探索之后可以发现, 只有大小关系才可能在只给了前两个回答的少数信息中保持, (一种笔者尝试但是无法做出本题的观点是可以尝试若干种策略, 分析在已经有 $x$ 个人给了数, 最后两位为两个指定数时和的所有可能性. 这一做法进行简单尝试会发现多来几个人之后模的条件难以保留)因为大概可以让和总是大于 0 .

当然, 想到让和大于 0 之后, 就会自然的去想每一次都让守卫写 0,1 , 那么最后一步就面临了选择, 在前面两个都是 0 的时候只能选择 $1,-1$ 让守卫写(否则和有可能是 0$)$, 为此就要前面两个是 0 的时候和不是 1 . 这时便可以诱导出策略, 想的是在和是 1 的时候让和要么变成 0 要么就不小于 2 , 此时便可以自然地想到在前两个是 0,1 的时候让守卫在 $-1,1$ 中选择.

## 二、十年级

10.1 在平行四边形 $A B C D$ 的边 $B C$ 上依次排列着四点 $B, E, F, C$, 设 $A C, B D$ 交于 $O$. 若 $A E, D F$ 和 $\odot(A O D)$ 相切, 证明它们同时和 $\odot(E O F)$ 相切.



证明 由 $A E$ 为 $\odot(A O D)$ 的切线以及 $A D / / B C$ 知

$$
\angle O A E=\angle A D O=\angle O B E
$$

故 $O, A, E, B$ 共圆, 同理 $O, F, C, D$ 共圆. 那么

$$
\angle A E O=\angle A B O=\angle O D C=\angle O F E \text {, }
$$

这表明 $A E$ 与 $\odot(E O F)$ 相切, 另一条直线同理.

评注 这是一道简单的几何题, 只要进行导角即可.

10.2 求所有正整数组成的集合 $\left\{x_{1}, x_{2}, \cdots, x_{20}\right\}$, 满足

$$
x_{i+2}^{2}=\operatorname{lcm}\left(x_{i}, x_{i+1}\right)+\operatorname{lcm}\left(x_{i-1}, x_{i}\right),
$$

其中 $i=1,2, \cdots, 20, x_{0}=x_{20}, x_{1}=x_{21}, x_{2}=x_{22}$.

解 考虑素数 $p \mid x_{i}$, 那么 $p \mid \operatorname{lcm}\left(x_{i}, x_{i+1}\right)+\operatorname{lcm}\left(x_{i}, x_{i-1}\right)=x_{i+2}^{2}$, 于是 $p \mid x_{i+2}$, 这表明

$$
p \mid \operatorname{lcm}\left(x_{i}, x_{i+1}\right)+\operatorname{lcm}\left(x_{i+1}, x_{i+2}\right)=x_{i+3}^{2},
$$

故 $p \mid x_{i+3}$, 这样可以推出 $p$ 整除所有的 $x_{i}$.

如果 $p \geq 3$, 不妨假设 $x_{3}$ 是 $\left\{x_{1}, x_{2}, \cdots, x_{20}\right\}$ 中的最大数, 那么

$$
x_{3}^{2}=\operatorname{lcm}\left(x_{20}, x_{1}\right)+\operatorname{lcm}\left(x_{1}, x_{2}\right) \leq \frac{x_{20} x_{1}}{3}+\frac{x_{1} x_{2}}{3} \leq \frac{2 x_{3}^{2}}{3},
$$

矛盾, 因此 $p=2$. 又 $x_{i}=1$ 不合题意, 因此每一个 $x_{i}$ 均为 2 的正整数次幂, 此时仍然设 $x_{3}$ 为最大的, 那么

$$
x_{3}^{2}=\operatorname{lcm}\left(x_{20}, x_{1}\right)+\operatorname{lcm}\left(x_{1}, x_{2}\right) \leq 2 x_{3},
$$

故 $x_{3}=2$. 经检验所有的 $x_{i}=2$ 满足要求, 原问题得证.

评注 这是一道较为简单的数论题, 想到单独分析一个素因子之后就可以结合大小关系解决问题.

10.3 某国家有 $N$ 个城市, 其中一些城市对通过双向航线互相连接(每对城市之间最多一条航线), 每条航线都属于 $k$ 个公司之一. 已知现在可以从任意一个城市通过航线到任意的另一个城市, 但当删除任意一家航空公司的所有航线后, 便无法做到了. 对固定的 $N, k$, 求该国家航线的最大可能值.

解 该国家航线数目的最大可能值为 $\mathrm{C}_{n}^{2}-\mathrm{C}_{k}^{2}$.

构造图 $G(V, E)$, 其中顶点集 $V$ 是 $N$ 个城市组成的集合, 边集 $E$ 为航线,则将第 $i$ 个点 $(1 \leq i \leq k)$ 向第 $k+1, k+2, \cdots, n$ 号点连 $i$ 色边, $k+1, \cdots, n$ 号点之间连任意颜色的边, 则这个图是连通的, 且去掉第 $i$ 种颜色之后 $i$ 号点不再与其余点连通, 这样的构造满足要求.

另一方面, 我们对 $t(0 \leq t \leq k)$ 归纳证明: 可以将这个图的顶点集划分为 $m \geq t+1$ 个部分, 每一个部分至少一个点, 其中至少有 $\mathrm{C}_{t}^{2}$ 个部分对 $X, Y$, 使得 $X, Y$ 之间没有任何颜色的边, 并且不同部分之间的边的颜色编号都不大于 $t$.

$t=0$ 时所有顶点属于一个部分显然成立.

假设 $t-1$ 时成立, 则当 $t$ 时, 根据归纳假设, 设 $t-1$ 时分成的部分为
$S_{1}, S_{2}, \cdots, S_{m}(m \geq t)$. 那么去掉第 $t$ 种颜色之后, 图不连通, 设此时图可以分为两个部分 $A$ 与 $B$. 因为这两个部分之间有边, 并且这些边不在不同部分之间,所以这样必定存在一个 $S_{i}$ 同时含有 $A$ 中和 $B$ 中的点.

现在, 令 $V_{i}$ 为 $S_{i}$ 中 $A$ 这一部分的点, $U_{i}$ 为 $S_{i}$ 中 $B$ 这一部分的点. 对于每一个 $i$, 留下 $U_{i}, V_{i}$ 中非空的. 我们证明这就是所需要的分划. 显然两两交为空, 并起来为顶点集;对于每一个 $i, U_{i}, V_{i}$ 至少留下一个, 上面已经论述了有一个 $U_{i}, V_{i}$均不为空, 所以至少留下了 $m+1 \geq t+1$ 个部分. 同时, $U_{i}, U_{j} ; V_{i}, V_{j}$ 之间的边颜色编号不超过 $t-1, U_{i}, V_{i}$ 之间的边颜色编号为 $k$, 也满足要求.

现在不妨假设 $U_{1}, V_{1}$ 均不为空, 那么 $U_{1}$ 和 $V_{i}(i>1)$ 中的点(若非空)不连边. 这是因为归纳假设表明了所有边的颜色均不大于 $t-1$, 但是 $A, B$ 的定义表示边的颜色恰好为 $t$, 就是不存在边, 对于 $V_{1}, U_{i}$ 有同样的结论. 再注意 $U_{1}, U_{i}$中的点连边蕴含于 $S_{1}, S_{i}$ 中的点连边, 对于 $V$ 也同理, 而原来 $S_{i}$ 和 $S_{j}$ 中的点没有边的时候 $(i, j \geq 2)$, 所对应到的不论是 $U$ 还是 $V$ 都没有边. 这代表了原来所没有的边都能对应到现在的两个集合之间, 并且对每个 $i>1$ 多出了 $U_{1}, V_{i}$或 $V_{1}, U_{i}$, 这样总计至少 $t-1$ 条边没有连 $(i=2,3, \cdots, m+1)$, 故至少有 $\mathrm{C}_{t-1}^{2}+t-1=\mathrm{C}_{t}^{2}$ 条, 完成了归纳过渡, 命题中取 $t=k$ 也证明了我们给出的答案是最优的.

评注 这是一道较为困难的组合图论题, 因为答案较难猜到, 所以上手难度较大.

笔者入手先从证明部分入手, 去掉每一种颜色后都会分成两块, 两块之间不连边(不要求块内连通), 这样就可以对每个点标上一个 $k$ 维 $0-1$ 数组, 第 $i$ 位代表去掉 $i$ 颜色后所在块是 0 块还是 1 块. 转化成一个超立方体上点的问题, 超立方体每个方向上都至少有上下两层各一个点, 再去分析超立方体上的性质:对于两个欧拉距离至少为 2 的两个标号所对应的点之间肯定不连边. 因此不连的边的条数至少为超立方体上这些点之间距离至少为 2 的点对数. 这样分析后就可以直接解决问题, 并给出例子.

上面的证明是思考了这些东西之后, 去掉了超立方体来书写的, 本质相同.

10.4 给定正整数 $n \geq 4$, 有 $2 n+4$ 张编号依次为 $1,2, \cdots, 2 n+4$ 的卡片. 在编号为 $m$ 的卡片上写有实数 $a_{m}$, 使得 $\left\lfloor a_{m}\right\rfloor=m$. 求证: 可以从中选出四张卡片,使得其中两张卡片上的数字之和与剩下的两张卡片上的数字之差小于 $\frac{1}{n-\sqrt{\frac{n}{2}}}$.

证明 考虑可重集 $S=\left\{a_{i}-a_{j} \mid 1 \leq i-j \leq d, 1 \leq i, j \leq 2 n+4\right\}$, 其中 $d$ 待
定.

我们希望在 $S$ 中找出两个差小于 $t=\frac{1}{n-\sqrt{n / 2}}$ 的元素, 并且它们所对应的下标为四个不同整数.

首先满足后一条. 注意到 $S$ 中两个元素的差化简后无非为 $a_{i}-a_{j}, a_{i}+$ $a_{j}-2 a_{k}, a_{i}+a_{j}-a_{k}-a_{l}$ 三种形式之一(不同字母对应的下标不同), 如果有两组 $(i, j)$ 使得 $-t<a_{i}-a_{j}<t$, 那么它们的下标一定不同(注意到 $n \geq 4$ 代表了 $t \leq \frac{1}{2}$, 再结合 $\left[a_{m}\right]=m$ 就可以说明), 作差之后直接找出了四张卡片. 现在至多一组 $\left|a_{x}-a_{y}\right|<t$, 将所有 $S$ 中形如 $a_{x}-a_{t}$ 的至多 $2 d$ 个元素去掉, 其中 $x-d \leq u \leq x+d$ 且 $u \neq x$. 此时对于每一个 $k$, 至多有两组 $i<j$ 使得 $\left|a_{i}+a_{j}-2 a_{k}\right|<t$. 这是因为前面的一步调整保证了这样的 $(i, j)$ 中的下标互不重复, 而若有 $a_{i}+a_{j}$ 和 $a_{i^{\prime}}+a_{j^{\prime}}$ 同时大于或者小于 $2 a_{k}$, 那么它们作差就是符合要求的, 这样就至多一组大于 $2 a_{k}$, 一组不大于 $2 a_{k}$, 共 2 个. 对于所有可能的 $k$和对应的 $i$ 去掉这些 $a_{i}-a_{k}$ 形式的元素, 至多去掉了 $4 n+8$ 个.

原来 $S$ 中有 $(2 n+4) d-\frac{d(d+1)}{2}$ 个元素, 现在至少还有

$$
(2 n+4) d-\frac{d(d+1)}{2}-2 d-(4 n+8)
$$

个. 注意到 $\left[a_{m}\right]=m$ 代表了 $S$ 中的元素大于 0 小于 $d+1$, 那么一定有两个的差小于 $\frac{d+1}{(2 n+2) d-\frac{d(d+1)}{2}-4 n-9}$.

现在只用选取合适的 $d$ 使得

$$
\frac{d+1}{(2 n+2) d-\frac{d(d+1)}{2}-4 n-9} \leq t,
$$

也就是

$$
(2 n+2) d-\frac{d(d+1)}{2}-4 n-9 \geq(d+1)\left(n-\sqrt{\frac{n}{2}}\right),
$$

令 $d=6$, 那么只用 $n-10 \geq 8-7 \sqrt{n / 2}, n \geq 6$ 时成立; $n=4,5$ 时 $n+2$ 组下标和为 $2 n+5$ 的数位于一个长度为 2 的区间中, 有两个的差小于 $\frac{2}{(n+1)}<\frac{1}{\left(n-\sqrt{\frac{n}{2}}\right)}$.证毕!

评注 本题是一个中等难度的组合估计题. 本解答中选取合适的 $d$ 可以做到 $\frac{1}{(2 n-O(\sqrt{n}))}$ 的界, 优于题目给出的界. 比较自然的想法是找一个集合使得其中的数的个数至少是极差的 $n-\sqrt{\frac{n}{2}}$ 倍, 尝试考虑某些 $a_{i}+a_{j}$ 构成的集合可以做到 $n$ 左右, 将 + 改成 - 并弥补一些可能产生的漏洞之后便能改进到解答中的界.

10.5 一位老师和他的 30 个学生在一个无限单元网格上进行如下游戏: 从老师开始, 接着 30 个学生各进行一次操作, 然后又轮到老师, 已知这样进行下
去. 每个人在一次操作中可以在网格中选取一条单元边(即两个相邻单元的公共边)进行染色, 每条边不能重复染色. 如果在若干次操作后, 网格上存在一个 $1 \times 2$ 或 $2 \times 1$ 矩形, 其整个边框都被染色, 但内部的一条单元边未被染色, 则老师获胜. 求证: 老师有获胜的策略.

证明 不妨假设这个方格表为欧氏平面,所有的格子的边界都是联结相邻格点的线段. 教师的策略分两步, 令 $n=1000$.

首先, 考虑画出一个以 $(0,0),(n, 0),(0, n),(n, n)$ 为顶点的正方形的 $4 n$ 条在格点中的边. 注意到这个正方形内部有 $2 n(n-1)$ 条边, 这个数量大于 $30 n$, 所以这一步完成的时候这个正方形的内部一定有一条边没有被染色.

其次, 教师依次选择正方形中任意一条未被染色的边染色, 直到正方形内部的所有边都被染色(由于正方形内部边数有限, 故这个时刻存在). 由于一个人一次只能染色一条边, 所以一定有一个时刻正方形内部恰有一条未被染色的边. 假设它是单位正方形 $A, B$ 的边界, 那么此时 $A, B$ 构成的 $1 \times 2$ 的矩形的边界都被染色(内部的边是唯一一条未被染色的边), 并且内部的边没有被染色, 于是教师获胜.

评注 这道题是中等难度的组合题. 在知道教师获胜之后, 重点要思考的是教师为何在只能走很少步数时获胜. 此时注意到题目中说了只用出现要求的子结构, 未说明谁走最后一步. 此时注意到若是一个网格中被填满, 最后一步只要不在边界上就能获胜, 因此只用先画出边界再填满中间便能获胜.

10.6 给定一个实系数多项式 $P(x)$, 其次数 $n>1$. 已知方程 $P(P(P(x)))=$ $P(x)$ 有 $n^{3}$ 个不同的实根. 求证: 这些实根可以被分为算术平均数相等的两组.

证明 设

$$
p(x)=a x^{n}+b x^{n-1}+q_{1}(x),
$$

其中 $(a \neq 0), q_{1}(x)$ 为 $n-2$ 次多项式. 于是

$$
p(p(x))=a^{n+1} x^{n^{2}}+n a^{n} b x^{n^{2}-1}+q_{2}(x),
$$

其中 $q_{2}(x)$ 为 $n^{2}-2$ 次多项式.

$$
p^{(3)}(x)=a^{n^{2}+n+1} x^{n^{3}}+n^{2} a^{n^{2}+n} b x^{n^{3}-1}+q_{3}(x),
$$

其中 $q_{3}(x)$ 是 $n^{3}-2$ 次多项式.

由 $p(x)=x$, 知 $p^{(3)}(x)=x$.
设 $p(x)=x$ 的根是 $x_{1}, x_{2}, \cdots, x_{n}, p^{(3)}(x)=x$ 的其余根是 $y_{1}, \cdots, y_{n^{3}-n}$,则有韦达定理知

$$
\frac{x_{1}+\cdots+x_{n}}{n}=-\frac{b}{n a}=\frac{x_{1}+\cdots+x_{n}+y_{1}+\cdots+y_{n^{3}-n}}{n^{3}}=\frac{y_{1}+\cdots+y_{n^{3}-n}}{n^{3}-n}
$$

原问题得证.

评注 这是一道简单的代数题, 只用想清楚这些根的构成并运用韦达定理即可.

10.7 同 9 年级第 7 题.

10.8 五边形 $A B C D E$ 内接于 $\odot \omega$, 令 $X, Y$ 为直线 $C D$ 和射线 $A B, A E$的交点, $P$ 为线段 $E X, B Y$ 的交点, $E X, B Y$ 再次交 $\omega$ 于 $Q, R . A^{\prime}$ 为 $A$ 关于 $C D$ 的对称点. $\odot(P Q R), \odot\left(A^{\prime} X Y\right)$ 交于两点. 证明: 可以标记两点 $M, N$ 使得 $C M, D N$ 的交点在 $\odot(P Q R)$ 上.



证明 设 $\odot(X Q C), \odot(C R Y)$ 再次交于 $M^{\prime}$, 则

$\angle X M^{\prime} Y=\angle E Q C+\angle C R B=\angle E A C+\angle B A C=\angle B A E=\angle X A Y=\angle X A^{\prime} Y$,最后一个等号用到了 $A, A^{\prime}$ 关于 $X Y$ 对称, 因此 $X, M^{\prime}, A^{\prime}, Y$ 四点共圆.

而

$$
\begin{aligned}
\angle Q M^{\prime} R & =\angle Q M^{\prime} C+\angle C M^{\prime} R \\
& =\angle Q X C+\angle C Y R \\
& =\angle P X Y+\angle P Y X
\end{aligned}
$$

$$
\begin{aligned}
& =180^{\circ}-\angle X P Y \\
& =180^{\circ}-\angle Q P R
\end{aligned}
$$

故 $P, Q, R, M^{\prime}$ 四点共圆. 为此可令 $M=M^{\prime}$, 类似定义 $N=N^{\prime}$ 为题目中两圆的交点.

设 $C M, D N$ 交于 $T$, 那么

$$
\angle T M R=\angle C M R=\angle C Y R=\angle D Y R=\angle D N R=\angle T N R,
$$

这表明 $T$ 在 $\odot(P Q R)$ 上.

评注 这是一道较为困难的几何题, 图形也比较优美. 通过标准作图比较容易猜到一组共圆, 进而发现两圆的交点其实是密克点, 然后导角即可. 如果没有猜到结论就很难入手了.

## 三、十一年级

11.1 对于某些正整数 $n>m, n$ 能表示成 $m$ 的 2021 个非负整数次幂之和,也可表示成 $m+1$ 的 2021 个非负整数次幂之和. 求正整数 $m$ 的最大可能值.

解 由条件得，

$$
n=\sum_{i=1}^{2021} m^{s_{i}}=\sum_{i=1}^{2021}(m+1)^{t_{i}}
$$

当 $m \geq 2022$ 时, 因为 $n>m$, 所以 $s_{i}, t_{i}$ 都不全为 0 . 设 $s_{i}$ 中有 $u(u \leq 2020)$个为 $0, n \equiv u(\bmod m)$. 而 $n \equiv 2021(\bmod m)$, 故 $m \mid 2021-u>0$, 故 $m \leq$ $2021-u$, 矛盾.

当 $m=2021$ 时,

$$
(m+1)^{2}+(m-4)(m+1)+3 \cdot 1=m^{2}+(m-1) m
$$

满足条件.

综上可得 $m$ 的最大值为 2021 .

评注 这是一道简单的数论题, 构造之后通过取模证明即可.

11.2 设 $P(x)$ 为次数 $n>1$ 的非零多项式, 且所有系数均为非负数.已知 $y=P(x)$ 为奇函数. 问: 在 $y=P(x)$ 的图像上 $G$ 上是否存在 $n$ 个点 $A_{1}, A_{2}, \cdots, A_{n}$ 满足: $G$ 在 $A_{1}$ 处的切线经过 $A_{2}$, 在 $A_{2}$ 处的切线经过 $A_{3}, \cdots$, $G$ 在 $A_{n}$ 处的切线经过 $A_{1}$ ?
解 设 $p(x)=c_{m} x^{2 m-1}+c_{m-1} x^{2 m-3}+\cdots+c_{1} x, c_{i} \geq 0, i=1,2, \cdots, m-$ $1, c_{m}>0$. 由 $n>1$ 知 $m \geq 2$, 假设存在满足条件的 $n$ 个点. 注意到 $p^{\prime}(x)=$ $(2 m-1) c_{m} x^{2 m-2}+\cdots+c_{1}$ 在 $x=0$ 处切线 $y=c_{1} x$, 由于 $p(x)-c_{1} x$ 单调递增,故实根只有 $x=0$, 则 $A_{1} \neq 0$. 不妨设 $A_{1}>0$.

$x=A_{2}$ 满足

$$
\begin{aligned}
& p(x)=p^{\prime}\left(A_{1}\right)\left(x-A_{1}\right)+p\left(A_{1}\right) \\
\Leftrightarrow & \left(x-A_{1}\right)\left(\sum_{k=1}^{m}\left(\sum_{j=0}^{2 k-2} x^{j} A_{1}^{2 k-2-j}-(2 k-1) A_{1}^{2 k-2}\right)\right)=0 .
\end{aligned}
$$

当 $0 \leq x<A_{1}$ 及 $x>A_{1}$ 时, 上式左侧均 $>0$, 因此 $A_{2}<0$.

同理知 $A_{2 i-1}>0, A_{2 i}<0, A_{2 m-1}>0 \Rightarrow A_{1}<0$ 矛盾.

于是不存在满足条件的 $n$ 个点.

评注 这是一道简单的代数题, 经过尝试并且结合 $n$ 是奇数的条件很容易去想交替的性质,这里的性质也比较显然(正负交替).

11.3 某种语言只含有三个字母 $A, B, C$. 一个字母序列被称作一个单词当且仅当它恰好含有 100 个字母, 使得其中 40 个字母是辅音字母(即 $B$ 和 $C$ ), 而剩余 60 个字母全为 $A$. 最多可以选取多少个不同的单词, 对于其中任意两个单词, 都存在一个相同的位置, 使得这两个单词在该位置上恰好是两个不同的辅音字母?

解 首先证明下面一个引理:

引理 对集合 $D_{i}=B_{i} \cup C_{i}, B_{i} \cap C_{i}=\varnothing(i=1,2, \cdots, m)$, 若对 $i \neq j$, 都有 $\left|B_{i} \cap C_{j}\right|+\left|B_{j} \cap C_{i}\right|>0$, 则

$$
\sum_{i=1}^{m} \frac{1}{2^{\left|D_{i}\right|}} \leq 1
$$

证明 对 $n=\left|\bigcup_{i=1}^{m} D_{i}\right|$ 进行归纳.

当 $n=0$ 时, $m=1$ (否则在 $\left|B_{i} \cap C_{j}\right|+\left|B_{j} \cap C_{i}\right|>0$ 中令 $i=1, j=2$ 矛盾), 故 $n=0$ 是结论成立.

假设 $n-1(n \geq 1)$ 时, 结论成立, 下面考虑 $n$ 的情况, 设 $\bigcup_{i=1}^{m} D_{i}=\{1,2, \cdots, n\}$.令

$$
F=\left\{D_{i} \mid D_{i} \cap\{n\}=\varnothing\right\}, G=\left\{D_{i} \mid n \in B_{i}\right\}, H=\left\{D_{i} \mid n \in C_{i}\right\},
$$

则由条件, 知 $F, G, H$ 为 $D_{1}, D_{2}, \cdots, D_{m}$ 的一个分划.

考虑 $F, G$ 中的元素 $D_{i}, D_{j}$, 则 $n$ 不属于 $B_{i} \cap C_{j}$ 或 $B_{j} \cap C_{i}$, 故对 $G$ 中的每
个 $D_{i}$, 令 $E_{i}=D_{i} \backslash\{n\}$. 注意到 $\left|E_{i}\right|=\left|D_{i}\right|-1$, 对 $F$ 及 $\left\{E_{i} \mid D_{i} \in G\right\}$ 用归纳假设有

$$
\sum_{D_{i} \in F} \frac{1}{2^{\left|D_{i}\right|}}+\sum_{D_{i} \in G} \frac{2}{2^{\left|D_{i}\right|}} \leq 1
$$

同理可得

$$
\sum_{D_{i} \in F} \frac{1}{2^{\left|D_{i}\right|}}+\sum_{D_{i} \in H} \frac{2}{2^{\left|D_{i}\right|}} \leq 1
$$

由上述两式可得引理成立.

回到原题, 设 $F$ 中元素为 $A_{1}, A_{2}, \cdots, A_{n}$. 令

$$
\begin{aligned}
& B_{i}=\left\{x \mid 1 \leq x \leq 100, A_{i} \text { 的第 } x \text { 位为 } B\right\}, \\
& C_{i}=\left\{x \mid 1 \leq x \leq 100, A_{i} \text { 的第 } x \text { 位为 } C\right\},
\end{aligned}
$$

由条件, 知 $\left|B_{i}\right|+\left|C_{i}\right|=40$, 任两个单词有一位不同的辅音字母表明

$$
\left(B_{i} \cap C_{j}\right)+\left(B_{j} \cap C_{i}\right) \neq 0
$$

对 $i \neq j$ 成立. 由引理有 $\sum_{i=1}^{n} \frac{1}{2^{\left|D_{i}\right|}} \leq 1$, 得 $n \leq 2^{40}$.

当 $n=2^{40}$ 时, 令 $A_{i}$ 取遍前 60 位为 $A$, 后 40 位为 $B$ 或 $C$ 的串即可.

综上可知, 最多可以选取 $2^{40}$ 个不同的单词.

评注 这是一道较难的组合问题, 构造比较好猜. 证明本题时, 会去想某一位为 $A B, A C$ 的两部分去归纳, 但正则性会使归纳难以进行, 因此要设计一种更一般的函数来归纳。

$11.4 \triangle A B C$ 中, 角平分线 $A A_{1}, C C_{1}$ 交于 $I$, 过 $B$ 平行于 $A C$ 的直线与 $A A_{1}, C C_{1}$ 分别交于点 $A_{2}, C_{2}$, 设 $\triangle A C_{1} C_{2}, \triangle C A_{1} A_{2}$ 的外心为 $O_{a}, O_{c}$, 证明: $\angle O_{a} B O_{c}=\angle A I C$.


证明 设以 $B$ 为圆心, $B A$ 为半径的圆为 $\omega_{a}, B$ 为圆心, $B C$ 为半径的圆为 $\omega_{c}$. 注意到 $B A=B A_{2}, B C=B C_{2}$, 那么 $A_{2}$ 在 $\omega_{a}$ 上, $C_{2}$ 在 $\omega_{c}$ 上.

设 $\omega_{c}, \odot O_{c}$ 交于 $X, \omega_{a}, \odot O_{a}$ 交于 $Y$, 那么

$$
\angle A X C=360^{\circ}-\angle A X C_{2}-\angle C_{2} X C .
$$

容易计算得到

$$
\angle A X C_{2}=\angle A C_{1} C_{2}=A+\frac{C}{2}, \angle C_{2} X C=90^{\circ}+\frac{C}{2},
$$

那么 $\angle A X C=90^{\circ}+B$, 同理 $\angle A Y C=90^{\circ}-B$, 这样 $A, X, C, Y$ 四点共圆.

设这个圆的圆心为 $U$, 那么 $X, C ; Y, A$ 分别关于 $B U$ 对称, 这表明 $A X=$ $C Y$. 结合 $B X=B C, B Y=B A$ 知 $\triangle A B X \cong \triangle Y B C$, 这样

$$
\angle A B X=\angle C B Y, \angle X B Y=B
$$

而 $O_{c} C_{2}=O_{c} X, B C_{2}=B X$, 这表明 $\angle O_{c} B X=\frac{1}{2} \angle C_{2} B X$, 同理 $\angle Y B O_{a}=$ $\frac{1}{2} \angle Y B A_{2}$, 三式相加得到 $\angle O_{a} B O_{c}=90^{\circ}+\frac{1}{2} B=\angle A I C$.

评注 这是一道较为困难的几何题, 笔者的做法是添出一种作图方法(也就是利用角平分线+平行的等腰) 所需要的辅助圆之后以外发现的. 当然本题解法并不唯一, 可以考虑构造相似对应并进行简单计算解决.

## 11.5 同十年级第 5 题.

11.6 在四面体 $S A B C$ 中, 任意两条边的长度都不相等. 在平面 $B C S$ 中,作 $S$ 关于 $B C$ 的中垂线的对称点 $A^{\prime}$, 类似的定义 $B^{\prime}, C^{\prime}$. 证明: 平面 $A B C$, $A B^{\prime} C^{\prime}, A^{\prime} B C^{\prime}, A^{\prime} B^{\prime} C$ 经过同一点.

证明 命题等价于: 平面 $A B^{\prime} C^{\prime}$ 和平面 $A B C$ 的交线 $l_{a}$ 以及类似定义的 $l_{b}, l_{c}$ 三线共点.

注意到 $B C / / A^{\prime} S, A C / / B^{\prime} S$, 这表明 $A^{\prime} B^{\prime} / /$ 面 $A B C$, 而 $l_{c} \in$ 面 $A B C$, 因此 $l_{c} / / A^{\prime} B^{\prime}$.

设 $\triangle A B C$ 的外心 $O$, 外接圆为 $\omega_{1}$. 对称性表明 $O S=O A^{\prime}=O B^{\prime}=O C^{\prime}$,这样 $S, A^{\prime}, B^{\prime}, C^{\prime}$ 四点共圆, 设这个圆为 $\omega_{2}$, 用位似变换将 $\omega_{2}$ 变换为 $\omega_{1}$, 设位似对应点为 $S_{1}, A_{1}, B_{1}, C_{1}$, 由于位似保平行, 条件变为 $S_{1} A_{1} / / B C$, (1)变为 $l_{c} / / A_{1} B_{1}$.

以 $\omega_{1}$ 为单位圆建立复平面, 用相应点的字母表示对应的复数, 那么条件化简为 $S_{1} A_{1}=B C$ 和 $S_{1} B_{1}=A C$, 显然 $C \in l_{c}$, 设 $l_{c}$ 再次交 $\omega_{1}$ 于 $X$, 那么 $C X=A_{1} B_{1}$, 联立三式得到 $X=\frac{A B C}{S^{2}}$ 为一个对称式, 这表明 $l_{c}, l_{b}, l_{a}$ 共点于 $X$.
证毕!

评注 这是一道中等难度的立体几何题, 考虑刻画出交线之后就变为难度不大的平面几何问题了.

11.7 求 $(1,2, \cdots, 2021)$ 的所有排列 $\left(a_{1}, a_{2}, \cdots, a_{2021}\right)$, 使得对任意满足 $|m-n|>20^{21}$ 的正整数 $m, n$, 都有以下不等式成立:

$$
\sum_{i=1}^{2021} \operatorname{gcd}\left(m+i, n+a_{i}\right)<2|m-n|
$$

解 满足条件的排列为 $a_{i}=i$.

首先证明下面的引理:

引理 $\operatorname{gcd}(x, y) \operatorname{gcd}(x, z) \leq x \operatorname{gcd}(y, z)$.

证明 对于一个素数 $p$, 我们设 $x, y, z$ 中 $p$ 的幂次分别为 $a, b, c$, 只需证明左侧 $p$ 的幂次小于右侧, 也就是 $\min (a, b)+\min (a, c) \leq a+\min (b, c)$, 不妨设 $b=\min (b, c)$, 则 $L H S \leq b+a=R H S$. 引理得证.

首先, 当 $a_{i}=i$ 时, 我们设

$$
d_{k}=\operatorname{gcd}\left(m+k, n+a_{k}\right)=\operatorname{gcd}(m+k, n+k)=\operatorname{gcd}(m-n, n+k),
$$

则有

$$
\begin{aligned}
d_{i} d_{j}(i \neq j) & \leq|m-n| \operatorname{gcd}(n+i, n+j) \\
& =|m-n| \operatorname{gcd}(n+i, i-j) \\
& \leq|m-n||i-j| \\
& \leq 2020|m-n| .
\end{aligned}
$$

这样至多有一个 $d_{i}$ 不小于 $\sqrt{2020|m-n|}$, 而这个 $d_{i}$ 显然不大于 $|m-n|$, 因此所有 $d_{i}$ 的和不大于

$$
|m-n|+2020 \sqrt{2020|m-n|}<2|m-n| \text { (用到 }|m-n| \geq 20^{21} \text { ). }
$$

而对一个不是这样的排列, 必定存在 $i>j$ 使得 $a_{i}-i \neq a_{j}-j$, 取 $j$ 使得 $a_{j}-j$最小, 即 $a_{j} \leq j-1$. 那么

$$
\begin{aligned}
& \operatorname{gcd}\left(m+i, n+a_{i}\right)=\operatorname{gcd}\left(m-n+i-a_{i}, n+a_{i}\right) \\
& \operatorname{gcd}\left(m+j, n+a_{j}\right)=\operatorname{gcd}\left(m-n+j-a_{j}, n+a_{j}\right)
\end{aligned}
$$

我们取

$$
m-n=M\left(i-j-a_{i}+a_{j}\right)+a_{i+1}-i, M=10^{1000},
$$

这样

$$
\operatorname{gcd}\left(m-n+i-a_{i}, m-n+j-a_{j}\right)=1,
$$

由中国剩余定理知道存在 $n$ 使得

$$
m-n+i-a_{i}\left|n+a_{i}, m-n+j-a_{j}\right| n+a_{j}
$$

这样

$$
\begin{aligned}
\sum_{k=1}^{2021} g c d\left(m+k, n+a_{k}\right) & \geq 2019+m-n+i-a_{i}+m-n+j-a_{j} \\
& \geq 2020+2(m-n)+i-a_{i} \\
& \geq 2(m-n)
\end{aligned}
$$

矛盾。

原问题得证.

评注 这是一道中等难度的数论题. 本题容易想到将 $\mathrm{gcd}$ 中的两项相减, 相减之后想到如果有两个 $a_{i}-i$ 不同, 使用中国剩余定理构造反例就很自然了,而之后的证明部分也可以通过简单估计解决.

11.8 已知有 100 名女生, 每名女生都有 100 个球, 共有 10000 个球, 其中共有 100 种颜色, 每种颜色的球恰有 100 个. 她们可以进行如下操作: 两名女生可以互相交换 1 个球(例如甲给乙 1 个球,乙给甲 1 个球). 证明: 存在一系列的操作, 每个球最多交换一次, 最后, 每个女孩都有 100 色颜色互不相同的球.

证明 记 $n=100$. 令 $X_{i, j}$ 为第 $i$ 名女生初始含有的 $j$ 色的球的数量. 我们考虑顶点集合为 $A_{1}, A_{2}, \cdots, A_{n} ; B_{1}, B_{2}, \cdots, B_{n}$ 的二部图. 这个图可以有重边,我们在 $A_{i}$ 和 $B_{j}$ 之间连接 $X_{i, j}$ 条边.

由于每一种颜色的球和每一个人初始含有的球都是 $n$ 个, 因此这个二部图是 $n$ 正则的, 它可以拆为 $n$ 个完美匹配的并( Hall 定理的推论). 令 $Y_{i, j}$为第 $i$ 个完美匹配中 $A_{j}$ 所对应的 $B$ 这一部中的下标所对应的颜色中的一个球, 并且 $Y_{i, j}$ 互不相同, 这样我们可以重新标号所有 $n^{2}$ 个球为 $Y_{i, j}$. 注意到 $Y_{i, j}(j=1,2, \cdots, n)$ 的颜色构成集合 $\{1,2, \cdots, n\}$, 并且第 $j$ 个人初始含有的球的集合为 $Y_{i, j}(i=1,2, \cdots, n)$.

现在, 我们对每一对 $1 \leq i<j \leq n$, 将第 $i$ 个人的 $Y_{j, i}$ 这个球和第 $j$ 个人的 $Y_{i, j}$ 这个球交换. 所有交换完毕之后, 第 $i$ 个人拥有球 $Y_{i, j}(j=1,2, \cdots, n)$, 所有颜色各一个. 并且所有的交换为所有的 $Y_{i, j}$ 和 $Y_{j, i}(i \neq j)$ 中各进行一次, 满足题
目要求.

评注 1. 前面所提到的 Hall 定理的推论是任意 $k$ 正则二部图都是 $k$ 个完美匹配的并. 证明概要是对 $k$ 归纳那就只用找到一个完美匹配, 去掉并运用归纳假设. 正则性并对边数算两次很容易证明 Hall 定理的条件成立、

2. 这里大概说一些笔者所这题的思路与曲折. 本题虽然解答很短, 但是确实很难, 很容易走入弯路.一个自然但很难走下去的想法是每次找出一对适当的球进行互换, 如果从解答的角度来分析, 使用到的 Hall 定理的证明就不是简单的贪心, 所以步骤较为简单的贪心算法都是比较难以成功的.

经过一些失败的对于贪心算法的尝试之后可能会注意到本题很关键的一点, 那就是所有操作是无后效性的, 都是平等的. 既然一次次操作很难进行下去,那就可以考虑一次性进行很多甚至所有的操作. 并且对于一些具体的例子进行试验来发现需要用到 Hall 定理, 例如有一个人的球都是同色的那就能发现命题(几乎)不弱于上述结论. 但是注意到上述例子之后还是很容易去想同时复原一行, 否决这一做法的理由是对于“球”和“人”的对偶性的理解, 会发现一行并不本质.

经过上述大量尝试之后才能确定要同时完成所有的操作. 那么现在的主要问题就是选择哪一些球进行操作, 只要大胆猜到几乎所有的球都进行操作, 并且用几个简单的例子(例如之前探索中一些算法的反例)验证结论, 就能坚定正确性, 而做出这一猜测之后不难得到证明.

