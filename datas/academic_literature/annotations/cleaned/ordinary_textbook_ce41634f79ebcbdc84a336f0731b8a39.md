数学新星网 莫学生专栏

www.nsmath.cn/xszl

# 对多边形剪角问题的研究 

张盛桐

(上海市上海中学, 200231)

摘要. 本文研究了正 $n$ 边形剪角问题, 证明了如下结果: 给定一个面积为 $S$的正 $n$ 边形, 其进行如下剪角操作: 每次取相邻两边的中点, 沿其连线剪下多边形的一个角. 反复这样操作, 最多能剪去的面积不超过 $\frac{2}{5}\left(1-\cos \frac{2 \pi}{n}\right) S$,且这个估计是渐进最优的. 特别地, 当 $n=6$ 时, 剪去的面积不超过 $\frac{S}{5}$.

## I. 引 言

在数学竞赛中下面的正六边形剪角问题备受关注: 给定一个正六边形, 每次取相邻两边的中点, 沿其连线剪下多边形的一个角, 反复这样操作, 请问: 这样子做下去最多能剪去原图形面积的多少?

我们最初见到的界是 $\frac{1}{3}$. 后来, 我在国家队培训时, 知道前几届国家队队员,如牟晓生、张瑞祥研究过这个问题, 他们证明了上界可改进为 $\frac{1}{4}$. 在这篇文章中, 我们把界改进到 $\frac{1}{5}$. 事实上, 我们证明了更一般的结果:

定理 1. 对一个面积为 $S$ 的正 $n$ 边形进行剪角操作, 能剪去的面积不超过 $\frac{2}{5}\left(1-\cos \frac{2 \pi}{n}\right) S$.

我们把问题转化为了一个纯代数问题.

对多边形 $M$, 我们称 $M$ 的边界三角形为所有由 $M$ 连续三个顶点为顶点的三角形. 把这种三角形的面积按顺时针方向排成一个数列, 称之为 $M$ 的特征数列 (数列). 例如:正六边形的特征数列形如 $(a, a, a, a, a, a)$. 我们看到, 每次对 $M$的剪角对应一个对特征数列的操作. 如图 1 , 对 $A_{3}$ 进行剪角, 所得的图形 $N$ 比 $M$ 多了一条边. 容易发现, $N$ 的特征数列相当于对 $M$ 的数列进行了如下修改:

设 $M$ 的数列中有三个连续元素 $(a, b, c)$, 则 $N$ 中这些元素变为 $\left(\frac{a}{2}, \frac{b}{4}, \frac{b}{4}, \frac{c}{2}\right)$,其余元素不变. 这里认为, 在数列两端的元素也是相邻的. 同时, 多边形面积减

收稿日期: 2016-12-17； 修订日期: 2017-02-15.
少了 $\frac{b}{4}$.

我们称这一过程为环形展开, 简称展开或操作 (因为每次序列长度增加 1).



图 1

定义 1. 在对 $(a, b, c)$ 的 (即上述) 操作中, 称 $b$ 为主元, $a, c$ 为副元.

定义 2. 我们称对一个数列的前 $k$ 次操作为一个 $k$ 步 (次) 操作序列, 记为 $Q_{k}$. 并将其中的操作从前之后称为第 $1,2, \cdots, k$ 步 (次).

在以下讨论中, 多边形的数列 (即被操作的数列) 简记为数列.

对于任意操作序列 $Q_{k}$, 我们引入计数器

$$
S_{Q_{k}}=\sum_{i=1}^{k} \frac{b_{i}}{4}
$$

其中 $b_{i}$ 为第 $i$ 步的主元. 这样, $S_{Q_{k}}$ 就代表了多边形进行 $Q_{k}$ 后减去的面积. 有了这些工具, 我们就可以系统地研究问题了.

定义 3. 设最初研究的为正 $n$ 边形, 它的数列为 $(1,1,1, \cdots, 1)$. 记所有 $k$ 次操作数列组成的集合为 $M_{k}$. 记 $S_{n, k}=\max _{Q_{k} \in M_{k}} S_{Q_{k}}$.

由于 $\left|M_{k}\right|$ 有限, 故定义是合理的. 因为每次操作会使 $S$ 上升, 所以我们有 $S_{n, k}$, 关于 $k$ 单调递增. 故可定义 $S_{n}=\lim _{k \rightarrow \infty} S_{n, k}$. 这个极限的存在性将在下一节证明.

有了这些定义, 定理 1 可以重新表述为:

定理 2. $S_{n} \leq \frac{1}{5} n$, 且常数在渐进意义下最优.

事实上, 要说明这一点, 只需要求数列为 $(1,1,1, \cdots, 1)$ 的正 $n$ 边形的面积 $S$. 读者可以自证这个简单的结论: $n=2\left(1-\cos \frac{2 \pi}{n}\right) S$.

## II. 主要结果证明

## 1. 基本记号及性质

我们先提出几个基本的引理.

引理 1 . 在若干次操作后, 数列中所有数均为 2 的负整数 (或 0 ) 次幂.

由归纳法, 此引理显然.

为了表述方便, 我们引入如下记号.

定义 4. 对任意操作序列 $Q_{k}$, 记由 $Q_{k}$ 前 $l$ 次操作构成的操作序列为 $Q_{k, l}$.

引理 2. $S_{n}$ 存在且 $S_{n}<\frac{n}{2}$.

证明 以下我们称正 $n$ 边形的数列 $(1,1, \cdots, 1)$ 在经过操作序列 $Q$ 后数列的和为 $\operatorname{Sum}_{Q}$. 对任意操作序列 $Q_{k}$, 取其中第 $l$ 次操作, 设主元为 $b$, 副元为 $a, c$.可以发现, 每次操作前后数列中 Sum 减小了

$$
\Delta \operatorname{Sum}_{l}=\operatorname{Sum}_{Q_{k, l}}-\operatorname{Sum}_{Q_{k, l+1}}=\frac{a+b+c}{2} .
$$

同时 $S$ 增加了

$$
\Delta S_{l}=S_{Q_{k, l}}-S_{Q_{k, l+1}}=\frac{b}{4}
$$

故有 $\Delta \mathrm{Sum}_{l} \geq 2 \Delta S_{l}$.

由于 $\operatorname{Sum}_{Q_{k, 0}}$ 即为原数列的和 $n$, 且后来 (由引理 1) 一直为正数, 所以有 $\sum_{l \in N} \Delta \operatorname{Sum}_{l}<n$, 从而

$$
S_{Q_{k}}=\sum_{l=0}^{k-1} \Delta S_{l} \leq \frac{1}{2} \sum_{l=0}^{k-1} \Delta \operatorname{Sum}_{l} \leq \frac{n}{2}
$$

故由 $Q_{k}$ 任意性得 $S_{n, k}<\frac{n}{2}$, 即数列 $\left\{S_{n, k}\right\}_{k \geq 1}$ 单调有界, 故有极限, 即 $S_{n}$ 存在且 $S_{n}<\frac{n}{2}$ 成立.

在考察问题的过程中, 我们还将引入另一种操作.

定义 5. 对数列的线性展开 (或操作) 规则如下: 与环形展开规则相同, 但数列两端的数不视为相邻. 若以最左边的数 $A_{1}$ 为主元操作, 则仅将它右边的数作为副元除以 2. 对最右边的数同理.

例如, $(1,1,1)$ 以第一个 1 为主元操作, 经过环形展开可变为 $\left(\frac{1}{4}, \frac{1}{4}, \frac{1}{2}, \frac{1}{2}\right)$, 经过线性展开可变为 $\left(\frac{1}{4}, \frac{1}{4}, \frac{1}{2}, 1\right)$.

我们将环形展开中的概念沿用在线性展开中, 将所有 $S$ 换为 $L$. 显然在线性展开中引理 1 , 引理 2 成立.

接下来, 我们再证明几个基本结论.

引理 3. $S_{2 n} \geq 2 S_{n}, L_{n} \geq S_{n}$.
证明 对每个正 $n$ 边形的操作序列 $Q_{m}$, 我们构造一个正 $2 n$ 边形的操作序列 $Q_{2 m}^{\prime}$, 使 $S_{Q_{2 m}^{\prime}}=S_{Q_{m}}$.

事实上, 我们可以安排操作 $S_{Q_{2 m}^{\prime}}$, 使对任意正整数 $l$, 若初始正 $n$ 边形数列经 $Q_{m}$ 的前 $l$ 步操作 $Q_{l}^{\prime \prime}$ 操作至数列 $K=\left(a_{1, l}, \cdots, a_{n+l, l}\right)$, 则初始正 $2 n$ 边形数列经 $Q_{m}^{\prime}$ 的前 $2 l$ 步操作 $Q_{2 l}^{\prime \prime \prime}$ 操作至数列 $K K=\left(a_{1, l}, \cdots, a_{n+l, l}, a_{1, l}, \cdots, a_{n+l, l}\right)$,且 $S_{Q_{2 l}^{\prime \prime \prime}}=2 S_{Q_{l}^{\prime \prime}}$.

对 $l$ 归纳. $l=0$ 时显然. 若 $l$ 时成立, 则 $l+1$ 时, 设对 $Q_{m}$ 第 $l$ 次操作主元为 $a_{s, l}$, 则将 $2 n$ 边形序列中两个 $a_{s, l}$ 都操作一次, 则不难验证得到的数列满足归纳假设, 且保持 $S_{Q_{2 l+2}^{\prime \prime \prime}}=2 S_{Q_{l+1}^{\prime \prime}}$. 故归纳假设对任意 $l$ 都成立.

由 $n$ 边形操作任意性, 有 $S_{2 n, k} \geq 2 S_{n, k}$, 即第一个不等式成立.

对第二个不等式, 我们同样对每个正 $n$ 边形的环形操作序列构造正 $n$ 边形的线性操作序列. 实际上, 我们只需使线性操作序列每次和环形操作序列操作同一个位置的元素即可. 由归纳可证这种操作满足如下性质：

设若干步后环形操作序列得到了 $K=\left(a_{1}, \ldots, a_{t}\right)$, 线性操作序列得到了 $K^{\prime}=\left(b_{1}, \ldots, b_{t}\right)$, 则 $b_{i} \geq a_{i}$ 对任意 $1 \geq i \geq t$ 成立.

读者可以自己验证这个性质, 这很简单. 对这种操作序列, 每次操作线性的主元总大于等于环形的主元, 故线性展开的 $L$ 大于等于环形展开的 $S$. 由操作任意性, $L_{n} \geq S_{n}$ 成立.

## 2. 主要的想法

现在我们全力研究线性展开. 以下所有展开、操作及其他术语都表示线性展开下的意义, 取定初始数列为正 $n$ 边形的数列 $(1,1, \cdots, 1)$. 我们的想法是, 将操作化归为一种特殊的、容易处理的类型.

定义 6. 称一个操作序列为严格极大的, 若它每次操作的主元都是数列中全部数中最大的.

我们试图证明以下两个命题:

命题 1. 对每个操作序列 $Q$, 存在一个严格极大操作序列 $Q^{\prime}$, 使它的计数器 $L_{Q^{\prime}} \geq L_{Q}$.

命题 2. 对每个严格极大操作, 有 $L \leq \frac{1}{5} n+c, c$ 为不依赖于 $n$ 的常数.

在以下的讨论中, 我们要用到 “产生” 这个概念. 这个概念的定义如下:

定义 7. 我们用图论的观点来看数列的变化. 构造一棵分层的有向树, 第
$k(k \geq 0)$ 层为第 $k$ 次操作后的数列 (第 0 层为原数列). 视每个数为一个顶点. 对于每一个数, 把它与下一层中由操作它得到的数相连, 并令这条边由前者指向后者. 这样, 我们就产生了一颗树. 如果一个数在树中能通过边走到另一个数 (只能按边的定向走), 则称前者产生后者, 这时也称前者是后者的祖先.

## 3. 命题 1 的证明

我们先看到两个重要的性质.

性质 1. 若操作序列中两次连续的操作主元不相邻, 则它们可以互换并使 $L$不变.

此为显然.

引理 4. 若操作序列中两次连续操作相邻, 但前一次的主元比后一次小, 则可对换两次操作使 $L$ 不减.

证明 设两次操作主元为 $P<Q, P$ 在第 $h$ 步操作, $Q$ 在第 $h+1$ 步操作. 数列中连续四项为 $(d, P, Q, c)$ (若 $Q$ 是最后一项, 视 $c$ 为 0 ). 我们比较原操作序列和对换后的操作序列.

原先操作

$$
(d, P, Q, c) \rightarrow\left(\frac{d}{2}, \frac{P}{4}, \frac{P}{4}, \frac{Q}{2}, c\right) \rightarrow\left(\frac{d}{2}, \frac{P}{4}, \frac{P}{8}, \frac{Q}{8}, \frac{Q}{8}, \frac{c}{2}\right)
$$

$\Delta L=\frac{P}{4}+\frac{Q}{8}$, 其余不变.

现在

$$
(d, P, Q, c) \rightarrow\left(\frac{d}{2}, \frac{P}{2}, \frac{Q}{4}, \frac{Q}{4}, c\right) \rightarrow\left(\frac{d}{2}, \frac{P}{8}, \frac{P}{8}, \frac{Q}{8}, \frac{Q}{4}, \frac{c}{2}\right)
$$

$\Delta L=\frac{P}{8}+\frac{Q}{4}$, 其余不变.

这里我们为了方便, 省略了 $L$ 的下标.

由性质 1 , 第二种操作比第一种操作在第 $h+1$ 步前 $L$ 大了 $\frac{Q-P}{8} \geq \frac{P}{8}$. 下面我们来分析后续操作的改变.

我们发现, 对于两种操作的同一位置, 第一种操作仅有一个 $\frac{P}{4}$ 比第二种操作大. 然而, 在后续操作中, 这个 $\frac{P}{4}$ 产生的对 $L$ 的贡献不超过 $\frac{P}{4} \cdot L_{1} \leq \frac{P}{8}$. (重申一下, 这里 $L_{1}$ 表示对单独一个 1 进行线性展开能得到的 $L$ 最大值). 同时, 其他数在原操作序列中对 $L$ 的贡献不超过在变换后操作序列中对 $L$ 的贡献, 即操作一计数器的增加不可能超过操作二的增加 $\frac{P}{8}$.

综上, 操作二得到的 $L$ 肯定大于等于操作一的 $L$.
回到命题 1 的证明. 我们采用调整法. 设操作序列已给定, 有 $N$ 步. 从第一步开始改变原序列, 来构造所需的序列. 设第 $k$ 步以前都已经调整为严格极大的. 若第 $k$ 步已是严格极大的, 则无需调整. 否则, 考虑当时数列中所有最大的数及他们产生的数. 我们考虑它们中第一个成为主元的数.

(1) 这个数不存在. 在操作序列最后加入一次这种操作, 这时 $L$ 上升了一个小正数 $\varepsilon$, 然后按第二种情况处理.

(2) 这个数存在. 设它为 (在第 $k$ 步前) $b$, 两边为 $a, c$.

我们证明可以用性质 1 将这次操作换到第 $k$ 步且使 $L$ 不减. 由于可以利用性质 1 将这次操作向前换, 直到不满足性质 1 条件, 故不妨设在这次操作前与 $b$相邻的数刚刚进行了操作. 设这是第 $h$ 步. 我们希望将这次操作提前至 $h-1$ 步或 $h-2$ 步.

由于在第 $k$ 至 $h-1$ 步间 $b$ 没有操作过, 故可记 $B_{s}$ 为第 $s(k \leq s \leq k-1)$ 步后得到的数列中由 $b$ “产生” 的数. 记 $A_{s}, C_{s}$ 为这些数列中与 $B_{s}$ 相邻的项. 可以看到, $A_{s}, C_{s}$ 分别是由 $A_{k}, C_{k}$ 产生的.

我们考虑 $a, c$ 在第 $K$ 至 $h-1$ 步时成为了多少次主元. 我们分以下三种情况讨论:
i) $a=b=c$;

由 $b$ 定义知这不可能. 因为第 $h$ 次操作前, $A_{h-1}$ 或 $C_{h-1}$ 已经做了主元, 这与 $b$ 是第 $k$ 步数列中所有最大的数且第一个成为主元矛盾.

ii) $b>a, b>c$;

我们设在第 $k$ 至 $h-1$ 步 $a, c$ (及他们产生的、与 $b$ 相邻的元素) 分别当了 $m, n$ 次主元, 第 $h-1$ 步操作了 $a$. 则第 $h$ 步时, $B_{h-1}=2^{-m+1} b$.

在第 $k$ 至 $h-1$ 步中 $b$ 没有操作. 我们分以下两种情况讨论.

(1) 在第 $k$ 至 $h-1$ 步, $b$ 右边的所有元素没有作为主元操作.

第 $h-1$ 步前, $P=A_{h-2}=4^{-m+1} a, Q=B_{h-2}=2^{-m+1} b$, 有 $P<Q$. 故由引理 4 可以将这两次操作对换, 使 $L$ 不减.

(2) 在第 $k$ 步至第 $h-1$ 步, $b$ 右边的元素作为主元操作了.

我们取最后一次这种操作的主元 $j$. 用性质 1 把这次操作往后换, 直到第 $h-1$ 步. 容易验证这是能完成的. 若 $j$ 不与 $b$ 相邻, 则可把第 $h-1$ 次操作与第 $h$ 次互换, 这就达到了目的. 若 $j$ 与 $b$ 相邻, 我们考虑第 $h-2$ 到 $h$ 次操作. 设 $A_{h-3}=A$, 同样定义 $B, C$.

第 $h-2$ 次操作主元为 $C$, 第 $h-1$ 次为 $A$, 第 $h$ 次主元在第 $h-2$ 步为 $B$.
由性质 1 可知能把第 $h-2$ 次操作与第 $h-1$ 次操作互换, 且使 $L$ 不变.

我们先导出 $A, B, C$ 的一些关系. 由于在第 $k$ 至 $h-1$ 次操作中 $b$ 未作为主元操作,故容易验证 $\frac{b^{2}}{a c}$ 单调不减, 得

$$
\frac{B^{2}}{A C} \geq \frac{b^{2}}{a c} \geq \frac{b^{2}}{(b / 2)^{2}}=4
$$

若 $B \geq 4 A$, 则第 $h-1$ 次操作主元为 $A$, 第 $h$ 次为 $\frac{B}{2}$, 故可把这两次操作交换使 $L$ 不减.

若 $B \geq 4 C$, 则可先交换 $h-1$ 次与 $h-2$ 次, 再如上交换.

最后, 若 $B \leq 2 A, B \leq 2 C$, 则由 $\frac{B^{2}}{A C} \geq 4$ 知 $A=C=\frac{B}{2}$. 这时我们将第 $h$ 次操作换到第 $h-2$ 次. 如下:

原操作

$$
(U, A, B, C, V) \rightarrow\left(\frac{U}{2}, \frac{A}{4}, \frac{A}{4}, \frac{B}{4}, \frac{C}{4}, \frac{C}{4}, \frac{V}{2}\right) \rightarrow\left(\frac{U}{2}, \frac{A}{4}, \frac{A}{8}, \frac{B}{16}, \frac{B}{16}, \frac{C}{8}, \frac{C}{4}, \frac{V}{2}\right),
$$

$L=(A+C+B / 4) / 4=5 / 8 A$.

改变后操作

$$
\begin{aligned}
& (U, A, B, C, V) \rightarrow\left(U, \frac{A}{2}, \frac{B}{4}, \frac{B}{4}, \frac{C}{2}, V\right) \rightarrow\left(\frac{U}{2}, \frac{A}{8}, \frac{A}{8}, \frac{B}{8}, \frac{B}{8}, \frac{C}{8}, \frac{C}{8}, \frac{V}{2}\right), \\
L= & (B+A / 2+C / 2) / 4=3 / 4 A .
\end{aligned}
$$

可以看到, 两次操作的 $L$ 相差 $\frac{A}{8}$. 而之后的操作中, 改变后操作只有两个数是比原操作 (对应位置上的) 小 $\frac{1}{2}$ 的. 设原操作中这两个数产生的对 $L$ 的贡献为 $S$, 则改变后操作这两个元素产生对 $L$ 的贡献为 $\frac{S}{2}$, 两个后续操作 $\mathrm{T}$ 之差不超过 $\frac{S}{2}$. 因为

$$
S \leq\left(\frac{A}{4}+\frac{C}{4}\right) \cdot L_{1}=2 \cdot \frac{A}{4} \cdot L_{1} \leq \frac{A}{4}
$$

故知改变后操作 $L$ 不减.

iii) $b=a$ 或 $b=c$;

同理可得.

综上, 我们证明了可以把对 $b$ 的操作往前换并使 $L$ 不减. 重复这一过程直到对 $b$ 的操作成为第 $k$ 步.

不断重复以上所有步骤, 可以对任意自然数 $M$ 满足前 $M$ 次操作都是严格极大地, 且得到的新操作 $L^{\prime} \geq L$. 我们发现, 在第一次分类讨论时, 若是第 (2)类情况, 则之后的步骤仅仅是对换了操作, 并没有增加操作的总长度. 因此, 取 $M=N+1$, 则前 $M$ 步操作后数列长大于 $M$, 故必定经历过 (1), 故此时必有 $L^{\prime}=L+\varepsilon_{0}$, 其中 $\varepsilon_{0}$ 为一个正数. 那么, 在之后的调整中恒有 $L^{\prime} \geq L+\varepsilon_{0}$.
所以, 我们还需要一个引理.

引理 5. 对任意正数 $\varepsilon$, 存在 $M_{0}$ 满足对任意 $M_{0}$ 次严格极大操作序列, 所得的数列的元素和 Sum 都小于 $\varepsilon$.

我们将在下一节证明这个引理. 之后取 $M=M_{0}$, 则此时 $L^{\prime} \geq L+\varepsilon_{0}$ 且由引理 2 证明知第 $M_{0}$ 次后的操作对 $L$ 的贡献 $L_{\text {remain }} \leq \frac{1}{2} \mathrm{Sum}=\frac{\varepsilon_{0}}{2}$. 故这 $M_{0}$ 次操作得到的 $L^{\prime \prime}=L^{\prime}-L_{\mathrm{remain}} \geq L$, 即命题 1 获证.

## 4. 命题 2 的证明

考虑任意严格极大操作序列. 很明显, 每次操作的主元是不增的. 记集合 $\left\{O_{k}\right\}$ 为所有主元为 $\frac{1}{2^{k}}$ 的操作. 可以在这个严格极大操作序列最后加上某些操作, 使其恰在某个 $O_{k}$ 后停止.

引理 6. 在开始进行 $O_{k}$ 时, 数列有如下性质:

(1) 所有数为 $2^{-k}$ 或 $2^{-k-1}$,

(2) 所有 $2^{-k-1}$ 旁边都有一个 $2^{-k-1}$.

证明 对 $k$ 归纳. $k=0$ 时, 显然. 设 $k$ 时成立, 现证明 $k+1$ 时结果也成立.

由归纳假设 (1), $O_{k}$ 前所有数为 $2^{-k}$ 或 $2^{-k-1}$.

由于在 $O_{k}$ 后, 没有 $2^{-k}$ 存在 (否则将对其操作), 故所有数都至多为 $2^{-k-1}$.又由于每个 $2^{-k}$ 在 $O_{k}$ 中至多充当一次主元或两次副元, 故每个 $2^{-k}$ 都变为至少 $2^{-k-2}$. 同时, 由归纳假设 (2), 每个 $2^{-k-1}$ 至多充当了一次副元 (旁边的 $2^{-k-1}$ 不会被操作), 故每个 $2^{-k-1}$ 在 $O_{k}$ 后至少为 $2^{-k-2}$. 故 (1) 成立.

对于 (2), 我们考察每个 $2^{-k-2}$ 的来源. 若它来自一个主元, 则该主元同时产生了两个相邻的 $2^{-k-2}$, 故 (2) 成立. 若它来自一个副元, 则该副元旁边肯定有主元产生的 $2^{-k-2}$, 故 (2) 成立.

综上, 归纳假设对 $k+1$ 成立.

我们把树改变一下, 删去某些层, 只保留每个进行完 $O_{k}$ 后得到的层.

我们考察与 $O_{k}$ 相关的参数. 设在 $O_{k}$ 前有 $A_{k}$ 个 $2^{-k}, B_{k}$ 个 $2^{-k-1}$. 在 $O_{k}$ 中,有 $W_{k}$ 次操作, 有 $X_{k}$ 个 $2^{-k}$ 是一次副元 (即在 $O_{k}$ 中充当了 0 次主元, 一次副元), $Y_{k}$ 个 $2^{-k}$ 是二次副元 (即在 $O_{k}$ 中充当了 0 次主元, 两次副元), $Z_{k}$ 个 $2^{-k-1}$是一次副元. (这里 $A_{k}, B_{k}$ 不再表示它们在上节中表示的意思).

我们有如下关系:

$$
A_{K+1}=B_{k}+X_{k}-Z_{k}
$$

$$
\begin{aligned}
B_{K+1} & =Y_{k}+2 W_{k}+Z_{k} \\
A_{K} & =W_{k}+X_{k}+Y_{k} \\
2 W_{K} & =2 Y_{k}+X_{k}+Z_{k}+H_{k}
\end{aligned}
$$

最后一个式子是对副元个数算两次得到, $H_{k} \in\{0,1,2\}$ 是以最左/右边元素为主元的操作.

我们可以得到:

$$
\begin{aligned}
& A_{k}+\frac{B_{k}}{2}-\frac{A_{K+1}}{2}-\frac{B_{k+1}}{4} \\
= & W_{k}+X_{k}+Y_{k}+\frac{Z_{k}}{2}-\frac{X_{k}}{2}-\frac{Y_{k}+2 W_{k}+Z_{k}}{4} \\
= & \frac{W_{k}}{2}+\frac{X_{k}}{2}+\frac{Z_{k}}{4}+\frac{3}{8}\left(2 W_{k}-X_{k}-Z_{K}-H_{k}\right) \\
= & \frac{5}{4} W_{k}+\frac{X_{k}-Z_{k}}{8}-\frac{3 H_{k}}{8} .
\end{aligned}
$$

这时, 我们可以证明引理 5 .

引理 5 的证明 我们可以得到以下关系:

$$
\begin{aligned}
& 12 A_{k}+10 B_{k}-10 A_{K+1}-8 B_{k+1} \\
= & 12\left(W_{k}+X_{k}+Y_{k}\right)+10\left(Z_{k}-X_{k}\right)-8\left(Y_{k}+2 W_{k}+Z_{k}\right) \\
= & 2\left(Z_{k}+X_{k}\right)+4 Y_{k}-4 W_{k} \\
= & -2 H_{k} .
\end{aligned}
$$

故得

$$
\left(A_{k}+B_{k}\right)-\frac{2}{3}\left(A_{K+1}+B_{k+1}\right) \geq-\frac{1}{6} H_{k} \geq-\frac{1}{3},
$$

即

$$
A_{k}+B_{k}+1 \geq \frac{2}{3}\left(A_{K+1}+B_{k+1}+1\right)
$$

故有

$$
A_{k}+B_{k}+1 \leq\left(\frac{3}{2}\right)^{k}\left(A_{0}+B_{0}+1\right) \leq\left(\frac{3}{2}\right)^{k}(n+1)
$$

即 $O_{k}$ 前有不超过 $A_{k}+B_{k} \leq\left(\frac{3}{2}\right)^{k}(n+1)$ 个数 (由于每次操作多一个数).

取 $N=\left(\frac{3}{2}\right)^{k}(n+1)$, 则此时 $O_{k-1}$ 已经结束. 由于 Sum 单调减少, 故

$$
\text { Sum } \leq \frac{A_{k}}{2^{k}}+\frac{B_{k}}{2^{k+1}} \leq \frac{A_{k}+B_{k}}{2^{k}} \leq\left(\frac{3}{4}\right)^{k}(n+1) \text {. }
$$

故取 $k=\left[\log _{\frac{4}{3}} \frac{n+1}{\varepsilon}\right]+1$ 即得所求的 $N$.
回到命题 2 . 由于

$$
\begin{aligned}
L & =\sum_{k=0}^{\infty} \frac{W_{k}}{2^{k+2}} \\
& =\frac{1}{5} \sum_{k=0}^{\infty} \frac{1}{2^{k}}\left(A_{k}+\frac{B_{k}}{2}-\frac{A_{k+1}}{2}-\frac{B_{k+1}}{4}+\frac{Z_{k}-X_{k}}{8}+\frac{3 H_{k}}{8}\right) \\
& =\frac{1}{5}\left(A_{0}+\frac{B_{0}}{2}\right)-\frac{1}{40} \sum_{k=0}^{\infty} \frac{X_{k}-Z_{k}}{2^{k}}+\frac{3}{40} \sum_{k=0}^{\infty} \frac{H_{k}}{2^{k}} \\
& \leq \frac{n}{5}+\frac{3}{40} \sum_{k=0}^{\infty} \frac{1}{2^{k-1}}-\frac{1}{40} \sum_{k=0}^{\infty} \frac{X_{k}-Z_{k}}{2^{k}} \\
& =\frac{n}{5}+\frac{3}{10}-\frac{1}{40} \sum_{k=0}^{\infty} \frac{X_{k}-Z_{k}}{2^{k}} .
\end{aligned}
$$

故要证明 $L \leq \frac{n}{5}+\frac{3}{10}$, 只需证:

引理 7. $\sum_{k=0}^{\infty} \frac{1}{2^{k}}\left(X_{k}-Z_{k}\right) \geq 0$.

证明 由 $Z_{k}$ 意义,可知每次 “ $2^{-k-1}$ 是副元” 对应一对相邻的 $2^{-k}$ 和 $2^{-k-1}$.这次操作对 $\sum \frac{Z_{k}}{2^{k}}$ 贡献了 $\frac{1}{2^{k}}$.

考虑这对数的祖先 (两个数在树中同一层的祖先). 显然, 这对数的祖先都相邻. 我们总能追溯到一对祖先, 使这对祖先相等. 取与 $2^{-k}$ 和 $2^{-k-1}$ 最相近的一对这种祖先. 这对祖先相等, 但进行一次 $O$ (设为 $O_{l}$ ) 后就不相等了. 我们考虑这次 $O_{l}$ 时发生了什么. 有两种可能:

(1) 其中的一个数作为主元, 另一个数作为一次副元. (即 $X$ )

(2) 其中一个数作为一次副元, 另一个数没变.(即 $Z$ )

(3) 其中的一个数作为两次副元, 另一个数作为一次副元. (不可能发生)

第一种情况对 $\sum \frac{X_{k}}{2^{k}}$ 贡献了 $\frac{1}{2^{l}}>\frac{1}{2^{k}}$, 所以我们让前面讨论的对 $\sum \frac{1}{2^{k}}$ 的贡献与这次贡献对应.

第二种情况则比较复杂. 由于没变的那个数肯定为 $\frac{1}{2^{l+1}}$, 所以变了的数也为 $\frac{1}{2^{l+1}}$. 由于变了的数为副元, 故它另一侧的数在 $O_{l}$ 前为 $\frac{1}{2^{l}}$.

现在我们从相邻数对 $\frac{1}{2^{l}}$ 和 $\frac{1}{2^{l-1}}$ 继续向上追溯, 又到达一对相等的祖先, 它们满足 (1) 或 (2) ... 不断重复这一过程直到到达一对满足 (1) 的相等祖先, 这对祖先为 $\sum \frac{X_{k}}{2^{k}}$ 做了贡献. 我们让前面讨论的对 $\sum \frac{Z_{k}}{2^{k}}$ 的贡献与这次贡献对应.

我们只需说明一点: 对每次 (1), 与之对应的 $\sum \frac{Z_{k}}{2^{k}}$ 的贡献小于等于它本身对 $\sum \frac{X_{k}}{2^{k}}$ 的贡献.

设这次 (1) 发生在 $O_{t}$. 我们证明, 对每个 $O_{l}(l \leq t+1)$, 至多有一次发生在
$O_{l}$ 的对 $\sum \frac{Z_{k}}{2^{k}}$ 的贡献与之对应.

只需证明, 对任意两对在同一层的相邻数, 它们向上追溯一层后也不会重合. 设这两对数为 $(a, b)$ 和 $(c, d)$, 其中 $a \neq b, c \neq d,(a, b)$ 在 $(c, d)$ 左边. 若它们追溯到了同一对数 $(e, f)$, 因为追溯不改变原先元素的左右为直系 $($ 如 $(p, q)$ 追溯到了 $(r, s)$, 则一定有 $p$ 追溯到了 $r, q$ 追溯到了 $s)$, 所以我们有 $a$ 和 $c$ 追溯到了 $e, b$ 和 $d$ 追溯到了 $f$. 但这是不可能的, 因为若 $e$ 产生了 $a$ 和 $c$, 则由 $b$ 在 $a$ 和 $c$中间可知 $b$ 也是由 $e$ 产生的, 这与 $b$ 和 $d$ 追溯到了 $f$ 矛盾.

综上, 对每个 $O_{l}(l \leq t+1)$, 至多有一次发生在 $O_{l}$ 的对 $\sum \frac{Z_{k}}{2^{k}}$ 的贡献与之对应. 立刻知道, 与这次 (1) 对应的贡献不超过: $\sum_{i=t+1}^{\infty} \frac{1}{2^{i}}=\frac{1}{2^{t}}>\frac{1}{2^{l}}$.

结合 $(1),(2)$ 两种情况可知, $\sum_{k=0}^{\infty} \frac{1}{2^{k}}\left(X_{k}-Z_{k}\right) \geq 0$.

故有 $L \leq \frac{n}{5}+\frac{3}{10}$, 对严格极大操作序列成立.

以上讨论表明, 对 $n$ 边形的任意线性展开有如下结论:

结论 $1 . L \leq \frac{n}{5}+\frac{3}{10}$.

我们知道, 有以下两个不等式成立:

$$
S_{2 n} \geq 2 S_{n}, S_{n} \leq \frac{n}{5}+\frac{3}{10}
$$

对任意正整数 $n, a$, 有:

$$
\frac{3}{10}+2^{a} \cdot \frac{n}{5} \geq S_{2^{a} n} \geq 2^{a} S_{n}
$$

由 $a$ 任意性, 立即得到

定理 2. $S_{n} \leq \frac{1}{5} n$, 且常数在渐进意义下最优.

## III. 几个注记

## 1. 最优性

对于 $2^{a}$ 边形, 每次间隔地取做主元, 对它们操作, 这样长为 $2 k$ 的序列变为了长为 $3 k$, 所有数变为了原来的 $\frac{1}{4}$, 且计数器 $T$ 增加了 $\frac{1}{5} \operatorname{Sum}$ (Sum 减小了 $\frac{5}{8}$ ).在 $a$ 批这种操作后, 序列长 $3^{a}$, 每个数变为了 $\frac{1}{4^{a}}$. 故取极限, 知 $\frac{1}{5}$ 在渐进意义下最优.

## 2. 为什么要用线性展开

在研究的大部分时间, 我都是在考虑环形展开. 但是后来发现, 在环形展开中无法交换最大元两边数的操作次序. 在这点上, 线性展开有极大的优势: 最大
数将数列分成了不相连的两部分.

3. 遗留的问题

i). 特别的, 对 $n=6$ 时的最优上界是多少? 知道这个上界不太可能是 $\frac{1}{5}$, 但不知道精确值 (由 MATLAB 模拟可知这个值大于 0.194).

ii). 对于其他的初始数列结论如何? 可以肯定命题 1 成立, 但命题 2 却不成立 (特别的, 引理 7 不成立, 因为可能回溯到初始就相等的一对数).

## IV．致谢

感谢王广廷、冯跃峰、冷岗松、牟晓生、席东盟、吴尉迟、施柯杰等老师在论文修改过程中给出的意见和建议.

