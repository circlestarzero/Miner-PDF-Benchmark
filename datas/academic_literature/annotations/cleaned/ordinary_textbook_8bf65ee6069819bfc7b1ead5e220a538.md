$$
\text { 数学新星网 } \% \text { 冯跃峰专栏 }
$$

# “ $n$ ”需要不小于 100 吗 

## — 2021 年 IMO 第一题思路分析

冯跃峰

今年 IMO 的第一题是一道非常 “人性化” 的题目 (也就是人们通常所说的“送分题”), 作为大考的首题, 让选手从容易入手, 可使其平复紧张的情绪, 正常发挥能力水平. 题目如下:

【原题】给定整数 $n \geq 100$, 伊凡把 $n, n+1, \cdots, 2 n$ 中每个数写在不同的卡片上, 然后将这 $n+1$ 张卡片打乱顺序并分成两堆. 试证: 至少有一堆中包含两张卡片, 使得这两张卡片上的数之和是一个完全平方数.

通过分析,我们发现, 其中未必要求 “ $n \geq 100$ ”, 可优化为 “ $n \geq 99$ ”, 但 $n=98$时结论不成立. 也就是说, 题目可改成如下形式:

【改编题】试证：对给定整数 $n \geq 99$, 将 $n+1$ 个正整数 $n, n+1, \cdots, 2 n$任意分成两组, 必有一组包含两个数, 其和是完全平方数. 但 $n=98$ 时结论不成立。

【题感】从目标看, 本题属于 “存在性” 问题. 要证明有一组包含两个数, 具有特定的性质：其和是完全平方数.

这有明显的抽屉原理背景, 构造“特定性质”抽屉即可: 同一抽屉中的任何两个数的和为平方数.

但仔细一想, 问题没那么简单, 因为题中 “抽屉” 的个数是确定的: $n+1$ 个数任意分成两堆, 每一组为一个抽屉.

由此想到换一种维度思考: 只需在区间 $[n, 2 n]$ 中找到 3 个元素 $a, b, c$, 使其中任何两个数的和为平方数.

如何找到这样的 3 个数? 由于 $n$ 是不确定的, 可从特例开始, 寻找规律.

【换维思考】更改策略: 找到 3 个数, 其中任何 2 个数的和为平方数.

修订日期: 2021-07-25.
【研究特例】取 $n=99$, 则相应区间为 [99, 198].

此区间有 100 个数, 仍然很复杂.

尽管题中限定 $n \geq 99$, 但并不能阻止我们对较小的 “ $n$ ”进行研究, 从中发现规律, 最终看出 “ $n \geq 99$ ” 的实际意义.

为直观起见, 用点表示数, 如果两数的和为平方数, 则将对应的点连边, 从而问题变成寻找长为 3 的圈.

【更换参数】依次考察自然数 $0,1,2,3, \cdots$ 构成的图, 发现如下的一些边:

$$
\begin{aligned}
& 1^{2}: 0 \sim 1, \\
& 2^{2}: 0 \sim 4,1 \sim 3, \\
& 3^{2}: 0 \sim 9,1 \sim 8,2 \sim 7,3 \sim 6,4 \sim 5, \\
& 4^{2}: 0 \sim 16,1 \sim 15,2 \sim 14,3 \sim 13,4 \sim 12, \\
& 5^{2}: 0 \sim 25,1 \sim 24,2 \sim 23,3 \sim 22,4 \sim 21,5 \sim 20,6 \sim 19,7 \sim 18,
\end{aligned}
$$

$$
8 \sim 17,9 \sim 16,10 \sim 15,11 \sim 14,12 \sim 13 .
$$

至此, 发现一个 3 -圈: $(0,9,16)$.

若直接画一个图, 则更一目了然.



这个圈有何特点? 一个显然的特点是 3 个数本身都是平方数. 但这个特点是难以迁移的: 要使任两数和为平方数, 则要求任两平方数在同一个勾股组中,这是很难实现的.

考察圈中任何两个数的和: $0+9=3^{2}, 0+16=4^{2}, 9+16=5^{2}$, 发现每两数和是 3 个连续平方数.

【特征迁移】一般地, 我们期望有 3 -圈 $(a, b, c)$, 使

$$
a+b=(m-1)^{2}, a+c=m^{2}, b+c=(m+1)^{2} .
$$

三式相加, 得 $2(a+b+c)=3 m^{2}+2$, 所以 $m$ 为偶数. 令 $m=2 k$, 则

$$
a+b=(2 k-1)^{2}, a+c=4 k^{2}, b+c=(2 k+1)^{2}, a+b+c=6 k^{2}+1 \text {. }
$$

解得

$$
a=2 k^{2}-4 k, b=2 k^{2}+1, c=2 k^{2}+4 k \text {. }
$$

【待定参数】现在确定 $k$ 的取值, 使 $a, b, c \in[n, 2 n]$.

令 $2 k^{2}-4 k \geq n, 2 k^{2}+4 k \leq 2 n$.

下面证明, 当 $n \geq 99$ 时(此时才发现该条件的意义), 上述关于 $k$ 的不等式组有正整数解.

由于 $k$ 要同时满足两个条件,可采用“拟对象逼近”策略: 先满足其中一个条件, 然后优化到满足另一个条件.

【拟对象逼近】考察满足 “ $2 k^{2}+4 k \leq 2 n$ ” 的整数 $k$, 期望其中有一个 $k$, 还满足 $2 k^{2}-4 k \geq n$.

怎样找到这样的 $k$ ? 这自然是 $k$ “越大越好”, 想到取极端.

【考察极端】取最大的整数 $k$, 使 $k^{2}+2 k \leq n$, 由 $k$ 的“最大性”, 有

$$
(k+1)^{2}+2(k+1)>n .
$$

我们只需证明对这样取定的 $k$, 有 $2 k^{2}-4 k \geq n$.

为了利用 $n<(k+1)^{2}+2(k+1)$, 采用“差比放缩法”.

$$
\begin{aligned}
n-\left(2 k^{2}-4 k\right) & <\left[(k+1)^{2}+2(k+1)\right]-\left(2 k^{2}-4 k\right) \\
& =-k^{2}+8 k+3 \\
& =-(k-4)^{2}+19 .
\end{aligned}
$$

要使 $-(k-4)^{2}+19 \leq 0$, 只需 $k \geq 9$, 这由 $(k+1)^{2}+2(k+1)>n \geq 99$ 保证, 命题获证.

【构造反例】当 $n=98$ 时, 构造的思路是很简单的, 因为 $[98,196]$ 中两数的和只可能是 $225,256,289,324,361$, 令其和为五者之一的两数分属两个不同集合即可.

但具体构造过程并不简单, 我们最初的构造就出现漏洞.

为了呈现构造的规律, 我们将每个集合分解为若干等差数列的并. 此外, 为了使构造简单, 希望每个等差数列尽可能长, 且公差尽可能小.

【以简驭繁】最简单的整数等差数列的公差为 1 , 可取 “最长” 的连续自然数序列:

$$
98,99, \cdots, 112 \in A
$$

则由平方数 225, 可知

$$
113,114, \cdots, 127 \in B
$$

如此下去, 得到一种构造:

$$
\begin{aligned}
& A=\{98,99, \cdots, 112\} \cup\{128,129, \cdots, 144\} \cup\{162,163, \cdots, 176\} \\
& B=\{113,114, \cdots, 127\} \cup\{145,146, \cdots, 161\} \cup\{177,178, \cdots, 196\}
\end{aligned}
$$

但这个构造有漏洞, 比如: $A$ 中有 $112+144=256$ 等等.

【改进】再尝试公差为 2 的等差数列: 取“最长”的等差数列:

$$
98,100, \cdots, 128 \in A \text {. }
$$

因为 $225-98=127,225-128=97$, 所以必有等差数列:

$$
99,101, \cdots, 127 \in B \text {. }
$$

同样, $256-98=158,256-128=128$, 所以必有等差数列:

$$
130,132, \cdots, 158 \in B \text {. }
$$

又 $289-98=191,289-128=161$, 所以必有等差数列:

$$
161,163, \cdots, 191 \in B
$$

但其中 $161+163=182$, 想到将序列的“首项” 161 调入 $A$, 这样, 又必须将以前属于 $A$ 的 128 调入 $B(161+128=172)$.

至此,

$$
A \supseteq(\{98,100, \cdots, 126\} \cup\{161\}) .
$$

前面的过程都需作相应的修改:

因为 $225-98=127,225-126=99$, 所以必有等差数列:

$$
\text { 99, 101, } \cdots, 127 \in B \text {. }
$$

同样, $256-98=158,256-126=130$, 所以必有等差数列:

$$
130,132, \cdots, 158 \in B .
$$

又 $289-98=191,289-126=163$, 所以必有等差数列:

$$
163,165, \cdots, 191 \in B
$$

此外, 前面已调入 $128 \in B$.

所以,

$B \supseteq(\{99,101, \cdots, 127\} \cup\{128,130,132, \cdots, 158\} \cup\{163,165, \cdots, 191\})$.
【局部扩展】现在, 让每个等差数列尽可能延长, 第一个无法延长, 因为 $127+129=256$.

第二个可加入 $160(162$ 不能加入: $127+162=289)$; 第三个可加入 193,195 .由此, 得到如下构造:

$$
\begin{aligned}
& A=\{98,100, \cdots, 126\} \cup\{129,131, \cdots, 161\} \cup\{162,164, \cdots, 196\}, \\
& B=\{99,101, \cdots, 127\} \cup\{128,130, \cdots, 160\} \cup\{163,165, \cdots, 195\} .
\end{aligned}
$$

穷举检验可知, $A, B$ 中都没有其和为平方数的两个数, 故 $n=98$ 时结论不成立.

【注】该构造由杨丕业老师通过电脑编程给出, 特此致谢! 以上是我们还原的探索过程.

【新写】对给定的正整数 $n(n \geq 99)$, 存在唯一的正整数 $k$, 使

$$
k^{2}+2 k \leq n<(k+1)^{2}+2(k+1) .
$$

对这样的 $k$, 由

$$
(k+1)^{2}+2(k+1)>n \geq 99
$$

有 $k \geq 9$. 于是,

$$
\begin{aligned}
n-\left(2 k^{2}-4 k\right) & <\left[(k+1)^{2}+2(k+1)\right]-\left(2 k^{2}-4 k\right) \\
& =-k^{2}+8 k+3 \\
& =-(k-4)^{2}+19 \\
& \leq-52+19<0 .
\end{aligned}
$$

令

$$
a=2 k^{2}-4 k, b=2 k^{2}+1, c=2 k^{2}+4 k,
$$

则 $a, b, c \in[n, 2 n]$, 且

$$
a+b=(2 k-1)^{2}, a+c=4 k^{2}, b+c=(2 k+1)^{2} \text {. }
$$

依题意, $a, b, c$ 被分成 2 组, 必定有一组含有其中 2 个数, 这两个数的和为平方数.

$$
n=98 \text { 时, 反例如下: }
$$

令

$$
\begin{aligned}
& A=\{98,100, \cdots, 126\} \cup\{129,131, \cdots, 161\} \cup\{162,164, \cdots, 196\}, \\
& B=\{99,101, \cdots, 127\} \cup\{128,130, \cdots, 160\} \cup\{163,165, \cdots, 195\},
\end{aligned}
$$

则 $A, B$ 中都没有其和为平方数的两个数.

综上所述, 命题获证.

【致谢】感谢㫿振华教授仔细审阅全稿, 并修正文中疏漏.

