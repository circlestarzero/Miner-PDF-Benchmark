# Szemerédi-Trotter 定理与多项式方法 

张瑞祥

说到平面上的组合几何, 你可能很容易想到它的两个最基本的元素一点和直线. 然而你也许不知道, 点和直线的关系中可以挖掘出一个很深刻的定理, 这就是我们今天要介绍的 Szemerédi-Trotter 定理.

定理 1 (Szemerédi-Trotter). 平面上有有限点集 $P$ 和有限直线集 $L$, 若 $p \in P$ 在 $l \in L$ 上, 就称 $(p, l)$ 是一个 “关联”, 所有关联的集合记为 $I(P, L)$. 则存在与 $P, L$ 无关的常数 $C$, 使得

$$
|I(P, L)| \leq C\left(|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}+|P|+|L|\right) .
$$

(1) 式是非常不平凡的. 根据乘法原理, 关联总数 $|I(P, L)| \leq|P||L|$. 但稍一想我们便知 $|P||L|$ 是达不到的：两点只能同在一条直线上! 当 $|P|$ 与 $|L|$ 相近时, (1) 式右边是 $|P|^{\frac{4}{3}}$ 量级, 比我们的 “平凡估计” $|P|^{2}$ 量级省了很多.

我们介绍定理 1 的一个证明. 这个证明中有一个十分有趣的方法, 它就是在当代关联几何领域大放异彩的 “多项式方法” . 这里说的关联几何, 是组合几何的一个重要分支. 它重点研究点、线等基本几何元素的 “关联度” 最好能是什么样子. 不难看出, 定理 1 给出了任意多个点与任意多条线的 “关联度”的一个非平凡上界.

现在我们设法证明定理 1 . 对于 $I(P, L)$, 我们能说些什么呢? 如果 $l \in L$ 过 $P$ 中 $p_{l} \geq 2$ 个点, 则 $L$ 上的点对至少有 $\left(\begin{array}{c}p_{l} \\ 2\end{array}\right) \geq p_{l}$ 个. 如果 $l$ 只过 $P$ 中至多一个点, 则所有这样的 $l$ 产生的关联数至多为 $|L|$. 由于总的点对数只有 $\left(\begin{array}{c}|P| \\ 2\end{array}\right)<|P|^{2}$,我们可得“平凡估计”：

$$
|I(P, L)| \leq|P|^{2}+|L| .
$$

对偶地, 我们可由 “两条线至多交于一点” 得

$$
|I(P, L)| \leq|L|^{2}+|P| .
$$

但 (2) 与 (3) 离 (1) 还相去甚远. 这时, 就该我们的多项式方法出场了. 说起多项式方法, 其实大家对其精神也许并不陌生, 这个方法的核心只有两步:

1). 构造一个多项式;

$2)$. 利用多项式来研究原问题.

如果大家还记得 2007 年 IMO 第 6 题, 那里便是用的这种方法.

用多项式方法来解决定理 1 的好处在于: 如下 Stone-Tukey 定理保证了我们可以很有效地用多项式的零点集对平面进行分割.

定理 2 (Stone-Tukey). 对平面上任意点集 $P$ 和任意正整数 $d$, 存在一个次数不超过 $d$ 的非零多项式 $Q$, 使得 $Q$ 的零点集至多将平面分割成 $C d^{2}$ 部分,每部分内部 (不含边界) 至多有 $C \left\lvert\, \frac{|P|}{d^{2}}\right.$ 个点. 其中 $C$ 是一个与 $P, d$ 无关的常数.

注 定理 2 的证明超出了初等数学的范围, 我们在此承认它.

定理 2 告诉我们, 一个 $d$ 次的多项式的零点集可以把任意一个平面点集均匀分成大约 $d^{2}$ 份. 实践证明, 这是一个非常有效的划分!

利用定理 2 , 我们来证明定理 1.

定理 1 的证明 我们对 $|L|$ 归纳证明:

$$
|I(P, L)| \leq C_{0}\left(|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}+|P|+|L|\right)
$$

这里 $C_{0}$ 是一个待定的常数.

当 $|L|=1$ 时, $|I(P, L)| \leq|P|$, 因此只要 $C_{0} \geq 1$, (4) 就成立.

假设 (4) 对 $|L|<t(t \geq 2)$ 成立. 现考虑 $|L|=t$ 的情形.

如果 $|L| \geq \frac{|P|^{2}}{1000}$, 则由 (2) 得

$$
|I(P, L)| \leq 1001|L|
$$

故只要 $C_{0}>1001,(4)$ 便成立.

以下假设 $|L|<\frac{|P|^{2}}{1000}$, 同理可设 $|P|<\frac{|L|^{2}}{1000}$.

令 $d$ 是一个待定的正整数, 由定理 2 , 存在常数 $C_{1}$ 和多项式 $Q$ 使得 $\operatorname{deg} Q \leq d$, 且 $Q$ 的零点集 $Z(Q)$ 将平面至多分成 $C_{1} d^{2}$ 部分, 每部分内部至多有 $C_{1} \frac{|P|}{d^{2}}$ 个点.

对任意 $l \in L, Q$ 限制在 $l$ 上是一个单变量的多项式, 则若它不等于 0 , 其至多有 $\operatorname{deg} Q \leq d$ 个根. 因此, $l$ 至多与以上说的至多分成的 $C_{1} d^{2}$ 部分中的 $d+1 \leq 2 d$ 个部分的内部相交. 注意在这里我们得到了一个很不平凡的界, 任一条直线只能与 $d^{2}$ (量级) 个部分中的 $d$ (量级) 个部分相交!

记 $Z(Q)$ 把平面切成的部分 (内部, 不含边界) 分别为 $S_{1}, \cdots, S_{k}, k \leq C_{1} d^{2}$.
对 $1 \leq i \leq k$, 设有 $l_{i}$ 条线与 $S_{i}$ 的内部相交, 则由以上讨论知,

$$
\sum_{i=1}^{k} l_{i} \leq 2 d|L|
$$

对于 $I(P, L)$ 中的关联 $(p, l)$, 我们将它们分成 3 类: 记所有满足 $l \nsubseteq$ $Z(Q), p \notin Z(Q)$ 的 $(p, l)$ 形成集合 $I_{1}(P, L)$; 所有满足 $l \nsubseteq Z(Q), p \in Z(Q)$ 的 $(p, l)$ 形成集合 $I_{2}(P, L)$; 而所有满足 $l \subseteq Z(Q)$ 的 $(p, l)$ 形成集合 $I_{3}(P, L)$. 我们对三者逐一估计.

对任意 $(p, l) \in I_{1}(P, L), p$ 一定落在某个 $S_{i}$ 的内部, 因此 $l$ 也一定穿过 $S_{i}$内部. 故结合 $(2)$ 和 (5), 得

$$
\begin{aligned}
\left|I_{1}(P, L)\right| & \leq \sum_{i}\left(S_{i} \text { 内部的关联数 }\right) \\
& \leq \sum_{i}\left(\left(S_{i} \text { 内部的点数 }\right)^{2}+l_{i}\right) \\
& \leq \sum_{i}\left(\left(C_{1} \frac{|P|}{d^{2}}\right)^{2}+l_{i}\right) \\
& \leq C_{1}^{3} \frac{|P|^{2}}{d^{2}}+2 d|L| .
\end{aligned}
$$

对任意 $(p, l) \in I_{2}(P, L), p$ 一定在 $Z(Q)$ 上, 但 $l$ 与 $Z(Q)$ 至多有 $d$ 个交点,故

$$
\left|I_{2}(P, L)\right| \leq d|L|
$$

对任意 $(p, l) \in I_{3}(P, L), l$ 一定在 $Z(Q)$ 上, 这意味着满足对任意 $p \in l$, $f_{l}(p)=0$ 的一次多项式 $f_{l}$ 整除 $Q$. 但 $Q$ 至多有 $d$ 个不同的一次因子,则所有这种直线 $l$ 至多有 $d$ 个. 如果我们在选取 $d$ 时, 令 $d \leq \frac{|L|}{2}$, 则由归纳假设,

$$
\left|I_{3}(P, L)\right| \leq C_{0}\left(\frac{|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}}{2^{\frac{2}{3}}}+|P|+|L|\right) .
$$

综合 (6), (7), (8) 知, 只要 $d \leq \frac{|L|}{2}$ 就有

$$
|I(P, L)| \leq C_{1}^{3} \frac{|P|^{2}}{d^{2}}+3 d|L|+\frac{C_{0}}{2^{\frac{2}{3}}}|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}+C_{0}|P|+C_{0}|L|
$$

我们试图令 (9) 中前两项尽量接近, 则可取

$$
d=\left\lfloor\frac{|P|^{\frac{2}{3}}|L|^{-\frac{1}{3}}}{100}\right\rfloor+1
$$

由假设 $|L|<\frac{|P|^{2}}{1000}$ 知，

$$
d \leq \frac{|P|^{\frac{2}{3}}|L|^{-\frac{1}{3}}}{50}
$$

由 $|P|<\frac{|L|^{2}}{1000}$ 知,

$$
d \leq \frac{|P|^{\frac{2}{3}}|L|^{-\frac{1}{3}}}{50} \leq \frac{|L|}{2}
$$

因此 (9) 成立. 故

$$
|I(P, L)| \leq 10000 C_{1}^{3}|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}+\frac{3}{50}|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}+\frac{C_{0}}{2^{\frac{2}{3}}}|P|^{\frac{2}{3}}|L|^{\frac{2}{3}}+C_{0}|P|+C_{0}|L| .
$$

因此只要令 $C_{0}>10000 C_{1}^{3}+\frac{3}{50}+\frac{C_{0}}{2^{\frac{2}{3}}}$ 便可完成归纳.

这种 “分而治之” 的本领, 是多项式方法的一大优势和特色, 也奠定了它在现代关联几何学中基石的地位.

定理 1 还有一个用图嵌入平面的交叉数的上界的证明. 知道我们提到的这个定理的同学不妨自己想一想.

