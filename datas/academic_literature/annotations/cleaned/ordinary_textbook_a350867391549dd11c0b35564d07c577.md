数学新星网 $\%$ 学生专栏

www.nsmath.cn/xszl

# 2023 年美国国家队选拔考试解答与评注 

唐自远

(长沙市雅礼中学, 410007)

指导教师: 彭喜

2023 年美国国家队选拔考试共有 6 道题, 题目风格新颖有趣, 整体难度较大, 其中第 $1,2,4$ 题为中等偏易的问题, 第 5 题为中等偏难的问题, 第 3,6 题为难题, 是备战冬令营及以上赛事的很好的训练题. 直于水平, 本文如有不妥之处,敬请指正.

## I. 试 题

1. 在周长为 2022 的圆 $\Gamma$ 上等距离地分布着 2022 个点, 将它们按某种顺序标记为 $A_{1}, A_{2}, \cdots, A_{2022}$. 初始时, 一只兔子在点 $A_{1}$ 处, 它沿着圆 $\Gamma$ 从点 $A_{1}$ 跳到点 $A_{2}$, 接着从点 $A_{2}$ 跳到点 $A_{3}$, 直至跳到点 $A_{2022}$, 再跳回点 $A_{1}$. 当从点 $P$ 跳到点 $Q$ 时, 兔子总是沿着圆 $\Gamma$ 上较短的一段弧 $\overparen{P Q}$; 如果 $P Q$ 是圆 $\Gamma$ 的直径,则兔子可以沿着任意一个半圆. 对于所有标记 2022 个点的方式, 求兔子跳过的 2022 段弧的长度之和的最大值.
2. 如图, 在锐角 $\triangle A B C$ 中, $M$ 是 $B C$ 的中点, $B E, C F$ 是高, 设 $K$ 是 $\triangle B M E, \triangle C M F$ 外接圆两条外公切线的交点. 若 $K$ 在 $\triangle A B C$ 外接圆上. 求证: $A K \perp B C$.



修订日期: 2023-04-12.

3. 设函数 $f, g: \mathbb{N} \rightarrow \mathbb{N}$ 满足:

(1) $f(0) \geq f(1) \geq \cdots \geq f(300) \geq 0$;

(2) $f(0)+f(1)+\cdots+f(300) \leq 300$;

(3) 对任意 20 个非负整数 $n_{1}, n_{2}, \cdots, n_{20}$ (不必不同), 都有

$$
g\left(n_{1}+n_{2}+\cdots+n_{20}\right) \leq f\left(n_{1}\right)+f\left(n_{2}\right)+\cdots+f\left(n_{20}\right) .
$$

求 $g(0)+g(1)+\cdots+g(6000)$ 的最大可能值.

4. 对非负整数 $a, b$, 定义位异或运算 $a \oplus b$, 是唯一的非负整数, 使得对每个非负整数 $k$,

$$
\left[\frac{a}{2^{k}}\right]+\left[\frac{b}{2^{k}}\right]-\left[\frac{a \oplus b}{2^{k}}\right]
$$

都是偶数. 求所有正整数 $a$, 使得对任意整数 $x>y \geq 0$, 都有

$$
x \oplus a x \neq y \oplus a y .
$$

5. 给定正整数 $m, n$, 甲乙两人在无穷大的方格表中玩游戏, 甲先秘密地在每个格中写上一个实数, 使得每个 $m \times n$ 和 $n \times m$ 矩形中所写数之和为零. 乙每次询问甲一个格中所写的数, 甲如实回答, 如果某一时刻乙能确定每个格中所写的数, 则乙获胜; 否则甲获胜.

求使乙能获胜的最少的询问次数, 或证明有限次询问不能使乙获胜.

6. 设函数 $f: \mathbb{N}^{+} \rightarrow \mathbb{N}^{+}$, 对任意 $m, n \in \mathbb{N}_{+}$, 定义

$$
\Delta(m, n)=\underbrace{f(f(\cdots f}_{f(n) \text { 次 }}(m) \cdots))-\underbrace{f(f(\cdots f}_{f(m) \text { 次 }}(n) \cdots))
$$

已知对任意不同的 $m, n \in \mathbb{N}$, 均有 $\Delta(m, n) \neq 0$.

求证: $\Delta$ 无界, 即对任意常数 $C$, 存在 $m, n \in \mathbb{N}_{+}$, 满足 $|\Delta(m, n)|>C$.

## II. 解答与评注

题 1 在周长为 2022 的圆 $\Gamma$ 上等距离地分布着 2022 个点, 将它们按某种顺序标记为 $A_{1}, A_{2}, \cdots, A_{2022}$. 初始时,一只兔子在点 $A_{1}$ 处, 它沿着圆 $\Gamma$ 从点 $A_{1}$跳到点 $A_{2}$, 接着从点 $A_{2}$ 跳到点 $A_{3}$, 直至跳到点 $A_{2022}$, 再跳回点 $A_{1}$. 当从点 $P$跳到点 $Q$ 时, 兔子总是沿着圆 $\Gamma$ 上较短的一段弧 $\widehat{P Q}$; 如果 $P Q$ 是圆 $\Gamma$ 的直径,则兔子可以沿着任意一个半圆. 对于所有标记 2022 个点的方式, 求兔子跳过的 2022 段弧的长度之和的最大值.

解 弧长的长度之和最大值为 2042222 .
将圆上 2022 个点顺次标记为 $1,2, \cdots, 2022$. 一方面, 令

$$
A_{1}=1, A_{2}=1012, A_{3}=2, A_{4}=1013, \cdots, A_{2021}=1011, A_{2022}=2022
$$

可知弧长总和为

$$
1011^{2}+1010^{2}+1=2042222 \text {. }
$$

另一方面, 记 $\ell\left(A_{i}, A_{i+1}\right)$ 为圆上较短的弧 $\widehat{A_{i} A_{i+1}}$ 的长度. (下标按模 2022 理解), 则容易证明

$$
\ell\left(A_{i}, A_{i+2}\right)+\ell\left(A_{i}, A_{i+1}\right)+\ell\left(A_{i+1}, A_{i+2}\right) \leq 2022 .
$$

因此

$$
\begin{aligned}
S & =\sum_{i=1}^{2022} \ell\left(A_{i}, A_{i+1}\right)=\sum_{i=1}^{1011}\left(\ell\left(A_{2 i-1}, A_{2 i}\right)+\ell\left(A_{2 i}, A_{2 i+1}\right)\right) \\
& \leq 1011 \times 2022-\sum_{i=1}^{1011} \ell\left(A_{2 i-1}, A_{2 i+1}\right) .
\end{aligned}
$$

于是只需证明

$$
\sum_{i=1}^{1011} \ell\left(A_{2 i-1}, A_{2 i+1}\right) \geq 2020
$$

若存在三点 $A_{2 i-1}, A_{2 j-1}, A_{2 k-1}$ 构成非钝角三角形, 那么易证

$$
\begin{aligned}
\sum_{i=1}^{1011} \ell\left(A_{2 i-1}, A_{2 i+1}\right) & \geq \ell\left(A_{2 i-1}, A_{2 j-1}\right)+\ell\left(A_{2 j-1}, A_{2 k-1}\right)+\ell\left(A_{2 k-1}, A_{2 i-1}\right) \\
& \geq 2022
\end{aligned}
$$

若不存在这样三点, 则 $A_{1}, A_{3}, \cdots, A_{2021}$ 为圆上连续的 1011 个点. 故存在两点 $A_{2 i-1}, A_{2 j-1}$ 使

$$
\ell\left(A_{2 i-1}, A_{2 j-1}\right)=1010 .
$$

因此易证

$$
\sum_{i=1}^{1011} \ell\left(A_{2 i-1}, A_{2 i+1}\right) \geq 2 \ell\left(A_{2 i-1}, A_{2 j-1}\right)=2020 \text {. }
$$

故总有

$$
\sum_{i=1}^{1011} \ell\left(A_{2 i-1}, A_{2 i+1}\right) \geq 2020
$$

亦即 $S \leq 2042222$.

综上, 弧长总和最大值为 2042222.

评注 中档偏易的问题, 关键在于用 $\widehat{A_{i} A_{i+2}}$ 联系 $\widehat{A_{i} A_{i+1}}$ 与 $\widehat{A_{i+1} A_{i+2}}$. 做此题时可能会误入歧途, 去讨论 $A_{i}, A_{i+1}, A_{i+2}$ 的一些位置关系(如角度) 等, 但经过一段时间的思考就不难发现, 从“反面”入手才是真正解决问题的途径.
题 2 如图, 在锐角 $\triangle A B C$ 中, $M$ 是 $B C$ 的中点, $B E, C F$ 是高, 设 $K$ 是 $\triangle B M E, \triangle C M F$ 外接圆两条外公切线的交点. 若 $K$ 在 $\triangle A B C$ 外接圆上. 求证: $A K \perp B C$.



证明 设 $B C$ 为直径的圆为反演基圆反演, 记 $M$ 为 $B C$ 中点, $K^{\prime} \rightleftharpoons K$ 为一组互反点. 则在反演下, 有

$$
\odot(B M E) \rightleftharpoons B E, \odot(C M F) \rightleftharpoons C H .
$$

记 $\odot(B M E), \odot(C M F)$ 两条公切线为 $\ell_{1}, \ell_{2}$.

由反演保角性, $\ell_{1}, \ell_{2}$ 的反演像以 $B H, C H$ 为两条外公切线. 易知 $\ell_{1}, \ell_{2}$ 反演像的交点为 $M, K^{\prime}$. 由对称性,

$$
\angle B H M=\angle C H K^{\prime} .
$$

又

$$
\angle B K^{\prime} C=\angle K B C+\angle K C B=\pi-\angle B H C,
$$

故 $B, H, C, K^{\prime}$ 共圆, 于是 $B H C K^{\prime}$ 为调和四边形.

熟知 $\angle H M C=\angle K^{\prime} M C, \triangle B H M \sim K^{\prime} B M$, 作 $H$ 关于 $B C$ 对称点 $K_{0}$. 则有

$$
B M^{2}=M H \cdot M K^{\prime}=M K_{0} \cdot M K^{\prime}=M K \cdot M K^{\prime} .
$$

结合 $\angle H M C=\angle K^{\prime} M C$. 有 $K=K_{0}$. 故 $A K \perp B C$. 证毕.

评注 中档难度的几何题, 遇到两圆交于中点这样的几何构型, 将它们反演为直线是很自然的想法. 本题还有很多种证法, 如观察到 $\odot(B M E), \odot(C M F)$, $\odot(A B C)$ 交于同一点 $Q$, 去证明 $B, K, C, Q$ 为调和四边形, 等等. 也可以直接用复数法证明.
题 3 设函数 $f, g: \mathbb{N} \rightarrow \mathbb{N}$ 满足:

(1) $f(0) \geq f(1) \geq \cdots \geq f(300) \geq 0$;

(2) $f(0)+f(1)+\cdots+f(300) \leq 300$;

(3) 对任意 20 个非负整数 $n_{1}, n_{2}, \cdots, n_{20}$ (不必不同), 都有

$$
g\left(n_{1}+n_{2}+\cdots+n_{20}\right) \leq f\left(n_{1}\right)+f\left(n_{2}\right)+\cdots+f\left(n_{20}\right) .
$$

求 $g(0)+g(1)+\cdots+g(6000)$ 的最大可能值.

解 所求最大可能值为 115440 .

一方面, 取 $f(i)=\max \{24-i, 0\}, g(i)=\max \{480-i, 0\}$, 可知此时

$$
g(0)+g(1)+\cdots+g(6000)=115440 \text {. }
$$

另一方面, 证明

$$
g(0)+g(1)+\cdots+g(6000) \leq 115440 \text {. }
$$

简单调整, 不妨设

$$
f(0)+f(1)+\cdots+f(300)=300
$$

且对 $n \geq 301$, 均有 $f(n)=0$.

考虑图形 $A$, 它由小矩形 $1 \times f(0), 1 \times f(1), \cdots, 1 \times f(300)$ 顺次拼接而成.



图形 A

则图形 $A$ 呈阶梯状, 且 $A$ 的面积 $S_{A}=300$. 将 $A$ 的阶梯格线向内延长得到阴影部分所示图形, 记为 $B$, 并记 $C=A \backslash B$. 设集合 $T$ 为

$$
T=\left\{a_{1}<a_{2}<\cdots<a_{t}\right\}=\{n \mid 0 \leq n \leq 299, f(n)>f(n+1)\},
$$

并设 $a_{0}=-1$, 考虑如下一组 $g(6000), g(5999), \cdots, g(0)$ 的放缩.

易知 $f\left(a_{t}+1\right)=\cdots=f(300)=0$, 故由 $g$ 的定义式, 易得

$$
g(6000)=g(5999)=\cdots=g\left(20\left(a_{t}+1\right)\right) \leq 0 .
$$

而

$$
\begin{gathered}
g\left(20\left(a_{t}+1\right)-1\right) \leq 19 f\left(a_{t}+1\right)+f\left(a_{t}\right)=f\left(a_{t}\right), \\
g\left(20\left(a_{t}+1\right)-2\right) \leq 19 f\left(a_{t}+1\right)+f\left(a_{t}-1\right)=f\left(a_{t}\right), \\
\vdots \\
g\left(20\left(a_{t}+1\right)-\left(a_{t}-a_{t-1}\right)\right) \leq 19 f\left(a_{t}+1\right)+f\left(a_{t-1}+1\right)=f\left(a_{t}\right) .
\end{gathered}
$$

因此有

$$
\begin{gathered}
f\left(a_{t}\right) \geq \max \left\{g\left(20\left(a_{t}+1\right)-1\right), g\left(20\left(a_{t}+1\right)-2\right), \cdots,\right. \\
\left.g\left(20\left(a_{t}+1\right)-\left(a_{t}-a_{t-1}\right)\right)\right\} .
\end{gathered}
$$

类似地, 可以得到

$$
\begin{gathered}
2 f\left(a_{t}\right) \geq \max \left\{g\left(20\left(a_{t}+1\right)-\left(a_{t}-a_{t-1}\right)-1\right), \cdots,\right. \\
\left.g\left(20\left(a_{t}+1\right)-2\left(a_{t}-a_{t-1}\right)\right)\right\}, \\
\vdots \\
20 f\left(a_{t}\right) \geq \max \left\{g\left(20\left(a_{t}+1\right)-19\left(a_{t}-a_{t-1}\right)-1\right), \cdots,\right. \\
\left.g\left(20\left(a_{t}+1\right)-20\left(a_{t}-a_{t-1}\right)\right)\right\} .
\end{gathered}
$$

将上面的式子累和, 即有

$$
\sum_{j=20\left(a_{t-1}+1\right)}^{20\left(a_{t}+1\right)-1} g(j) \leq 210 f\left(a_{t}\right)\left(a_{t}-a_{t-1}\right)
$$

继续下去, 有

$$
\begin{gathered}
f\left(a_{t-1}\right)+19 f\left(a_{t}\right) \geq \max \left\{g\left(20\left(a_{t-1}+1\right)-1\right), \cdots,\right. \\
\left.g\left(20\left(a_{t-1}+1\right)-\left(a_{t-1}-a_{t-2}\right)\right)\right\}, \\
2 f\left(a_{t-1}\right)+18 f\left(a_{t}\right) \geq \max \left\{g\left(20\left(a_{t-1}+1\right)-\left(a_{t-1}-a_{t-2}\right)-1\right), \cdots,\right. \\
\left.g\left(20\left(a_{t-1}+1\right)-2\left(a_{t-1}-a_{t-2}\right)\right)\right\}, \\
\vdots \\
20 f\left(a_{t-1}\right) \geq \max \left\{g\left(20\left(a_{t-1}+1\right)-19\left(a_{t-1}-a_{t-2}\right)-1\right), \cdots,\right. \\
\left.g\left(20\left(a_{t-1}+1\right)-20\left(a_{t-1}-a_{t-2}\right)\right)\right\} .
\end{gathered}
$$

累和, 有

$$
\sum_{j=20\left(a_{t-2}+1\right)}^{20\left(a_{t-1}+1\right)-1} g(j) \leq 190 f\left(a_{t}\right)\left(a_{t-1}-a_{t-2}\right)+210 f\left(a_{t-1}\right)\left(a_{t-1}-a_{t-2}\right) .
$$

依次下去得到所有这样的关系式, 则有

$$
\begin{aligned}
\sum_{k=0}^{6000} g(k) & \leq \sum_{k=0}^{t-1} \sum_{j=20\left(a_{k}+1\right)}^{20\left(a_{k+1}+1\right)-1} g(j) \\
& \leq 210 \sum_{k=0}^{t-1} f\left(a_{k+1}\right)\left(a_{k+1}-a_{k}\right)+190 \sum_{k=1}^{t-1} f\left(a_{k+1}\right)\left(a_{k}-a_{k-1}\right)
\end{aligned}
$$

注意到, 在右式中,

$$
\begin{gathered}
\sum_{k=0}^{t-1} f\left(a_{k+1}\right)\left(a_{k+1}-a_{k}\right)=S_{A}=300 \\
\sum_{k=1}^{t-1} f\left(a_{k+1}\right)\left(a_{k}-a_{k-1}\right)=S_{B}
\end{gathered}
$$

因此

$$
\sum_{k=0}^{6000} g(k) \leq 115440
$$

只需 $S_{B} \leq 276$, 亦即 $S_{C} \geq 24$. 下证明 $S_{C} \geq 24$.

设 $A$ 有 $t$ 个凸拐点. 将 $A$ 补齐为一个 $a \times b$ 矩形. 因 $a b \geq 300$, 故 $a+b \geq 35$.



设 $D$ 为补齐的图形, $C^{\prime}$ 为与阶梯右上边界相邻的单位方格构成的区域, 则

$$
S_{C} \geq S_{C^{\prime}}=a+b-t .
$$

假设 $a+b-t \leq 23$, 则因 $D$ 有 $t-2$ 个凹拐点, 故其面积至少为

$$
1+2+\cdots+t-1=\frac{t(t-1)}{2} .
$$

因此

$$
300+\frac{t(t-1)}{2} \leq a b \leq \frac{(a+b)^{2}}{4} \leq \frac{(23+t)^{2}}{4} .
$$

这等价于

$$
t^{2}-48 t+671=(t-24)^{2}+95 \leq 0
$$

矛盾!
因此

$$
S_{C} \geq S_{C^{\prime}} \geq 24
$$

于是

$$
\sum_{k=0}^{6000} g(k) \leq 210 \times 300+190 \times 276=115440 .
$$

综上, 所求最大可能值为 115440 .

评注 困难的问题. 本题不能一上来就想通过调整法来求出每个 $g(k)$ 取最小值的状态. 事实上, 当猜出答案后, 我们会发现很多时候其实只需要一个很松的放缩. 同时, 采取数形结合可以帮助我们发现一组 $g(k)$ 的方便计算的放缩, 将结论转化为一个不算困难的组合几何问题.

最后, 凸拐点的处理技巧在 2013 年朝鲜数学奥林匹克的第 6 题中同样出现过,有兴趣的读者可以自行查阅。

题 $\mathbf{4}$ 对非负整数 $a, b$, 定义位异或运算 $a \oplus b$, 是唯一的非负整数, 使得对每个非负整数 $k$,

$$
\left[\frac{a}{2^{k}}\right]+\left[\frac{b}{2^{k}}\right]-\left[\frac{a \oplus b}{2^{k}}\right]
$$

都是偶数. 求所有正整数 $a$, 使得对任意整数 $x>y \geq 0$, 都有

$$
x \oplus a x \neq y \oplus a y .
$$

解 所求 $a$ 为全体正偶数.

先确定 $a \oplus b$. 设

$$
a=\left(a_{t} a_{t-1} \cdots a_{1} a_{0}\right)_{2}, b=\left(b_{t} b_{t-1} \cdots b_{1} b_{0}\right)_{2}
$$

为 $a, b$ 的二进制表示.

记 $c=\left(c_{t} c_{t-1} \cdots c_{1} c_{0}\right)_{2}$ 满足

$$
c_{i}=\left\{\begin{array}{l}
1, a_{i} \neq b_{i} \\
0, a_{i}=b_{i}
\end{array},\right.
$$

则有

$$
\left[\frac{a}{2^{k}}\right]+\left[\frac{b}{2^{k}}\right] \equiv a_{k}+b_{k} \equiv c_{k} \equiv\left[\frac{c}{2^{k}}\right] \quad(\bmod 2) .
$$

又因

$$
\left[\frac{c}{2^{k}}\right] \equiv\left[\frac{c^{\prime}}{2^{k}}\right] \quad(\bmod 2)
$$

等价于 $c$ 与 $c^{\prime}$ 在二进制下第 $k+1$ 位相同. 故 $a \oplus b$ 确实是唯一的, 因此

$$
a \oplus b=c .
$$

回到原题, 现说明所求 $a$ 为全体正偶数.

一方面, 当 $a$ 为奇数时, 取

$$
x=2^{a}+1, y=2^{a}-1,
$$

只需证对所有 $k$, 均有

$$
\left[\frac{2^{a}+1}{2^{k}}\right]+\left[\frac{a\left(2^{a}+1\right)}{2^{k}}\right] \equiv\left[\frac{2^{a}-1}{2^{k}}\right]+\left[\frac{a\left(2^{a}-1\right)}{2^{k}}\right](\bmod 2) .
$$

(1) $k=0$, 显然成立.

(2) $0<k \leq a$, 则

$$
\begin{gathered}
{\left[\frac{2^{a}+1}{2^{k}}\right]-\left[\frac{2^{a}-1}{2^{k}}\right]=1,} \\
{\left[\frac{a\left(2^{a}+1\right)}{2^{k}}\right]-\left[\frac{a\left(2^{a}-1\right)}{2^{k}}\right]=\left[\frac{a}{2^{k}}\right]-\left[\frac{-a}{2^{k}}\right] \equiv 1 \quad(\bmod 2) .}
\end{gathered}
$$

(3) $k>a$, 记 $m$ 为大于 $a\left(2^{a}-1\right)$ 且能被 $2^{k}$ 整除的最小数, 则

$$
m \geq(a+1) 2^{a}>a\left(2^{a}+1\right) .
$$

故

$$
\left[\frac{a\left(2^{a}-1\right)}{2^{k}}\right]=\left[\frac{a\left(2^{a}+1\right)}{2^{k}}\right],\left[\frac{2^{a}-1}{2^{k}}\right]=\left[\frac{2^{a}+1}{2^{k}}\right]=0 .
$$

简单验证可知上面 3 种情况中, $(*)$ 均成立. 故 $a$ 为奇数不符合要求.

另一方面, 假设对偶数 $a$, 整数 $x \neq y>0$ 有

$$
x \oplus a x=y \oplus a y .
$$

即对 $k \in \mathbb{N}$, 均有

$$
\left[\frac{x}{2^{k}}\right]+\left[\frac{a x}{2^{k}}\right] \equiv\left[\frac{y}{2^{k}}\right]+\left[\frac{a y}{2^{k}}\right] \quad(\bmod 2) .
$$

取 $k=0$, 可知

$$
a(x-y) \equiv x-y \quad(\bmod 2),
$$

故 $2 \mid x-y$.

归纳地, 假设 $k=t-1$ 已经推出 $2^{t} \mid x-y$. 取 $k=t, x-y=m \cdot 2^{t}$, 则

$$
\left[\frac{x}{2^{t}}\right]+\left[\frac{a x}{2^{t}}\right] \equiv\left[\frac{y}{2^{t}}\right]+\left[\frac{a y}{2^{t}}\right] \quad(\bmod 2) \Leftrightarrow \frac{a(x-y)}{2^{t}} \equiv m \quad(\bmod 2) .
$$

故 $m$ 为偶数, 即 $2^{t+1} \mid x-y$. 依次下去, 必有 $x=y$, 矛盾!

综上, 所求 $a$ 为全体正偶数.
评注 较简单的问题, 解出 $a \oplus b$ 是本题的关键部分. 根据形式

$$
\left[\frac{a}{2^{k}}\right]+\left[\frac{b}{2^{k}}\right] \equiv\left[\frac{a \oplus b}{2^{k}}\right]
$$

很自然地联想到二进制表示. 此后的工作均无突出难点.

题 5 给定正整数 $m, n$, 甲乙两人在无穷大的方格表中玩游戏, 甲先秘密地在每个格中写上一个实数, 使得每个 $m \times n$ 和 $n \times m$ 矩形中所写数之和为零. 乙每次询问甲一个格中所写的数, 甲如实回答, 如果某一时刻乙能确定每个格中所写的数, 则乙获胜; 否则甲获胜.

求使乙能获胜的最少的询问次数, 或证明有限次询问不能使乙获胜.

解 $(m, n)=1$ 时, $(m-1)^{2}+(n-1)^{2}$ 次; $(m, n) \neq 1$ 时, 乙不能获胜.

先看 $(m, n)=d>1$ 时甲的策略: 不妨让甲执行更强的操作, 即让每个 $d \times d$方格表中所写数之和为 0 .

假设乙询问了有限次并得知了一些方格内的填数, 甲不妨找到一个边长大于 $d$ 且包含所有乙询问过的方格的正方形 $S$, 并将这其中的准确填数全告诉乙.

只需证明此时乙无法确定所有方格中的填数.



如上图, 取 $A$ 为一个 $1 \times(d-1)$ 区域. 甲在其中填入 $d-1$ 个变量 $x_{1}, x_{2}, \cdots, x_{d-1}$,则此时 $B$ 中填数唯一确定.

在 $S$ 四边上执行相同操作. 即可确定 $S$ 周围一格区域的填数. 易知这些填数是合法的. 此后甲每次都按这个策略将当前正方形周围一格区域的填数确定，可得到一种合法的填数方式, 但 $x_{1}, x_{2}, \cdots, x_{d-1}$ 是自由变量, 故乙无法确定每个格子的填数.

再考虑 $(m, n)=1$ 时的情形.

先证明乙可以通过 $(m-1)^{2}+(n-1)^{2}$ 次询问确定每个格子的填数.

乙的策略是: 先问先询问下图中 $(m-1)^{2}+(n-1)^{2}$ 格内的填数.

对于方格 $D$, 取图中黑框确定的矩形即可确定 $D$ 中的填数, 类似地, 可以确定区域 $C$ 中的填数.



设此时图表上方 $m+n-2$ 个方格中填数为 $x_{1}, x_{2}, \cdots, x_{m+n-2}$.

下证这 $m+n-2$ 个数是唯一确定的. 事实上, 只需证明以下矩阵是满秩的.



其中 $m>n$, 且前 $m-1$ 行每行有 $n$ 个 1 , 后 $n-1$ 行每行用 $m$ 个 1 .

设 $m=n q+r$, 对后 $n-1$ 行中的每行, 将其末尾 $n q$ 个 1 改为 0 , 则此时最后一行最后一个 1 出现在第 $n-2+r$ 列, 故第 $n-1+r$ 列至第 $n+m-2$ 列中非零行构成一个下三角子式. 删除该下三角矩阵所在的行和列(各 $m-r=n q$个), 得到矩阵 $A^{\prime}$. 上述变换等价于在 $A$ 中删去了一个行列式为 1 的分块, 故 $|\operatorname{det} A|=\left|\operatorname{det} A^{\prime}\right|$, 并且 $A^{\prime}$ 可以看作在 $A$ 中用 $r$ 替换 $m$ 后得到的矩阵,因此可以不断操作下去, 可知该操作过程等价于 Euclid 算法, 故最后 $A$ 化为对角矩阵 $E$,因此 $|\operatorname{det} A|=|\operatorname{det} E|=1$. 于是 $A$ 满秩.

而根据条件, $x_{1}, x_{2}, \cdots, x_{m+n-2}$ 对应的 $m+n-2$ 个线性方程的系数矩阵恰为 $A$, 故 $x_{1}, x_{2}, \cdots, x_{m+n-2}$ 唯一确定. 由此, 乙可以确定这 $m+n-2$ 列中任一个方格的填数. 从而易知乙可以确定任一方格的填数,

另一方面, 证明乙至少需要 $(m-1)^{2}+(n-1)^{2}$ 次询问.

构造两种填数 $C_{1}$ 与 $C_{2}: C_{1}$ 的规则是每个 $1 \times m$ 与 $m \times 1$ 矩阵中填数之和均为 0 , 在 $C_{1}$ 中一个 $(m-1) \times(m-1)$ 方格表中任意填数, 并扩展至整个方格.
$C_{2}$ 的规则是每个 $n \times 1$ 与 $1 \times n$ 矩阵中填数之和均为 0 , 在 $C_{2}$ 中一个 $(n-1) \times(n-1)$ 方格中任意填数, 并扩展至整个方格.

现将 $C_{1}$ 与 $C_{2}$ 相加, 得到的填数方法符合要求, 且有 $(m-1)^{2}+(n-1)^{2}$ 个自由变量.

综上, $(m, n)=1$ 时, 乙最少需 $(m-1)^{2}+(n-1)^{2}$ 次; $(m, n)>1$ 时, 乙不能获胜.

评注 中档偏难的问题, $(m, n)>1$ 时的情形相对容易, 为了方便后面的递归填数, 加强甲的操作是有必要的. $(m, n)=1$ 时的答案其实并不好猜. 从 $(m, n)>1$ 时甲的策略来看, 乙要获胜, 就需要完成一步解线性方程组的操作.从而根据”方程个数与变量个数相等”的感觉去猜答案可能会更准确.

题 6 设函数 $f: \mathbb{N}^{+} \rightarrow \mathbb{N}^{+}$, 对任意 $m, n \in \mathbb{N}_{+}$, 定义

$$
\Delta(m, n)=\underbrace{f(f(\cdots f}_{f(n) \text { 次 }}(m) \cdots))-\underbrace{f(f(\cdots f}_{f(m) \text { 次 }}(n) \cdots))
$$

已知对任意不同的 $m, n \in \mathbb{N}$, 均有 $\Delta(m, n) \neq 0$.

求证: $\Delta$ 无界, 即对任意常数 $C$, 存在 $m, n \in \mathbb{N}_{+}$, 满足 $|\Delta(m, n)|>C$.

证明 ${ }^{[1]}$ 假设 $\Delta(m, n)$ 有界. 设为 $|\Delta(m, n)| \leq N$.

若对 $m \neq n$ 有 $f(m)=f(n)$, 则

$$
\Delta(m, n)=f^{f(n)}(m)-f^{f(m)}(n)=0,
$$

矛盾! 故 $f$ 是单射.

因此 $f$ 将 $\mathbb{N}^{+}$分解为若干条不交的轨道. 证明以下引理:

引理 $f$ 仅有一条轨道.

证明 假设 $f$ 的全部轨道为 $A_{1}, A_{2}, \cdots$. 若存在一条轨道仅含有限个元素,设这些元素构成集合 $A$. 固定 $m \in A$, 取 $n \in \mathbb{N}^{+}$使得 $f^{f(m)}(n)$ 充分大, 则

$$
\Delta(m, n)=\left|f^{f(n)}(m)-f^{f(m)}(n)\right| \geq f^{f(m)}(n)-\max _{a \in A}(a)>N
$$

矛盾!

故 $A_{1}, A_{2}, \cdots$ 均为无限轨道. 若存在至少 $2 N+2$ 条轨道, 从轨道

$$
A_{1}, A_{2}, \cdots, A_{2 N+2}
$$

中选出 $2 N+2$ 个代表元 $a_{1}, a_{2}, \cdots, a_{2 N+2}$, 并取一条无穷长的轨道 $A$. 取 $k \in \mathbb{N}^{+}$, 满足

$$
k>\max \left\{f\left(a_{1}\right), f\left(a_{2}\right), \cdots, f\left(a_{2 N+2}\right)\right\} .
$$

再取 $a_{0} \in A$, 并令 $n=f^{k}\left(a_{0}\right)$, 则对每个 $a_{i}$ 均存在 $g\left(a_{i}\right) \in \mathbb{N}^{+}$使

$$
n=f^{f\left(a_{i}\right)}\left(g\left(a_{i}\right)\right),
$$

易知这些 $g\left(a_{i}\right)$ 互不相同. 但 $[n-N, n+N]$ 中共 $2 N+1$ 个整数且 $f^{f\left(g\left(a_{i}\right)\right)}\left(a_{i}\right)$分属不同的轨道, 故存在 $i$ 使

$$
f^{f\left(g\left(a_{i}\right)\right)}\left(a_{i}\right) \notin[n-N, n+N]
$$

从而

$$
\left|\Delta\left(g\left(a_{i}\right), a_{i}\right)\right|>N
$$

矛盾!

因此 $f$ 至多包含 $2 N+1$ 条轨道 $A_{1}, A_{2}, \cdots, A_{2 N+1}$, 它们均为无穷长的轨道. 给定 $a \in A_{1}$, 称不具有形式 $f^{j}(a)\left(j \in \mathbb{N}^{+}\right)$的数为好数.

假设好数有无穷多个. 因轨道数有限, 易知 $\left\{f^{f(a)}(n) \mid n \in \mathbb{N}^{+}\right\}$覆盖所有充分大的数. 固定 $n>m, n, m$ 充分大, $f^{f(a)}(n) \in[m, n]$ 时,

$$
f^{f(n)}(a) \in[m-N, n+N]
$$

并且 $n$ 互不相同时, $f^{f(n)}(a)$ 也互不相同, 故 $[m-N, n+N]$ 中至多有 $2 N$ 个好数. 但因好数有无穷多个, 故可选取 $m, n$ 使 $[m-N, n+N]$ 中有多于 $2 N$ 个好数, 矛盾!

因此好数仅有有限个, 结合不存在有限长的轨道可知 $f$ 仅有一条轨道. 引理获证.

回到原题, 由好数仅有有限多个, 可知 $f$ 轨道必有起始点.

故 $f$ 的形态为

$$
a \rightarrow f(a) \rightarrow f^{2}(a) \rightarrow \cdots \rightarrow f^{k}(a) \rightarrow \cdots
$$

记 $f^{n}(a)=g(n)$, 则 $g: \mathbb{N} \rightarrow \mathbb{N}^{+}$为双射. 对于 $m \neq n$,

$$
\begin{aligned}
\Delta(g(n), g(m)) & =f^{f^{m+1}(a)+n}(a)-f^{f^{n+1}(a)+m}(a) \\
& =g(g(m+1)+n)-g(g(n+1)+m)
\end{aligned}
$$

故有

$$
0<|g(g(m+1)+n)-g(g(n+1)+m)| \leq N
$$

故

$$
g(m+1)+n \neq g(n+1)+m
$$

即

$$
g(m+1)-m \neq g(n+1)-n \text {. }
$$

因此 $\{g(n)-n\}_{n \geq 0}$ 互不相同. 故 $\{g(n)-n\}_{n \geq 0}$ 没有下界. 否则设 $g(n)-n$ 有下界, 则对任意充分大的 $M$, 均有 $n>M^{\prime}$ 时, $g(n)-n>M$, 故

$$
g(n), g(n+1), \cdots>n+M
$$

但 $g$ 是 $\mathbb{N}$ 到 $\mathbb{N}^{+}$的双射, 矛盾.

取 $B$ 使得 $g(B)+N \leq B$ 且 $g(B)>N$. 并令 $n=B-g(m+1)$, 则对 $g(m+1) \leq B$, 均有

$0<|g(g(m+1)+n)-g(g(n+1)+m)|=|g(B)-g(m+g(B-g(m+1)+1))| \leq N$.记

$$
A=\left\{g^{-1}(g(B)-N), g^{-1}(g(B)-N+1), \cdots, g^{-1}(g(B)+N)\right\} .
$$

令

$$
t=\max \left\{g^{-1}(g(B)-N), \cdots, g^{-1}(g(B)+N) .\right\}
$$

取 $m=t-1$, 则

$$
0<|g(B)-g(t-1+g(B+1-g(t)))| \leq N \text {. }
$$

故

$$
t-1+g(B-g(t)+1) \in A,
$$

只能

$$
B+1-g(t)=g^{-1}(1) \text {. }
$$

而我们有 $|g(t)-g(B)| \leq N$, 故

$$
\left|(B-g(B))+1-g^{-1}(1)\right| \leq N
$$

对无穷多个 $B$ 成立, 这与 $\{g(n)-n\}_{n \geq 0}$ 互不相同矛盾!

综上, $\Delta(m, n)$ 无界. 证毕!

评注 很困难的问题, 步骤杂乱且每一步都不好想. 在有了探索轨道性质的基本想法后,引理是一个很大胆的猜测. 引理证明中前几个性质都不算困难. 也许出于简化轨道的想法, 我们希望进一步探索不具有形式 $f^{k}(a)$ 的数的性质, 从而完成证明. 后面的部分主要难点在于不能只将眼光放在粗略的无界性放缩上,需要具体地设出如 $A$ 这样的集合, 才能找到解决问题的突破口.

## 参考文献

[1] https://artofproblemsolving.com/community/c6h2995866p26896222.

