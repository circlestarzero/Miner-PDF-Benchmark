数学新星网 当学生专栏

www.nsmath.cn/xszl

# 2021 年 IMO 预选题试题及解析 

王衔邦 ${ }^{1}$ 孙牧聪 ${ }^{1}$ 马尧 ${ }^{1}$ Qiao Zhang ${ }^{2}$

(1. 中国人民大学附属中学, 100080; 2. Sierra Canyon School, 91311 )

指导教师：陈晨（学而思数学竞赛主教练）

每年，世界各国会有大量的命题寄送到国际数学奥林匹克组委会，组委会会选出里面比较不错的题目组成 longlist, 然后进一步第选组成 shortlist, 最终经过领队投票，从 shortlist 里选出六道题目作为当年的 IMO 考题。这里的 shortlist 我们一般简称为 IMOSL，也叫” imo 预选题 “，会发给各国领队参考可以用于下一年的训练, 选拔等。IMOSL 一般题目优美, 新颖, 难度从低到高,是数学竞赛爱好者不可多得的好资料, 非常适合作为参加 CMO, TST 前的练习。

今年的 IMOSL 与往年风格非常不同, 考察了大量往年不会考察的问题.

个人觉得对中国学生而言：A4,A7,A8,G7,G8,N8,C6 是值得仔细研究的题目. 我个人最喜欢的题目是 $\mathrm{C} 6$, 非常优雅而具有美感.

每年我会指导一些学生写 IMOSL 的解析, 今年由于联赛的推迟, 学生们时间有限，我们只从每道题所有人的解答里各选出了一种我们心目中最直接或最有代表性的做法. 限于水平和时间有限，有不足之处，敬请读者指点.

## I. 试题

代数 (Algebra)

A1. 设 $n$ 是正整数, $A$ 为 $\left\{0,1, \cdots, 5^{n}\right\}$ 的一个 $4 n+2$ 元子集. 证明: 存在 $A$ 中的元素 $a<b<c$, 满足 $c+2 a>3 b$.

A2. 求所有的正整数 $n$, 使得

$$
\sum_{i=1}^{n} \sum_{j=1}^{n}\left[\frac{i j}{n+1}\right]=\frac{n^{2}(n-1)}{4}
$$

A3. 给定正整数 $n$. 设 $a_{1}, a_{2}, \cdots, a_{n}$ 是 $1,2, \cdots, n$ 的一个排列, 求 $\sum_{k=1}^{n}\left[\frac{a_{k}}{k}\right]$的最小值.

A4. 设 $n$ 是正整数, $x_{1}, x_{2}, \cdots, x_{n}$ 是实数. 证明:

$$
\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}-x_{j}\right|} \leq \sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}\right|}
$$

A5. 设整数 $n \geq 2$, 正实数 $a_{1}, a_{2}, \cdots, a_{n}$ 满足 $a_{1}+a_{2}+\cdots+a_{n}=1$, 证明:

$$
\sum_{k=1}^{n} \frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\frac{1}{3}
$$

A6. 设整数 $m \geq 2$. 集合 $A$ 由有限个整数组成, $B_{1}, B_{2}, \cdots, B_{m}$ 是 $A$ 的子集. 若对于任意 $1 \leq k \leq m, B_{k}$ 中的所有元素之和为 $m^{k}$, 证明: $A$ 中至少包含 $\frac{m}{2}$ 个元素.

A7. 设 $n$ 是正整数. $x_{0}, x_{1}, \cdots, x_{n+1}$ 是非负实数, 满足 $x_{i} x_{i+1}-x_{i-1}^{2} \geq 1$对任意 $i=1,2, \cdots, n$ 成立. 证明:

$$
x_{0}+x_{1}+\cdots+x_{n+1}>\left(\frac{2 n}{3}\right)^{\frac{3}{2}}
$$

A8. 求所有函数 $f: \mathbb{R} \rightarrow \mathbb{R}$, 满足对于任意实数 $a, b, c$, 均有

$$
(f(a)-f(b))(f(b)-f(c))(f(c)-f(a))=f\left(a b^{2}+b c^{2}+c a^{2}\right)-f\left(a^{2} b+b^{2} c+c^{2} a\right)
$$

## 组合 (Combinatorics)

C1. 设 $S$ 是一个无穷正整数集合, 且存在两两不同的 $a, b, c, d \in S$, 满足 $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. 证明: 存在两两不同的 $x, y, z \in S$, 满足 $\operatorname{gcd}(x, y)=$ $\operatorname{gcd}(y, z) \neq \operatorname{gcd}(z, x)$.

C2. 给定不小于 3 的正整数 $n$. 在环形项链上有 $m \geq n+1$ 颗珠子. 用 $n$种颜色对珠子染色, 使得在任意连续的 $n+1$ 颗珠子中所有颜色都至少出现一次. 求最大的正整数 $m$, 使得该要求无法实现.

C3. 两只松鼠 $\mathrm{B}$ 和 $\mathrm{J}$ 为过冬收集了 2021 枚核桃. $\mathrm{J}$ 将它们依次编号为 1 至 2021, 并在一棵树的周围挖了一圈共 2021 个小坑. 第二天早上, $\mathrm{J}$ 发现 B 已经在每个小坑中放人了一枚核桃, 但并未注意编号. J 决定用 2021 次操作来改变这些核桃的位置. 在第 $k$ 次操作中, $\mathrm{J}$ 把与第 $k$ 号核桃相邻的两枚核桃交换位置. 证明: 存在某个 $k$, 使得在第 $k$ 次操作中, $\mathrm{J}$ 交换了两枚编号为 $a, b$ 的核桃, 且 $a<k<b$.

C4. 在一个国家中有 $n$ 座城市, 任意两座城市之间恰有一条单向道路. 一条从 $X$ 至 $Y$ 的路径是指经过一系列道路, 使得可以从 $X$ 沿着这些道路到达 $Y$, 且不经过重复的城市. 称一个路径集合是多样的, 如果任何道路不属于集合中多于一条路径. 对于两座不同城市 $A, B$, 定义 $N_{A B}$ 为从 $A$ 到 $B$ 的多样的路
径集合中路径个数的最大值. 证明: $N_{A B}=N_{B A}$ 当且仅当从 $A$ 出发的道路数与从 $B$ 出发的道路数相同.

C5. 设整数 $n>k \geq 1$. 有 $2 n+1$ 位同学围成一圈, 每个同学都有 $2 k$ 个邻居, 即左右两边与他最近的各 $k$ 个同学. 已知共有 $n+1$ 个女孩和 $n$ 个男孩, 证明: 存在一个女孩, 她的邻居中至少有 $k$ 个女孩.

C6. 一个猎人和一只隐身兔在一个无穷大的方格表中玩游戏. 首先, 猎人用有限多种颜色对每个格染色, 兔子秘密地选择一个出发格. 在每一分钟, 兔子会告诉猎人它当前所在格的颜色, 然后移动到一个未到过的邻格 (即和当前格有公共边的格). 若有限时间后, 猎人能够确定兔子的出发格, 或者兔子无法移动, 则猎人获胜. 那么猎人是否有必胜策略?

C7. 设整数 $m \geq 2$. 有一个 $3 m \times 3 m$ 的棋盘, 一只青蛙在左下角的格 $S$中, 想到答右上角的格 $F$. 青蛙每次可以向右或向上跳一格. 棋盘上的一些格是黏的, 这意味着当青蛙跳到其中时会被黏住. 称一个方格组成的集合 $X$ 是阻碍的, 如果 $X$ 中所有格都是黏的时, 青蛙无法从 $S$ 到达 $F$. 称一个阻碍的集合是极小的, 如果它不包含一个更小的阻碍集合. 证明:

(1) 存在一个极小的阻碍集合至少包含 $3 m^{2}-3 m$ 个格;

(2) 每个极小的阻碍集合都至多包含 $3 m^{2}$ 个格.

C8. 求最大的正整数 $N$, 使得存在一个 $N \times 100$ 的数表 $T$, 满足

(i) 每行都是 $1,2, \cdots, 100$ 的一个排列;

(ii) 对任意两个不同的行 $r, s$, 存在一列 $c$, 使得 $|T(r, c)-T(s, c)| \geq 2$. 这里, $T(r, c)$ 表示位于第 $r$ 行第 $c$ 列的格中的数.

## 几何 (Geometry)

G1. 在平行四边形 $A B C D$ 中, $A C=B C . P$ 是 $A B$ 延长线上一点, $\triangle A C D$的外接圆与线段 $P D$ 交于 $Q, \triangle A P Q$ 的外接圆与线段 $P C$ 交于 $R$. 证明: 直线 $C D, A Q, B R$ 交于一点.

G2. 凸四边形 $A B C D$ 有内切圆 $\odot I, \triangle A I C$ 的外接圆为 $\Omega$. 延长 $B A, B C, A D, C D$分别交 $\Omega$ 于 $X, Z, Y, T$, 证明:

$$
A D+D T+T X+X A=C D+D Y+Y Z+Z C
$$

G3. 设 $n$ 是正整数. 给定一个 $2 n \times 2 n$ 的单位点阵 $\mathbf{L}$. 设 $\mathcal{F}$ 是一个多边形集合, 使得其中的每个多边形的顶点都属于 $\mathbf{L}$, 且 $\mathbf{L}$ 中的每个点都恰是 $\mathcal{F}$ 中的一个多边形的顶点. 求 $\mathcal{F}$ 中所有多边形面积之和的最大可能值.
注：还有另外一个版本, 即钦定 $\mathcal{F}$ 中的多边形必须是四边形. 由于该版本严格弱于原题, 故略去.

G4. 四边形 $A B C D$ 内接于圆 $\Omega$, 该圆在 $D$ 处的切线与射线 $B A, B C$ 分别交于 $E, F . T$ 是 $\triangle A B C$ 内一点, 满足 $T E\|C D, T F\| A D . K$ 是线段 $D F$ 上不同于 $D$ 的一点, 满足 $T D=T K$. 证明: 直线 $A C, D T, B K$ 交于一点.

G5. 各边长互不相同的四边形 $A B C D$ 内接于圆 $O . \angle A B C, \angle A D C$ 的平分线分别与 $A C$ 交于 $B_{1}, D_{1}$. 设 $O_{B}$ 为过 $B$ 且与 $A C$ 切于 $D_{1}$ 的圆的圆心, $O_{D}$为过 $D$ 且与 $A C$ 切于 $B_{1}$ 的圆的圆心. 若 $B D_{1} \| D B_{1}$, 证明: $O_{B}, O, O_{D}$ 共线.

G6. 求所有整数 $n \geq 3$, 使得任何边长为 1 的等边凸 $n$ 边形都包含一个边长为 1 的正三角形.(含边界)

G7. 在锐角三角形 $A B C$ 中, $A B>A C, D$ 是其形内一点且在 $\angle B A C$ 的角平分线上. 边 $A C$ 上一点 $E$ 满足 $\angle A D E=\angle B C D$, 边 $A B$ 上一点 $F$ 满足 $\angle A D F=\angle C B D$, 直线 $A C$ 上一点 $X$ 满足 $B X=C X$. 设 $O_{1}, O_{2}$ 分别为 $\triangle A D C, \triangle E D X$ 的外心, 证明: $B C, E F, O_{1} O_{2}$ 交于一点.

G8. 在 $\triangle A B C$ 中, 外接圆 $\omega$ 与 $A$-旁切圆 $\Omega_{A}$ 交于 $X, Y$. 设 $P, Q$ 分别是 $A$ 在 $\Omega_{A}$ 在 $X, Y$ 处切线上的投影, $\triangle A P X$ 外接圆在 $P$ 处切线与 $\triangle A Q Y$ 在 $Q$处切线交于 $R$. 证明: $A R \perp B C$.

数论 (Number Theory)

N1. 求所有的正整数 $n$, 使得存在正整数 $a, b$, 满足 $a^{2}+b+3$ 不能被任何质数的立方整除, 且

$$
n=\frac{a b+3 b+8}{a^{2}+b+3}
$$

N2. 设整数 $n \geq 100$. 将 $n, n+1, \cdots, 2 n$ 任意分为两组, 证明: 总存在同组的两个数之和是完全平方数.

N3. 求所有的正整数 $n$, 满足 $n$ 的全体 $k$ 格正因数可以排列为 $d_{1}, d_{2}, \cdots, d_{k}$,使得对任意 $i=1,2, \cdots, k, d_{1}+d_{2}+\cdots+d_{i}$ 都是完全平方数.

N4. 设有理数 $r>1 . A$ 在一条直线上玩跳棋游戏, 初始 0 处有一枚红棋子, 1 处有一枚蓝棋子. 在一次操作中, $A$ 选择一枚棋子和一个整数 $k$, 若选择的棋子在 $x$ 处且另一枚棋子在 $y$ 处, 则可将 $x$ 处的棋子移至 $x^{\prime}$ 处, 这里 $x^{\prime}$ 满足 $x^{\prime}-y=r^{k}(x-y)$. 求所有的 $r$, 使得 $A$ 在 2021 次操作内可以将红棋子移至 1 处.

N5. 证明: $n !=a^{n-1}+b^{n-1}+c^{n-1}$ 只有有限多组正整数解.

N6. 求所有整数 $n \geq 2$, 使得对于任意 $n$ 个和不被 $n$ 整除且互不相同的正整数, 总能将它们按某种顺序排列为 $a_{1}, a_{2}, \cdots, a_{n}$, 使得

$$
n \mid 1 \cdot a_{1}+2 \cdot a_{2}+\cdots+n \cdot a_{n}
$$

N7. 设 $a_{1}, a_{2}, \cdots$ 是无穷正整数列, 满足对任意正整数 $m, n$, 都有 $a_{n+2 m} \mid a_{n}+$ $a_{n+m}$. 证明: 存在正整数 $N, T$, 满足对于任意正整数 $n \geq N$, 都有 $a_{n}=a_{n+T}$.

N8. 求所有正整数 $n$, 使得存在 $P(x) \in \mathbb{Z}[x]$, 满足对任意正整数 $m$, $P^{(m)}(1), P^{(m)}(2), \cdots, P^{(m)}(n)$ 除以 $n$ 恰有 $\left\lceil\frac{n}{2^{m}}\right\rceil$ 个不同的余数. 这里 $P^{(m)}$ 表示 $P$ 的 $m$ 次迭代.

## II. 解答与评注

代数 (Algebra)

A1. 设 $n$ 是正整数, $A$ 为 $\left\{0,1, \cdots, 5^{n}\right\}$ 的一个 $4 n+2$ 元子集. 证明: 存在 $A$ 中的元素 $a<b<c$, 满足 $c+2 a>3 b$.

证明 用反证法, 假设 $|A|=4 n+2$ 是 $S=\left\{0,1, \cdots, 5^{n}\right\}$ 的子集, 且对任意 $A$ 中的元素 $a<b<c, c+2 a \leq 3 b$, 即 $\frac{3}{2}(c-b) \leq c-a$. 设 $A$ 中的 $4 n+2$ 个元素从小到大排列分别为 $a_{1}<a_{2}<\cdots<a_{4 n+2}$, 那么

$$
a_{4 n+2}-a_{1} \geq \frac{3}{2}\left(a_{4 n+2}-a_{2}\right) \geq\left(\frac{3}{2}\right)^{2}\left(a_{4 n+2}-a_{3}\right) \geq \cdots \geq\left(\frac{3}{2}\right)^{4 n}\left(a_{4 n+2}-a_{4 n+1}\right) \geq\left(\frac{81}{16}\right)^{n}>5^{n}
$$

矛盾!

评注 本题是简单题, 注意到变形 $\frac{3}{2}(c-b) \leq c-a$ 后, 问题便迎刃而解.

A2. 求所有的正整数 $n$, 使得

$$
\sum_{i=1}^{n} \sum_{j=1}^{n}\left[\frac{i j}{n+1}\right]=\frac{n^{2}(n-1)}{4}
$$

答案 $n=p-1$, 其中 $p$ 取遍所有质数.

解 固定 $i$, 有

$$
\begin{aligned}
\sum_{j=1}^{n}\left[\frac{i j}{n+1}\right] & =\frac{1}{2} \sum_{j=1}^{n}\left(\left[\frac{i j}{n+1}\right]+\left[\frac{i(n+1-j)}{n+1}\right]\right) \\
& \geq \frac{1}{2} \sum_{j=1}^{n}(i-1) \\
& =\frac{(i-1) n}{2}
\end{aligned}
$$

故原式 $\geq \sum_{i=1}^{n} \frac{(i-1) n}{2}=\frac{n^{2}(n-1)}{4}$. 由题意, 上式取等, 故对于任意正整数 $i, j \leq n$ 有

$$
\left[\frac{i j}{n+1}\right]+\left[\frac{i(n+1-j)}{n+1}\right]=i-1
$$

即 $\frac{i j}{n+1}$ 不是整数. 当 $n+1$ 不是质数时, 设 $n+1=p q(p, q \geq 2)$, 取 $i=p, j=q$不成立; 当 $n+1$ 是质数时, 由于 $i, j<n+1$, 故 $(i j, n+1)=1$, 一定成立.

综上, 所求所有的 $n=p-1, p$ 取遍所有质数.

评注 通过尝试小情况可以猜出答案. 注意到 $n+1$ 是质数的时候左边几乎取到最小, 从而自然地考虑将左边往小放缩.

A3. 给定正整数 $n$. 设 $a_{1}, a_{2}, \cdots, a_{n}$ 是 $1,2, \cdots, n$ 的一个排列, 求 $\sum_{k=1}^{n}\left[\frac{a_{k}}{k}\right]$的最小值.

答案 $\left[\log _{2} n\right]+1$.

解 一方面, 归纳给出构造. 当 $n=1$ 时取 $a_{1}=1$ 即可. 若 $1,2, \cdots, n-1$时都可给出构造, 则 $n$ 时: 设 $2^{a} \leq n<2^{a+1}$, 其中 $a$ 为正整数. 令 $m=2^{a}$. 根据归纳假设, 存在 1 至 $m-1$ 的排列 $b_{1}, \cdots, b_{m-1}$, 满足

$$
\sum_{k=1}^{m-1}\left[\frac{b_{k}}{k}\right]=\left[\log _{2}(m-1)\right]+1=a
$$

令 $a_{i}=b_{i}, i=1,2, \cdots, m-1$. 再令 $a_{m}=n, a_{j}=j-1, j=m+1, \cdots, n$. 这样有

$$
\begin{aligned}
\sum_{k=1}^{n}\left[\frac{a_{k}}{k}\right] & =\sum_{k=1}^{m-1}\left[\frac{a_{k}}{k}\right]+\left[\frac{n}{m}\right] \\
& =a+1 \\
& =\left[\log _{2} n\right]+1
\end{aligned}
$$

故 $n$ 时也存在构造, 归纳证毕!

另一方面, 归纳证明 $\sum_{k=1}^{n}\left[\frac{a_{k}}{k}\right] \geq\left[\log _{2} n\right]+1$. 为方便归纳, 我们加强命题: 当 $a_{1}, a_{2}, \cdots, a_{n}$ 为互不相同的正整数时, 上式仍然成立.

当 $n=1$ 时命题显然成立. 若 $1,2, \cdots, n-1$ 时命题均成立, $n$ 时: 设 $a_{t}$ 为 $a_{1}, \cdots, a_{n}$ 中的最大者, 则有 $a_{t} \geq n$, 得到

$$
\begin{aligned}
\sum_{k=1}^{n}\left[\frac{a_{k}}{k}\right] & \geq \sum_{k=1}^{t-1}\left[\frac{a_{k}}{k}\right]+\left[\frac{n}{t}\right] \\
& \geq\left[\log _{2}(t-1)\right]+1+\left[\frac{n}{t}\right]
\end{aligned}
$$

记 $\left[\log _{2}(t-1)\right]=\beta,\left[\log _{2} n\right]=r$. 由 $t \leq n$ 知 $\beta \leq r$. 若 $\beta<r$, 有

$$
\begin{aligned}
{\left[\log _{2}(t-1)\right]+1+\left[\frac{n}{t}\right] } & \geq \beta+1+\left[2^{r-\beta-1}\right] \\
& \geq \beta+1+(r-\beta-1)+1=r+1
\end{aligned}
$$

若 $\beta=r$, 有

$$
\left[\log _{2}(t-1)\right]+1+\left[\frac{n}{t}\right] \geq \beta+1=r+1
$$

故 $n$ 时命题成立, 归纳证毕!

评注 本题的重点在于猜出取等并不是 $a_{i}=i$, 在得到答案后, 归纳证明是最自然的想法.

A4. 设 $n$ 是正整数, $x_{1}, x_{2}, \cdots, x_{n}$ 是实数. 证明:

$$
\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}-x_{j}\right|} \leq \sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}\right|}
$$

证明 归纳证明这一命题. 当 $n=1$ 时左边 $=0$, 显然成立. 若 $1,2, \cdots, n-1$时结论均成立, 则 $n$ 时, 分三种情形讨论.

情形 $\mathbf{1} x_{1}, x_{2}, \cdots, x_{n}$ 中有 0 , 不妨设 $x_{n}=0$. 此时原不等式等价于

$$
\sum_{i=1}^{n-1} \sum_{j=1}^{n-1} \sqrt{\left|x_{i}-x_{j}\right|}+2 \sum_{i=1}^{n} \sqrt{\left|x_{i}\right|} \leq \sum_{i=1}^{n-1} \sum_{j=1}^{n-1} \sqrt{\left|x_{i}+x_{j}\right|}+2 \sum_{i=1}^{n} \sqrt{\left|x_{i}\right|}
$$

由 $n-1$ 时的归纳假设得证!

情形 2 存在 $i \neq j$ 使 $x_{i}+x_{j}=0$, 不妨设 $x_{n-1}+x_{n}=0$. 此时 $\sqrt{\left|x_{i}-x_{n}\right|}=$ $\sqrt{\left|x_{i}+x_{n-1}\right|}, \sqrt{\left|x_{i}+x_{n}\right|}=\sqrt{\left|x_{i}-x_{n-1}\right|}$, 故两边包含 $x_{n-1}, x_{n}$ 的项可以约去,用 $n-2$ 时的归纳假设得证!

情形 3 不存在 $i \neq j$ 满足 $x_{i}+x_{j}=0$. 注意到若将 $x_{1}, \cdots, x_{n}$ 同时加上 $\epsilon$,则不等式左边不变. 考虑令

$$
f(\epsilon)=\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}+2 \epsilon\right|}
$$

设 $x_{i}+x_{j}$ 中最小的正数为 $2 \alpha$, 最大的负数为 $2 \beta$. 因为 $\sqrt{c+2 \epsilon}, \sqrt{c-2 \epsilon}$ 均为关于 $\epsilon$ 的上凸函数, 故 $f(x)$ 在 $(-\beta,-\alpha)$ 上也是关于 $x$ 的上凸函数. 这说明

$$
f(0) \geq \frac{\alpha f(-\beta)+|\beta| f(-\alpha)}{\alpha+|\beta|}
$$

由情形 1,2 知 $f(-\beta), f(-\alpha) \geq 0$, 故 $f(0) \geq 0$. 得证!

综上, 归纳证毕.

评注 这个问题比较困难, 目前给出的这个做法比较适合中学生理解. 实际上也可以通过构造适当的积分或期望（两者实质是一样的）来解决.

A5. 设整数 $n \geq 2$, 正实数 $a_{1}, a_{2}, \cdots, a_{n}$ 满足 $a_{1}+a_{2}+\cdots+a_{n}=1$, 证明:

$$
\sum_{k=1}^{n} \frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\frac{1}{3}
$$

证明 先证明一个引理:

引理 对任意正实数 $x, y$ 满足 $x+y \leq 1$, 都有 $\frac{(x+y)^{3}-y^{3}}{3}>\frac{x y^{2}}{1-x}$.

引理的证明 只需要证明

$$
\left((x+y)^{3}-y^{3}\right)(1-x)>3 x y^{2}
$$

拆开化简后, 以 $x$ 为主元, 只需证

$$
f(x)=x^{2}+(3 y-1) x+3 y(y-1)<0
$$

$x$ 的取值范围为 $(0,1-y]$, 由于 $y<1$ 有 $f(0)<0$, 且

$$
f(1-y)=(1-y)^{2}+(3 y-1)(1-y)+3 y(y-1)=y(y-1)<0
$$

又由 $f(x)$ 为开口向上的二次函数, 故对于任意 $x \in(0,1-y]$ 有 $f(x)<0$. 得证!

回到原题. 令 $S_{k}=a_{1}+a_{2}+\cdots+a_{k}$. 由引理, 带入 $x=a_{k}, y=S_{k-1}$, 我们有

$$
\frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\frac{S_{k}^{3}-S_{k-1}^{3}}{3}
$$

相加后, 得到原式 $<\frac{S_{n}^{3}}{3}=\frac{1}{3}$. 证毕!

评注 本题的引理看似莫名其妙, 但实际隐含着对上界 $\frac{1}{3}$ 真实含义的一种合理猜测, 即为 $f(x)=x^{2}$ 在 0 到 1 的积分. 引理实际上是在说明

$$
\frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\int_{S_{k-1}}^{S_{k}} x^{2} \mathrm{~d} x
$$

若要通过该方法做出本题, 首先需要考虑加强命题, 对于 $a_{1}+\cdots+a_{n}=p<1$的情形, 是否存在一个上界函数 $g(p)$. 事实上 $g(p)=\frac{p^{3}}{3}$ 就是满足要求的.

A6. 设整数 $m \geq 2$. 集合 $A$ 由有限个整数组成, $B_{1}, B_{2}, \cdots, B_{m}$ 是 $A$ 的子集. 若对于任意 $1 \leq k \leq m, B_{k}$ 中的所有元素之和为 $m^{k}$, 证明: $A$ 中至少包含 $\frac{m}{2}$ 个元素.

证明 用反证法, 反设存在 $A=\left\{a_{1}, a_{2}, \cdots, a_{n}\right\}$, 其中 $n<\frac{m}{2}$. 由题意知存在 $\epsilon_{i j} \in\{0,1\}(1 \leq i \leq m, 1 \leq j \leq n)$, 使得对于任意 $1 \leq i \leq m$, 有

$$
\sum_{j=1}^{n} \epsilon_{i j} a_{j}=m^{i}
$$

先证明一个引理. 引理 存在整数 $\alpha_{1}, \cdots, \alpha_{m}$, 满足 $\left|\alpha_{i}\right| \leq m-1(i=1,2, \cdots, m)$,
且对于任意 $1 \leq j \leq n$, 有

$$
\sum_{i=1}^{m} \alpha_{i} \epsilon_{i j}=0
$$

引理的证明 考虑一个定义域为所有满足 $\left|\beta_{i}\right| \leq m-1$ 的正整数组 $\beta=$ $\left(\beta_{1}, \beta_{2}, \cdots, \beta_{m}\right)$ 构成的集合的函数

$$
f(\beta)=\left(\sum_{i=1}^{m} \beta_{i} \epsilon_{i 1}, \sum_{i=1}^{m} \beta_{i} \epsilon_{i 2}, \cdots, \sum_{i=1}^{m} \beta_{i} \epsilon_{i m}\right)
$$

所有满足条件的 $\beta$ 有 $m^{m}$ 个, 且由于 $\sum_{i=1}^{m} \beta_{i} \epsilon_{i j} \leq m(m-1)$, 有值域的大小不超过 $(1+m(m-1))^{n}$. 因为 $n<\frac{m}{2}$, 故 $m^{m}>(1+m(m-1))^{n}$, 由抽居原理, 存在不相同的 $\beta, \gamma$, 满足 $f(\beta)=f(\gamma)$. 取 $\alpha_{i}=\beta_{i}-\gamma_{i}$ 即可.

回到原题. 由 $\alpha_{i}$ 的定义, 有

$$
\begin{aligned}
\sum_{i=1}^{m} \alpha_{i} m^{i} & =\sum_{i=1}^{m}\left(\alpha_{i} \sum_{j=1}^{n} \epsilon_{i j} a_{j}\right) \\
& =\sum_{j=1}^{n}\left(a_{j} \sum_{i=1}^{m} \alpha_{i} \epsilon_{i j}\right)=0
\end{aligned}
$$

然而 $\left|\alpha_{i}\right| \leq m-1$ 且不全为 0 . 这与 $\sum_{i=1}^{m} \alpha_{i} m^{i}=0$ 矛盾!

评注 本题蕴含了代数的一些思想, 对中国学生不是一道难题.

A7. 设 $n$ 是正整数. $x_{0}, x_{1}, \cdots, x_{n+1}$ 是非负实数, 满足 $x_{i} x_{i+1}-x_{i-1}^{2} \geq 1$对任意 $i=1,2, \cdots, n$ 成立. 证明:

$$
x_{0}+x_{1}+\cdots+x_{n+1}>\left(\frac{2 n}{3}\right)^{\frac{3}{2}}
$$

证明 记 $y_{i}=2 x_{i-1}+x_{i}(1 \leq i \leq n+1)$. 则

$$
\begin{aligned}
y_{i+1}^{2}-y_{i}^{2} & =\left(2 x_{i}+x_{i+1}\right)^{2}-\left(2 x_{i-1}+x_{i}\right)^{2} \\
& \geq\left(2 x_{i}+x_{i+1}\right)^{2}-3\left(2 x_{i-1}^{2}+x_{i}^{2}\right) \\
& =\left(x_{i}^{2}+4 x_{i} x_{i+1}+x_{i+1}^{2}\right)-6 x_{i-1}^{2} \\
& \geq 6 x_{i} x_{i+1}-6 x_{i-1}^{2} \geq 6
\end{aligned}
$$

对任意 $1 \leq i \leq n$ 成立. 因此, $y_{i}^{2} \geq y_{1}^{2}+6(i-1) \geq 6(i-1)$, 即 $y_{i} \geq \sqrt{6(i-1)}$.故

$$
\begin{aligned}
x_{0}+x_{1}+\cdots+x_{n+1} & \geq \frac{1}{3}\left(\left(2 x_{1}+x_{2}\right)+\cdots+\left(2 x_{n}+x_{n+1}\right)\right) \\
& =\frac{1}{3}\left(y_{2}+y_{3}+\cdots+y_{n+1}\right) \\
& \geq \frac{\sqrt{6}}{3}(\sqrt{1}+\sqrt{2}+\cdots+\sqrt{n})
\end{aligned}
$$

$$
>\frac{\sqrt{6}}{3} \int_{0}^{n} \sqrt{x} \mathrm{~d} x=\left(\frac{2 n}{3}\right)^{3 / 2}
$$

得证!

评注 这里 $y_{i}$ 的构造是根据凑适当局部不等式的要求找出来的.

A8. 求所有函数 $f: \mathbb{R} \rightarrow \mathbb{R}$, 满足对于任意实数 $a, b, c$, 均有 $(f(a)-f(b))(f(b)-f(c))(f(c)-f(a))=f\left(a b^{2}+b c^{2}+c a^{2}\right)-f\left(a^{2} b+b^{2} c+c^{2} a\right)$

答案 $f(x) \equiv c$ 或 $f(x)=x+c$ 或 $f(x)=-x+c$ 或 $f(x)=x^{3}+c$ 或 $f(x)=-x^{3}+c$, 其中 $c$ 为常数.

解 首先注意到 $f_{1}(x)=f(x)+c$ 仍满足要求 (其中 $c$ 为常数), 故不妨设 $f(0)=0$. 同时 $f_{2}(x)=-f(x)$ 也满足要求, 故不妨设 $f(1) \geq 0$.

我们先证明一个引理.

引理若 $f$ 为偶函数, 则 $f(x) \equiv 0$.

引理证明 在 (1) 中代人 $(a, b, c),(a,-b, c)$ 得

$f\left(a b^{2}+b c^{2}+c a^{2}\right)-f\left(a^{2} b+b^{2} c+c^{2} a\right)=f\left(a b^{2}-b c^{2}+c a^{2}\right)-f\left(-a^{2} b+b^{2} c+c^{2} a\right)$

若 $(a, b, c)$ 满足 $a b^{2}+b c^{2}+c a^{2}=-\left(a^{2} b+b^{2} c+c^{2} a\right)$ 且 $-a^{2} b+b^{2} c+c^{2} a \neq 0$, 记 $\frac{a b^{2}-b c^{2}+c a^{2}}{-a^{2} b+b^{2} c+c^{2} a}=t$, 通过将 $a, b, c$ 同时扩倍, 得到对任意 $x \neq 0$ 都有 $f(x)=$ $f(t x)$. 容易得到这样的 $(a, b, c)$ 有无穷多组且每组得到的 $t$ 并不是定值. 根据连续变化性, 存在 $l<r$, 使得对任意 $x \neq 0$ 及 $t \in[l, r]$, 有 $f(x)=f(t x)$.

若 $0 \in(l, r)$, 立即推出 $f(x) \equiv 0$. 否则 $f(x)=f(t x)=f(|t| x)$, 因而不妨设 $0<l<r$. 对于任意 $0<x_{1}<x_{2}$, 设 $p=\left\lceil\log _{r / l} x_{2} / x_{1}\right\rceil$, 则一定存在 $s_{1}, \cdots, s_{p}, t_{1}, \cdots, t_{p} \in(l, r)$ 满足

$$
x_{1} \cdot s_{1} s_{2} \cdots s_{p}=x_{2} \cdot t_{1} t_{2} \cdots t_{p}
$$

进而 $f\left(x_{1}\right)=f\left(x_{2}\right)$. 这说明, 对任意 $x \neq 0, f(x)=c$ 为常数. 在原式中令 $(a, b, c)=(1,2, \sqrt{2}-2)$ 得 $f(14-7 \sqrt{2})=0$, 进而 $f(x)=0$. 引理证毕!

回到原题. 代人 $b=0$ 知

$$
f^{2}(a) f(c)-f(a) f^{2}(c)=f\left(a^{2} c\right)-f\left(a c^{2}\right)
$$

(2) 中令 $a=1, c=-1$, 得到 $f(1) f(-1)(f(1)-f(-1))=f(-1)-f(1)$, 故 $f(1)=f(-1)$ 或 $f(1) f(-1)=-1$.

情形 $1 f(1)=f(-1)$. 此时 (2) 中分别令 $a=1,-1$, 得到 $f\left(c^{2}\right)=f\left(-c^{2}\right)$,故 $f$ 为偶函数. 根据引理, $f(x) \equiv 0$.
情形 $2 f(1) f(-1)=-1$. (2) 中分别令 $a=1,-1$ 有

$$
\begin{gathered}
f\left(c^{2}\right)=f(1) f^{2}(c)+f(c)\left(1-f^{2}(1)\right) \\
f\left(-c^{2}\right)=f(-1) f^{2}(c)+f(c)\left(1-f^{2}(-1)\right)
\end{gathered}
$$

在后式中代人 $f(-1)=\frac{-1}{f(1)}$, 有

$$
f\left(-c^{2}\right)=\frac{-1}{f^{2}(1)}\left(f(1) f^{2}(c)+f(c)\left(1-f^{2}(1)\right)\right)=\frac{-1}{f^{2}(1)} f\left(c^{2}\right)
$$

故对于任意 $x \geq 0, f(x) \cdot \frac{-1}{f^{2}(1)}=f(-x)$. 对 $a, b, c \geq 0$, 原式中代人 $(a, b, c)$ 及 $(-a,-b,-c)$, 如果 $f(a), f(b), f(c)$ 互不相同, 则

$$
\begin{aligned}
& \left(\frac{-1}{f^{2}(1)}\right)^{3}(f(a)-f(b))(f(b)-f(c))(f(c)-f(a)) \\
& =(f(-a)-f(-b))(f(-b)-f(-c))(f(-c)-f(-a)) \\
& =f\left(-a b^{2}-b c^{2}-c a^{2}\right)-f\left(-a^{2} b-b^{2} c-c^{2} a\right) \\
& =\left(\frac{-1}{f^{2}(1)}\right)^{-1}\left(f\left(a b^{2}+b c^{2}+c a^{2}\right)-f\left(a^{2} b+b^{2} c+c^{2} a\right)\right)
\end{aligned}
$$

故 $\left(\frac{-1}{f^{2}(1)}\right)^{4}=1$, 得到 $f(1)=1$ 或 -1 , 又 $f(1) \geq 0$ 故 $f(1)=1$.

但需要注意的是我们可能无法选出这样的 $a, b, c$. 如果无法选出, 因为 $f(0), f(1)$已经不同, 说明任意 $x \geq 0$ 有 $f(x)=0$ 或 $f(x)=1$. 若存在 $f(x)=0, x>0$,则 (2) 中代人 $c=x$ 知 $f\left(a^{2} x\right)=f\left(a x^{2}\right)$, 再将 $a$ 取反得到 $f$ 为偶函数, 由引理知 $f(x) \equiv 0$; 若对任意 $x>0$ 有 $f(x)=f(1)$, 则原式中取 $(1,2, \sqrt{2}-2)$ 得到 $f(14-7 \sqrt{2})=0$, 矛盾.

(2) 中令 $a=1,-1$, 得到 $f\left(c^{2}\right)=-f\left(-c^{2}\right)$, 即 $f$ 为奇函数. (2) 中代人 $(a, c),(a,-c)$, 对比得到 $f(a) f^{2}(c)=f\left(a c^{2}\right)$. 令 $a=1$ 得 $f^{2}(c)=f\left(c^{2}\right)$, 再代回得到 $f(a) f\left(c^{2}\right)=f\left(a c^{2}\right)$. 故对于任意实数 $x$ 和非负实数 $y$, 有 $f(x) f(y)=f(x y)$.因为 $f$ 是奇函数, 故对任意 $x, y$, 都满足

$$
f(x) f(y)=f(x y)
$$

因为 $f^{2}(x)=f\left(x^{2}\right)$, 故在 $x>0$ 时 $f(x) \geq 0$. 根据 Cauchy 方程结论, 如果 $f(x)$不能写成 $x^{\alpha}$, 则 $(x, f(x))$ 在 $(0,+\infty)^{2}$ 上稠密. 这说明, 对充分小的正实数 $\epsilon$, 存在 $A<\epsilon$ 满足 $f(A)>1$. 在原式中代人 $a=A, b=1$, 并取 $c^{2}+A^{2} c+A \geq 0$, 得

$$
\begin{aligned}
f\left(A c^{2}+c+A^{2}\right) & =f\left(c^{2}+A^{2} c+A\right)+(f(A)-1)(f(c)-f(A))(f(c)-1) \\
& \geq(f(A)-1)(f(c)-f(A))(f(c)-1)
\end{aligned}
$$

$$
\geq-\frac{(f(A)-1)^{3}}{4}
$$

注意到 $c^{2}+A^{2} c+A \geq 0$ 时, $A c^{2}+c+A^{2}$ 的最小值为负数 $d$, 故这给出了一个 $f(x)$ 在 $[d,+\infty)$ 的一个负的下界. 根据 $f$ 是奇函数, 这也给出了 $f(x)$ 在 $[0,-d]$上一个正的上界. 这与秱密性矛盾!

故存在实数 $\alpha$, 使得 $f(x)=x^{\alpha}$ 对任意 $x>0$ 成立! 最后一步, 我们讨论 $\alpha$的取值. 原式中令 $a=c+2 \Delta, b=c+\Delta$, 并让 $\Delta \rightarrow 0$. 得到

$$
\begin{gathered}
\frac{a^{\alpha}-b^{\alpha}}{a-b}, \frac{b^{\alpha}-c^{\alpha}}{b-c} \rightarrow \alpha c^{\alpha-1} \\
\frac{c^{\alpha}-a^{\alpha}}{c-a} \rightarrow-\alpha c^{\alpha-1} \\
\frac{\left(a b^{2}+b c^{2}+c a^{2}\right)^{\alpha}-\left(a^{2} b+b^{2} c+c^{2} a\right)^{\alpha}}{\left(a b^{2}+b c^{2}+c a^{2}\right)-\left(a^{2} b+b^{2} c+c^{2} a\right)} \rightarrow-\alpha\left(3 c^{3}\right)^{\alpha-1}
\end{gathered}
$$

故 $-\alpha^{3} c^{3 \alpha-3}=-\alpha 3^{\alpha-1} c^{3 \alpha-3}$, 故 $\alpha^{2}=3^{\alpha-1}$, 知 $\alpha=1$ 或 3 .

经检验, $f(x)=x$ 及 $f(x)=x^{3}$ 均满足要求.

综上所述, $f(x) \equiv c$ 或 $f(x)=x+c$ 或 $f(x)=-x+c$ 或 $f(x)=x^{3}+c$ 或 $f(x)=-x^{3}+c$, 其中 $c$ 为常数.

评注 本题是十分困难的函数方程问题. 原式中代入 $a=b$ 无用, 故从直接赋值入手较为困难. 本解答中注意到平移不变性, 可直接设 $f(0)=0$, 然后代入 $1,-1$ 常用特殊值, 从而一步步得出柯西方程条件, 之后有关有界性的推导也是巧妙地利用了原式和不等式的关系.

注 关于引理还有另外一种更强的表述方式：若 $f$ 为单射, 则 $f(x) \equiv 0$. 证明思路是先找到某个 $x \neq 0$ 使 $f(x)=0$, 进而将 $c=x$ 代入 (2) 得到 $f$ 为偶函数.

## 组合 (Combinatorics)

C1. 设 $S$ 是一个无穷正整数集合, 且存在两两不同的 $a, b, c, d \in S$, 满足 $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. 证明: 存在两两不同的 $x, y, z \in S$, 满足 $\operatorname{gcd}(x, y)=$ $\operatorname{gcd}(y, z) \neq \operatorname{gcd}(z, x)$.

证明 称 $a \in S$ 是好的, 若存在 $x \neq y \in S$ 使得 $\operatorname{gcd}(a, x) \neq \operatorname{gcd}(a, y)$. 设 $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$, 考虑 $\operatorname{gcd}(a, c)$ 可知 $a, c$ 中至少有一个是好的.

不妨设 $a$ 是好的. 由 $a$ 的因数有限, 故一定存在 $d \mid a$ 使得 $S$ 中有无穷多个 $x$ 满足 $\operatorname{gcd}(a, x)=D$. 取 $\operatorname{gcd}(a, y)=D^{\prime} \neq D$. 那么一定存在 $x_{1}, x_{2} \in S$, 满足 $\operatorname{gcd}\left(a, x_{1}\right)=\operatorname{gcd}\left(a, x_{2}\right)=D$ 且 $\operatorname{gcd}\left(y, x_{1}\right)=\operatorname{gcd}\left(y, x_{2}\right)$. 若 $\operatorname{gcd}\left(x_{1}, x_{2}\right) \neq D$, 则 $\left(x_{1}, a, x_{2}\right)$ 满足要求; 否则, 若 $\operatorname{gcd}\left(y, x_{1}\right)=\operatorname{gcd}\left(y, x_{2}\right) \neq D$, 则 $\left(x_{1}, y, x_{2}\right)$ 满足要
求; 若仍不满足, 则 $\left(a, x_{1}, y\right)$ 满足要求.

C2. 给定不小于 3 的正整数 $n$. 在环形项链上有 $m \geq n+1$ 颗珠子. 用 $n$种颜色对珠子染色, 使得在任意连续的 $n+1$ 颗珠子中所有颜色都至少出现一次. 求最大的正整数 $m$, 使得该要求无法实现.

答案 $m$ 的最大值为 $n^{2}-n-1$.

解 先证明 $m=n^{2}-n-1$ 不行. 由抽居原理, 必有一个颜色的珠子不超过 $\left\lfloor\frac{m}{n}\right\rfloor=n-2$ 个. 若题目条件得以满足, 那么这种颜色的任意两个相邻珠子之间隔着不超过 $n$ 个珠子, 这说明总珠子的个数 $\leq(n-2)(n+1)<m$. 矛盾!

再说明当 $m \geq n^{2}-n$ 时, 一定存在一种构造满足题目条件. 考虑如下构造: 把 $m$ 个珠子分成若干长度为 $n$ 或 $n+1$ 的段, 对于长度为 $n$ 的段依次染色 $1,2, \cdots, n$; 对于长度为 $n+1$ 的段依次染色 $1,1,2,3, \cdots, n$. 容易证明该构造满足要求, 只需证明存在非负整数 $k, l$, 使得 $k n+l(n+1)=m$. 取 $k+l=\left\lfloor\frac{m}{n}\right\rfloor=S$,则 $k n+l(n+1)$ 取遍 $S n$ 至 $S(n+1)$ 之间的所有整数, 又

$$
S(n+1) \geq \frac{(m-n+1)(n+1)}{n} \geq m
$$

故一定存在满足条件的 $k, l$.

C3. 两只松鼠 B 和 $\mathrm{J}$ 为过冬收集了 2021 枚核桃. $\mathrm{J}$ 将它们依次编号为 1 至 2021, 并在一棵树的周围挖了一圈共 2021 个小坑. 第二天早上, J 发现 B 已经在每个小坑中放入了一枚核桃, 但并未注意编号. J 决定用 2021 次操作来改变这些核桃的位置. 在第 $k$ 次操作中, $\mathrm{J}$ 把与第 $k$ 号核桃相邻的两枚核桃交换位置. 证明: 存在某个 $k$, 使得在第 $k$ 次操作中, $\mathrm{J}$ 交换了两枚编号为 $a, b$ 的核桃, 且 $a<k<b$.

证明 用反证法, 反设命题不成立. 考虑对每个核桃随着操作黑白染色: 初始所有核桃都是白色的, 在第 $k$ 次操作后, 编号为 $k$ 的核桃被染为黑色. 这样在第 $k$ 次操作后, 所有编号 $\leq k$ 的核桃都是黑色的, $>k$ 的则是白色. 由假设可知操作时左右两边核桃的颜色必定相同, 故问题转化为: 每次将一个核桃染为黑色, 需要保证两边核桃颜色相同, 问是否可以最终将所有核桃染为黑色.

我们证明: 在 $k(k \geq 2)$ 次操作后, 一定存在两个黑色的核桃, 使得它们之间隔着偶数个核桃, 且中间的核桃都是白色的. $k=2$ 时, 因为 2021 为奇数, 一定成立. 设现在核桃 $(s, t)$ 满足条件, 若一次操作将 $s, t$ 之间的一个核桃 $a$ 染为黑色, 则 $(s, a),(a, t)$ 之中必有一个满足条件.

那么在不断操作后, 一定有两个黑色核桃中间只隔着两个白色核桃, 那么这
两个白色核桃永远不会被染色, 与假设矛盾.

评注 主动忽略区别来构造一定的不变性是很有意思的手段, 本题的想法也可以用来解决下列问题:

高空中的一个棋盘上, 有若干只蚂蚁以相同的速度向东西南北方向前进. 若两只相向而行的蚂蚁相遇, 则它们均转动 90 度反向而行. 证明: 所有蚂蚁最终会掉下去。

C4. 在一个国家中有 $n$ 座城市, 任意两座城市之间恰有一条单向道路. 一条从 $X$ 至 $Y$ 的路径是指经过一系列道路, 使得可以从 $X$ 沿着这些道路到达 $Y$, 且不经过重复的城市. 称一个路径集合是多样的, 如果任何道路不属于集合中多于一条路径. 对于两座不同城市 $A, B$, 定义 $N_{A B}$ 为从 $A$ 到 $B$ 的多样的路径集合中路径个数的最大值. 证明: $N_{A B}=N_{B A}$ 当且仅当从 $A$ 出发的道路数与从 $B$ 出发的道路数相同.

证明 下面用 $(X Y)$ 表示图中从 $X$ 到达 $Y$ 的路 (隐含其一定存在). 并定义一条路径是基本的, 若其包含不超过 2 条边.

我们先证明一个引理.

引理若 $N_{A B}=t$, 则存在一个大小为 $t$ 的从 $A$ 到 $B$ 的多样集合 $S$, 满足其包含所有从 $A$ 到 $B$ 的基本路径.

引理证明 因为 $N_{A B}=t$, 则存在一个大小为 $t$ 的从 $A$ 到 $B$ 的多样集合 $P$. 设 $P$ 是满足条件且包含基本路径最多的一个集合. 若一条基本路径 $p$ 未被包含, 则分几种情形讨论:

1) 若 $p$ 的长度为 1 , 则 $P \cup\{p\}$ 仍是多样的集合, 与最大性矛盾.
2) 若 $p$ 的长度为 2 , 设其为 $A \rightarrow X \rightarrow B$.

i. 若 $(A X),(X B)$ 均不在 $P$ 中, 则 $P \cup\{p\}$ 仍为多样的集合, 矛盾.

ii. 若 $(A X)$ 在 $P$ 中但 $(X B)$ 不在 $P$ 中, 则将包含 $(A X)$ 的路径替换为 $p$, 与包含基本路径数的最大性矛盾.

iii. 若 $(X B)$ 在 $P$ 中但 $(A X)$ 不在 $P$ 中, 与 ii 同理.

iv. 若 $(A X),(X B)$ 均在 $P$ 中. 设包含 $(A X)$ 的路径为 $A \rightarrow X \rightarrow Y_{1} \rightarrow \cdots \rightarrow$ $Y_{k} \rightarrow B$, 包含 $(X B)$ 的路径为 $A \rightarrow Z_{1} \rightarrow \cdots \rightarrow Z_{l} \rightarrow X \rightarrow B$, 则将这两条路径替换为 $p$ 及 $A \rightarrow Z_{1} \rightarrow \cdots \rightarrow Z_{l} \rightarrow X \rightarrow Y_{1} \rightarrow \cdots \rightarrow Y_{k} \rightarrow B$. 注意到后者可能经过相同的点, 则将中间形成的圈从路径中删去即可. 与最大性矛盾.

综上, 引理证毕.

回到原题. 将所有异于 $A, B$ 的点划分为四类点: 对于点 $C$, 若 $(A C),(B C)$,
则为 I 类点; 若 $(C A),(C B)$, 则为 II 类点; 若 $(A C),(C B)$, 则为 III 类点; 若 $(C A),(B C)$, 则为 IV 类点. 并不妨有 $(A B)$. 设 $A, B$ 点的出度分别为 $a, b$.

设 $P$ 为从 $A$ 到 $B$ 的一个多样的集合. 我们构造一个从 $B$ 到 $A$ 的一个多样集合 $P^{\prime}$ : 首先它包含所有 IV 类点形成的基本路径. 由引理, 可不妨设 $(A B) \in P$ 且对于所有 III 类点 $C$ 有路径 $A \rightarrow C \rightarrow B$ 在 $P$ 中. 对于 $P$ 中的其余路径 $A \rightarrow X \rightarrow Z_{1} \rightarrow \cdots \rightarrow Z_{l} \rightarrow Y \rightarrow B$, 一定有 $X$ 是 $I$ 类点且 $Y$ 为 $I I$类点, 故也存在 $B \rightarrow X \rightarrow Z_{1} \rightarrow \cdots \rightarrow Z_{l} \rightarrow Y \rightarrow A$, 将其加人 $P^{\prime}$ 中. 那么

$$
|P|-\left|P^{\prime}\right|=\left(1+s_{3}\right)-s_{4}=a-b
$$

其中 $s_{3}, s_{4}$ 代表 III,IV 类点的个数. 故 $N_{A B}-N_{B A} \leq a-b$. 同理可得 $N_{B A}-$ $N_{A B} \leq b-a$, 结合两式得

$$
N_{A B}-N_{B A}=a-b
$$

故 $N_{A B}=N_{B A}$ 当且仅当 $a=b$.

C5. 设整数 $n>k \geq 1$. 有 $2 n+1$ 位同学围成一圈, 每个同学都有 $2 k$ 个邻居, 即左右两边与他最近的各 $k$ 个同学. 已知共有 $n+1$ 个女孩和 $n$ 个男孩, 证明: 存在一个女孩，她的邻居中至少有 $k$ 个女孩。

证明 为了方便论证, 我们将女生记为 1 , 男生记为 0 , 并设这 $2 n+1$ 个数字顺时针排列依次为 $a_{1}, a_{2}, \cdots, a_{2 n+1}$. 以下角标按 $\bmod (2 n+1)$ 理解.

反设命题不成立, 那么对于任意 $a_{i}=1$, 有

$$
\sum_{j=i-k}^{i+k} a_{j} \leq k
$$

对于 $a_{i}=1$, 我们记 $p_{i}$ 为: 从 $a_{i+k+1}$ 开始顺时针方向第一个满足 $a_{j}=1$ 的下标 $j$. 那么一定存在序列 $t_{1}, t_{2}, \cdots, t_{m}$, 满足 $t_{i+1}=p\left(t_{i}\right)(1 \leq i \leq m)$, 其中 $t_{m+1}=t_{1}$. 记 $l_{i}=\left(t_{i+1}-t_{i}\right) \bmod (2 n+1)$ 及

$$
S_{i}=\sum_{j=t_{i}}^{t_{i+1}-1} a_{j}
$$

则由条件可知

$$
\begin{aligned}
S_{i-1}+S_{i} & =\sum_{j=t_{i-1}}^{t_{i}-1} a_{j}+\sum_{j=t_{i}}^{t_{i+1}-1} a_{j} \\
& =\sum_{j=t_{i-1}}^{t_{i}-k-1} a_{j}+\left(\sum_{j=t_{i}-k}^{t_{i}-1} a_{j}+\sum_{j=t_{i}}^{t_{i}+k} a_{j}\right) \\
& \leq\left(l_{i-1}-k\right)+k=l_{i-1}
\end{aligned}
$$

求和, 得

$$
2 \sum_{i=1}^{m} S_{i} \leq \sum_{i=1}^{m} l_{i}
$$

然而设从 $t_{1}$ 到 $t_{2}$, 一直到 $t_{m}$ 再回到 $t_{1}$ 共走了 $q$ 圈, 则

$$
\begin{aligned}
& \sum_{i=1}^{m} l_{i}=q(2 n+1) \\
& \sum_{i=1}^{m} S_{i}=q(n+1)
\end{aligned}
$$

故 $2 q(n+1) \leq q(2 n+1)$, 矛盾!

评注 本题是较为经典的利用平均值原理的模型. 这一类型的问题中, 最经典的是一道小学奥数中的经典问题:

加油站问题一辆车在环形道路上行驶, 初始车内无油. 有一些地方有加油站, 这些加油站的总油量足够汽车环行一圈. 证明: 一定存在一个出发点, 使得汽车可以在环形道路上行使一圈。

对于这类问题, 一般要设出两个关键点之间的部分和, 利用条件得到不等式, 然后相加, 与总量相矛盾. 值得注意的是, 2022 年中国国家集训队测试的第 23 题也是此类问题.

C6. 一个猎人和一只隐身兔在一个无穷大的方格表中玩游戏。首先，猎人用有限多种颜色对每个格染色, 兔子秘密地选择一个出发格. 在每一分钟, 兔子会告诉猎人它当前所在格的颜色, 然后移动到一个未到过的邻格 (即和当前格有公共边的格). 若有限时间后，猎人能够确定兔子的出发格，或者兔子无法移动, 则猎人获胜. 那么猎人是否有必胜策略?

答案 猎人有必胜策略.

证明 首先, 注意到我们可以对一个点染许多颜色. 如果我们对一个点染 $k$个颜色 $c_{1}, c_{2}, \cdots, c_{k}$, 其中第 $i$ 个颜色一共有 $a_{i}$ 种, 那么我们可以将 $a_{1} a_{2} \cdots a_{k}$种不同的 $\left(c_{1}, c_{2}, \cdots, c_{k}\right)$ 分别对应一种颜色, 从而就解决了原问题. 之所以要转化为多个染法, 是因为我们就可以用每个染法来获取不同的信息, 将这些信息整合就能判断出兔子的位置.

对于第一种染法, 我们来确定兔子每次行走的方向. 我们将整个方格表五染色. 设五种颜色编号为 $0,1,2,3,4$, 染色方法满足：两个上下相邻的格, 下格的颜色编号恰为上格颜色编号 +2 ; 两个左右相邻的格, 右格的颜色编号恰为左格颜色编号 +1 (颜色编号按模 5 考虑). 这样, 根据免子连续两步所在格的颜色, 就能判断出兔子这一步的行走方向. 这样, 我们只需要确定兔子当前格在哪里, 就
能沿着线路确定出出发点.

对于第二种染法, 我们二染色 (黑白), 将一些列全部染黑, 满足相邻两黑色列的距离互不相同. 这样, 如果兔子的行走轨迹中跨越了两个黑色列, 我们就能判断出兔子当前的横坐标. 所以, 当兔子轨迹的横坐标有无限种时, 我们可以判断兔子起点的横坐标.

对于第三种染法, 我们同理可以做到：当兔子轨迹的纵坐标有无限种时, 我们可以判断兔子起点的纵坐标.

对于第四种染法, 我们可以将一些斜对角线染黑, 同理可以做到: 当兔子轨迹的所有坐标 $(x, y)$ 满足 $x+y$ 有无限种时, 我们可以判断兔子起点 $\left(x_{0}, y_{0}\right)$ 的 $x_{0}+y_{0}$ 的值.

注意到, 兔子行走轨迹中, $x, y, x+y$ 一定有至少两个有无限种. 于是, 我们可以判断出 $x_{0}, y_{0}, x_{0}+y_{0}$ 其中的两个, 进而可以确定 $x_{0}, y_{0}$ 的值.

评注 这是一道十分有趣的组合构造题. 从思维上的关键就是由一种染法转化为多种染法进行组合, 进而综合这些颜色所得到的信息从而确定出发位置.先确定行走轨迹是自然的想法，但对于后面处理的方法可能会有所不同．笔者认为第四种染法不好想到, 为了处理一维坐标有限的情形, 可以在两个黑列之间再提供信息.

C7. 设整数 $m \geq 2$. 有一个 $3 m \times 3 m$ 的棋盘, 一只青蛙在左下角的格 $S$中, 想到达右上角的格 $F$. 青蛙每次可以向右或向上跳一格. 棋盘上的一些格是秥的, 这意味着当青蛙跳到其中时会被稆住. 称一个方格组成的集合 $X$ 是阻碍的，如果 $X$ 中所有格都是馧的时，青蛙无法从 $S$ 到达 $F$. 称一个阻碍的集合是极小的，如果它不包含一个更小的阻碍集合. 证明:

(1) 存在一个极小的阻碍集合至少包含 $3 m^{2}-3 m$ 个格;

(2) 每个极小的阻碍集合都至多包含 $3 m^{2}$ 个格.

(1) 证明 如下图, 该阻碍集合包含 $3 m^{2}-2 m+2$ 个格. 这里我们用 $x$ 表示阻碍集合包含的格子. 容易证明, 任意去掉一个格, 都会使得存在一条从 $S$ 到 $F$ 的路线.

（2）证明 对于所有不是黏的格子, 我们将所有从 $S$ 能够到达的格子染红,所有能到达 $F$ 的格子染蓝. 由于这是一个阻碍集合, 易得任意一格不能同时染为红色和蓝色. 我们将既不是红色也不是蓝色的格染为绿色. 一个例子如下图所示.

设 $R, B, G$ 分别为红, 蓝, 绿色格子的个数. 我们证明: $G \leq R+1$.


注意到, 从 $R$ 个红格开始, 共有 $2 R$ 种跳法 (这里将跳出边界的不合法跳法也算在内). 因为极小性, 所有绿格应均被遍历到, 同时除了 $S$ 格外的所有红格也都会被遍历到. 于是, $2 R \geq G+(R-1)$, 得到 $G \leq R+1$.

同理, $G \leq B+1$. 又因为 $R+B+G=9 m^{2}$, 我们有

$$
9 m^{2}=R+B+G \geq(G-1)+(G-1)+G=3 G-2
$$

故 $G \leq 3 m^{2}$. 所有黏的格子都会被涂成绿色, 故极小阻碍集合大小一定不超过 $3 m^{2}$.

C8. 求最大的正整数 $N$, 使得存在一个 $N \times 100$ 的数表 $T$, 满足

(i) 每行都是 $1,2, \cdots, 100$ 的一个排列;

(ii) 对任意两个不同的行 $r, s$, 存在一列 $c$, 使得 $|T(r, c)-T(s, c)| \geq 2$. 这里, $T(r, c)$ 表示位于第 $r$ 行第 $c$ 列的格中的数.

答案 最大的正整数 $N$ 为 $\frac{100 !}{2^{50}}$.

解 我们分为构造和证明两部分解决. 合题的每行可以被表式成置换 $\sigma_{i}$ : $\{1,2, \cdots, 100\} \rightarrow\{1,2, \cdots, 100\}(1 \leq i \leq N)$. 其中若第 $i$ 行第 $j$ 列为 $k$, 则 $\sigma_{i}(j)=k$.

记 $\pi_{i}=\sigma_{i}^{-1}, 1 \leq i \leq N$. 则原题条件等价于对任意 $1 \leq i<j \leq N, \pi_{i}$ 与 $\pi_{j}$间无法通过交换若干对两两不交的相邻位相互转化.

我们首先证明 $N \leq \frac{100 !}{2^{50}}$. 对任意 $1 \leq i \leq N$, 定义

$$
S_{i}=\left(\left\{\pi_{i}(1), \pi_{i}(2)\right\},\left\{\pi_{i}(3), \pi_{i}(4)\right\}, \cdots,\left\{\pi_{i}(99), \pi_{i}(100)\right\}\right) .
$$

则易见 $1 \leq i<j \leq N, S_{i} \neq S_{j}$, 否则 $\pi_{i}, \pi_{j}$ 间可相互转化. 又不同的 $S_{i}$ 最多可能有 $\frac{100 !}{2^{50}}$ 种, 故 $N \leq \frac{100 !}{2^{5} 0}$.
下面, 我们给出 $N=\frac{100 !}{2^{50}}$ 时的构造. 对于 $S_{1}, S_{2}, \cdots, S_{N}$ 遍历所有 $\{1,2, \cdots, 100\}$划分为 50 个二元集的方式，我们对应定义 $\pi_{i}(1 \leq i \leq N)$ 如下:

记 $\pi_{i}(0)=0$, 对 $k$ 归纳构造 $\pi_{i}(2 k-1), \pi_{i}(2 k), 1 \leq k \leq 50$.

当需要构造 $k$ 时, 我们定义 $\pi_{i}(2 k-1), \pi_{i}(2 k)$, 使 $\pi_{i}(2 k-2), \pi_{i}(2 k-1), \pi_{i}(2 k)$对应逆序数为偶数且 $\left\{\pi_{i}(2 k-1), \pi_{i}(2 k)\right\}$ 为 $S_{i}$ 第 $k$ 位.

我们来证明此种构造满足条件. 若不然, 考虑 $1 \leq i<j \leq N$ 使 $\pi_{i}$ 与 $\pi_{j}$ 间可通过交换若干对两两不交的相邻位相互转化. 我们考虑使 $\left\{\pi_{i}(2 k-\right.$ $\left.1), \pi_{i}(2 k)\right\} \neq\left\{\pi_{j}(2 k-1), \pi_{j}(2 k)\right\}$ 成立的最大正整数 $k$. 则必有 $\pi_{i}$ 与 $\pi_{j}$ 的第 $2 k-2,2 k-1$ 位互换后 $\pi_{i}(2 k-u)=\pi_{j}(2 k-u), u=0,1,2$. 则它们第 $2 k-2,2 k-1,2 k$ 位对应逆序数相差为 1 , 与均为偶数矛盾!

评注结论是显然的, 主要难在构造, 这里取巧使用了归纳构造 (也是容易想到的), 我们一直寻求有高度对称美感的构造, 但一无所获.

## 几何 (Geometry)

G1. 在平行四边形 $A B C D$ 中, $A C=B C . P$ 是 $A B$ 延长线上一点, $\triangle A C D$的外接圆与线段 $P D$ 交于 $Q, \triangle A P Q$ 的外接圆与线段 $P C$ 交于 $R$. 证明: 直线 $C D, A Q, B R$ 交于一点.



证明 设 $A Q$ 交 $D C$ 于 $E$.

有 $\angle Q R C=\angle P A Q=\angle Q E C$, 故 $Q, R, E, C$ 共圆; $\angle A R C=\angle A Q D=$
$\angle A C D=\angle A B C$, 故 $A, B, R, C$ 共圆. 故有

$$
\angle B R P=\angle B A C=\angle A D C=\angle E Q C=\angle E R C
$$

即 $B, R, E$ 共线. 这说明 $A Q, D C, B R$ 交于一点. 证毕!

G2. 凸四边形 $A B C D$ 有内切圆 $\odot I, \triangle A I C$ 的外接圆为 $\Omega$. 延长 $B A, B C, A D, C D$分别交 $\Omega$ 于 $X, Z, Y, T$, 证明:

$$
A D+D T+T X+X A=C D+D Y+Y Z+Z C
$$



证明 设 $A B, B C, C D, D A$ 分别切 $\odot I$ 于 $P, Q, R, S$.

注意到 $\angle I T R=\angle I Z Q$, 故 $I T=I Z$, 这说明过 $T, Z$ 的 $\odot I$ 切线长相等, 即 $T R=Z Q$. 同理, 由于 $\angle I X P=\angle I Y S$, 故 $I X=I Y$, 有 $X P=Y S$. 由对称性可得 $T X=Y Z$. 观察等式两边,

$$
\begin{aligned}
A D+D T+T X+X A & =(A S+D S)+(T R-D R)+T X+(X P-A P) \\
& =A P+D S+T R-D S+T X+X P-A P \\
& =T R+T X+X P
\end{aligned}
$$

同理有

$$
C D+D Y+Y Z+Z C=Y S+Y Z+Z Q
$$

由 $T R=Z Q, T X=Y Z, X P=Y S$ 得证!

G3. 设 $n$ 是正整数. 给定一个 $2 n \times 2 n$ 的单位点阵 $\mathbf{L}$. 设 $\mathcal{F}$ 是一个多边形集合, 使得其中的每个多边形的顶点都属于 $\mathbf{L}$, 且 $\mathbf{L}$ 中的每个点都恰是 $\mathcal{F}$ 中的一个多边形的顶点. 求 $\mathcal{F}$ 中所有多边形面积之和的最大可能值.

答案 $\frac{1}{3} n^{2}(2 n+1)(2 n-1)$.
解 我们需要利用多边形面积公式:

多边形面积公式设 $O$ 为原点. $n$ 边形的顶点顺时针依次排列为 $P_{1}\left(x_{1}, y_{1}\right)$, $P_{2}\left(x_{2}, y_{2}\right), \cdots, P_{n}\left(x_{n}, y_{n}\right)$, 其面积为 $S$. 则

$$
\begin{aligned}
2 S & =\overrightarrow{O P_{2}} \times \overrightarrow{O P_{1}}+\overrightarrow{O P_{3}} \times \overrightarrow{O P_{2}}+\cdots+\overrightarrow{O P_{1}} \times \overrightarrow{O P_{n}} \\
& =\left(x_{2} y_{1}-x_{1} y_{2}\right)+\left(x_{3} y_{2}-x_{2} y_{3}\right)+\cdots+\left(x_{1} y_{n}-x_{n} y_{1}\right)
\end{aligned}
$$

回到原题. 设 $2 n \times 2 n$ 点阵坐标为 $(i, j)(1 \leq i, j \leq 2 n)$. 由面积公式, 设点 $P$ 在多边形顺时针方向的下一个点为 $P^{\prime}$, 则多边形面积总和为

$$
\frac{1}{2}\left(\sum_{P} y_{P} x_{P^{\prime}}-\sum_{P} x_{P} y_{P^{\prime}}\right)
$$

$P$ 遍历所有格点时, $x_{P}, y_{P}, x_{P^{\prime}}, y_{P^{\prime}}$ 各遍历 $1,2, \cdots, 2 n$ 各 $2 n$ 次. 由排序不等式,得

$$
\begin{gathered}
\sum_{P} y_{P} x_{P^{\prime}} \leq 2 n \cdot\left(1^{2}+2^{2} \cdots+(2 n)^{2}\right) \\
\sum_{P} x_{P} y_{P^{\prime}} \geq 2 n \cdot(1 \cdot 2 n+2 \cdot(2 n-1)+\cdots+2 n \cdot 1)
\end{gathered}
$$

故

$$
\begin{aligned}
S & \leq \frac{1}{2}\left(2 n \sum_{i=1}^{2 n} i^{2}-2 n \sum_{i=1}^{2 n} i(2 n+1-i)\right) \\
& =\frac{1}{3} n^{2}(2 n+1)(2 n-1)
\end{aligned}
$$

对于构造, 我们采用类似 “弦图” 的方式: 每个多边形都是正方形, 顶点为 $(x, y)$, $(2 n+1-x, 2 n+1-y),(2 n+1-y, x),(y, 2 n+1-x)(1 \leq x, y \leq n) . n=2$ 时的情形如下:



图 $1 n=2$ 时的情形, 不同颜色代表不同正方形

评注 代数化处理是最简单的做法，也可以通过局部调整做出.

G4. 四边形 $A B C D$ 内接于圆 $\Omega$, 该圆在 $D$ 处的切线与射线 $B A, B C$ 分别交于 $E, F . T$ 是 $\triangle A B C$ 内一点, 满足 $T E\|C D, T F\| A D . K$ 是线段 $D F$ 上不同于 $D$ 的一点, 满足 $T D=T K$. 证明: 直线 $A C, D T, B K$ 交于一点.

证明 设 $A C$ 分别交 $E T, F T$ 于 $P, Q$. 则有 $\angle A P E=\angle A C D=\angle A D E$, 故



$A, E, D, P$ 共圆. 同理得 $C, F, D, Q$ 共圆.

由 $T E\|C D, T F\| A D$ 得到 $\angle C D A=\angle E T F$, 故

$$
\angle E T F=\angle C D A=\pi-\angle C B A
$$

又因为

$$
\angle P D Q=\pi-\angle E D P-\angle F D Q=\pi-\angle C A B+\angle B C A=\angle C B A
$$

故 $\angle P D Q+\angle P T Q=\pi$, 即 $D, P, T, Q$ 共圆. 同时, 注意到

$$
\angle T D P=\angle T Q P=\angle D A P
$$

故 $D T$ 是 $A E D P$ 外接圆的切线. 同理有另一边, 故 $D T$ 为圆 $A E D P, C F D Q$的公切线. 故 $\angle T K D=\angle T D K=\angle D P E$, 即 $K$ 在圆 $D P T Q$ 上. 有

$$
\angle T K D=\angle E P D=\angle E A D=\angle B D E
$$

故 $T K \| B D$. 结合三组平行和共圆知四边形 $D A B C$ 与 $T Q K P$ 相似, 也有 $\triangle D A B$ 相似于 $\triangle T Q K$. 设 $D T$ 交 $A C$ 于 $X, B K$ 交 $A C$ 于 $Y$, 则 $\frac{A X}{X Q}=\frac{A D}{T Q}$且 $\frac{A Y}{Y Q}=\frac{A B}{Q K}$, 由相似知 $\frac{A X}{X Q}=\frac{A Y}{Y Q}$, 故 $X=Y$.

评注 看出交点是位似中心后, 本题就不难了.

G5. 各边长互不相同的四边形 $A B C D$ 内接于圆 $O . \angle A B C, \angle A D C$ 的平分线分别与 $A C$ 交于 $B_{1}, D_{1}$. 设 $O_{B}$ 为过 $B$ 且与 $A C$ 切于 $D_{1}$ 的圆的圆心, $O_{D}$为过 $D$ 且与 $A C$ 切于 $B_{1}$ 的圆的圆心. 若 $B D_{1} \| D B_{1}$, 证明: $O_{B}, O, O_{D}$ 共线.

证明 设圆 $O$ 与圆 $O_{B}$ 交于 $B, X$, 与圆 $O_{D}$ 交于 $D, Y$. 设圆 $O$ 与 $Y B_{1}$ 再次交于 $U$, 与 $X D_{1}$ 再次交于 $V$, 与 $D B_{1}$ 再次交于 $S$, 与 $B D_{1}$ 再次交于 $T$. 设



$A C$ 中点为 $L$.

由 $A C$ 与圆 $O$ 相切, 得到

$$
\angle T A C=\angle B D_{1} A-\angle B X A=\angle B X V-\angle B X A=\angle A C V
$$

故 $V T \| A C$. 同理 $U S \| A C$. 又 $B D_{1} \| D B_{1}$, 得 $\angle B_{1} S U=\angle D_{1} T V$. 我们有

$$
\frac{A S}{S C} \cdot \frac{A T}{T C}=\left(\frac{A B_{1}}{B_{1} C} \cdot \frac{C D}{A D}\right)\left(\frac{A D_{1}}{D_{1} C} \cdot \frac{B C}{A B}\right)=\frac{A B \cdot C D \cdot A D \cdot B C}{B C \cdot A D \cdot C D \cdot A B}=1
$$

故 $S, L, T$ 共线, 进而 $\triangle L B_{1} S$ 与 $\triangle L D_{1} T$ 相似. 又 $L S=L U, L T=L V$ 且 $S U\|A C\| V T$, 故 $\triangle L S U$ 与 $\triangle L T V$ 相似, 进而 $\triangle B_{1} S U=\triangle D_{1} T V$. 所以

$$
\angle B D_{1} Y=\angle S U Y=\angle S U B_{1}=\angle T V D_{1}=\angle T V X=\angle D_{1} B X
$$

又 $B_{1} D \| B D_{1}$, 故 $B X \| D Y$, 这立即得到 $O_{B} O O_{D}$ 共线.

评注 注意到圆内接四边形 $A B C D$ 并不是一般的, 故采用计算方法会较为困难.

G6. 求所有整数 $n \geq 3$, 使得任何边长为 1 的等边凸 $n$ 边形都包含一个边长为 1 的正三角形. (含边界)

答案 所有 $\geq 3$ 的奇数.

解 我们首先说明, 当 $n \geq 4$ 为偶数时, 命题不成立, 即存在一个边长为 1 的等边凸 $n$ 边形 $A_{0} A_{1} \cdots A_{n-1}$, 其内部不存在边长为 1 的正三角形. 令 $n=2 k$,让 $A_{0}, A_{k}$ 均在 $x$ 轴上, $A_{1}, A_{2}, \cdots, A_{k-1}$ 在 $x$ 轴上侧, $A_{k+i}$ 和 $A_{k-i}$ 关于 $x$ 轴
对称 $(i=1,2, \cdots, k-1)$. 我们让 $A_{1}, \cdots, A_{k-1}$ 的纵坐标始终不超过 $\epsilon \rightarrow 0$, 这样显然满足要求.



下设 $n=2 k+1\left(k \in \mathbb{N}_{+}\right)$, 来证命题成立. 当 $k=1$ 时结论平凡, 来看 $k \geq 2$时的情形. 设 $P=A_{0} A_{1} \cdots A_{2 k}$ 的最长对角线长度为 $d$, 这条最长的对角线将 $P$分为了两部分, 由抽屉原理, 必定有一部分含有至少 $k+1$ 条原多边形的边. 于是可不妨设 $d=A_{0} A_{l}, l \geq k+1$. 我们证明, 在多边形 $A_{0} A_{1} \cdots A_{l}$ 中必定存在边长为 1 的正三角形.

如果 $\angle A_{l} A_{0} A_{1} \geq \frac{\pi}{3}$. 因为 $d$ 的最大性, 有 $A_{1} A_{l} \leq A_{0} A_{l}$, 所以 $\angle A_{0} A_{1} A_{l} \geq$ $\angle A_{l} A_{0} A_{1} \geq \frac{\pi}{3}$. 这表明, 以 $A_{0} A_{1}$ 为边的一个向内的边长为 1 的正三角形完全包含在了 $\triangle A_{0} A_{1} A_{l}$ 中, 命题得证.

下设 $\angle A_{l} A_{0} A_{1}, \angle A_{l-1} A_{l} A_{0}$ 都小于 $\frac{\pi}{3}$. 如图所示, 考虑一个等腰梯形 $A_{0} S T A_{l}$,

其中 $A_{0} A_{l} \| S T, A_{0} S=A_{l} T=1, \angle A_{l} A_{0} S=\angle A_{0} A_{l} T=\frac{\pi}{3}$. 如果 $A_{1}, A_{2}, \cdots, A_{l-1}$全部包含在了 $A_{0} S T A_{1}$ 内, 那么

$$
\begin{aligned}
l & =A_{0} A_{1}+A_{1} A_{2}+\cdots+A_{l-1} A_{l} \\
& \leq A_{0} S+S T+T A_{l}=d+1
\end{aligned}
$$

故 $l-1 \leq d$. 考虑另一边的 $A_{l} A_{l+1} \cdots A_{0}$, 共有 $n-l \leq l-1$ 条长为 1 的边, 然而一条边 $A_{0} A_{l}$ 长为 $d \geq l-1$, 矛盾!

于是, 存在一点 $A_{p}$ 在 $A_{0} S T A_{l}$ 外. 我们作其中一边在 $A_{0} A_{l}$ 上的单位正三角形, 满足 $A_{p}$ 在它得到一条对称轴上, 如图所示. 这即证明了原问题!


注 对于 $n \geq 3$ 为奇数, 还可以证明更强的命题：存在 $i$, 使得单位正三角形 $A_{i} A_{i+1} B$ 被完全包含在 $P$ 中.

评注 $n$ 是偶数时的构造是自然的, 但是 $n$ 是奇数的证明略显困难. 重在如何刻画多边形内部一定会有空隙这一点, 这里我们考虑了最长的对角线, 利用两边边数差, 得到边数较多的一侧一定会有一个点离对角线的距离较长, 从而证明了原题.

G7. 在锐角三角形 $A B C$ 中, $A B>A C, D$ 是其形内一点且在 $\angle B A C$ 的角平分线上. 边 $A C$ 上一点 $E$ 满足 $\angle A D E=\angle B C D$, 边 $A B$ 上一点 $F$ 满足 $\angle A D F=\angle C B D$, 直线 $A C$ 上一点 $X$ 满足 $B X=C X$. 设 $O_{1}, O_{2}$ 分别为 $\triangle A D C, \triangle E D X$ 的外心, 证明: $B C, E F, O_{1} O_{2}$ 交于一点.



证明 设 $Q$ 是 $D$ 在 $\triangle A B C$ 内的等角共轭点. 因为 $D$ 在 $\angle B A C$ 的平分线上, 有 $A, D, Q$ 共线. 因为

$$
\begin{aligned}
& \angle A D E=\angle B C D=\angle A C Q, \\
& \angle A D F=\angle C B D=\angle A B Q,
\end{aligned}
$$

所以 $D, E, C, Q$ 和 $D, F, B, Q$ 分别共圆. 于是,

$$
A E \cdot A C=A D \cdot A Q=A F \cdot A B,
$$

进而 $C, E, F, B$ 共圆.

注意到 $\angle F D E+\angle B D C=\pi$, 所以 $D$ 在 CEFB 中存在等角共轭点, 它即为 $Q$. 于是

$$
\angle F D B=\pi-\angle E D C=\pi-\angle E Q C
$$

$$
=\angle Q E C+\angle Q C E=\angle D E F+\angle D C B
$$

所以 $D E F$ 的外接圆与 $D B C$ 的外接圆相切, 设它们的内公切线为 $l$. 于是, 我们对 $\odot(D E F), \odot(D B C), \odot(C E F B)$ 用根心定理, 得到 $B C, E F$ 及 $l$ 交于一点,设其为 $T$.

设 $M$ 为 $\triangle A E F, \triangle A B C$ 外接圆的另一个交点, 对 $\odot(A E F), \odot(A B C), \odot(C$ $E F B)$ 用根心定理, 得到 $A, M, T$ 共线. 所以, 有

$$
T D^{2}=T B \cdot T C=T E \cdot T F=T A \cdot T M
$$

以 $T$ 为中心, $T D$ 为半径反演. 则 $D \leftrightarrow D, B \leftrightarrow C, E \leftrightarrow F, A \leftrightarrow M$, 所以 $\odot(A D C) \leftrightarrow \odot(M D B)$. 设 $\odot(A D C), \odot(M D B)$ 交于不同于 $D$ 的一点 $K$, 则 $K \leftrightarrow K$, 故 $T, O_{1}$ 都在 $D K$ 的中垂线上. 所以, 只需证明 $E, D, X, K$ 共圆, 这样 $O_{2}$ 也在 $D K$ 的中垂线上, 进而 $O_{1} O_{2}$ 过点 $T$.

对 $\odot(A D C K), \odot(M D B K), \odot(A B C M)$ 用根心定理, 得到 $D K, B M, A C$ 交于一点, 设其为 $P$. 因为

$$
\begin{aligned}
\angle B M E & =\angle A M E-\angle A M B \\
& =\pi-\angle A F E-\angle A C B \\
& =\pi-2 \angle A C B=\angle B X C,
\end{aligned}
$$

所以 $B, X, M, E$ 共圆. 故

$$
X P \cdot P E=B P \cdot P M=D P \cdot P K
$$

于是 $X, E, D, K$ 共圆. 综上, 命题得证!

G8. 在 $\triangle A B C$ 中, 外接圆 $\omega$ 与 $A$-旁切圆 $\Omega_{A}$ 交于 $X, Y$. 设 $P, Q$ 分别是 $A$ 在 $\Omega_{A}$ 在 $X, Y$ 处切线上的投影, $\triangle A P X$ 外接圆在 $P$ 处切线与 $\triangle A Q Y$ 在 $Q$处切线交于 $R$. 证明: $A R \perp B C$.

证明 作 $\Omega_{A}$ 的另一条平行于 $B C$ 的切线 $l$, 设 $P X$ 交 $l$ 于 $Z, X P$ 与 $\omega$ 再次交于 $U$. 我们重新定义 $R$ 为 $A$ 在 $l$ 上的垂足, 来证 $P R$ 与 $\triangle A P X$ 外接圆相切.

注意到, $\angle A P Z=\angle A R Z=\frac{\pi}{2}$, 所以 $A, P, R, Z$ 共圆. 故 $\angle Z P R=\angle Z A R=$ $\frac{\pi}{2}-\angle A Z R$, 所以只需要证明 $\angle A Z R=\angle A X P$, 即 $l$ 与 $\triangle A X Z$ 外接圆相切.

对 $A B C$ 及退化的三角形 $U U X$ 用彭赛列闭合定理, 得到 $U$ 在 $\omega, \Omega_{A}$ 的公切线的切点上.

我们考虑这个问题 (实际上是转换了作图方式): $\triangle U Z V$ 的内切圆 $\Omega_{A}$ 与


$U Z$ 切于 $X$. 设过 $U, X$ 且与 $U V$ 相切的圆与 $\odot(U Z V)$ 交于 $A$. 过 $A$ 作 $\Omega_{A}$ 的切线, 交 $\odot(A U X)$ 于 $B, C(\neq A)$. 证明: $B C \| Z V .(*)$

我们证明, 若解决了该问题, 则解决了原问题. 我们忽略 $l \| B C$ 的条件, 考虑所有 $l$ 的方向使得 $\Omega_{A}$ 是 $\triangle U Z V$ 的内切圆. 注意到, $\angle A V Z$ 在 0 至 $\pi$ 上是单调的, 故恰好有一个方向满足 $A U V Z$ 共圆. 对 $\triangle U Z V$ 用 Miquel 定理, 得到 $\odot(A X Z)$ 与 $Z V$ 相切, 所以我们只需要证明 $l \| B C$ 即可.

下解决 $(*)$ 所述问题. 设 $A B, A C$ 交 $\odot(A U V Z)$ 于 $D, E, I_{A}$ 为 $\Omega_{A}$ 的圆心, $U V$ 切 $\Omega_{A}$ 于 $X^{\prime}$.

对 $U Z V$ 及 $A D E$ 用彭赛列闭合定理, 得到 $D E$ 与 $\Omega_{A}$ 相切. 注意到,

$$
\angle B U C=\angle B A C=\angle D A E=\angle D U E \text {, }
$$

故 $\angle B U E, \angle C U D$ 共角平分线.

设 $l_{1}$ 为一条垂直于 $\angle B U E$ 角平分线的直线, 并且 $U B, U C, U D, U E, U X, U X^{\prime}$分别交 $l_{1}$ 于 $B^{*}, C^{*}, D^{*}, E^{*}, X^{*}, X^{* *}$. 由对称性, 我们有 $B^{*} C^{*}=D^{*} E^{*}$, 于是 $B^{*} E^{*}, C^{*} D^{*}$ 共中点, 记其为 $M$.

由笛沙格对合定理的对偶形式，存在线束之间的对合变换，使得 $U B, U E$; $U C, U D ; U X, U X^{\prime}$ 分别对换. 于是, 存在一种对合变换, 将 $B^{*}, C^{*}, X^{*}$ 分别变为 $E^{*}, D^{*}, X^{* *}$. 该变换一定是在 $M$ 处的一个反射, 所以 $\angle B U E$ 的平分线也与 $\angle X U X^{\prime}$ 的平分线重合. 于是, 设 $U B$ 与 $\odot(A U V Z)$ 交于 $B^{\prime}$, 有 $\angle B^{\prime} U Z=$ $\angle V U E$, 所以 $B^{\prime} E \| l$. 由 Reim 定理, 可得 $B^{\prime} E \| B C$, 进而 $l \| B C$, 得证!

## 数论 (Number Theory)

N1. 求所有的正整数 $n$, 使得存在正整数 $a, b$, 满足 $a^{2}+b+3$ 不能被任何
质数的立方整除, 且

$$
n=\frac{a b+3 b+8}{a^{2}+b+3}
$$

答案 $n=2$.

解 注意到

$$
n=\frac{a b+3 b+8}{a^{2}+b+3}=(a+3)-\frac{(a+3)\left(a^{2}+3\right)-8}{b+\left(a^{2}+3\right)}=\frac{(a+3)(a+1)^{3}}{b+\left(a^{2}+3\right)},
$$

因此 $b+\left(a^{2}+3\right) \mid(a+1)^{3}$. 由于 $a+1 \geq 2$, 故可设

$$
a+1=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \cdots p_{t}^{\alpha_{t}}
$$

其中 $p_{1}<p_{2}<\cdots<p_{t}$ 为质数, $t, \alpha_{1}, \alpha_{2}, \cdots, \alpha_{t}$ 是正整数. 于是, 有

$$
b+\left(a^{2}+3\right) \mid p_{1}^{3 \alpha_{1}} p_{2}^{3 \alpha_{2}} \cdots p_{t}^{3 \alpha_{t}}
$$

因为 $b+\left(a^{2}+3\right)$ 不被任何质数的立方整除, 故

$$
b+\left(a^{2}+3\right) \mid p_{1}^{2} p_{2}^{2} \cdots p_{t}^{2}
$$

因此,

$$
b+\left(a^{2}+3\right) \leq p_{1}^{2} p_{2}^{2} \cdots p_{t}^{2} \leq p_{1}^{2 \alpha_{1}} p_{2}^{2 \alpha_{2}} \cdots p_{t}^{2 \alpha_{t}}=(a+1)^{2}
$$

从而

$$
\frac{(a+1)^{3}}{b+\left(a^{2}+3\right)} \geq \frac{(a+1)^{3}}{(a+1)^{2}}=a+1
$$

因为 $a+2 X(a+1)^{3}$, 所以 $\frac{(a+1)^{3}}{b+\left(a^{2}+3\right)} \neq a+2$. 又因为

$$
n=(a+3)-\frac{(a+3)\left(a^{2}+3\right)-8}{b+\left(a^{2}+3\right)}<n+3
$$

且 $n$ 为正整数, 我们得到必有 $n=2$.

当 $a=b=n=2$ 时, 满足条件. 从而 $n=2$.

N2. 设整数 $n \geq 100$. 将 $n, n+1, \cdots, 2 n$ 任意分为两组, 证明: 总存在同组的两个数之和是完全平方数.

证明 对三个正整数 $a, b, c$, 如果 $a+b, b+c, c+a$ 均为完全平方数, 那么将它们分为两组, 一定存在两个数同组, 进而它们的和是完全平方数.

事实上, 我们取 $a+b=(2 k-1)^{2}, a+c=(2 k)^{2}, b+c=(2 k+1)^{2}$, 得到 $a=2 k^{2}-4 k, b=2 k^{2}+1, c=2 k^{2}+4 k$. 故对于原题而言, 只需要证明存在正整数 $k$ 满足

$$
n \leq 2 k^{2}-4 k<2 k^{2}+4 k \leq 2 n
$$

这等价于

$$
k^{2}+2 k \leq n \leq 2 k^{2}-4 k
$$

由于当 $k \geq 9$ 时 $2 k^{2}-4 k+1 \geq(k+1)^{2}+2(k+1)$, 于是

$$
\bigcup_{k=9}^{\infty}\left[k^{2}+2 k, 2 k^{2}-4 k\right]
$$

包含所有不小于 $9^{2}+2 \cdot 9=99$ 的整数, 所以也一定包含 $n$. 故原题得证!

注 结论在 $n=98$ 时不成立. 其中一个构造是, 其中一组恰好包含 $98,100, \cdots, 124,126 ; 129,131, \cdots, 159,161 ; 162,164, \cdots, 194,196$.

N3. 求所有的正整数 $n$, 满足 $n$ 的全体 $k$ 个正因数可以排列为 $d_{1}, d_{2}, \cdots, d_{k}$,使得对任意 $i=1,2, \cdots, k, d_{1}+d_{2}+\cdots+d_{i}$ 都是完全平方数.

答案 $n=1,3$.

解 我们对 $m$ 归纳证明 $d_{m}=2 m-1(1 \leq m \leq k)$.

当 $m=1$ 时, 我们来证 $d_{1}=1$. 反设 $d_{t}=1(t \geq 2)$, 设 $d_{1}+\cdots+d_{t-1}=A$,那么 $A, A+1$ 均为完全平方数, 且 $A$ 为正整数, 矛盾! 因此归纳奠基得证.

若 $1,2, \cdots, m-1$ 时都成立, 则 $m$ 时, 我们证明 $d_{m}=2 m-1$.

由于归纳假设, 我们有 $d_{1}+d_{2}+\cdots+d_{m-1}=(m-1)^{2}$. 设 $d_{1}+d_{2}+\cdots+d_{m}=$ $a^{2}$, 即 $d_{m}=a^{2}-(m-1)^{2}(a \geq m)$. 于是 $d_{m}$ 有因子 $a+m-1$, 所以 $a+m-1 \mid n$,故它也在 $d_{1}, \cdots, d_{k}$ 中出现.

因为 $a+m-1 \geq 2 m-1$, 所以它大于 $d_{1}, d_{2}, \cdots, d_{m-1}$, 于是 $a+m-1=$ $d_{l}(l \geq m)$. 如果 $l=m$ 立即得到 $a=m$, 否则 $l>m$. 我们设 $d_{1}+\cdots+d_{l-1}=B^{2}$,于是 $B^{2}+(a+m-1)$ 均为完全平方数. 从而,

$$
a+m-1 \geq 2 B+1 \geq 2 \cdot \sqrt{d_{1}+\cdots+d_{m}}+1=2 a+1
$$

这与 $a \geq m$ 矛盾!

综上, 我们归纳证明了 $d_{m}=2 m-1$ 对任意 $m=1,2, \cdots, k$ 成立. 所以 $n=\max \left\{d_{1}, d_{2}, \cdots, d_{k}\right\}=2 k-1$, 又因为 $2 k-3 \mid 2 k-1$, 故 $k$ 只能为 1,2 , 分别对应 $n=1,3$.

N4. 设有理数 $r>1 . A$ 在一条直线上玩跳棋游戏, 初始 0 处有一枚红棋子, 1 处有一枚蓝棋子. 在一次操作中, $A$ 选择一枚棋子和一个整数 $k$, 若选择的棋子在 $x$ 处且另一枚棋子在 $y$ 处, 则可将 $x$ 处的棋子移至 $x^{\prime}$ 处, 这里 $x^{\prime}$ 满足 $x^{\prime}-y=r^{k}(x-y)$. 求所有的 $r$, 使得 $A$ 在 2021 次操作内可以将红棋子移至 1 处.
答案 $r=\frac{q+1}{q}, 1 \leq q \leq 1010$.

解 我们建立数轴, 使 0 的对应点为 $B, 1$ 的对应点为 $R$. 则红蓝两子保持在数轴上跳动.

在某个时刻中, 设蓝子位于点 $u$, 红字位于点 $v$, 此时定义 $f=\frac{u}{u-v}$. 则初始时, $f=0$, 且在某次操作中, $f \rightarrow r^{k} \cdot f$ 或 $f \rightarrow r^{k} \cdot f+1-r^{k}$.

于是对待定的 $r$, 操作结束后的 $f$ 可写为 $f(r)=\sum_{t \in S} a_{t} r^{t}$, 其中 $S$ 为某个整数集, $a_{t}$ 是正整数 $(t \in S)$.

于是操作结束后红子到达 0 的对应点当且仅当此时 $f=1$. 因此满足条件的 $r \in \mathbb{Q}_{>1}$ 为 $f(r)=1$ 的根.

又因为每次操作不改变 $f(1)$, 故最终所得函数亦有 $f(1)=0$.

注意到 $f(r)$ 是一个关于 $r$ 的若干幂次分别乘以某个系数之和, 故可将 $f(r)$适当乘以某个 $r^{l}\left(l \in \mathbb{Z}_{+}\right)$的幂使之成为整系数多项式, 设为 $g(r)+x^{l}$. 则 $r$ 为 $g(x)=0$ 的根. 设 $r=\frac{p}{q},(p, q)=1, p>q$. 则 $g\left(\frac{p}{q}\right)=0$. 因此

$$
p x-q \mid g(x)
$$

故 $p-q \mid g(1)$. 又 $g(1)=1^{l} \cdot f(1)-1=-1$, 故 $p-q \mid 1$, 从而 $p=q+1$.

我们不妨使操作 $f \rightarrow r^{k} \cdot f$ 或操作 $f \rightarrow r^{k} \cdot f+1-r^{k}$ 轮流进行, 因为两次相同种类的操作可以合并成一次. 故每两次操作最多有一次使 $g$ 末项系数绝对值增加 1 , 另一次不变. 又因为初始有末项系数绝对值不超过 1 , 因此最终 $g$末项系数不超过 1012 , 从而 $q+1 \leq 1012, q \leq 1011$. 特别地, 若 $q=1011$, 则 $r=\frac{1012}{1011}$.

由各项系数绝对值每两次最多增加 2 , 且可以不妨设 $g$ 的首项系数为正, 可知 $g(x)=x^{m} \cdot(1011 x-1012)$. 在此时必然所有奇数步进行操作 $f \rightarrow r^{k} \cdot f+1-r^{k}$,偶数步进行操作 $f \rightarrow r^{k} \cdot f$, 且取的 $k$ 正负交替, 且绝对值不变. 由于最后一次只进行了前一种操作, 可验证知不成立.

另一方面, 当 $r=\frac{q+1}{q}(1 \leq q \leq 1010)$ 时, 蓝子 (取 $k=1$ ) 红子 (取 $k=-1)$ 轮流操作 $q$ 次即可.

综上, 得证.

评注 本题难度适中, 主要是看出应当固定两枚棋子取考虑在此尺度下 1 所在点的移动, 这里 1 在此尺度下的位置其实就是本题的 $f$. 看出 $f$ 类似多项式后自然可以想到使用因式定理，此后分析首末项系数即可.

N5. 证明: $n !=a^{n-1}+b^{n-1}+c^{n-1}$ 只有有限多组正整数解.
证明 熟知以下不等式对任意正整数 $n$ 及质数 $p$ 成立:

$$
v_{p}(n !)<\frac{n}{p-1}
$$

我们证明, 当 $n \geq 100$ 时, 原方程没有正整数解, 从而证明了只有有限多组正整数解. 反设存在 $(n, a, b, c)$ 满足 $n \geq 100$, 且 $n !=a^{n-1}+b^{n-1}+c^{n-1}$.

当 $n$ 是奇数时, $2 \mid n-1$, 于是 $x^{n-1} \equiv 0,1(\bmod 4)$ 对任意 $x$ 成立. 因为 $4 \mid n !$,所以 $a, b, c$ 只能均为偶数, 但此时有右边是 $2^{n-1}$ 的倍数, 又

$$
v_{2}(n !)=n-S_{2}(n) \leq n-2<n-1,
$$

矛盾! 于是 $n$ 为偶数.

为了方便估计, 我们先证明一个引理.

引理 $n !<\left(\frac{n-1}{2}\right)^{n-1}$.

引理的证明 因为

$$
\begin{aligned}
n ! & =2 n(n-1)(n-2)(n-3) \cdot(3 \cdot 4 \cdots(n-4)) \\
& \leq 2(n-1)^{4}\left(\frac{3+\cdots+(n-4)}{n-6}\right)^{n-6} \\
& =2(n-1)^{4}\left(\frac{n-1}{2}\right)^{n-6}<\left(\frac{n-1}{2}\right)^{n-1},
\end{aligned}
$$

得证.

回到原题. 如果 $a+b$ 含有某个奇质因子 $p$, 那么 $p \mid a^{n-1}+b^{n-1}$. 根据引理, $a, b<(n-1) / 2$, 故 $a+b<n$, 所以 $p \mid n !$, 故 $p \mid c$. 如果 $p \mid a, b$, 那么

$$
\frac{n}{p-1}>v_{p}(n !)=v_{p}\left(a^{n-1}+b^{n-1}+c^{n-1}\right) \geq n-1,
$$

矛盾. 所以 $p \nmid a, b$, 我们有

$$
v_{p}\left(a^{n-1}+b^{n-1}\right)=v_{p}(a+b)+v_{p}(n-1) \text {, }
$$

且 $v_{p}\left(c^{n-1}\right)>n-1>v_{p}(a+b)+v_{p}(n-1)$, 于是

$$
v_{p}(n !)=v_{p}(a+b)+v_{p}(n-1) .
$$

又 $a+b<n-1$, 这表明, $1,2, \cdots, n$ 中除去 $a+b, n-1$ 外都不是 $p$ 的倍数. 又 $p \mid c$, 即 $p<n / 2$, 说明 $1,2, \cdots, n$ 中至少有两个 $p$ 的倍数. 故 $n-1=2 p$, 这与 $n$为偶数矛盾.

综上所述, $a+b, b+c, c+a$ 都是 2 的幂. 不妨设 $a \leq b \leq c$. 因为 $v_{2}(n !)<n$,故 $a, b, c$ 不能都是 4 的倍数, 又 $a, b, c>0$, 容易得到只能 $a=b=2, c=$ $2^{r}-2(r \geq 2)$. 注意到 $c \mid n !$, 故 $c \mid a^{n-1}+b^{n-1}=2^{n}$, 这表明 $c$ 也是 2 的幂, 于是 $r=2$. 这立即推出 $n !=3 \cdot 2^{n-1}$, 显然矛盾!
综上, $n \geq 100$ 时无正整数解.

N6. 求所有整数 $n \geq 2$, 使得对于任意 $n$ 个和不被 $n$ 整除且互不相同的正整数, 总能将它们按某种顺序排列为 $a_{1}, a_{2}, \cdots, a_{n}$, 使得

$$
n \mid 1 \cdot a_{1}+2 \cdot a_{2}+\cdots+n \cdot a_{n}
$$

答案 $n$ 为奇数或 $n$ 为 2 的幂.

解 先来证明 $n$ 为非 2 的幂的偶数时, 原题不成立.

设 $n=2^{k} m(k \geq 1, m \geq 3$ 且 $m$ 为奇数 $)$.

$$
a_{1} \equiv a_{2} \equiv \cdots \equiv a_{n-1} \equiv 1, a_{n} \equiv 2^{k}+1 \quad(\bmod n)
$$

注意到 $a_{1} \equiv a_{2} \equiv \cdots \equiv a_{n} \equiv 1\left(\bmod 2^{k}\right)$, 故

$$
\sum_{i=1}^{n} i a_{i} \equiv \frac{n(n+1)}{2}\left(\bmod 2^{k}\right)
$$

而 $2^{k} \times \frac{n(n+1)}{2}$, 故

$$
2^{k} \chi \sum_{i=1}^{n} i a_{i} \equiv \frac{n(n+1)}{2}
$$

从而

$$
n \not \sum_{i=1}^{n} i a_{i} \equiv \frac{n(n+1)}{2} .
$$

再来证明当 $n$ 为奇数或 $n$ 为 2 的幂时, 原题成立.

我们记 $S$ 为选定的 $n$ 个正整数所构成的集合, $s$ 为 $S$ 中所有数的和.

注意到, 对任意 $x=1,2, \cdots, n-1$, 有

$$
\sum_{i=1}^{n} i a_{i+x} \equiv \sum_{i=1}^{n}(i-x) a_{i} \equiv \sum_{i=1}^{n} i a_{i}-x s \quad(\bmod n)
$$

于是, 我们只需要找到一个排列 $a$, 使得

$$
\sum_{i=1}^{n} i a_{i} \equiv 0 \quad(\bmod (n, s))
$$

即可通过调整 $x$ 的取值使得 $b_{i}=a_{i+x}$ 满足条件.

我们先证明一个引理.

引理若 $m>1$, 则对于任意正整数集 $|S|=m k$, 它可以被划分为 $m$ 个大小均为 $k$ 的子集 $T_{1}, T_{2}, \cdots, T_{m}$, 使得对任意 $1 \leq i \leq m$, 要么 $T_{i}$ 中所有数之和不是 $k$ 的倍数, 要么 $T_{i}$ 中所有数 $\bmod k$ 同余.

引理的证明 对 $m$ 归纳证明这一命题.

先讨论 $m=2$ 时的情形. 如果 $S$ 中不存在 $k$ 个数 $\bmod k$ 同余, 那么一
定存在三个数 $a, b, c$ 互相不同余. 那么, 任取 $U$ 是 $S-\{a, b, c\}$ 的 $k-1$ 元子集, $U \cup\{a\}, U \cup\{b\}, U \cup\{c\}$ 中一定存在一个集合 $U_{0}$, 使得 $U_{0}$ 中所有元素之和 $\bmod k$ 不为 $0, s$, 此时划分 $U_{0}, S-U_{0}$ 满足条件!

如果 $S$ 中存在 $k$ 个数 $\bmod k$ 同余. 我们让这些数同属一个集合 $A$, 其它元素属于 $B$. 如果 $B$ 中元素之和不是 $k$ 的倍数, 已经得证. 否则, $s \equiv 0$ $(\bmod k)$, 于是如果 $S$ 中存在两数不同余, 可以选取 $|U|=k$, 使 $U$ 中元素之和 $\bmod k$ 不为 0 , 此时 $U, S-U$ 是满足条件的划分; 如果 $S$ 中所有数 $\bmod k$ 都同余, 那么任意一种划分方式都是满足条件的.

当 $m-1$ 时成立, 来讨论 $m$ 时的情形 $(m \geq 3)$. 如果 $S$ 中存在 $k$ 个数 $\bmod k$ 同余, 直接将它们放为一组, 用 $m-1$ 时的归纳假设; 否则一定存在 $k$ 个数, 它们的和不是 $k$ 的倍数, 将它们放为一组用归纳假设即可. 引理得证.

回到原题. 下证结论在 $n$ 是奇数或 2 的幂时成立.

如果 $n$ 是质数, 则由此时 $(n, s)=1$, 即知结论成立. 对于一般的情形, 我们可取质数 $p$ 及正整数 $t$ 使得 $p^{t} \mid n, p^{t}$ 〈s. 故由引理, 我们可以将 $S$ 划分为 $p$ 个 $\frac{n}{p}=: k$ 元集, 使得对每个集合, 要么其元素和不是 $k$ 的倍数, 要么其元素模 $k$ 余数全部相同.

对于第一种情况的集合, 由归纳假设知其内部存在一个排列 $a$, 使得

$$
k \mid \sum_{i=1}^{k} i a_{i}
$$

若 $n$ 是奇数, 则 $k$ 亦为奇数, 对第二种情况的集合内部的任意排列 $b$, 均有

$$
\sum_{i=1}^{k} i b_{i} \equiv b_{1} \frac{k(k+1)}{2} \equiv 0 \quad(\bmod k)
$$

将这些排列结合起来, 我们可以得到 $S$ 中元素的一组排列 $c$, 使得

$$
k \mid \sum_{i=1}^{k} i c_{i}
$$

由 $(n, s) \mid k$, 知此时成立.

下讨论 $n=2^{t}, t \in \mathbb{N}_{+}$的情形. 此时 $p=2, k=2^{t-1}$. 故对于任意上述子集,存在一个排列 $\left(a_{1}, a_{2}, \cdots, a_{k}\right)$, 使得

$$
2^{t-2} \mid \sum_{i=1}^{k} i a_{i}
$$

这是因为, 若该子集属于第一种情况, 它是 $k$ 的倍数; 若该子集属于第二种情况,则

$$
\sum_{i=1}^{k} i a_{i} \equiv a_{1} \frac{k(k+1)}{2} \equiv 0 \quad\left(\bmod \frac{k}{2}\right)
$$

此时我们将这两个排列均按顺序轮流放人新排列, 可生成一个新排列, 这两个排列一个位于新排列的奇数位, 一个位于偶数位. 他们对应都分别为 $k$ 的倍数:

$$
\sum_{i=1}^{k}(2 i-1) a_{i} \equiv \sum_{i=1}^{k} 2 i a_{i} \equiv 2 \sum_{i=1}^{k} i a_{i} \equiv 0 \quad(\bmod k)
$$

于是新排列符合要求. 因为 $(n, s) \mid k$, 知此时成立.

评注 $n$ 为质数的情况是简单的, 其余情况都是仿照 $n$ 为质数时的情况进行微调处理.

N7. 设 $a_{1}, a_{2}, \cdots$ 是无穷正整数列, 满足对任意正整数 $m, n$, 都有 $a_{n+2 m} \mid a_{n}+$ $a_{n+m}$. 证明: 存在正整数 $N, T$, 满足对于任意正整数 $n \geq N$, 都有 $a_{n}=a_{n+T}$.

证明 我们先证明, $\left\{a_{n}\right\}$ 是有界的.

反设 $\left\{a_{n}\right\}$ 无界. 于是, 对于任意正整数 $T$, 都存在 $N$, 使得 $a_{N} \geq T$, 且 $a_{N}>\max \left\{a_{1}, a_{2}, \cdots, a_{N-1}\right\}$. 我们取 $T$ 充分大, 从而 $N$ 也充分大.

注意到 $a_{N} \mid a_{N-1}+a_{N-2}$, 而 $a_{N-1}, a_{N-2}<a_{N}$, 故只能 $a_{N-1}+a_{N-2}=a_{N}$.同理可得 $a_{N-2}+a_{N-4}=a_{N}, a_{N-4}+a_{N-8}=a_{N}$. 所以, 我们有

$$
a_{N-1}=a_{N-4}, a_{N-2}=a_{N-8}
$$

再结合 $a_{N-1} \mid a_{N-4}+a_{N-7}$ 得到 $a_{N-1} \mid a_{N-7}$. 再用 $a_{N-1}=a_{N-4} \mid a_{N-7}+a_{N-10}$,得到 $a_{N-1} \mid a_{N-10}$; 又 $a_{N-7} \mid a_{N-10}+a_{N-13}$, 有 $a_{N-1} \mid a_{N-13}$. 以此类推, 得到 $a_{N-1} \mid a_{N-3 k-1}$ 对任意 $3 k+1<N$ 成立.

因为 $a_{N-2} \mid a_{N-5}+a_{N-8}$, 得到 $a_{N-2} \mid a_{N-5}$. 这样, 同上推导可得 $a_{N-2} \mid a_{N-3 k-2}$对任意 $3 k+2<N$ 成立.

所以, $a_{N-1}+a_{N-2}<a_{1}+a_{2}+a_{3}$, 这即 $a_{N}<a_{1}+a_{2}+a_{3}$. 取 $T>a_{1}+a_{2}+a_{3}$即得到矛盾. 故 $\left\{a_{n}\right\}$ 有界. 于是, 我们可以设正整数 $M$ 满足对任意正整数 $n$有 $a_{n} \leq M$.

因为数列有界, 所以在数列中出现的质因子也有限 (质因子一定 $\leq M$ ), 并且对每个质数, 其次数也必定有限 (事实上, 对质数 $p, a_{n}$ 的含 $p$ 量一定不超过 $\left.\log _{p} M\right)$.

设数列中出现的所有质因子为 $p_{1}, p_{2}, \cdots, p_{t}$. 取定 $p_{i}$ 和正整数 $\alpha_{i} \leq \log _{p_{i}} M$,记 $s=p_{i}^{\alpha_{i}}$. 如果对于同奇偶的两数 $n_{1}<n_{2}$ 满足 $s \mid a_{n_{1}}, a_{n_{2}}$, 那么因为 $a_{n_{2}} \mid a_{n_{1}}+$ $a_{\left(n_{1}+n_{2}\right) / 2}$, 就有 $s \mid a_{\left(n_{1}+n_{2}\right) / 2}$. 由此, 如果存在无穷多个 $n$ 满足 $s \mid a_{n}$, 我们取定前两个是 $s$ 倍数的 $a_{n_{1}}, a_{n_{2}}$, 就能依次推出 $n_{1}+n_{3}=2 n_{2}, n_{2}+n_{4}=2 n_{3}, \cdots$. 进而是 $s$ 的倍数的项最终周期.
对所有 $\left(p_{i}, \alpha_{i}\right)$ 用中国剩余定理, 得到 $\left\{a_{n}\right\}$ 最终周期.

N8. 求所有正整数 $n$, 使得存在 $P(x) \in \mathbb{Z}[x]$, 满足对任意正整数 $m$, $P^{(m)}(1), P^{(m)}(2), \cdots, P^{(m)}(n)$ 除以 $n$ 恰有 $\left\lceil\frac{n}{2^{m}}\right\rceil$ 个不同的余数. 这里 $P^{(m)}$ 表示 $P$ 的 $m$ 次迭代.

答案 所有 2 的幂及所有质数.

解 我们记 $S_{m, n}$ 为 $P^{(m)}\left(\mathbb{Z}_{n}\right)$ 在 $\bmod n$ 下取值集合, $f_{m, n}=\left|S_{m, n}\right|$. 那么,条件即 $f_{m, n}=\left\lceil\frac{n}{2^{m}}\right\rceil$ 对任意 $m \geq 1$ 成立. 这等价于对任意 $m \in \mathbb{N}$, 都有

$$
f_{m+1, n}=\left\lceil\frac{f_{m, n}}{2}\right\rceil
$$

第一步, 我们证明所有 2 的幂和质数都满足要求.

当 $n=2^{k}$ 时, 直接取 $P(x)=2 x$ 即可. 当 $n=p$ 为质数时, 熟知任意映射 $g: \mathbb{Z}_{p} \rightarrow \mathbb{Z}_{p}$ 都是一个整系数多项式, 于是一定存在满足要求的 $P$.

第二步, 我们证明当 $n$ 不是质数的幂次时, 一定不存在满足要求的 $P$.

设 $n=a b$, 其中 $(a, b)=1, a, b>1$. 注意到, 根据中国剩余定理,

$$
f_{m, a b}=f_{m, a} f_{m, b}
$$

并且如果 $f_{m, l}=f_{m+1, l}$, 那么对于任意 $s>m$, 都有 $f_{s, l}=f_{m, l}$. 因为在 $m$ 充分大时 $f_{m, a b}=1$, 得到对于任意 $m$, 有 $f_{m, a}>f_{m+1, a}$ 或者 $f_{m, a}=1$; 同理有 $b$.

于是, 存在最小的 $m$, 满足 $f_{m+1, a}=1$ 或 $f_{m+1, b}=1$. 不妨设 $f_{m+1, a}=1$, 那么

$$
f_{m+1, a b}=f_{m+1, b}<f_{m, b} \leq \frac{f_{m, a b}}{2} \leq f_{m+1, a b}
$$

矛盾!

第三步, 我们证明: 当 $n=p^{k}$, 其中 $p$ 为奇质数, $k \geq 2$ 时, 不存在满足要求的 $P$.

记 $S_{r}$ 为 $\mathbb{Z}_{n}$ 中所有 $\bmod p=r$ 的数构成的子集. 我们先证明一个引理.

引理对任意 $r$, 要么 $\left|P\left(S_{r}\right)\right|=p^{k-1}$, 要么 $\left|P\left(S_{r}\right)\right| \leq p^{k-2}$.

引理的证明 注意到 $P(r+h)=P(r)+h P^{\prime}(r)+h^{2} Q(r, h)$, 其中 $Q$ 为整系数多项式.

如果 $p \mid P^{\prime}(r)$, 则有 $P(r+p s) \equiv P(r)\left(\bmod p^{2}\right)$, 这表明所有 $P\left(S_{r}\right)$ 中的元素 $\bmod p^{2}$ 同余, 故 $\left|P\left(S_{r}\right)\right| \leq p^{k-2}$. 下设 $p \not P^{\prime}(r)$, 我们说明 $\left|P\left(S_{r}\right)\right|=p^{k-1}$.

反设 $\left|P\left(S_{r}\right)\right|<p^{k-1}$ 对某些 $k>1$ 成立. 我们选取最小的 $k$ 满足该条件.由 $k$ 的最小性, 如果考虑 $P\left(S_{r}\right)$ 中的元素 $\bmod p^{k-1}$ 构成的集合 $P^{\prime}\left(S_{r}\right)$, 那么
它恰含 $p^{k-2}$ 个元素. 于是

$$
\left|P\left(S_{r}\right)\right|<p \cdot\left|P^{\prime}\left(S_{r}\right)\right|
$$

这说明存在 $u=P(x) \in P\left(S_{r}\right)(x \equiv r(\bmod p))$ 和 $p \not t$, 满足 $u+p^{k-1} t \notin P\left(S_{r}\right)$.注意到,

$$
P\left(x+p^{k-1} s\right) \equiv u+p^{k-1} s P^{\prime}(x) \quad\left(\bmod p^{k}\right),
$$

这表明，

$$
p^{k-1} s P^{\prime}(x) \equiv p^{k-1} t \quad\left(\bmod p^{k}\right)
$$

没有解. 所以,

$$
s P^{\prime}(x) \equiv t \quad(\bmod p)
$$

没有解. 这与 $p X P^{\prime}(r)$ 矛盾! 引理证毕.

回到原题. 因为 $P^{m}\left(\mathbb{Z}_{n}\right)$ 所含元素个数在 $m$ 充分大时为 1 , 我们可以取最大的 $m$, 使得 $\left|P^{m-1}\left(S_{r}\right)\right|=p^{k-1}$ 对某些 $r \in \mathbb{Z}_{p}$ 成立. 我们定义

$$
a:=\left|P^{m}\left(\mathbb{Z}_{n}\right)-P^{m}\left(S_{r}\right)\right| \leq\left|P^{m-1}\left(\mathbb{Z}_{n}\right)-P^{m-1}\left(S_{r}\right)\right|
$$

于是,

$$
a+p^{k-1} \leq f_{m-1, p^{k}} \leq 2 f_{m, p^{k}} \leq 2 p^{k-2}+2 a
$$

故 $(p-2) p^{k-2} \leq a$. 注意到 $f_{i, p}=1$ 当 $i$ 充分大时成立, 存在唯一的 $t \in \mathbb{Z}_{p}$, 使得 $P(t) \equiv t(\bmod p)$. 更进一步, 当 $i$ 增长时, 集合

$$
\left\{s \in \mathbb{Z}_{p} \mid P^{i}(s) \equiv t \quad(\bmod p)\right\}=: T_{i}
$$

的大小不断严格增大, 直到变为 $\mathbb{Z}_{p}$. 所以, $T_{m-1} \geq \min \{p, m\}$.

注意到, 要么有 $f_{m-1, p}=1$, 要么存在 $X$ 为 $\mathbb{Z}_{p}$ 的元素个数至少为 $m$ 的真子集, 满足对任意 $x \in X$, 有 $P^{m-1}(x) \equiv t(\bmod p)$.

对于第一种情形, 有 $\left|P^{m-1}\left(\mathbb{Z}_{n}\right)\right| \leq p^{k-1}=\left|P^{m-1}\left(S_{r}\right)\right|$, 故 $a=0$, 矛盾.

对于第二种情形, 设 $Y$ 包含所有 $\mathbb{Z}_{n}$ 中的元素, 满足它在某个满足条件的 $X$ 中出现. 令 $Z=\mathbb{Z}_{n}-Y$. 则有 $P^{m-1}(Y)$ 为 $S_{t}$ 的真子集, $P\left(S_{t}\right)$ 为 $S_{t}$ 的真子集,

$$
Z=\bigcup_{i \in \mathbb{Z}_{p}-X} S_{i}
$$

所以

$$
\left|P^{m}(Y)\right| \leq\left|P\left(S_{t}\right)\right| \leq p^{k-2}
$$

且

$$
\left|P^{m}(Z)\right| \leq\left|\mathbb{Z}_{p}-X\right| \cdot p^{k-2} \leq(p-m) p^{k-2} .
$$

于是,

$$
(p-2) p^{k-2} \leq a<\left|P^{m}\left(\mathbb{Z}_{n}\right)\right| \leq\left|P^{m}(Y)\right|+\left|P^{m}(Z)\right| \leq(p-m+1) p^{k-2}
$$

所以 $m<3$, 故 $\left|P^{2}\left(S_{q}\right)\right| \leq p^{k-2}$ 对任意 $q$ 成立, 得到

$$
\frac{p^{k}}{4} \leq\left|P^{2}\left(\mathbb{Z}_{n}\right)\right| \leq p^{k-1}
$$

这表明 $p=3$. 对于 $p=3$ 的情形, 我们仍然设 $t \in\{0,1,2\}$ 满足 $P(t) \equiv t$ $(\bmod 3)$.

如果 $3 X P^{\prime}(t)$, 根据引理得到 $P\left(S_{t}\right)=S_{t}$, 矛盾!

如果 $3 \mid P^{\prime}(t)$. 在公式

$$
P(t+h)=P(t)+h P^{\prime}(t)+h^{2} Q(t, h)
$$

中代人 $h=3^{i} s$, 得到 $P\left(t+3^{i} s\right) \equiv P(t)\left(\bmod 3^{i+1}\right)$. 于是, 所有 $P^{i}\left(S_{t}\right)$ 中的元素 $\bmod 3^{i+1}$ 同余, 即 $\left|P^{k-1}\left(S_{t}\right)\right|=1$.

注意到 $f_{1,3} \leq 2, f_{2,3} \leq 1$, 所以 $P^{2}\left(\mathbb{Z}_{3^{k}}\right)$ 是 $S_{t}$ 的真子集. 得到

$$
\left|P^{k+1}\left(\mathbb{Z}_{3^{k}}\right)\right| \leq\left|P^{k-1}\left(S_{t}\right)\right|=1
$$

这立即得到 $3^{k} \leq 2^{k+1}$, 当 $k \geq 2$ 时不成立!

评注 非常困难的问题, 需要对多项式差分非常熟悉才比较好做.

