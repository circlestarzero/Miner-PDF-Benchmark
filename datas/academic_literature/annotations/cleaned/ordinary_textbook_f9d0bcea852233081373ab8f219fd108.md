# 一个球面点集划分问题 

尹顺 王琇

(湖南师范大学附属中学, 410006)

指导教师: 汤礼达

2020 年美国湾区数学竞赛的最后一题是:

问题 设 $a, b$ 为非负整数, $S$ 为球面 $\Omega$ 上 $a+b+3$ 个点的集合, 其中任意四点不共面. 求有多少个平面经过 $S$ 中三点, 使得其将 $S$ 中剩余的点分为一侧 $a$个点, 另一侧 $b$ 个点?

证明 先证明原问题等价于如下的平面问题:

问题* 设 $T$ 为平面上 $a+b+3$ 个点的集合, 其中任意三点不共线,任意四点不共圆. 称 $T$ 的一个三元子集是好的，如果经过这三点的圆的内部恰有 $T$ 中 $a$个或 $b$ 个点. 求好的三元子集数目.

任取 $\Omega$ 上一点 $P$, 使得 $P$ 不与 $S$ 中任意三点共面, 且 $P$ 与球心的连线不垂直于过 $S$ 中任意三点的平面. 考虑经过 $P$ 的对径点且与球面相切的平面 $\Gamma$. 定义映射 $i: \Omega \backslash\{P\} \rightarrow \Gamma$ 如下: 对 $\Omega$ 上任意异于点 $P$ 的一点 $Q, i(Q)$ 为直线 $P Q$与 $\Gamma$ 的交点.

我们说明对 $\Omega$ 上的任意一个圆周 $C$, 其在 $i$ 下的像仍然是一个圆.



修订日期: 2020-04-27.
事实上, 注意所有形如 $P X(X \in C)$ 的直线形成一个椭圆雉面 $F$, 且 $C$ 所在平面 $\Gamma_{1}$ 截 $F$ 得一个圆. 设 $C$ 上距离点 $P$ 最近和最远的两点分别为 $Q, R$ (由 $P$的选取知这样的点唯一存在), 则 $P, Q, R, i(Q), i(R)$ 共面, 且由射影定理有

$$
P Q \cdot \operatorname{Pi}(Q)=(d(P, \Gamma))^{2}=P R \cdot P i(R) .
$$

因此 $\triangle P Q R \sim \triangle P i(R) i(Q)$, 从而 $\angle R P Q$ 的平分线 $\ell$ 与直线 $Q R, i(Q) i(R)$ 的夹角相等.

注意到 $F$ 关于 $\ell$ 轴对称, 因此由上述夹角相等以及对称性知 $F$ 被 $\Gamma, \Gamma_{1}$ 所截图形相似. 因为 $\Gamma_{1}$ 截 $F$ 得一个圆, 故 $\Gamma$ 截 $F$ 所得图形, 即 $C$ 在 $i$ 下的像, 也是一个圆.

于是原问题等价于在平面 $\Gamma$ 上对点集 $T=i(S)$ 考虑问题*.

先通过一个特例求好的三元子集数目. 在平面直角坐标系 $x O y$ 中, 令

$$
T=\left\{A_{i}\left(x_{i}, x_{i}^{2}\right) \mid 1 \leqslant i \leqslant a+b+3\right\},
$$

其中 $0<x_{1}<\cdots<x_{a+b+3}$. 则直线 $A_{i} A_{j}$ 斜率为 $k_{i j}=\frac{x_{i}^{2}-x_{j}^{2}}{x_{i}-x_{j}}=x_{i}+x_{j}$.

对 $i<j<t$, 有

$$
\tan \angle A_{i} A_{t} A_{j}=\frac{k_{j t}-k_{i t}}{1+k_{j t} k_{i t}}=\frac{x_{j}-x_{i}}{1+\left(x_{j}+x_{t}\right)\left(x_{i}+x_{t}\right)}(>0),
$$

从而若固定 $i<j$, 则 $\angle A_{i} A_{t} A_{j}(t>j)$ 关于 $t$ 递减.

类似地, 对 $\ell<i<j$,

$$
\tan \angle A_{i} A_{\ell} A_{j}=\frac{x_{j}-x_{i}}{1+\left(x_{j}+x_{\ell}\right)\left(x_{i}+x_{\ell}\right)}(>0),
$$

故若固定 $i<j$, 则 $\angle A_{i} A_{\ell} A_{j}(\ell<i)$ 关于 $\ell$ 递减.

因此对任意 $i<j<k$, 当点 $X$ 在抛物线的弧 $O A_{i}$ (这里及以下, 所说的抛物线的弧均指不含端点)上时, 由 (2) 知 $\angle A_{j} X A_{k}>\angle A_{j} A_{i} A_{k}$, 故弧 $O A_{i}$在 $\odot\left(A_{i} A_{j} A_{k}\right)$ 内部.

类似地由 (2) 可知弧 $A_{j} A_{k}$ 在 $\odot\left(A_{i} A_{j} A_{k}\right)$ 内部, 而由 (1) 可知弧 $A_{i} A_{j}$ 以及 $A_{k}$ 右侧的抛物线在 $\odot\left(A_{i} A_{j} A_{k}\right)$ 外部.

由此可知 $\left\{A_{i}, A_{j}, A_{k}\right\}$ 为好的三元子集当且仅当弧 $O A_{i}, A_{j} A_{k}$ 上一共恰有 $a$ 或 $b$ 个已知点, 也即 $(i-1)+(k-j-1)=a$ 或 $b$.

若 $(i-1)+(k-j-1)=a$, 则 $i \leqslant a+1$. 对每个取定的 $i$, 应有

$$
i+1 \leqslant j \leqslant(a+b+3)+i-a-2=b+i+1 \text {, }
$$

故 $j$ 有 $b+1$ 种取值, 其中每个取值都对应着相应的一组满足要求的 $\{i, j, k\}$,共 $(a+1)(b+1)$ 组.



同理恰有 $(a+1)(b+1)$ 组 $\{i, j, k\}$ 满足 $(i-1)+(k-j-1)=b$, 因此这时好的三元子集数目为

$$
\left\{\begin{array}{c}
2(a+1)(b+1), \text { 若 } a \neq b, \\
(a+1)(b+1), \text { 若 } a=b .
\end{array}\right.
$$

最后说明对任意一般的 $T$, 均可以适当对其进行操作化为上述特例, 而不改变好的三元子集数目. 这只需证明任取 $T$ 中一个点 $U$, 对其适当进行移动时不会改变好的三元子集的数目.

我们将 $T \backslash\{U\}$ 中任两点确定的直线以及任三点确定的圆取出, 再取出所有这些图形两两之间的全体交点, 这些交点只有有限个.

任意取定一个方向, 使得 $U$ 沿此方向移动时不经过上述交点中的任意一个. $(*)$

下面证明当 $U$ 沿此方向移动到任意位置(使得 $T$ 中无三点共线或四点共圆,将这称作“合理位置”)时, 好的三元子集数目不变.

在运动过程中定义两种“临界状态”: 有四点共圆时称为临界状态 I, 有三点共线时称为临界状态 II. 点 $U$ 从初始时间 $t_{0}=0$ 开始匀速移动, 如果任一时刻点 $U$ 不在合理位置, 则此刻必然产生某类临界状态.

易知若 $U$ 从一个合理位置移动到另一个合理位置时没有产生过临界状态,则好的三元子集数目不变. 下面假设有临界状态产生, 由方向的选取满足 $(*)$ 知两种临界状态不会同时产生, 因此只要考虑恰产生一次临界状态的情况.

设在 $t_{1}$ 时刻产生了临界状态, 对临界状态的类型分类讨论.

1. I 型临界状态. 设 $t_{1}$ 时刻 $U$ 与 $T$ 中另外三点 $A, B, C$ 共圆, 且这时 $\odot(U A B C)$ 内部有 $r(r \in \mathbb{N})$ 个已知点. 结合 $(*)$ 可知存在 $\varepsilon>0$, 使得在 $\left[t_{1}-\varepsilon, t_{1}+\varepsilon\right]$ 中任意时刻, 对任意过 $T$ 中三点且异于 $\odot(U A B C)$ 的圆, 其内部的 $T$ 中元素数目恒为常数; 同时 $U, A, B, C$ 的凸包恒为四边形, 不妨设四点即
按此顺序作为凸四边形的四个顶点.

在 $t_{1}-\varepsilon$ 时刻, $U$ 在 $\odot(A B C)$ 外, 从而 $\angle B A C>\angle B U C$. 于是 $\odot(A B C)$ 内部点数为 $r, \odot(U B C)$ 内部点数为 $r+1$.

同时此时 $\angle A B U \neq \angle A C U$, 故 $\odot(U A B)$ 和 $\odot(U A C)$ 内部点数为 $r, r+1$ (不一定按照这个顺序).

类似地, 在 $t_{1}+\varepsilon$ 时刻, $U$ 在 $\odot(A B C)$ 内, 从而 $\angle B A C<\angle B U C$. 于是 $\odot(A B C)$ 内部点数为 $r+1, \odot(U B C)$ 内部点数为 $r$, 而 $\odot(U A B)$ 和 $\odot(U A C)$内部点数为 $r, r+1$ (不一定按照这个顺序).

由此可见好的三元子集数目不发生改变.


2. II 型临界状态. 设 $t_{1}$ 时刻 $U$ 与 $T$ 中另外两点 $A, B$ 共线. 则结合 $(*)$ 可知存在 $\varepsilon>0$, 使得在 $\left[t_{1}-\varepsilon, t_{1}\right) \cup\left(t_{1}, t_{1}+\varepsilon\right]$ 中任意时刻, 对任意过 $T$ 中三点且异于 $\odot(U A B)$ 的圆, 其内部的点数恒为常数; 同时 $\odot(U A B)$ 内部的已知点恰好为直线 $A B$ 某侧(除 $U$ 外)的全体已知点.

由于直线 $A B$ 两侧除 $U$ 外已知点数目之和为 $a+b$, 因此在 $t_{1}-\varepsilon, t_{1}+\varepsilon$ 两时刻, $\{U, A, B\}$ 要么同时是好的三元子集, 要么同时不是.

因此这种情况下好的三元子集数目也不变.


综上, 在满足按照 $(*)$ 的前提下移动 $T$ 中任意一点时, 好的三元子集数目不变. 对任意初始的 $T$, 容易经有限步这样的移动化归为特例中情形, 从而可知好的三元子集数目为

$$
\left\{\begin{array}{l}
2(a+1)(b+1), \text { 若 } a \neq b, \\
(a+1)(b+1), \text { 若 } a=b .
\end{array}\right.
$$

评注 原问题在球面上考虑, 不利于思考几何图形的位置关系, 通过球极反演化为平面问题*后更加直观. 注意问题本身暗示答案与各点的位置无关, 这提示我们一方面可以通过研究特例得到答案, 另一方面对一般的点集有某种方式将其化归为特例。

特例的选取要求是便于计算好的三元子集数目, 这可以通过某种凸性达到,因此我们选择抛物线上的点作为特例. 化归的办法是移动已知点, 其中的关键想法是将移动过程分解为若干个临界状态. 在离临界状态充分近的时刻, 点的移动对好的三元子集影响较小, 这为论证提供了方便.

